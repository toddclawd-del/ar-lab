(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function j2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var b3={exports:{}},qy={};var qD;function xQ(){if(qD)return qy;qD=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,s){var a=null;if(s!==void 0&&(a=""+s),r.key!==void 0&&(a=""+r.key),"key"in r){s={};for(var o in r)o!=="key"&&(s[o]=r[o])}else s=r;return r=s.ref,{$$typeof:n,type:i,key:a,ref:r!==void 0?r:null,props:s}}return qy.Fragment=e,qy.jsx=t,qy.jsxs=t,qy}var XD;function _Q(){return XD||(XD=1,b3.exports=xQ()),b3.exports}var D=_Q(),x3={exports:{}},Nn={};var YD;function SQ(){if(YD)return Nn;YD=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),A=Symbol.iterator;function v(z){return z===null||typeof z!="object"?null:(z=A&&z[A]||z["@@iterator"],typeof z=="function"?z:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,_={};function E(z,$,ae){this.props=z,this.context=$,this.refs=_,this.updater=ae||x}E.prototype.isReactComponent={},E.prototype.setState=function(z,$){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,$,"setState")},E.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function C(){}C.prototype=E.prototype;function T(z,$,ae){this.props=z,this.context=$,this.refs=_,this.updater=ae||x}var R=T.prototype=new C;R.constructor=T,S(R,E.prototype),R.isPureReactComponent=!0;var B=Array.isArray;function U(){}var O={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function L(z,$,ae){var he=ae.ref;return{$$typeof:n,type:z,key:$,ref:he!==void 0?he:null,props:ae}}function P(z,$){return L(z.type,$,z.props)}function W(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function j(z){var $={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(ae){return $[ae]})}var V=/\/+/g;function q(z,$){return typeof z=="object"&&z!==null&&z.key!=null?j(""+z.key):$.toString(36)}function re(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(U,U):(z.status="pending",z.then(function($){z.status==="pending"&&(z.status="fulfilled",z.value=$)},function($){z.status==="pending"&&(z.status="rejected",z.reason=$)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function Q(z,$,ae,he,me){var le=typeof z;(le==="undefined"||le==="boolean")&&(z=null);var fe=!1;if(z===null)fe=!0;else switch(le){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(z.$$typeof){case n:case e:fe=!0;break;case p:return fe=z._init,Q(fe(z._payload),$,ae,he,me)}}if(fe)return me=me(z),fe=he===""?"."+q(z,0):he,B(me)?(ae="",fe!=null&&(ae=fe.replace(V,"$&/")+"/"),Q(me,$,ae,"",function(et){return et})):me!=null&&(W(me)&&(me=P(me,ae+(me.key==null||z&&z.key===me.key?"":(""+me.key).replace(V,"$&/")+"/")+fe)),$.push(me)),1;fe=0;var _e=he===""?".":he+":";if(B(z))for(var Pe=0;Pe<z.length;Pe++)he=z[Pe],le=_e+q(he,Pe),fe+=Q(he,$,ae,le,me);else if(Pe=v(z),typeof Pe=="function")for(z=Pe.call(z),Pe=0;!(he=z.next()).done;)he=he.value,le=_e+q(he,Pe++),fe+=Q(he,$,ae,le,me);else if(le==="object"){if(typeof z.then=="function")return Q(re(z),$,ae,he,me);throw $=String(z),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return fe}function K(z,$,ae){if(z==null)return z;var he=[],me=0;return Q(z,he,"","",function(le){return $.call(ae,le,me++)}),he}function ce(z){if(z._status===-1){var $=z._result;$=$(),$.then(function(ae){(z._status===0||z._status===-1)&&(z._status=1,z._result=ae)},function(ae){(z._status===0||z._status===-1)&&(z._status=2,z._result=ae)}),z._status===-1&&(z._status=0,z._result=$)}if(z._status===1)return z._result.default;throw z._result}var ue=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)},oe={map:K,forEach:function(z,$,ae){K(z,function(){$.apply(this,arguments)},ae)},count:function(z){var $=0;return K(z,function(){$++}),$},toArray:function(z){return K(z,function($){return $})||[]},only:function(z){if(!W(z))throw Error("React.Children.only expected to receive a single React element child.");return z}};return Nn.Activity=g,Nn.Children=oe,Nn.Component=E,Nn.Fragment=t,Nn.Profiler=r,Nn.PureComponent=T,Nn.StrictMode=i,Nn.Suspense=c,Nn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Nn.__COMPILER_RUNTIME={__proto__:null,c:function(z){return O.H.useMemoCache(z)}},Nn.cache=function(z){return function(){return z.apply(null,arguments)}},Nn.cacheSignal=function(){return null},Nn.cloneElement=function(z,$,ae){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var he=S({},z.props),me=z.key;if($!=null)for(le in $.key!==void 0&&(me=""+$.key),$)!F.call($,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&$.ref===void 0||(he[le]=$[le]);var le=arguments.length-2;if(le===1)he.children=ae;else if(1<le){for(var fe=Array(le),_e=0;_e<le;_e++)fe[_e]=arguments[_e+2];he.children=fe}return L(z.type,me,he)},Nn.createContext=function(z){return z={$$typeof:a,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:s,_context:z},z},Nn.createElement=function(z,$,ae){var he,me={},le=null;if($!=null)for(he in $.key!==void 0&&(le=""+$.key),$)F.call($,he)&&he!=="key"&&he!=="__self"&&he!=="__source"&&(me[he]=$[he]);var fe=arguments.length-2;if(fe===1)me.children=ae;else if(1<fe){for(var _e=Array(fe),Pe=0;Pe<fe;Pe++)_e[Pe]=arguments[Pe+2];me.children=_e}if(z&&z.defaultProps)for(he in fe=z.defaultProps,fe)me[he]===void 0&&(me[he]=fe[he]);return L(z,le,me)},Nn.createRef=function(){return{current:null}},Nn.forwardRef=function(z){return{$$typeof:o,render:z}},Nn.isValidElement=W,Nn.lazy=function(z){return{$$typeof:p,_payload:{_status:-1,_result:z},_init:ce}},Nn.memo=function(z,$){return{$$typeof:h,type:z,compare:$===void 0?null:$}},Nn.startTransition=function(z){var $=O.T,ae={};O.T=ae;try{var he=z(),me=O.S;me!==null&&me(ae,he),typeof he=="object"&&he!==null&&typeof he.then=="function"&&he.then(U,ue)}catch(le){ue(le)}finally{$!==null&&ae.types!==null&&($.types=ae.types),O.T=$}},Nn.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Nn.use=function(z){return O.H.use(z)},Nn.useActionState=function(z,$,ae){return O.H.useActionState(z,$,ae)},Nn.useCallback=function(z,$){return O.H.useCallback(z,$)},Nn.useContext=function(z){return O.H.useContext(z)},Nn.useDebugValue=function(){},Nn.useDeferredValue=function(z,$){return O.H.useDeferredValue(z,$)},Nn.useEffect=function(z,$){return O.H.useEffect(z,$)},Nn.useEffectEvent=function(z){return O.H.useEffectEvent(z)},Nn.useId=function(){return O.H.useId()},Nn.useImperativeHandle=function(z,$,ae){return O.H.useImperativeHandle(z,$,ae)},Nn.useInsertionEffect=function(z,$){return O.H.useInsertionEffect(z,$)},Nn.useLayoutEffect=function(z,$){return O.H.useLayoutEffect(z,$)},Nn.useMemo=function(z,$){return O.H.useMemo(z,$)},Nn.useOptimistic=function(z,$){return O.H.useOptimistic(z,$)},Nn.useReducer=function(z,$,ae){return O.H.useReducer(z,$,ae)},Nn.useRef=function(z){return O.H.useRef(z)},Nn.useState=function(z){return O.H.useState(z)},Nn.useSyncExternalStore=function(z,$,ae){return O.H.useSyncExternalStore(z,$,ae)},Nn.useTransition=function(){return O.H.useTransition()},Nn.version="19.2.4",Nn}var KD;function jb(){return KD||(KD=1,x3.exports=SQ()),x3.exports}var X=jb();const Gd=j2(X);var _3={exports:{}},Xy={},S3={exports:{}},E3={};var $D;function EQ(){return $D||($D=1,(function(n){function e(Q,K){var ce=Q.length;Q.push(K);e:for(;0<ce;){var ue=ce-1>>>1,oe=Q[ue];if(0<r(oe,K))Q[ue]=K,Q[ce]=oe,ce=ue;else break e}}function t(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var K=Q[0],ce=Q.pop();if(ce!==K){Q[0]=ce;e:for(var ue=0,oe=Q.length,z=oe>>>1;ue<z;){var $=2*(ue+1)-1,ae=Q[$],he=$+1,me=Q[he];if(0>r(ae,ce))he<oe&&0>r(me,ae)?(Q[ue]=me,Q[he]=ce,ue=he):(Q[ue]=ae,Q[$]=ce,ue=$);else if(he<oe&&0>r(me,ce))Q[ue]=me,Q[he]=ce,ue=he;else break e}}return K}function r(Q,K){var ce=Q.sortIndex-K.sortIndex;return ce!==0?ce:Q.id-K.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var c=[],h=[],p=1,g=null,A=3,v=!1,x=!1,S=!1,_=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function R(Q){for(var K=t(h);K!==null;){if(K.callback===null)i(h);else if(K.startTime<=Q)i(h),K.sortIndex=K.expirationTime,e(c,K);else break;K=t(h)}}function B(Q){if(S=!1,R(Q),!x)if(t(c)!==null)x=!0,U||(U=!0,j());else{var K=t(h);K!==null&&re(B,K.startTime-Q)}}var U=!1,O=-1,F=5,L=-1;function P(){return _?!0:!(n.unstable_now()-L<F)}function W(){if(_=!1,U){var Q=n.unstable_now();L=Q;var K=!0;try{e:{x=!1,S&&(S=!1,C(O),O=-1),v=!0;var ce=A;try{t:{for(R(Q),g=t(c);g!==null&&!(g.expirationTime>Q&&P());){var ue=g.callback;if(typeof ue=="function"){g.callback=null,A=g.priorityLevel;var oe=ue(g.expirationTime<=Q);if(Q=n.unstable_now(),typeof oe=="function"){g.callback=oe,R(Q),K=!0;break t}g===t(c)&&i(c),R(Q)}else i(c);g=t(c)}if(g!==null)K=!0;else{var z=t(h);z!==null&&re(B,z.startTime-Q),K=!1}}break e}finally{g=null,A=ce,v=!1}K=void 0}}finally{K?j():U=!1}}}var j;if(typeof T=="function")j=function(){T(W)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,q=V.port2;V.port1.onmessage=W,j=function(){q.postMessage(null)}}else j=function(){E(W,0)};function re(Q,K){O=E(function(){Q(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return A},n.unstable_next=function(Q){switch(A){case 1:case 2:case 3:var K=3;break;default:K=A}var ce=A;A=K;try{return Q()}finally{A=ce}},n.unstable_requestPaint=function(){_=!0},n.unstable_runWithPriority=function(Q,K){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ce=A;A=Q;try{return K()}finally{A=ce}},n.unstable_scheduleCallback=function(Q,K,ce){var ue=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ue+ce:ue):ce=ue,Q){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=ce+oe,Q={id:p++,callback:K,priorityLevel:Q,startTime:ce,expirationTime:oe,sortIndex:-1},ce>ue?(Q.sortIndex=ce,e(h,Q),t(c)===null&&Q===t(h)&&(S?(C(O),O=-1):S=!0,re(B,ce-ue))):(Q.sortIndex=oe,e(c,Q),x||v||(x=!0,U||(U=!0,j()))),Q},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(Q){var K=A;return function(){var ce=A;A=K;try{return Q.apply(this,arguments)}finally{A=ce}}}})(E3)),E3}var JD;function pk(){return JD||(JD=1,S3.exports=EQ()),S3.exports}var w3={exports:{}},Da={};var ZD;function wQ(){if(ZD)return Da;ZD=1;var n=jb();function e(c){var h="https://react.dev/errors/"+c;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(c,h,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:g==null?null:""+g,children:c,containerInfo:h,implementation:p}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(c,h){if(c==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Da.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Da.createPortal=function(c,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return s(c,h,null,p)},Da.flushSync=function(c){var h=a.T,p=i.p;try{if(a.T=null,i.p=2,c)return c()}finally{a.T=h,i.p=p,i.d.f()}},Da.preconnect=function(c,h){typeof c=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,i.d.C(c,h))},Da.prefetchDNS=function(c){typeof c=="string"&&i.d.D(c)},Da.preinit=function(c,h){if(typeof c=="string"&&h&&typeof h.as=="string"){var p=h.as,g=o(p,h.crossOrigin),A=typeof h.integrity=="string"?h.integrity:void 0,v=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?i.d.S(c,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:g,integrity:A,fetchPriority:v}):p==="script"&&i.d.X(c,{crossOrigin:g,integrity:A,fetchPriority:v,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Da.preinitModule=function(c,h){if(typeof c=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=o(h.as,h.crossOrigin);i.d.M(c,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&i.d.M(c)},Da.preload=function(c,h){if(typeof c=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,g=o(p,h.crossOrigin);i.d.L(c,p,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Da.preloadModule=function(c,h){if(typeof c=="string")if(h){var p=o(h.as,h.crossOrigin);i.d.m(c,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else i.d.m(c)},Da.requestFormReset=function(c){i.d.r(c)},Da.unstable_batchedUpdates=function(c,h){return c(h)},Da.useFormState=function(c,h,p){return a.H.useFormState(c,h,p)},Da.useFormStatus=function(){return a.H.useHostTransitionStatus()},Da.version="19.2.4",Da}var eL;function MQ(){if(eL)return w3.exports;eL=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),w3.exports=wQ(),w3.exports}var tL;function CQ(){if(tL)return Xy;tL=1;var n=pk(),e=jb(),t=MQ();function i(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)u+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function s(l){var u=l,m=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(m=u.return),l=u.return;while(l)}return u.tag===3?m:null}function a(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function o(l){if(l.tag===31){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function c(l){if(s(l)!==l)throw Error(i(188))}function h(l){var u=l.alternate;if(!u){if(u=s(l),u===null)throw Error(i(188));return u!==l?null:l}for(var m=l,y=u;;){var M=m.return;if(M===null)break;var I=M.alternate;if(I===null){if(y=M.return,y!==null){m=y;continue}break}if(M.child===I.child){for(I=M.child;I;){if(I===m)return c(M),l;if(I===y)return c(M),u;I=I.sibling}throw Error(i(188))}if(m.return!==y.return)m=M,y=I;else{for(var G=!1,ie=M.child;ie;){if(ie===m){G=!0,m=M,y=I;break}if(ie===y){G=!0,y=M,m=I;break}ie=ie.sibling}if(!G){for(ie=I.child;ie;){if(ie===m){G=!0,m=I,y=M;break}if(ie===y){G=!0,y=I,m=M;break}ie=ie.sibling}if(!G)throw Error(i(189))}}if(m.alternate!==y)throw Error(i(190))}if(m.tag!==3)throw Error(i(188));return m.stateNode.current===m?l:u}function p(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l;for(l=l.child;l!==null;){if(u=p(l),u!==null)return u;l=l.sibling}return null}var g=Object.assign,A=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),T=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function j(l){return l===null||typeof l!="object"?null:(l=W&&l[W]||l["@@iterator"],typeof l=="function"?l:null)}var V=Symbol.for("react.client.reference");function q(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===V?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case S:return"Fragment";case E:return"Profiler";case _:return"StrictMode";case B:return"Suspense";case U:return"SuspenseList";case L:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case x:return"Portal";case T:return l.displayName||"Context";case C:return(l._context.displayName||"Context")+".Consumer";case R:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case O:return u=l.displayName||null,u!==null?u:q(l.type)||"Memo";case F:u=l._payload,l=l._init;try{return q(l(u))}catch{}}return null}var re=Array.isArray,Q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},ue=[],oe=-1;function z(l){return{current:l}}function $(l){0>oe||(l.current=ue[oe],ue[oe]=null,oe--)}function ae(l,u){oe++,ue[oe]=l.current,l.current=u}var he=z(null),me=z(null),le=z(null),fe=z(null);function _e(l,u){switch(ae(le,u),ae(me,l),ae(he,null),u.nodeType){case 9:case 11:l=(l=u.documentElement)&&(l=l.namespaceURI)?gD(l):0;break;default:if(l=u.tagName,u=u.namespaceURI)u=gD(u),l=AD(u,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}$(he),ae(he,l)}function Pe(){$(he),$(me),$(le)}function et(l){l.memoizedState!==null&&ae(fe,l);var u=he.current,m=AD(u,l.type);u!==m&&(ae(me,l),ae(he,m))}function ot(l){me.current===l&&($(he),$(me)),fe.current===l&&($(fe),Qy._currentValue=ce)}var Je,_t;function Be(l){if(Je===void 0)try{throw Error()}catch(m){var u=m.stack.trim().match(/\n( *(at )?)/);Je=u&&u[1]||"",_t=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Je+l+_t}var Le=!1;function Te(l,u){if(!l||Le)return"";Le=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(u){var mt=function(){throw Error()};if(Object.defineProperty(mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(mt,[])}catch($e){var Ge=$e}Reflect.construct(l,[],mt)}else{try{mt.call()}catch($e){Ge=$e}l.call(mt.prototype)}}else{try{throw Error()}catch($e){Ge=$e}(mt=l())&&typeof mt.catch=="function"&&mt.catch(function(){})}}catch($e){if($e&&Ge&&typeof $e.stack=="string")return[$e.stack,Ge.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var I=y.DetermineComponentFrameRoot(),G=I[0],ie=I[1];if(G&&ie){var Ae=G.split(`
`),Oe=ie.split(`
`);for(M=y=0;y<Ae.length&&!Ae[y].includes("DetermineComponentFrameRoot");)y++;for(;M<Oe.length&&!Oe[M].includes("DetermineComponentFrameRoot");)M++;if(y===Ae.length||M===Oe.length)for(y=Ae.length-1,M=Oe.length-1;1<=y&&0<=M&&Ae[y]!==Oe[M];)M--;for(;1<=y&&0<=M;y--,M--)if(Ae[y]!==Oe[M]){if(y!==1||M!==1)do if(y--,M--,0>M||Ae[y]!==Oe[M]){var lt=`
`+Ae[y].replace(" at new "," at ");return l.displayName&&lt.includes("<anonymous>")&&(lt=lt.replace("<anonymous>",l.displayName)),lt}while(1<=y&&0<=M);break}}}finally{Le=!1,Error.prepareStackTrace=m}return(m=l?l.displayName||l.name:"")?Be(m):""}function Ye(l,u){switch(l.tag){case 26:case 27:case 5:return Be(l.type);case 16:return Be("Lazy");case 13:return l.child!==u&&u!==null?Be("Suspense Fallback"):Be("Suspense");case 19:return Be("SuspenseList");case 0:case 15:return Te(l.type,!1);case 11:return Te(l.type.render,!1);case 1:return Te(l.type,!0);case 31:return Be("Activity");default:return""}}function ne(l){try{var u="",m=null;do u+=Ye(l,m),m=l,l=l.return;while(l);return u}catch(y){return`
Error generating stack: `+y.message+`
`+y.stack}}var ft=Object.prototype.hasOwnProperty,qe=n.unstable_scheduleCallback,Ne=n.unstable_cancelCallback,tt=n.unstable_shouldYield,Z=n.unstable_requestPaint,H=n.unstable_now,de=n.unstable_getCurrentPriorityLevel,De=n.unstable_ImmediatePriority,Ie=n.unstable_UserBlockingPriority,we=n.unstable_NormalPriority,st=n.unstable_LowPriority,it=n.unstable_IdlePriority,It=n.log,Ot=n.unstable_setDisableYieldValue,Qe=null,Ve=null;function at(l){if(typeof It=="function"&&Ot(l),Ve&&typeof Ve.setStrictMode=="function")try{Ve.setStrictMode(Qe,l)}catch{}}var bt=Math.clz32?Math.clz32:ve,ht=Math.log,Vt=Math.LN2;function ve(l){return l>>>=0,l===0?32:31-(ht(l)/Vt|0)|0}var Me=256,rt=262144,Ut=4194304;function nt(l){var u=l&42;if(u!==0)return u;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function ke(l,u,m){var y=l.pendingLanes;if(y===0)return 0;var M=0,I=l.suspendedLanes,G=l.pingedLanes;l=l.warmLanes;var ie=y&134217727;return ie!==0?(y=ie&~I,y!==0?M=nt(y):(G&=ie,G!==0?M=nt(G):m||(m=ie&~l,m!==0&&(M=nt(m))))):(ie=y&~I,ie!==0?M=nt(ie):G!==0?M=nt(G):m||(m=y&~l,m!==0&&(M=nt(m)))),M===0?0:u!==0&&u!==M&&(u&I)===0&&(I=M&-M,m=u&-u,I>=m||I===32&&(m&4194048)!==0)?u:M}function gt(l,u){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&u)===0}function Qt(l,u){switch(l){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kt(){var l=Ut;return Ut<<=1,(Ut&62914560)===0&&(Ut=4194304),l}function rn(l){for(var u=[],m=0;31>m;m++)u.push(l);return u}function ti(l,u){l.pendingLanes|=u,u!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function ui(l,u,m,y,M,I){var G=l.pendingLanes;l.pendingLanes=m,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=m,l.entangledLanes&=m,l.errorRecoveryDisabledLanes&=m,l.shellSuspendCounter=0;var ie=l.entanglements,Ae=l.expirationTimes,Oe=l.hiddenUpdates;for(m=G&~m;0<m;){var lt=31-bt(m),mt=1<<lt;ie[lt]=0,Ae[lt]=-1;var Ge=Oe[lt];if(Ge!==null)for(Oe[lt]=null,lt=0;lt<Ge.length;lt++){var $e=Ge[lt];$e!==null&&($e.lane&=-536870913)}m&=~mt}y!==0&&vi(l,y,0),I!==0&&M===0&&l.tag!==0&&(l.suspendedLanes|=I&~(G&~u))}function vi(l,u,m){l.pendingLanes|=u,l.suspendedLanes&=~u;var y=31-bt(u);l.entangledLanes|=u,l.entanglements[y]=l.entanglements[y]|1073741824|m&261930}function yr(l,u){var m=l.entangledLanes|=u;for(l=l.entanglements;m;){var y=31-bt(m),M=1<<y;M&u|l[y]&u&&(l[y]|=u),m&=~M}}function Ir(l,u){var m=u&-u;return m=(m&42)!==0?1:qr(m),(m&(l.suspendedLanes|u))!==0?0:m}function qr(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function Ki(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function Rr(){var l=K.p;return l!==0?l:(l=window.event,l===void 0?32:zD(l.type))}function en(l,u){var m=K.p;try{return K.p=l,u()}finally{K.p=m}}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,Y="__reactProps$"+di,se="__reactContainer$"+di,ge="__reactEvents$"+di,Ue="__reactListeners$"+di,je="__reactHandles$"+di,Xe="__reactResources$"+di,xt="__reactMarker$"+di;function At(l){delete l[hi],delete l[Y],delete l[ge],delete l[Ue],delete l[je]}function Ct(l){var u=l[hi];if(u)return u;for(var m=l.parentNode;m;){if(u=m[se]||m[hi]){if(m=u.alternate,u.child!==null||m!==null&&m.child!==null)for(l=ED(l);l!==null;){if(m=l[hi])return m;l=ED(l)}return u}l=m,m=l.parentNode}return null}function Tt(l){if(l=l[hi]||l[se]){var u=l.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return l}return null}function Dt(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l.stateNode;throw Error(i(33))}function He(l){var u=l[Xe];return u||(u=l[Xe]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function J(l){l[xt]=!0}var pe=new Set,xe={};function Se(l,u){be(l,u),be(l+"Capture",u)}function be(l,u){for(xe[l]=u,l=0;l<u.length;l++)pe.add(u[l])}var ct=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yt={},ut={};function Ft(l){return ft.call(ut,l)?!0:ft.call(yt,l)?!1:ct.test(l)?ut[l]=!0:(yt[l]=!0,!1)}function wt(l,u,m){if(Ft(u))if(m===null)l.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":l.removeAttribute(u);return;case"boolean":var y=u.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){l.removeAttribute(u);return}}l.setAttribute(u,""+m)}}function Yt(l,u,m){if(m===null)l.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(u);return}l.setAttribute(u,""+m)}}function Bt(l,u,m,y){if(y===null)l.removeAttribute(m);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(m);return}l.setAttributeNS(u,m,""+y)}}function jt(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function yn(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function Kn(l,u,m){var y=Object.getOwnPropertyDescriptor(l.constructor.prototype,u);if(!l.hasOwnProperty(u)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var M=y.get,I=y.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return M.call(this)},set:function(G){m=""+G,I.call(this,G)}}),Object.defineProperty(l,u,{enumerable:y.enumerable}),{getValue:function(){return m},setValue:function(G){m=""+G},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function Sn(l){if(!l._valueTracker){var u=yn(l)?"checked":"value";l._valueTracker=Kn(l,u,""+l[u])}}function zt(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var m=u.getValue(),y="";return l&&(y=yn(l)?l.checked?"true":"false":l.value),l=y,l!==m?(u.setValue(l),!0):!1}function St(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var $t=/[\n"\\]/g;function Lt(l){return l.replace($t,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function ni(l,u,m,y,M,I,G,ie){l.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?l.type=G:l.removeAttribute("type"),u!=null?G==="number"?(u===0&&l.value===""||l.value!=u)&&(l.value=""+jt(u)):l.value!==""+jt(u)&&(l.value=""+jt(u)):G!=="submit"&&G!=="reset"||l.removeAttribute("value"),u!=null?In(l,G,jt(u)):m!=null?In(l,G,jt(m)):y!=null&&l.removeAttribute("value"),M==null&&I!=null&&(l.defaultChecked=!!I),M!=null&&(l.checked=M&&typeof M!="function"&&typeof M!="symbol"),ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"?l.name=""+jt(ie):l.removeAttribute("name")}function $i(l,u,m,y,M,I,G,ie){if(I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(l.type=I),u!=null||m!=null){if(!(I!=="submit"&&I!=="reset"||u!=null)){Sn(l);return}m=m!=null?""+jt(m):"",u=u!=null?""+jt(u):m,ie||u===l.value||(l.value=u),l.defaultValue=u}y=y??M,y=typeof y!="function"&&typeof y!="symbol"&&!!y,l.checked=ie?l.checked:!!y,l.defaultChecked=!!y,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(l.name=G),Sn(l)}function In(l,u,m){u==="number"&&St(l.ownerDocument)===l||l.defaultValue===""+m||(l.defaultValue=""+m)}function Oi(l,u,m,y){if(l=l.options,u){u={};for(var M=0;M<m.length;M++)u["$"+m[M]]=!0;for(m=0;m<l.length;m++)M=u.hasOwnProperty("$"+l[m].value),l[m].selected!==M&&(l[m].selected=M),M&&y&&(l[m].defaultSelected=!0)}else{for(m=""+jt(m),u=null,M=0;M<l.length;M++){if(l[M].value===m){l[M].selected=!0,y&&(l[M].defaultSelected=!0);return}u!==null||l[M].disabled||(u=l[M])}u!==null&&(u.selected=!0)}}function $n(l,u,m){if(u!=null&&(u=""+jt(u),u!==l.value&&(l.value=u),m==null)){l.defaultValue!==u&&(l.defaultValue=u);return}l.defaultValue=m!=null?""+jt(m):""}function Ji(l,u,m,y){if(u==null){if(y!=null){if(m!=null)throw Error(i(92));if(re(y)){if(1<y.length)throw Error(i(93));y=y[0]}m=y}m==null&&(m=""),u=m}m=jt(u),l.defaultValue=m,y=l.textContent,y===m&&y!==""&&y!==null&&(l.value=y),Sn(l)}function Zi(l,u){if(u){var m=l.firstChild;if(m&&m===l.lastChild&&m.nodeType===3){m.nodeValue=u;return}}l.textContent=u}var Br=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Dr(l,u,m){var y=u.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?y?l.setProperty(u,""):u==="float"?l.cssFloat="":l[u]="":y?l.setProperty(u,m):typeof m!="number"||m===0||Br.has(u)?u==="float"?l.cssFloat=m:l[u]=(""+m).trim():l[u]=m+"px"}function Ho(l,u,m){if(u!=null&&typeof u!="object")throw Error(i(62));if(l=l.style,m!=null){for(var y in m)!m.hasOwnProperty(y)||u!=null&&u.hasOwnProperty(y)||(y.indexOf("--")===0?l.setProperty(y,""):y==="float"?l.cssFloat="":l[y]="");for(var M in u)y=u[M],u.hasOwnProperty(M)&&m[M]!==y&&Dr(l,M,y)}else for(var I in u)u.hasOwnProperty(I)&&Dr(l,I,u[I])}function ps(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ip=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),eu=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function co(l){return eu.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}function Gs(){}var xl=null;function ch(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Ga=null,uo=null;function uh(l){var u=Tt(l);if(u&&(l=u.stateNode)){var m=l[Y]||null;e:switch(l=u.stateNode,u.type){case"input":if(ni(l,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),u=m.name,m.type==="radio"&&u!=null){for(m=l;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+Lt(""+u)+'"][type="radio"]'),u=0;u<m.length;u++){var y=m[u];if(y!==l&&y.form===l.form){var M=y[Y]||null;if(!M)throw Error(i(90));ni(y,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(u=0;u<m.length;u++)y=m[u],y.form===l.form&&zt(y)}break e;case"textarea":$n(l,m.value,m.defaultValue);break e;case"select":u=m.value,u!=null&&Oi(l,!!m.multiple,u,!1)}}}var hh=!1;function tu(l,u,m){if(hh)return l(u,m);hh=!0;try{var y=l(u);return y}finally{if(hh=!1,(Ga!==null||uo!==null)&&(Ko(),Ga&&(u=Ga,l=uo,uo=Ga=null,uh(u),l)))for(u=0;u<l.length;u++)uh(l[u])}}function _l(l,u){var m=l.stateNode;if(m===null)return null;var y=m[Y]||null;if(y===null)return null;m=y[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(l=l.type,y=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!y;break e;default:l=!1}if(l)return null;if(m&&typeof m!="function")throw Error(i(231,u,typeof m));return m}var Ha=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),aa=!1;if(Ha)try{var Sl={};Object.defineProperty(Sl,"passive",{get:function(){aa=!0}}),window.addEventListener("test",Sl,Sl),window.removeEventListener("test",Sl,Sl)}catch{aa=!1}var Hs=null,fh=null,Qo=null;function nu(){if(Qo)return Qo;var l,u=fh,m=u.length,y,M="value"in Hs?Hs.value:Hs.textContent,I=M.length;for(l=0;l<m&&u[l]===M[l];l++);var G=m-l;for(y=1;y<=G&&u[m-y]===M[I-y];y++);return Qo=M.slice(l,1<y?1-y:void 0)}function iu(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function ho(){return!0}function ru(){return!1}function er(l){function u(m,y,M,I,G){this._reactName=m,this._targetInst=M,this.type=y,this.nativeEvent=I,this.target=G,this.currentTarget=null;for(var ie in l)l.hasOwnProperty(ie)&&(m=l[ie],this[ie]=m?m(I):I[ie]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?ho:ru,this.isPropagationStopped=ru,this}return g(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=ho)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=ho)},persist:function(){},isPersistent:ho}),u}var Vo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gc=er(Vo),El=g({},Vo,{view:0,detail:0}),su=er(El),au,wl,Ml,Xr=g({},El,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pg,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Ml&&(Ml&&l.type==="mousemove"?(au=l.screenX-Ml.screenX,wl=l.screenY-Ml.screenY):wl=au=0,Ml=l),au)},movementY:function(l){return"movementY"in l?l.movementY:wl}}),rp=er(Xr),dh=g({},Xr,{dataTransfer:0}),ph=er(dh),Ef=g({},El,{relatedTarget:0}),wf=er(Ef),Ms=g({},Vo,{animationName:0,elapsedTime:0,pseudoElement:0}),Qa=er(Ms),Qs=g({},Vo,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),jo=er(Qs),ou=g({},Vo,{data:0}),fg=er(ou),dg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Iv(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=Cx[l])?!!u[l]:!1}function pg(){return Iv}var Tx=g({},El,{key:function(l){if(l.key){var u=dg[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=iu(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?Mx[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pg,charCode:function(l){return l.type==="keypress"?iu(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?iu(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),mh=er(Tx),mg=g({},Xr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rv=er(mg),Bv=g({},El,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pg}),Ix=er(Bv),Rx=g({},Vo,{propertyName:0,elapsedTime:0,pseudoElement:0}),HC=er(Rx),Cs=g({},Xr,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),Bx=er(Cs),Dx=g({},Vo,{newState:0,oldState:0}),Lx=er(Dx),Nx=[9,13,27,32],gh=Ha&&"CompositionEvent"in window,Mf=null;Ha&&"documentMode"in document&&(Mf=document.documentMode);var gg=Ha&&"TextEvent"in window&&!Mf,Dv=Ha&&(!gh||Mf&&8<Mf&&11>=Mf),Ux=" ",sp=!1;function Ag(l,u){switch(l){case"keyup":return Nx.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lv(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Ah=!1;function Fx(l,u){switch(l){case"compositionend":return Lv(u);case"keypress":return u.which!==32?null:(sp=!0,Ux);case"textInput":return l=u.data,l===Ux&&sp?null:l;default:return null}}function Nv(l,u){if(Ah)return l==="compositionend"||!gh&&Ag(l,u)?(l=nu(),Qo=fh=Hs=null,Ah=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Dv&&u.locale!=="ko"?null:u.data;default:return null}}var Uv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fv(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!Uv[l.type]:u==="textarea"}function vg(l,u,m,y){Ga?uo?uo.push(y):uo=[y]:Ga=y,u=G_(u,"onChange"),0<u.length&&(m=new gc("onChange","change",null,m,y),l.push({event:m,listeners:u}))}var lu=null,vh=null;function Px(l){uD(l,0)}function Cf(l){var u=Dt(l);if(zt(u))return l}function Pv(l,u){if(l==="change")return u}var Cl=!1;if(Ha){var ap;if(Ha){var Ov="oninput"in document;if(!Ov){var kv=document.createElement("div");kv.setAttribute("oninput","return;"),Ov=typeof kv.oninput=="function"}ap=Ov}else ap=!1;Cl=ap&&(!document.documentMode||9<document.documentMode)}function fo(){lu&&(lu.detachEvent("onpropertychange",op),vh=lu=null)}function op(l){if(l.propertyName==="value"&&Cf(vh)){var u=[];vg(u,vh,l,ch(l)),tu(Px,u)}}function Ox(l,u,m){l==="focusin"?(fo(),lu=u,vh=m,lu.attachEvent("onpropertychange",op)):l==="focusout"&&fo()}function zv(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Cf(vh)}function kx(l,u){if(l==="click")return Cf(u)}function zx(l,u){if(l==="input"||l==="change")return Cf(u)}function Gv(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var oa=typeof Object.is=="function"?Object.is:Gv;function Tf(l,u){if(oa(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var m=Object.keys(l),y=Object.keys(u);if(m.length!==y.length)return!1;for(y=0;y<m.length;y++){var M=m[y];if(!ft.call(u,M)||!oa(l[M],u[M]))return!1}return!0}function lp(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function If(l,u){var m=lp(l);l=0;for(var y;m;){if(m.nodeType===3){if(y=l+m.textContent.length,l<=u&&y>=u)return{node:m,offset:u-l};l=y}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=lp(m)}}function Hi(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?Hi(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function Gx(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var u=St(l.document);u instanceof l.HTMLIFrameElement;){try{var m=typeof u.contentWindow.location.href=="string"}catch{m=!1}if(m)l=u.contentWindow;else break;u=St(l.document)}return u}function Hv(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}var Hx=Ha&&"documentMode"in document&&11>=document.documentMode,Tl=null,Il=null,Rf=null,yg=!1;function Bf(l,u,m){var y=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;yg||Tl==null||Tl!==St(y)||(y=Tl,"selectionStart"in y&&Hv(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Rf&&Tf(Rf,y)||(Rf=y,y=G_(Il,"onSelect"),0<y.length&&(u=new gc("onSelect","select",null,u,m),l.push({event:u,listeners:y}),u.target=Tl)))}function Vs(l,u){var m={};return m[l.toLowerCase()]=u.toLowerCase(),m["Webkit"+l]="webkit"+u,m["Moz"+l]="moz"+u,m}var yh={animationend:Vs("Animation","AnimationEnd"),animationiteration:Vs("Animation","AnimationIteration"),animationstart:Vs("Animation","AnimationStart"),transitionrun:Vs("Transition","TransitionRun"),transitionstart:Vs("Transition","TransitionStart"),transitioncancel:Vs("Transition","TransitionCancel"),transitionend:Vs("Transition","TransitionEnd")},cp={},Qv={};Ha&&(Qv=document.createElement("div").style,"AnimationEvent"in window||(delete yh.animationend.animation,delete yh.animationiteration.animation,delete yh.animationstart.animation),"TransitionEvent"in window||delete yh.transitionend.transition);function Ac(l){if(cp[l])return cp[l];if(!yh[l])return l;var u=yh[l],m;for(m in u)if(u.hasOwnProperty(m)&&m in Qv)return cp[l]=u[m];return l}var bg=Ac("animationend"),up=Ac("animationiteration"),Vv=Ac("animationstart"),Qx=Ac("transitionrun"),QC=Ac("transitionstart"),Vx=Ac("transitioncancel"),jv=Ac("transitionend"),po=new Map,hp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hp.push("scrollEnd");function mo(l,u){po.set(l,u),Se(u,[l])}var fp=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},go=[],vc=0,ms=0;function dp(){for(var l=vc,u=ms=vc=0;u<l;){var m=go[u];go[u++]=null;var y=go[u];go[u++]=null;var M=go[u];go[u++]=null;var I=go[u];if(go[u++]=null,y!==null&&M!==null){var G=y.pending;G===null?M.next=M:(M.next=G.next,G.next=M),y.pending=M}I!==0&&cu(m,M,I)}}function gs(l,u,m,y){go[vc++]=l,go[vc++]=u,go[vc++]=m,go[vc++]=y,ms|=y,l.lanes|=y,l=l.alternate,l!==null&&(l.lanes|=y)}function xg(l,u,m,y){return gs(l,u,m,y),Ao(l)}function la(l,u){return gs(l,null,null,u),Ao(l)}function cu(l,u,m){l.lanes|=m;var y=l.alternate;y!==null&&(y.lanes|=m);for(var M=!1,I=l.return;I!==null;)I.childLanes|=m,y=I.alternate,y!==null&&(y.childLanes|=m),I.tag===22&&(l=I.stateNode,l===null||l._visibility&1||(M=!0)),l=I,I=I.return;return l.tag===3?(I=l.stateNode,M&&u!==null&&(M=31-bt(m),l=I.hiddenUpdates,y=l[M],y===null?l[M]=[u]:y.push(u),u.lane=m|536870912),I):null}function Ao(l){if(50<Tu)throw Tu=0,Oh=null,Error(i(185));for(var u=l.return;u!==null;)l=u,u=l.return;return l.tag===3?l.stateNode:null}var uu={};function Wv(l,u,m,y){this.tag=l,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lr(l,u,m,y){return new Wv(l,u,m,y)}function _g(l){return l=l.prototype,!(!l||!l.isReactComponent)}function _a(l,u){var m=l.alternate;return m===null?(m=lr(l.tag,u,l.key,l.mode),m.elementType=l.elementType,m.type=l.type,m.stateNode=l.stateNode,m.alternate=l,l.alternate=m):(m.pendingProps=u,m.type=l.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=l.flags&65011712,m.childLanes=l.childLanes,m.lanes=l.lanes,m.child=l.child,m.memoizedProps=l.memoizedProps,m.memoizedState=l.memoizedState,m.updateQueue=l.updateQueue,u=l.dependencies,m.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},m.sibling=l.sibling,m.index=l.index,m.ref=l.ref,m.refCleanup=l.refCleanup,m}function Df(l,u){l.flags&=65011714;var m=l.alternate;return m===null?(l.childLanes=0,l.lanes=u,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=m.childLanes,l.lanes=m.lanes,l.child=m.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=m.memoizedProps,l.memoizedState=m.memoizedState,l.updateQueue=m.updateQueue,l.type=m.type,u=m.dependencies,l.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),l}function Rl(l,u,m,y,M,I){var G=0;if(y=l,typeof l=="function")_g(l)&&(G=1);else if(typeof l=="string")G=cQ(l,m,he.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case L:return l=lr(31,m,u,M),l.elementType=L,l.lanes=I,l;case S:return hu(m.children,M,I,u);case _:G=8,M|=24;break;case E:return l=lr(12,m,u,M|2),l.elementType=E,l.lanes=I,l;case B:return l=lr(13,m,u,M),l.elementType=B,l.lanes=I,l;case U:return l=lr(19,m,u,M),l.elementType=U,l.lanes=I,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case T:G=10;break e;case C:G=9;break e;case R:G=11;break e;case O:G=14;break e;case F:G=16,y=null;break e}G=29,m=Error(i(130,l===null?"null":typeof l,"")),y=null}return u=lr(G,m,u,M),u.elementType=l,u.type=y,u.lanes=I,u}function hu(l,u,m,y){return l=lr(7,l,y,u),l.lanes=m,l}function Sg(l,u,m){return l=lr(6,l,null,u),l.lanes=m,l}function Lf(l){var u=lr(18,null,null,0);return u.stateNode=l,u}function Eg(l,u,m){return u=lr(4,l.children!==null?l.children:[],l.key,u),u.lanes=m,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}var pp=new WeakMap;function Va(l,u){if(typeof l=="object"&&l!==null){var m=pp.get(l);return m!==void 0?m:(u={value:l,source:u,stack:ne(u)},pp.set(l,u),u)}return{value:l,source:u,stack:ne(u)}}var fu=[],du=0,Nf=null,Uf=0,Sa=[],tr=0,yc=null,cr=1,Wo="";function Bl(l,u){fu[du++]=Uf,fu[du++]=Nf,Nf=l,Uf=u}function jx(l,u,m){Sa[tr++]=cr,Sa[tr++]=Wo,Sa[tr++]=yc,yc=l;var y=cr;l=Wo;var M=32-bt(y)-1;y&=~(1<<M),m+=1;var I=32-bt(u)+M;if(30<I){var G=M-M%5;I=(y&(1<<G)-1).toString(32),y>>=G,M-=G,cr=1<<32-bt(u)+M|m<<M|y,Wo=I+l}else cr=1<<I|m<<M|y,Wo=l}function Dl(l){l.return!==null&&(Bl(l,1),jx(l,1,0))}function wg(l){for(;l===Nf;)Nf=fu[--du],fu[du]=null,Uf=fu[--du],fu[du]=null;for(;l===yc;)yc=Sa[--tr],Sa[tr]=null,Wo=Sa[--tr],Sa[tr]=null,cr=Sa[--tr],Sa[tr]=null}function Mg(l,u){Sa[tr++]=cr,Sa[tr++]=Wo,Sa[tr++]=yc,cr=u.id,Wo=u.overflow,yc=l}var br=null,Qi=null,Jn=!1,bc=null,ja=!1,Ff=Error(i(519));function Ll(l){var u=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Nl(Va(u,l)),Ff}function Wx(l){var u=l.stateNode,m=l.type,y=l.memoizedProps;switch(u[hi]=l,u[Y]=y,m){case"dialog":ri("cancel",u),ri("close",u);break;case"iframe":case"object":case"embed":ri("load",u);break;case"video":case"audio":for(m=0;m<Ro.length;m++)ri(Ro[m],u);break;case"source":ri("error",u);break;case"img":case"image":case"link":ri("error",u),ri("load",u);break;case"details":ri("toggle",u);break;case"input":ri("invalid",u),$i(u,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0);break;case"select":ri("invalid",u);break;case"textarea":ri("invalid",u),Ji(u,y.value,y.defaultValue,y.children)}m=y.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||u.textContent===""+m||y.suppressHydrationWarning===!0||pD(u.textContent,m)?(y.popover!=null&&(ri("beforetoggle",u),ri("toggle",u)),y.onScroll!=null&&ri("scroll",u),y.onScrollEnd!=null&&ri("scrollend",u),y.onClick!=null&&(u.onclick=Gs),u=!0):u=!1,u||Ll(l,!0)}function qx(l){for(br=l.return;br;)switch(br.tag){case 5:case 31:case 13:ja=!1;return;case 27:case 3:ja=!0;return;default:br=br.return}}function Pf(l){if(l!==br)return!1;if(!Jn)return qx(l),Jn=!0,!1;var u=l.tag,m;if((m=u!==3&&u!==27)&&((m=u===5)&&(m=l.type,m=!(m!=="form"&&m!=="button")||s3(l.type,l.memoizedProps)),m=!m),m&&Qi&&Ll(l),qx(l),u===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(i(317));Qi=SD(l)}else if(u===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(i(317));Qi=SD(l)}else u===27?(u=Qi,id(l.type)?(l=u3,u3=null,Qi=l):Qi=u):Qi=br?Xl(l.stateNode.nextSibling):null;return!0}function pu(){Qi=br=null,Jn=!1}function Cg(){var l=bc;return l!==null&&(_r===null?_r=l:_r.push.apply(_r,l),bc=null),l}function Nl(l){bc===null?bc=[l]:bc.push(l)}var Of=z(null),mu=null,Ul=null;function xc(l,u,m){ae(Of,u._currentValue),u._currentValue=m}function Fl(l){l._currentValue=Of.current,$(Of)}function Tg(l,u,m){for(;l!==null;){var y=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,y!==null&&(y.childLanes|=u)):y!==null&&(y.childLanes&u)!==u&&(y.childLanes|=u),l===m)break;l=l.return}}function Ig(l,u,m,y){var M=l.child;for(M!==null&&(M.return=l);M!==null;){var I=M.dependencies;if(I!==null){var G=M.child;I=I.firstContext;e:for(;I!==null;){var ie=I;I=M;for(var Ae=0;Ae<u.length;Ae++)if(ie.context===u[Ae]){I.lanes|=m,ie=I.alternate,ie!==null&&(ie.lanes|=m),Tg(I.return,m,l),y||(G=null);break e}I=ie.next}}else if(M.tag===18){if(G=M.return,G===null)throw Error(i(341));G.lanes|=m,I=G.alternate,I!==null&&(I.lanes|=m),Tg(G,m,l),G=null}else G=M.child;if(G!==null)G.return=M;else for(G=M;G!==null;){if(G===l){G=null;break}if(M=G.sibling,M!==null){M.return=G.return,G=M;break}G=G.return}M=G}}function Pl(l,u,m,y){l=null;for(var M=u,I=!1;M!==null;){if(!I){if((M.flags&524288)!==0)I=!0;else if((M.flags&262144)!==0)break}if(M.tag===10){var G=M.alternate;if(G===null)throw Error(i(387));if(G=G.memoizedProps,G!==null){var ie=M.type;oa(M.pendingProps.value,G.value)||(l!==null?l.push(ie):l=[ie])}}else if(M===fe.current){if(G=M.alternate,G===null)throw Error(i(387));G.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(l!==null?l.push(Qy):l=[Qy])}M=M.return}l!==null&&Ig(u,l,m,y),u.flags|=262144}function mp(l){for(l=l.firstContext;l!==null;){if(!oa(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function gu(l){mu=l,Ul=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function En(l){return Xx(mu,l)}function kf(l,u){return mu===null&&gu(l),Xx(l,u)}function Xx(l,u){var m=u._currentValue;if(u={context:u,memoizedValue:m,next:null},Ul===null){if(l===null)throw Error(i(308));Ul=u,l.dependencies={lanes:0,firstContext:u},l.flags|=524288}else Ul=Ul.next=u;return m}var Yx=typeof AbortController<"u"?AbortController:function(){var l=[],u=this.signal={aborted:!1,addEventListener:function(m,y){l.push(y)}};this.abort=function(){u.aborted=!0,l.forEach(function(m){return m()})}},VC=n.unstable_scheduleCallback,jC=n.unstable_NormalPriority,Yr={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qv(){return{controller:new Yx,data:new Map,refCount:0}}function bh(l){l.refCount--,l.refCount===0&&VC(jC,function(){l.controller.abort()})}var Wa=null,Rg=0,_c=0,vo=null;function Xv(l,u){if(Wa===null){var m=Wa=[];Rg=0,_c=We(),vo={status:"pending",value:void 0,then:function(y){m.push(y)}}}return Rg++,u.then(Yv,Yv),u}function Yv(){if(--Rg===0&&Wa!==null){vo!==null&&(vo.status="fulfilled");var l=Wa;Wa=null,_c=0,vo=null;for(var u=0;u<l.length;u++)(0,l[u])()}}function Kv(l,u){var m=[],y={status:"pending",value:null,reason:null,then:function(M){m.push(M)}};return l.then(function(){y.status="fulfilled",y.value=u;for(var M=0;M<m.length;M++)(0,m[M])(u)},function(M){for(y.status="rejected",y.reason=M,M=0;M<m.length;M++)(0,m[M])(void 0)}),y}var Kx=Q.S;Q.S=function(l,u){Py=H(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&Xv(l,u),Kx!==null&&Kx(l,u)};var Au=z(null);function Bg(){var l=Au.current;return l!==null?l:Cn.pooledCache}function gp(l,u){u===null?ae(Au,Au.current):ae(Au,u.pool)}function $v(){var l=Bg();return l===null?null:{parent:Yr._currentValue,pool:l}}var xh=Error(i(460)),Ap=Error(i(474)),Fn=Error(i(542)),Dg={then:function(){}};function Ea(l){return l=l.status,l==="fulfilled"||l==="rejected"}function Lg(l,u,m){switch(m=l[m],m===void 0?l.push(u):m!==u&&(u.then(Gs,Gs),u=m),u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,Eh(l),l;default:if(typeof u.status=="string")u.then(Gs,Gs);else{if(l=Cn,l!==null&&100<l.shellSuspendCounter)throw Error(i(482));l=u,l.status="pending",l.then(function(y){if(u.status==="pending"){var M=u;M.status="fulfilled",M.value=y}},function(y){if(u.status==="pending"){var M=u;M.status="rejected",M.reason=y}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,Eh(l),l}throw Ol=u,xh}}function _h(l){try{var u=l._init;return u(l._payload)}catch(m){throw m!==null&&typeof m=="object"&&typeof m.then=="function"?(Ol=m,xh):m}}var Ol=null;function Sh(){if(Ol===null)throw Error(i(459));var l=Ol;return Ol=null,l}function Eh(l){if(l===xh||l===Fn)throw Error(i(483))}var wh=null,Mh=0;function vp(l){var u=Mh;return Mh+=1,wh===null&&(wh=[]),Lg(wh,l,u)}function yo(l,u){u=u.props.ref,l.ref=u!==void 0?u:null}function zf(l,u){throw u.$$typeof===A?Error(i(525)):(l=Object.prototype.toString.call(u),Error(i(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l)))}function Ng(l){function u(Ce,Ee){if(l){var Fe=Ce.deletions;Fe===null?(Ce.deletions=[Ee],Ce.flags|=16):Fe.push(Ee)}}function m(Ce,Ee){if(!l)return null;for(;Ee!==null;)u(Ce,Ee),Ee=Ee.sibling;return null}function y(Ce){for(var Ee=new Map;Ce!==null;)Ce.key!==null?Ee.set(Ce.key,Ce):Ee.set(Ce.index,Ce),Ce=Ce.sibling;return Ee}function M(Ce,Ee){return Ce=_a(Ce,Ee),Ce.index=0,Ce.sibling=null,Ce}function I(Ce,Ee,Fe){return Ce.index=Fe,l?(Fe=Ce.alternate,Fe!==null?(Fe=Fe.index,Fe<Ee?(Ce.flags|=67108866,Ee):Fe):(Ce.flags|=67108866,Ee)):(Ce.flags|=1048576,Ee)}function G(Ce){return l&&Ce.alternate===null&&(Ce.flags|=67108866),Ce}function ie(Ce,Ee,Fe,dt){return Ee===null||Ee.tag!==6?(Ee=Sg(Fe,Ce.mode,dt),Ee.return=Ce,Ee):(Ee=M(Ee,Fe),Ee.return=Ce,Ee)}function Ae(Ce,Ee,Fe,dt){var fn=Fe.type;return fn===S?lt(Ce,Ee,Fe.props.children,dt,Fe.key):Ee!==null&&(Ee.elementType===fn||typeof fn=="object"&&fn!==null&&fn.$$typeof===F&&_h(fn)===Ee.type)?(Ee=M(Ee,Fe.props),yo(Ee,Fe),Ee.return=Ce,Ee):(Ee=Rl(Fe.type,Fe.key,Fe.props,null,Ce.mode,dt),yo(Ee,Fe),Ee.return=Ce,Ee)}function Oe(Ce,Ee,Fe,dt){return Ee===null||Ee.tag!==4||Ee.stateNode.containerInfo!==Fe.containerInfo||Ee.stateNode.implementation!==Fe.implementation?(Ee=Eg(Fe,Ce.mode,dt),Ee.return=Ce,Ee):(Ee=M(Ee,Fe.children||[]),Ee.return=Ce,Ee)}function lt(Ce,Ee,Fe,dt,fn){return Ee===null||Ee.tag!==7?(Ee=hu(Fe,Ce.mode,dt,fn),Ee.return=Ce,Ee):(Ee=M(Ee,Fe),Ee.return=Ce,Ee)}function mt(Ce,Ee,Fe){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return Ee=Sg(""+Ee,Ce.mode,Fe),Ee.return=Ce,Ee;if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case v:return Fe=Rl(Ee.type,Ee.key,Ee.props,null,Ce.mode,Fe),yo(Fe,Ee),Fe.return=Ce,Fe;case x:return Ee=Eg(Ee,Ce.mode,Fe),Ee.return=Ce,Ee;case F:return Ee=_h(Ee),mt(Ce,Ee,Fe)}if(re(Ee)||j(Ee))return Ee=hu(Ee,Ce.mode,Fe,null),Ee.return=Ce,Ee;if(typeof Ee.then=="function")return mt(Ce,vp(Ee),Fe);if(Ee.$$typeof===T)return mt(Ce,kf(Ce,Ee),Fe);zf(Ce,Ee)}return null}function Ge(Ce,Ee,Fe,dt){var fn=Ee!==null?Ee.key:null;if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint")return fn!==null?null:ie(Ce,Ee,""+Fe,dt);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case v:return Fe.key===fn?Ae(Ce,Ee,Fe,dt):null;case x:return Fe.key===fn?Oe(Ce,Ee,Fe,dt):null;case F:return Fe=_h(Fe),Ge(Ce,Ee,Fe,dt)}if(re(Fe)||j(Fe))return fn!==null?null:lt(Ce,Ee,Fe,dt,null);if(typeof Fe.then=="function")return Ge(Ce,Ee,vp(Fe),dt);if(Fe.$$typeof===T)return Ge(Ce,Ee,kf(Ce,Fe),dt);zf(Ce,Fe)}return null}function $e(Ce,Ee,Fe,dt,fn){if(typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint")return Ce=Ce.get(Fe)||null,ie(Ee,Ce,""+dt,fn);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case v:return Ce=Ce.get(dt.key===null?Fe:dt.key)||null,Ae(Ee,Ce,dt,fn);case x:return Ce=Ce.get(dt.key===null?Fe:dt.key)||null,Oe(Ee,Ce,dt,fn);case F:return dt=_h(dt),$e(Ce,Ee,Fe,dt,fn)}if(re(dt)||j(dt))return Ce=Ce.get(Fe)||null,lt(Ee,Ce,dt,fn,null);if(typeof dt.then=="function")return $e(Ce,Ee,Fe,vp(dt),fn);if(dt.$$typeof===T)return $e(Ce,Ee,Fe,kf(Ee,dt),fn);zf(Ee,dt)}return null}function Jt(Ce,Ee,Fe,dt){for(var fn=null,yi=null,sn=Ee,Hn=Ee=0,li=null;sn!==null&&Hn<Fe.length;Hn++){sn.index>Hn?(li=sn,sn=null):li=sn.sibling;var bi=Ge(Ce,sn,Fe[Hn],dt);if(bi===null){sn===null&&(sn=li);break}l&&sn&&bi.alternate===null&&u(Ce,sn),Ee=I(bi,Ee,Hn),yi===null?fn=bi:yi.sibling=bi,yi=bi,sn=li}if(Hn===Fe.length)return m(Ce,sn),Jn&&Bl(Ce,Hn),fn;if(sn===null){for(;Hn<Fe.length;Hn++)sn=mt(Ce,Fe[Hn],dt),sn!==null&&(Ee=I(sn,Ee,Hn),yi===null?fn=sn:yi.sibling=sn,yi=sn);return Jn&&Bl(Ce,Hn),fn}for(sn=y(sn);Hn<Fe.length;Hn++)li=$e(sn,Ce,Hn,Fe[Hn],dt),li!==null&&(l&&li.alternate!==null&&sn.delete(li.key===null?Hn:li.key),Ee=I(li,Ee,Hn),yi===null?fn=li:yi.sibling=li,yi=li);return l&&sn.forEach(function(ld){return u(Ce,ld)}),Jn&&Bl(Ce,Hn),fn}function bn(Ce,Ee,Fe,dt){if(Fe==null)throw Error(i(151));for(var fn=null,yi=null,sn=Ee,Hn=Ee=0,li=null,bi=Fe.next();sn!==null&&!bi.done;Hn++,bi=Fe.next()){sn.index>Hn?(li=sn,sn=null):li=sn.sibling;var ld=Ge(Ce,sn,bi.value,dt);if(ld===null){sn===null&&(sn=li);break}l&&sn&&ld.alternate===null&&u(Ce,sn),Ee=I(ld,Ee,Hn),yi===null?fn=ld:yi.sibling=ld,yi=ld,sn=li}if(bi.done)return m(Ce,sn),Jn&&Bl(Ce,Hn),fn;if(sn===null){for(;!bi.done;Hn++,bi=Fe.next())bi=mt(Ce,bi.value,dt),bi!==null&&(Ee=I(bi,Ee,Hn),yi===null?fn=bi:yi.sibling=bi,yi=bi);return Jn&&Bl(Ce,Hn),fn}for(sn=y(sn);!bi.done;Hn++,bi=Fe.next())bi=$e(sn,Ce,Hn,bi.value,dt),bi!==null&&(l&&bi.alternate!==null&&sn.delete(bi.key===null?Hn:bi.key),Ee=I(bi,Ee,Hn),yi===null?fn=bi:yi.sibling=bi,yi=bi);return l&&sn.forEach(function(bQ){return u(Ce,bQ)}),Jn&&Bl(Ce,Hn),fn}function Wi(Ce,Ee,Fe,dt){if(typeof Fe=="object"&&Fe!==null&&Fe.type===S&&Fe.key===null&&(Fe=Fe.props.children),typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case v:e:{for(var fn=Fe.key;Ee!==null;){if(Ee.key===fn){if(fn=Fe.type,fn===S){if(Ee.tag===7){m(Ce,Ee.sibling),dt=M(Ee,Fe.props.children),dt.return=Ce,Ce=dt;break e}}else if(Ee.elementType===fn||typeof fn=="object"&&fn!==null&&fn.$$typeof===F&&_h(fn)===Ee.type){m(Ce,Ee.sibling),dt=M(Ee,Fe.props),yo(dt,Fe),dt.return=Ce,Ce=dt;break e}m(Ce,Ee);break}else u(Ce,Ee);Ee=Ee.sibling}Fe.type===S?(dt=hu(Fe.props.children,Ce.mode,dt,Fe.key),dt.return=Ce,Ce=dt):(dt=Rl(Fe.type,Fe.key,Fe.props,null,Ce.mode,dt),yo(dt,Fe),dt.return=Ce,Ce=dt)}return G(Ce);case x:e:{for(fn=Fe.key;Ee!==null;){if(Ee.key===fn)if(Ee.tag===4&&Ee.stateNode.containerInfo===Fe.containerInfo&&Ee.stateNode.implementation===Fe.implementation){m(Ce,Ee.sibling),dt=M(Ee,Fe.children||[]),dt.return=Ce,Ce=dt;break e}else{m(Ce,Ee);break}else u(Ce,Ee);Ee=Ee.sibling}dt=Eg(Fe,Ce.mode,dt),dt.return=Ce,Ce=dt}return G(Ce);case F:return Fe=_h(Fe),Wi(Ce,Ee,Fe,dt)}if(re(Fe))return Jt(Ce,Ee,Fe,dt);if(j(Fe)){if(fn=j(Fe),typeof fn!="function")throw Error(i(150));return Fe=fn.call(Fe),bn(Ce,Ee,Fe,dt)}if(typeof Fe.then=="function")return Wi(Ce,Ee,vp(Fe),dt);if(Fe.$$typeof===T)return Wi(Ce,Ee,kf(Ce,Fe),dt);zf(Ce,Fe)}return typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint"?(Fe=""+Fe,Ee!==null&&Ee.tag===6?(m(Ce,Ee.sibling),dt=M(Ee,Fe),dt.return=Ce,Ce=dt):(m(Ce,Ee),dt=Sg(Fe,Ce.mode,dt),dt.return=Ce,Ce=dt),G(Ce)):m(Ce,Ee)}return function(Ce,Ee,Fe,dt){try{Mh=0;var fn=Wi(Ce,Ee,Fe,dt);return wh=null,fn}catch(sn){if(sn===xh||sn===Fn)throw sn;var yi=lr(29,sn,null,Ce.mode);return yi.lanes=dt,yi.return=Ce,yi}}}var Sc=Ng(!0),Ug=Ng(!1),ca=!1;function yp(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jv(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function Ec(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function vu(l,u,m){var y=l.updateQueue;if(y===null)return null;if(y=y.shared,(an&2)!==0){var M=y.pending;return M===null?u.next=u:(u.next=M.next,M.next=u),y.pending=u,u=Ao(l),cu(l,null,m),u}return gs(l,y,u,m),Ao(l)}function yu(l,u,m){if(u=u.updateQueue,u!==null&&(u=u.shared,(m&4194048)!==0)){var y=u.lanes;y&=l.pendingLanes,m|=y,u.lanes=m,yr(l,m)}}function hn(l,u){var m=l.updateQueue,y=l.alternate;if(y!==null&&(y=y.updateQueue,m===y)){var M=null,I=null;if(m=m.firstBaseUpdate,m!==null){do{var G={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};I===null?M=I=G:I=I.next=G,m=m.next}while(m!==null);I===null?M=I=u:I=I.next=u}else M=I=u;m={baseState:y.baseState,firstBaseUpdate:M,lastBaseUpdate:I,shared:y.shared,callbacks:y.callbacks},l.updateQueue=m;return}l=m.lastBaseUpdate,l===null?m.firstBaseUpdate=u:l.next=u,m.lastBaseUpdate=u}var Zv=!1;function bp(){if(Zv){var l=vo;if(l!==null)throw l}}function Gf(l,u,m,y){Zv=!1;var M=l.updateQueue;ca=!1;var I=M.firstBaseUpdate,G=M.lastBaseUpdate,ie=M.shared.pending;if(ie!==null){M.shared.pending=null;var Ae=ie,Oe=Ae.next;Ae.next=null,G===null?I=Oe:G.next=Oe,G=Ae;var lt=l.alternate;lt!==null&&(lt=lt.updateQueue,ie=lt.lastBaseUpdate,ie!==G&&(ie===null?lt.firstBaseUpdate=Oe:ie.next=Oe,lt.lastBaseUpdate=Ae))}if(I!==null){var mt=M.baseState;G=0,lt=Oe=Ae=null,ie=I;do{var Ge=ie.lane&-536870913,$e=Ge!==ie.lane;if($e?(Un&Ge)===Ge:(y&Ge)===Ge){Ge!==0&&Ge===_c&&(Zv=!0),lt!==null&&(lt=lt.next={lane:0,tag:ie.tag,payload:ie.payload,callback:null,next:null});e:{var Jt=l,bn=ie;Ge=u;var Wi=m;switch(bn.tag){case 1:if(Jt=bn.payload,typeof Jt=="function"){mt=Jt.call(Wi,mt,Ge);break e}mt=Jt;break e;case 3:Jt.flags=Jt.flags&-65537|128;case 0:if(Jt=bn.payload,Ge=typeof Jt=="function"?Jt.call(Wi,mt,Ge):Jt,Ge==null)break e;mt=g({},mt,Ge);break e;case 2:ca=!0}}Ge=ie.callback,Ge!==null&&(l.flags|=64,$e&&(l.flags|=8192),$e=M.callbacks,$e===null?M.callbacks=[Ge]:$e.push(Ge))}else $e={lane:Ge,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},lt===null?(Oe=lt=$e,Ae=mt):lt=lt.next=$e,G|=Ge;if(ie=ie.next,ie===null){if(ie=M.shared.pending,ie===null)break;$e=ie,ie=$e.next,$e.next=null,M.lastBaseUpdate=$e,M.shared.pending=null}}while(!0);lt===null&&(Ae=mt),M.baseState=Ae,M.firstBaseUpdate=Oe,M.lastBaseUpdate=lt,I===null&&(M.shared.lanes=0),jl|=G,l.lanes=G,l.memoizedState=mt}}function Hf(l,u){if(typeof l!="function")throw Error(i(191,l));l.call(u)}function $x(l,u){var m=l.callbacks;if(m!==null)for(l.callbacks=null,l=0;l<m.length;l++)Hf(m[l],u)}var Qf=z(null),Fg=z(0);function Jx(l,u){l=Ka,ae(Fg,l),ae(Qf,u),Ka=l|u.baseLanes}function ey(){ae(Fg,Ka),ae(Qf,Qf.current)}function xp(){Ka=Fg.current,$(Qf),$(Fg)}var wa=z(null),ua=null;function wc(l){var u=l.alternate;ae(Zn,Zn.current&1),ae(wa,l),ua===null&&(u===null||Qf.current!==null||u.memoizedState!==null)&&(ua=l)}function ty(l){ae(Zn,Zn.current),ae(wa,l),ua===null&&(ua=l)}function Zx(l){l.tag===22?(ae(Zn,Zn.current),ae(wa,l),ua===null&&(ua=l)):Ma()}function Ma(){ae(Zn,Zn.current),ae(wa,wa.current)}function Lr(l){$(wa),ua===l&&(ua=null),$(Zn)}var Zn=z(0);function qa(l){for(var u=l;u!==null;){if(u.tag===13){var m=u.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||l3(m)||c3(m)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var nr=0,Dn=null,Di=null,qn=null,bo=!1,Vf=!1,Ch=!1,Pg=0,_p=0,jf=null,ny=0;function ur(){throw Error(i(321))}function iy(l,u){if(u===null)return!1;for(var m=0;m<u.length&&m<l.length;m++)if(!oa(l[m],u[m]))return!1;return!0}function Og(l,u,m,y,M,I){return nr=I,Dn=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Q.H=l===null||l.memoizedState===null?B_:Sy,Ch=!1,I=m(y,M),Ch=!1,Vf&&(I=Th(u,m,y,M)),e_(l),I}function e_(l){Q.H=Wf;var u=Di!==null&&Di.next!==null;if(nr=0,qn=Di=Dn=null,bo=!1,_p=0,jf=null,u)throw Error(i(300));l===null||Kr||(l=l.dependencies,l!==null&&mp(l)&&(Kr=!0))}function Th(l,u,m,y){Dn=l;var M=0;do{if(Vf&&(jf=null),_p=0,Vf=!1,25<=M)throw Error(i(301));if(M+=1,qn=Di=null,l.updateQueue!=null){var I=l.updateQueue;I.lastEffect=null,I.events=null,I.stores=null,I.memoCache!=null&&(I.memoCache.index=0)}Q.H=xo,I=u(m,y)}while(Vf);return I}function Ih(){var l=Q.H,u=l.useState()[0];return u=typeof u.then=="function"?Sp(u):u,l=l.useState()[0],(Di!==null?Di.memoizedState:null)!==l&&(Dn.flags|=1024),u}function ry(){var l=Pg!==0;return Pg=0,l}function sy(l,u,m){u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~m}function ay(l){if(bo){for(l=l.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}bo=!1}nr=0,qn=Di=Dn=null,Vf=!1,_p=Pg=0,jf=null}function is(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qn===null?Dn.memoizedState=qn=l:qn=qn.next=l,qn}function Nr(){if(Di===null){var l=Dn.alternate;l=l!==null?l.memoizedState:null}else l=Di.next;var u=qn===null?Dn.memoizedState:qn.next;if(u!==null)qn=u,Di=l;else{if(l===null)throw Dn.alternate===null?Error(i(467)):Error(i(310));Di=l,l={memoizedState:Di.memoizedState,baseState:Di.baseState,baseQueue:Di.baseQueue,queue:Di.queue,next:null},qn===null?Dn.memoizedState=qn=l:qn=qn.next=l}return qn}function kg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sp(l){var u=_p;return _p+=1,jf===null&&(jf=[]),l=Lg(jf,l,u),u=Dn,(qn===null?u.memoizedState:qn.next)===null&&(u=u.alternate,Q.H=u===null||u.memoizedState===null?B_:Sy),l}function bu(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Sp(l);if(l.$$typeof===T)return En(l)}throw Error(i(438,String(l)))}function oy(l){var u=null,m=Dn.updateQueue;if(m!==null&&(u=m.memoCache),u==null){var y=Dn.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(u={data:y.data.map(function(M){return M.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),m===null&&(m=kg(),Dn.updateQueue=m),m.memoCache=u,m=u.data[u.index],m===void 0)for(m=u.data[u.index]=Array(l),y=0;y<l;y++)m[y]=P;return u.index++,m}function Mc(l,u){return typeof u=="function"?u(l):u}function zg(l){var u=Nr();return ly(u,Di,l)}function ly(l,u,m){var y=l.queue;if(y===null)throw Error(i(311));y.lastRenderedReducer=m;var M=l.baseQueue,I=y.pending;if(I!==null){if(M!==null){var G=M.next;M.next=I.next,I.next=G}u.baseQueue=M=I,y.pending=null}if(I=l.baseState,M===null)l.memoizedState=I;else{u=M.next;var ie=G=null,Ae=null,Oe=u,lt=!1;do{var mt=Oe.lane&-536870913;if(mt!==Oe.lane?(Un&mt)===mt:(nr&mt)===mt){var Ge=Oe.revertLane;if(Ge===0)Ae!==null&&(Ae=Ae.next={lane:0,revertLane:0,gesture:null,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null}),mt===_c&&(lt=!0);else if((nr&Ge)===Ge){Oe=Oe.next,Ge===_c&&(lt=!0);continue}else mt={lane:0,revertLane:Oe.revertLane,gesture:null,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null},Ae===null?(ie=Ae=mt,G=I):Ae=Ae.next=mt,Dn.lanes|=Ge,jl|=Ge;mt=Oe.action,Ch&&m(I,mt),I=Oe.hasEagerState?Oe.eagerState:m(I,mt)}else Ge={lane:mt,revertLane:Oe.revertLane,gesture:Oe.gesture,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null},Ae===null?(ie=Ae=Ge,G=I):Ae=Ae.next=Ge,Dn.lanes|=mt,jl|=mt;Oe=Oe.next}while(Oe!==null&&Oe!==u);if(Ae===null?G=I:Ae.next=ie,!oa(I,l.memoizedState)&&(Kr=!0,lt&&(m=vo,m!==null)))throw m;l.memoizedState=I,l.baseState=G,l.baseQueue=Ae,y.lastRenderedState=I}return M===null&&(y.lanes=0),[l.memoizedState,y.dispatch]}function cy(l){var u=Nr(),m=u.queue;if(m===null)throw Error(i(311));m.lastRenderedReducer=l;var y=m.dispatch,M=m.pending,I=u.memoizedState;if(M!==null){m.pending=null;var G=M=M.next;do I=l(I,G.action),G=G.next;while(G!==M);oa(I,u.memoizedState)||(Kr=!0),u.memoizedState=I,u.baseQueue===null&&(u.baseState=I),m.lastRenderedState=I}return[I,y]}function t_(l,u,m){var y=Dn,M=Nr(),I=Jn;if(I){if(m===void 0)throw Error(i(407));m=m()}else m=u();var G=!oa((Di||M).memoizedState,m);if(G&&(M.memoizedState=m,Kr=!0),M=M.queue,Ay(r_.bind(null,y,M,l),[l]),M.getSnapshot!==u||G||qn!==null&&qn.memoizedState.tag&1){if(y.flags|=2048,xu(9,{destroy:void 0},i_.bind(null,y,M,m,u),null),Cn===null)throw Error(i(349));I||(nr&127)!==0||n_(y,u,m)}return m}function n_(l,u,m){l.flags|=16384,l={getSnapshot:u,value:m},u=Dn.updateQueue,u===null?(u=kg(),Dn.updateQueue=u,u.stores=[l]):(m=u.stores,m===null?u.stores=[l]:m.push(l))}function i_(l,u,m,y){u.value=m,u.getSnapshot=y,s_(u)&&a_(l)}function r_(l,u,m){return m(function(){s_(u)&&a_(l)})}function s_(l){var u=l.getSnapshot;l=l.value;try{var m=u();return!oa(l,m)}catch{return!0}}function a_(l){var u=la(l,2);u!==null&&On(u,l,2)}function uy(l){var u=is();if(typeof l=="function"){var m=l;if(l=m(),Ch){at(!0);try{m()}finally{at(!1)}}}return u.memoizedState=u.baseState=l,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mc,lastRenderedState:l},u}function hy(l,u,m,y){return l.baseState=m,ly(l,Di,typeof y=="function"?y:Mc)}function WC(l,u,m,y,M){if(Vg(l))throw Error(i(485));if(l=u.action,l!==null){var I={payload:M,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){I.listeners.push(G)}};Q.T!==null?m(!0):I.isTransition=!1,y(I),m=u.pending,m===null?(I.next=u.pending=I,o_(u,I)):(I.next=m.next,u.pending=m.next=I)}}function o_(l,u){var m=u.action,y=u.payload,M=l.state;if(u.isTransition){var I=Q.T,G={};Q.T=G;try{var ie=m(M,y),Ae=Q.S;Ae!==null&&Ae(G,ie),l_(l,u,ie)}catch(Oe){fy(l,u,Oe)}finally{I!==null&&G.types!==null&&(I.types=G.types),Q.T=I}}else try{I=m(M,y),l_(l,u,I)}catch(Oe){fy(l,u,Oe)}}function l_(l,u,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(y){c_(l,u,y)},function(y){return fy(l,u,y)}):c_(l,u,m)}function c_(l,u,m){u.status="fulfilled",u.value=m,u_(u),l.state=m,u=l.pending,u!==null&&(m=u.next,m===u?l.pending=null:(m=m.next,u.next=m,o_(l,m)))}function fy(l,u,m){var y=l.pending;if(l.pending=null,y!==null){y=y.next;do u.status="rejected",u.reason=m,u_(u),u=u.next;while(u!==y)}l.action=null}function u_(l){l=l.listeners;for(var u=0;u<l.length;u++)(0,l[u])()}function dy(l,u){return u}function py(l,u){if(Jn){var m=Cn.formState;if(m!==null){e:{var y=Dn;if(Jn){if(Qi){t:{for(var M=Qi,I=ja;M.nodeType!==8;){if(!I){M=null;break t}if(M=Xl(M.nextSibling),M===null){M=null;break t}}I=M.data,M=I==="F!"||I==="F"?M:null}if(M){Qi=Xl(M.nextSibling),y=M.data==="F!";break e}}Ll(y)}y=!1}y&&(u=m[0])}}return m=is(),m.memoizedState=m.baseState=u,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dy,lastRenderedState:u},m.queue=y,m=T_.bind(null,Dn,y),y.dispatch=m,y=uy(!1),I=_y.bind(null,Dn,!1,y.queue),y=is(),M={state:u,dispatch:null,action:l,pending:null},y.queue=M,m=WC.bind(null,Dn,M,I,m),M.dispatch=m,y.memoizedState=l,[u,m,!1]}function h_(l){var u=Nr();return my(u,Di,l)}function my(l,u,m){if(u=ly(l,u,dy)[0],l=zg(Mc)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var y=Sp(u)}catch(G){throw G===xh?Fn:G}else y=u;u=Nr();var M=u.queue,I=M.dispatch;return m!==u.memoizedState&&(Dn.flags|=2048,xu(9,{destroy:void 0},f_.bind(null,M,m),null)),[y,I,l]}function f_(l,u){l.action=u}function gy(l){var u=Nr(),m=Di;if(m!==null)return my(u,m,l);Nr(),u=u.memoizedState,m=Nr();var y=m.queue.dispatch;return m.memoizedState=l,[u,y,!1]}function xu(l,u,m,y){return l={tag:l,create:m,deps:y,inst:u,next:null},u=Dn.updateQueue,u===null&&(u=kg(),Dn.updateQueue=u),m=u.lastEffect,m===null?u.lastEffect=l.next=l:(y=m.next,m.next=l,l.next=y,u.lastEffect=l),l}function Gg(){return Nr().memoizedState}function Hg(l,u,m,y){var M=is();Dn.flags|=l,M.memoizedState=xu(1|u,{destroy:void 0},m,y===void 0?null:y)}function Qg(l,u,m,y){var M=Nr();y=y===void 0?null:y;var I=M.memoizedState.inst;Di!==null&&y!==null&&iy(y,Di.memoizedState.deps)?M.memoizedState=xu(u,I,m,y):(Dn.flags|=l,M.memoizedState=xu(1|u,I,m,y))}function d_(l,u){Hg(8390656,8,l,u)}function Ay(l,u){Qg(2048,8,l,u)}function p_(l){Dn.flags|=4;var u=Dn.updateQueue;if(u===null)u=kg(),Dn.updateQueue=u,u.events=[l];else{var m=u.events;m===null?u.events=[l]:m.push(l)}}function m_(l){var u=Nr().memoizedState;return p_({ref:u,nextImpl:l}),function(){if((an&2)!==0)throw Error(i(440));return u.impl.apply(void 0,arguments)}}function g_(l,u){return Qg(4,2,l,u)}function A_(l,u){return Qg(4,4,l,u)}function v_(l,u){if(typeof u=="function"){l=l();var m=u(l);return function(){typeof m=="function"?m():u(null)}}if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function y_(l,u,m){m=m!=null?m.concat([l]):null,Qg(4,4,v_.bind(null,u,l),m)}function vy(){}function b_(l,u){var m=Nr();u=u===void 0?null:u;var y=m.memoizedState;return u!==null&&iy(u,y[1])?y[0]:(m.memoizedState=[l,u],l)}function x_(l,u){var m=Nr();u=u===void 0?null:u;var y=m.memoizedState;if(u!==null&&iy(u,y[1]))return y[0];if(y=l(),Ch){at(!0);try{l()}finally{at(!1)}}return m.memoizedState=[y,u],y}function yy(l,u,m){return m===void 0||(nr&1073741824)!==0&&(Un&261930)===0?l.memoizedState=u:(l.memoizedState=m,l=Qn(),Dn.lanes|=l,jl|=l,m)}function __(l,u,m,y){return oa(m,u)?m:Qf.current!==null?(l=yy(l,m,y),oa(l,u)||(Kr=!0),l):(nr&42)===0||(nr&1073741824)!==0&&(Un&261930)===0?(Kr=!0,l.memoizedState=m):(l=Qn(),Dn.lanes|=l,jl|=l,u)}function S_(l,u,m,y,M){var I=K.p;K.p=I!==0&&8>I?I:8;var G=Q.T,ie={};Q.T=ie,_y(l,!1,u,m);try{var Ae=M(),Oe=Q.S;if(Oe!==null&&Oe(ie,Ae),Ae!==null&&typeof Ae=="object"&&typeof Ae.then=="function"){var lt=Kv(Ae,y);Ep(l,u,lt,Ja(l))}else Ep(l,u,y,Ja(l))}catch(mt){Ep(l,u,{then:function(){},status:"rejected",reason:mt},Ja())}finally{K.p=I,G!==null&&ie.types!==null&&(G.types=ie.types),Q.T=G}}function qC(){}function by(l,u,m,y){if(l.tag!==5)throw Error(i(476));var M=E_(l).queue;S_(l,M,u,ce,m===null?qC:function(){return w_(l),m(y)})}function E_(l){var u=l.memoizedState;if(u!==null)return u;u={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mc,lastRenderedState:ce},next:null};var m={};return u.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mc,lastRenderedState:m},next:null},l.memoizedState=u,l=l.alternate,l!==null&&(l.memoizedState=u),u}function w_(l){var u=E_(l);u.next===null&&(u=l.alternate.memoizedState),Ep(l,u.next.queue,{},Ja())}function xy(){return En(Qy)}function M_(){return Nr().memoizedState}function C_(){return Nr().memoizedState}function XC(l){for(var u=l.return;u!==null;){switch(u.tag){case 24:case 3:var m=Ja();l=Ec(m);var y=vu(u,l,m);y!==null&&(On(y,u,m),yu(y,u,m)),u={cache:qv()},l.payload=u;return}u=u.return}}function YC(l,u,m){var y=Ja();m={lane:y,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Vg(l)?I_(u,m):(m=xg(l,u,m,y),m!==null&&(On(m,l,y),R_(m,u,y)))}function T_(l,u,m){var y=Ja();Ep(l,u,m,y)}function Ep(l,u,m,y){var M={lane:y,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null};if(Vg(l))I_(u,M);else{var I=l.alternate;if(l.lanes===0&&(I===null||I.lanes===0)&&(I=u.lastRenderedReducer,I!==null))try{var G=u.lastRenderedState,ie=I(G,m);if(M.hasEagerState=!0,M.eagerState=ie,oa(ie,G))return gs(l,u,M,0),Cn===null&&dp(),!1}catch{}if(m=xg(l,u,M,y),m!==null)return On(m,l,y),R_(m,u,y),!0}return!1}function _y(l,u,m,y){if(y={lane:2,revertLane:We(),gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null},Vg(l)){if(u)throw Error(i(479))}else u=xg(l,m,y,2),u!==null&&On(u,l,2)}function Vg(l){var u=l.alternate;return l===Dn||u!==null&&u===Dn}function I_(l,u){Vf=bo=!0;var m=l.pending;m===null?u.next=u:(u.next=m.next,m.next=u),l.pending=u}function R_(l,u,m){if((m&4194048)!==0){var y=u.lanes;y&=l.pendingLanes,m|=y,u.lanes=m,yr(l,m)}}var Wf={readContext:En,use:bu,useCallback:ur,useContext:ur,useEffect:ur,useImperativeHandle:ur,useLayoutEffect:ur,useInsertionEffect:ur,useMemo:ur,useReducer:ur,useRef:ur,useState:ur,useDebugValue:ur,useDeferredValue:ur,useTransition:ur,useSyncExternalStore:ur,useId:ur,useHostTransitionStatus:ur,useFormState:ur,useActionState:ur,useOptimistic:ur,useMemoCache:ur,useCacheRefresh:ur};Wf.useEffectEvent=ur;var B_={readContext:En,use:bu,useCallback:function(l,u){return is().memoizedState=[l,u===void 0?null:u],l},useContext:En,useEffect:d_,useImperativeHandle:function(l,u,m){m=m!=null?m.concat([l]):null,Hg(4194308,4,v_.bind(null,u,l),m)},useLayoutEffect:function(l,u){return Hg(4194308,4,l,u)},useInsertionEffect:function(l,u){Hg(4,2,l,u)},useMemo:function(l,u){var m=is();u=u===void 0?null:u;var y=l();if(Ch){at(!0);try{l()}finally{at(!1)}}return m.memoizedState=[y,u],y},useReducer:function(l,u,m){var y=is();if(m!==void 0){var M=m(u);if(Ch){at(!0);try{m(u)}finally{at(!1)}}}else M=u;return y.memoizedState=y.baseState=M,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:M},y.queue=l,l=l.dispatch=YC.bind(null,Dn,l),[y.memoizedState,l]},useRef:function(l){var u=is();return l={current:l},u.memoizedState=l},useState:function(l){l=uy(l);var u=l.queue,m=T_.bind(null,Dn,u);return u.dispatch=m,[l.memoizedState,m]},useDebugValue:vy,useDeferredValue:function(l,u){var m=is();return yy(m,l,u)},useTransition:function(){var l=uy(!1);return l=S_.bind(null,Dn,l.queue,!0,!1),is().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,u,m){var y=Dn,M=is();if(Jn){if(m===void 0)throw Error(i(407));m=m()}else{if(m=u(),Cn===null)throw Error(i(349));(Un&127)!==0||n_(y,u,m)}M.memoizedState=m;var I={value:m,getSnapshot:u};return M.queue=I,d_(r_.bind(null,y,I,l),[l]),y.flags|=2048,xu(9,{destroy:void 0},i_.bind(null,y,I,m,u),null),m},useId:function(){var l=is(),u=Cn.identifierPrefix;if(Jn){var m=Wo,y=cr;m=(y&~(1<<32-bt(y)-1)).toString(32)+m,u="_"+u+"R_"+m,m=Pg++,0<m&&(u+="H"+m.toString(32)),u+="_"}else m=ny++,u="_"+u+"r_"+m.toString(32)+"_";return l.memoizedState=u},useHostTransitionStatus:xy,useFormState:py,useActionState:py,useOptimistic:function(l){var u=is();u.memoizedState=u.baseState=l;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=m,u=_y.bind(null,Dn,!0,m),m.dispatch=u,[l,u]},useMemoCache:oy,useCacheRefresh:function(){return is().memoizedState=XC.bind(null,Dn)},useEffectEvent:function(l){var u=is(),m={impl:l};return u.memoizedState=m,function(){if((an&2)!==0)throw Error(i(440));return m.impl.apply(void 0,arguments)}}},Sy={readContext:En,use:bu,useCallback:b_,useContext:En,useEffect:Ay,useImperativeHandle:y_,useInsertionEffect:g_,useLayoutEffect:A_,useMemo:x_,useReducer:zg,useRef:Gg,useState:function(){return zg(Mc)},useDebugValue:vy,useDeferredValue:function(l,u){var m=Nr();return __(m,Di.memoizedState,l,u)},useTransition:function(){var l=zg(Mc)[0],u=Nr().memoizedState;return[typeof l=="boolean"?l:Sp(l),u]},useSyncExternalStore:t_,useId:M_,useHostTransitionStatus:xy,useFormState:h_,useActionState:h_,useOptimistic:function(l,u){var m=Nr();return hy(m,Di,l,u)},useMemoCache:oy,useCacheRefresh:C_};Sy.useEffectEvent=m_;var xo={readContext:En,use:bu,useCallback:b_,useContext:En,useEffect:Ay,useImperativeHandle:y_,useInsertionEffect:g_,useLayoutEffect:A_,useMemo:x_,useReducer:cy,useRef:Gg,useState:function(){return cy(Mc)},useDebugValue:vy,useDeferredValue:function(l,u){var m=Nr();return Di===null?yy(m,l,u):__(m,Di.memoizedState,l,u)},useTransition:function(){var l=cy(Mc)[0],u=Nr().memoizedState;return[typeof l=="boolean"?l:Sp(l),u]},useSyncExternalStore:t_,useId:M_,useHostTransitionStatus:xy,useFormState:gy,useActionState:gy,useOptimistic:function(l,u){var m=Nr();return Di!==null?hy(m,Di,l,u):(m.baseState=l,[l,m.queue.dispatch])},useMemoCache:oy,useCacheRefresh:C_};xo.useEffectEvent=m_;function jg(l,u,m,y){u=l.memoizedState,m=m(y,u),m=m==null?u:g({},u,m),l.memoizedState=m,l.lanes===0&&(l.updateQueue.baseState=m)}var wp={enqueueSetState:function(l,u,m){l=l._reactInternals;var y=Ja(),M=Ec(y);M.payload=u,m!=null&&(M.callback=m),u=vu(l,M,y),u!==null&&(On(u,l,y),yu(u,l,y))},enqueueReplaceState:function(l,u,m){l=l._reactInternals;var y=Ja(),M=Ec(y);M.tag=1,M.payload=u,m!=null&&(M.callback=m),u=vu(l,M,y),u!==null&&(On(u,l,y),yu(u,l,y))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var m=Ja(),y=Ec(m);y.tag=2,u!=null&&(y.callback=u),u=vu(l,y,m),u!==null&&(On(u,l,m),yu(u,l,m))}};function Ey(l,u,m,y,M,I,G){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(y,I,G):u.prototype&&u.prototype.isPureReactComponent?!Tf(m,y)||!Tf(M,I):!0}function wy(l,u,m,y){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(m,y),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(m,y),u.state!==l&&wp.enqueueReplaceState(u,u.state,null)}function _u(l,u){var m=u;if("ref"in u){m={};for(var y in u)y!=="ref"&&(m[y]=u[y])}if(l=l.defaultProps){m===u&&(m=g({},m));for(var M in l)m[M]===void 0&&(m[M]=l[M])}return m}function D_(l){fp(l)}function My(l){console.error(l)}function Cy(l){fp(l)}function Wg(l,u){try{var m=l.onUncaughtError;m(u.value,{componentStack:u.stack})}catch(y){setTimeout(function(){throw y})}}function L_(l,u,m){try{var y=l.onCaughtError;y(m.value,{componentStack:m.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function Ty(l,u,m){return m=Ec(m),m.tag=3,m.payload={element:null},m.callback=function(){Wg(l,u)},m}function Iy(l){return l=Ec(l),l.tag=3,l}function N_(l,u,m,y){var M=m.type.getDerivedStateFromError;if(typeof M=="function"){var I=y.value;l.payload=function(){return M(I)},l.callback=function(){L_(u,m,y)}}var G=m.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(l.callback=function(){L_(u,m,y),typeof M!="function"&&(Pr===null?Pr=new Set([this]):Pr.add(this));var ie=y.stack;this.componentDidCatch(y.value,{componentStack:ie!==null?ie:""})})}function rs(l,u,m,y,M){if(m.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(u=m.alternate,u!==null&&Pl(u,m,M,!0),m=wa.current,m!==null){switch(m.tag){case 31:case 13:return ua===null?Zf():m.alternate===null&&hr===0&&(hr=3),m.flags&=-257,m.flags|=65536,m.lanes=M,y===Dg?m.flags|=16384:(u=m.updateQueue,u===null?m.updateQueue=new Set([y]):u.add(y),Pp(l,y,M)),!1;case 22:return m.flags|=65536,y===Dg?m.flags|=16384:(u=m.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([y])},m.updateQueue=u):(m=u.retryQueue,m===null?u.retryQueue=new Set([y]):m.add(y)),Pp(l,y,M)),!1}throw Error(i(435,m.tag))}return Pp(l,y,M),Zf(),!1}if(Jn)return u=wa.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=M,y!==Ff&&(l=Error(i(422),{cause:y}),Nl(Va(l,m)))):(y!==Ff&&(u=Error(i(423),{cause:y}),Nl(Va(u,m))),l=l.current.alternate,l.flags|=65536,M&=-M,l.lanes|=M,y=Va(y,m),M=Ty(l.stateNode,y,M),hn(l,M),hr!==4&&(hr=2)),!1;var I=Error(i(520),{cause:y});if(I=Va(I,m),Ph===null?Ph=[I]:Ph.push(I),hr!==4&&(hr=2),u===null)return!0;y=Va(y,m),m=u;do{switch(m.tag){case 3:return m.flags|=65536,l=M&-M,m.lanes|=l,l=Ty(m.stateNode,y,l),hn(m,l),!1;case 1:if(u=m.type,I=m.stateNode,(m.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Pr===null||!Pr.has(I))))return m.flags|=65536,M&=-M,m.lanes|=M,M=Iy(M),N_(M,l,m,y),hn(m,M),!1}m=m.return}while(m!==null);return!1}var qg=Error(i(461)),Kr=!1;function As(l,u,m,y){u.child=l===null?Ug(u,null,m,y):Sc(u,l.child,m,y)}function Ry(l,u,m,y,M){m=m.render;var I=u.ref;if("ref"in y){var G={};for(var ie in y)ie!=="ref"&&(G[ie]=y[ie])}else G=y;return gu(u),y=Og(l,u,m,G,I,M),ie=ry(),l!==null&&!Kr?(sy(l,u,M),Ur(l,u,M)):(Jn&&ie&&Dl(u),u.flags|=1,As(l,u,y,M),u.child)}function Rh(l,u,m,y,M){if(l===null){var I=m.type;return typeof I=="function"&&!_g(I)&&I.defaultProps===void 0&&m.compare===null?(u.tag=15,u.type=I,Xg(l,u,I,y,M)):(l=Rl(m.type,null,y,u,u.mode,M),l.ref=u.ref,l.return=u,u.child=l)}if(I=l.child,!eA(l,M)){var G=I.memoizedProps;if(m=m.compare,m=m!==null?m:Tf,m(G,y)&&l.ref===u.ref)return Ur(l,u,M)}return u.flags|=1,l=_a(I,y),l.ref=u.ref,l.return=u,u.child=l}function Xg(l,u,m,y,M){if(l!==null){var I=l.memoizedProps;if(Tf(I,y)&&l.ref===u.ref)if(Kr=!1,u.pendingProps=y=I,eA(l,M))(l.flags&131072)!==0&&(Kr=!0);else return u.lanes=l.lanes,Ur(l,u,M)}return qf(l,u,m,y,M)}function Bh(l,u,m,y){var M=y.children,I=l!==null?l.memoizedState:null;if(l===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),y.mode==="hidden"){if((u.flags&128)!==0){if(I=I!==null?I.baseLanes|m:m,l!==null){for(y=u.child=l.child,M=0;y!==null;)M=M|y.lanes|y.childLanes,y=y.sibling;y=M&~I}else y=0,u.child=null;return Ca(l,u,I,m,y)}if((m&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},l!==null&&gp(u,I!==null?I.cachePool:null),I!==null?Jx(u,I):ey(),Zx(u);else return y=u.lanes=536870912,Ca(l,u,I!==null?I.baseLanes|m:m,m,y)}else I!==null?(gp(u,I.cachePool),Jx(u,I),Ma(),u.memoizedState=null):(l!==null&&gp(u,null),ey(),Ma());return As(l,u,M,m),u.child}function kl(l,u){return l!==null&&l.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function Ca(l,u,m,y,M){var I=Bg();return I=I===null?null:{parent:Yr._currentValue,pool:I},u.memoizedState={baseLanes:m,cachePool:I},l!==null&&gp(u,null),ey(),Zx(u),l!==null&&Pl(l,u,y,!0),u.childLanes=M,null}function Yg(l,u){return u=Zg({mode:u.mode,children:u.children},l.mode),u.ref=l.ref,l.child=u,u.return=l,u}function U_(l,u,m){return Sc(u,l.child,null,m),l=Yg(u,u.pendingProps),l.flags|=2,Lr(u),u.memoizedState=null,l}function Kg(l,u,m){var y=u.pendingProps,M=(u.flags&128)!==0;if(u.flags&=-129,l===null){if(Jn){if(y.mode==="hidden")return l=Yg(u,y),u.lanes=536870912,kl(null,l);if(ty(u),(l=Qi)?(l=_D(l,ja),l=l!==null&&l.data==="&"?l:null,l!==null&&(u.memoizedState={dehydrated:l,treeContext:yc!==null?{id:cr,overflow:Wo}:null,retryLane:536870912,hydrationErrors:null},m=Lf(l),m.return=u,u.child=m,br=u,Qi=null)):l=null,l===null)throw Ll(u);return u.lanes=536870912,null}return Yg(u,y)}var I=l.memoizedState;if(I!==null){var G=I.dehydrated;if(ty(u),M)if(u.flags&256)u.flags&=-257,u=U_(l,u,m);else if(u.memoizedState!==null)u.child=l.child,u.flags|=128,u=null;else throw Error(i(558));else if(Kr||Pl(l,u,m,!1),M=(m&l.childLanes)!==0,Kr||M){if(y=Cn,y!==null&&(G=Ir(y,m),G!==0&&G!==I.retryLane))throw I.retryLane=G,la(l,G),On(y,l,G),qg;Zf(),u=U_(l,u,m)}else l=I.treeContext,Qi=Xl(G.nextSibling),br=u,Jn=!0,bc=null,ja=!1,l!==null&&Mg(u,l),u=Yg(u,y),u.flags|=4096;return u}return l=_a(l.child,{mode:y.mode,children:y.children}),l.ref=u.ref,u.child=l,l.return=u,l}function Dh(l,u){var m=u.ref;if(m===null)l!==null&&l.ref!==null&&(u.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(i(284));(l===null||l.ref!==m)&&(u.flags|=4194816)}}function qf(l,u,m,y,M){return gu(u),m=Og(l,u,m,y,void 0,M),y=ry(),l!==null&&!Kr?(sy(l,u,M),Ur(l,u,M)):(Jn&&y&&Dl(u),u.flags|=1,As(l,u,m,M),u.child)}function Mp(l,u,m,y,M,I){return gu(u),u.updateQueue=null,m=Th(u,y,m,M),e_(l),y=ry(),l!==null&&!Kr?(sy(l,u,I),Ur(l,u,I)):(Jn&&y&&Dl(u),u.flags|=1,As(l,u,m,I),u.child)}function $g(l,u,m,y,M){if(gu(u),u.stateNode===null){var I=uu,G=m.contextType;typeof G=="object"&&G!==null&&(I=En(G)),I=new m(y,I),u.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,I.updater=wp,u.stateNode=I,I._reactInternals=u,I=u.stateNode,I.props=y,I.state=u.memoizedState,I.refs={},yp(u),G=m.contextType,I.context=typeof G=="object"&&G!==null?En(G):uu,I.state=u.memoizedState,G=m.getDerivedStateFromProps,typeof G=="function"&&(jg(u,m,G,y),I.state=u.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(G=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),G!==I.state&&wp.enqueueReplaceState(I,I.state,null),Gf(u,y,I,M),bp(),I.state=u.memoizedState),typeof I.componentDidMount=="function"&&(u.flags|=4194308),y=!0}else if(l===null){I=u.stateNode;var ie=u.memoizedProps,Ae=_u(m,ie);I.props=Ae;var Oe=I.context,lt=m.contextType;G=uu,typeof lt=="object"&&lt!==null&&(G=En(lt));var mt=m.getDerivedStateFromProps;lt=typeof mt=="function"||typeof I.getSnapshotBeforeUpdate=="function",ie=u.pendingProps!==ie,lt||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(ie||Oe!==G)&&wy(u,I,y,G),ca=!1;var Ge=u.memoizedState;I.state=Ge,Gf(u,y,I,M),bp(),Oe=u.memoizedState,ie||Ge!==Oe||ca?(typeof mt=="function"&&(jg(u,m,mt,y),Oe=u.memoizedState),(Ae=ca||Ey(u,m,Ae,y,Ge,Oe,G))?(lt||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(u.flags|=4194308)):(typeof I.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=y,u.memoizedState=Oe),I.props=y,I.state=Oe,I.context=G,y=Ae):(typeof I.componentDidMount=="function"&&(u.flags|=4194308),y=!1)}else{I=u.stateNode,Jv(l,u),G=u.memoizedProps,lt=_u(m,G),I.props=lt,mt=u.pendingProps,Ge=I.context,Oe=m.contextType,Ae=uu,typeof Oe=="object"&&Oe!==null&&(Ae=En(Oe)),ie=m.getDerivedStateFromProps,(Oe=typeof ie=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(G!==mt||Ge!==Ae)&&wy(u,I,y,Ae),ca=!1,Ge=u.memoizedState,I.state=Ge,Gf(u,y,I,M),bp();var $e=u.memoizedState;G!==mt||Ge!==$e||ca||l!==null&&l.dependencies!==null&&mp(l.dependencies)?(typeof ie=="function"&&(jg(u,m,ie,y),$e=u.memoizedState),(lt=ca||Ey(u,m,lt,y,Ge,$e,Ae)||l!==null&&l.dependencies!==null&&mp(l.dependencies))?(Oe||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(y,$e,Ae),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(y,$e,Ae)),typeof I.componentDidUpdate=="function"&&(u.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof I.componentDidUpdate!="function"||G===l.memoizedProps&&Ge===l.memoizedState||(u.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||G===l.memoizedProps&&Ge===l.memoizedState||(u.flags|=1024),u.memoizedProps=y,u.memoizedState=$e),I.props=y,I.state=$e,I.context=Ae,y=lt):(typeof I.componentDidUpdate!="function"||G===l.memoizedProps&&Ge===l.memoizedState||(u.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||G===l.memoizedProps&&Ge===l.memoizedState||(u.flags|=1024),y=!1)}return I=y,Dh(l,u),y=(u.flags&128)!==0,I||y?(I=u.stateNode,m=y&&typeof m.getDerivedStateFromError!="function"?null:I.render(),u.flags|=1,l!==null&&y?(u.child=Sc(u,l.child,null,M),u.child=Sc(u,null,m,M)):As(l,u,m,M),u.memoizedState=I.state,l=u.child):l=Ur(l,u,M),l}function F_(l,u,m,y){return pu(),u.flags|=256,As(l,u,m,y),u.child}var By={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function js(l){return{baseLanes:l,cachePool:$v()}}function Jg(l,u,m){return l=l!==null?l.childLanes&~m:0,u&&(l|=da),l}function P_(l,u,m){var y=u.pendingProps,M=!1,I=(u.flags&128)!==0,G;if((G=I)||(G=l!==null&&l.memoizedState===null?!1:(Zn.current&2)!==0),G&&(M=!0,u.flags&=-129),G=(u.flags&32)!==0,u.flags&=-33,l===null){if(Jn){if(M?wc(u):Ma(),(l=Qi)?(l=_D(l,ja),l=l!==null&&l.data!=="&"?l:null,l!==null&&(u.memoizedState={dehydrated:l,treeContext:yc!==null?{id:cr,overflow:Wo}:null,retryLane:536870912,hydrationErrors:null},m=Lf(l),m.return=u,u.child=m,br=u,Qi=null)):l=null,l===null)throw Ll(u);return c3(l)?u.lanes=32:u.lanes=536870912,null}var ie=y.children;return y=y.fallback,M?(Ma(),M=u.mode,ie=Zg({mode:"hidden",children:ie},M),y=hu(y,M,m,null),ie.return=u,y.return=u,ie.sibling=y,u.child=ie,y=u.child,y.memoizedState=js(m),y.childLanes=Jg(l,G,m),u.memoizedState=By,kl(null,y)):(wc(u),Cp(u,ie))}var Ae=l.memoizedState;if(Ae!==null&&(ie=Ae.dehydrated,ie!==null)){if(I)u.flags&256?(wc(u),u.flags&=-257,u=Dy(l,u,m)):u.memoizedState!==null?(Ma(),u.child=l.child,u.flags|=128,u=null):(Ma(),ie=y.fallback,M=u.mode,y=Zg({mode:"visible",children:y.children},M),ie=hu(ie,M,m,null),ie.flags|=2,y.return=u,ie.return=u,y.sibling=ie,u.child=y,Sc(u,l.child,null,m),y=u.child,y.memoizedState=js(m),y.childLanes=Jg(l,G,m),u.memoizedState=By,u=kl(null,y));else if(wc(u),c3(ie)){if(G=ie.nextSibling&&ie.nextSibling.dataset,G)var Oe=G.dgst;G=Oe,y=Error(i(419)),y.stack="",y.digest=G,Nl({value:y,source:null,stack:null}),u=Dy(l,u,m)}else if(Kr||Pl(l,u,m,!1),G=(m&l.childLanes)!==0,Kr||G){if(G=Cn,G!==null&&(y=Ir(G,m),y!==0&&y!==Ae.retryLane))throw Ae.retryLane=y,la(l,y),On(G,l,y),qg;l3(ie)||Zf(),u=Dy(l,u,m)}else l3(ie)?(u.flags|=192,u.child=l.child,u=null):(l=Ae.treeContext,Qi=Xl(ie.nextSibling),br=u,Jn=!0,bc=null,ja=!1,l!==null&&Mg(u,l),u=Cp(u,y.children),u.flags|=4096);return u}return M?(Ma(),ie=y.fallback,M=u.mode,Ae=l.child,Oe=Ae.sibling,y=_a(Ae,{mode:"hidden",children:y.children}),y.subtreeFlags=Ae.subtreeFlags&65011712,Oe!==null?ie=_a(Oe,ie):(ie=hu(ie,M,m,null),ie.flags|=2),ie.return=u,y.return=u,y.sibling=ie,u.child=y,kl(null,y),y=u.child,ie=l.child.memoizedState,ie===null?ie=js(m):(M=ie.cachePool,M!==null?(Ae=Yr._currentValue,M=M.parent!==Ae?{parent:Ae,pool:Ae}:M):M=$v(),ie={baseLanes:ie.baseLanes|m,cachePool:M}),y.memoizedState=ie,y.childLanes=Jg(l,G,m),u.memoizedState=By,kl(l.child,y)):(wc(u),m=l.child,l=m.sibling,m=_a(m,{mode:"visible",children:y.children}),m.return=u,m.sibling=null,l!==null&&(G=u.deletions,G===null?(u.deletions=[l],u.flags|=16):G.push(l)),u.child=m,u.memoizedState=null,m)}function Cp(l,u){return u=Zg({mode:"visible",children:u},l.mode),u.return=l,l.child=u}function Zg(l,u){return l=lr(22,l,null,u),l.lanes=0,l}function Dy(l,u,m){return Sc(u,l.child,null,m),l=Cp(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function O_(l,u,m){l.lanes|=u;var y=l.alternate;y!==null&&(y.lanes|=u),Tg(l.return,u,m)}function Lh(l,u,m,y,M,I){var G=l.memoizedState;G===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:y,tail:m,tailMode:M,treeForkCount:I}:(G.isBackwards=u,G.rendering=null,G.renderingStartTime=0,G.last=y,G.tail=m,G.tailMode=M,G.treeForkCount=I)}function Ta(l,u,m){var y=u.pendingProps,M=y.revealOrder,I=y.tail;y=y.children;var G=Zn.current,ie=(G&2)!==0;if(ie?(G=G&1|2,u.flags|=128):G&=1,ae(Zn,G),As(l,u,y,m),y=Jn?Uf:0,!ie&&l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&O_(l,m,u);else if(l.tag===19)O_(l,m,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(M){case"forwards":for(m=u.child,M=null;m!==null;)l=m.alternate,l!==null&&qa(l)===null&&(M=m),m=m.sibling;m=M,m===null?(M=u.child,u.child=null):(M=m.sibling,m.sibling=null),Lh(u,!1,M,m,I,y);break;case"backwards":case"unstable_legacy-backwards":for(m=null,M=u.child,u.child=null;M!==null;){if(l=M.alternate,l!==null&&qa(l)===null){u.child=M;break}l=M.sibling,M.sibling=m,m=M,M=l}Lh(u,!0,m,null,I,y);break;case"together":Lh(u,!1,null,null,void 0,y);break;default:u.memoizedState=null}return u.child}function Ur(l,u,m){if(l!==null&&(u.dependencies=l.dependencies),jl|=u.lanes,(m&u.childLanes)===0)if(l!==null){if(Pl(l,u,m,!1),(m&u.childLanes)===0)return null}else return null;if(l!==null&&u.child!==l.child)throw Error(i(153));if(u.child!==null){for(l=u.child,m=_a(l,l.pendingProps),u.child=m,m.return=u;l.sibling!==null;)l=l.sibling,m=m.sibling=_a(l,l.pendingProps),m.return=u;m.sibling=null}return u.child}function eA(l,u){return(l.lanes&u)!==0?!0:(l=l.dependencies,!!(l!==null&&mp(l)))}function KC(l,u,m){switch(u.tag){case 3:_e(u,u.stateNode.containerInfo),xc(u,Yr,l.memoizedState.cache),pu();break;case 27:case 5:et(u);break;case 4:_e(u,u.stateNode.containerInfo);break;case 10:xc(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,ty(u),null;break;case 13:var y=u.memoizedState;if(y!==null)return y.dehydrated!==null?(wc(u),u.flags|=128,null):(m&u.child.childLanes)!==0?P_(l,u,m):(wc(u),l=Ur(l,u,m),l!==null?l.sibling:null);wc(u);break;case 19:var M=(l.flags&128)!==0;if(y=(m&u.childLanes)!==0,y||(Pl(l,u,m,!1),y=(m&u.childLanes)!==0),M){if(y)return Ta(l,u,m);u.flags|=128}if(M=u.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),ae(Zn,Zn.current),y)break;return null;case 22:return u.lanes=0,Bh(l,u,m,u.pendingProps);case 24:xc(u,Yr,l.memoizedState.cache)}return Ur(l,u,m)}function tA(l,u,m){if(l!==null)if(l.memoizedProps!==u.pendingProps)Kr=!0;else{if(!eA(l,m)&&(u.flags&128)===0)return Kr=!1,KC(l,u,m);Kr=(l.flags&131072)!==0}else Kr=!1,Jn&&(u.flags&1048576)!==0&&jx(u,Uf,u.index);switch(u.lanes=0,u.tag){case 16:e:{var y=u.pendingProps;if(l=_h(u.elementType),u.type=l,typeof l=="function")_g(l)?(y=_u(l,y),u.tag=1,u=$g(null,u,l,y,m)):(u.tag=0,u=qf(null,u,l,y,m));else{if(l!=null){var M=l.$$typeof;if(M===R){u.tag=11,u=Ry(null,u,l,y,m);break e}else if(M===O){u.tag=14,u=Rh(null,u,l,y,m);break e}}throw u=q(l)||l,Error(i(306,u,""))}}return u;case 0:return qf(l,u,u.type,u.pendingProps,m);case 1:return y=u.type,M=_u(y,u.pendingProps),$g(l,u,y,M,m);case 3:e:{if(_e(u,u.stateNode.containerInfo),l===null)throw Error(i(387));y=u.pendingProps;var I=u.memoizedState;M=I.element,Jv(l,u),Gf(u,y,null,m);var G=u.memoizedState;if(y=G.cache,xc(u,Yr,y),y!==I.cache&&Ig(u,[Yr],m,!0),bp(),y=G.element,I.isDehydrated)if(I={element:y,isDehydrated:!1,cache:G.cache},u.updateQueue.baseState=I,u.memoizedState=I,u.flags&256){u=F_(l,u,y,m);break e}else if(y!==M){M=Va(Error(i(424)),u),Nl(M),u=F_(l,u,y,m);break e}else for(l=u.stateNode.containerInfo,l.nodeType===9?l=l.body:l=l.nodeName==="HTML"?l.ownerDocument.body:l,Qi=Xl(l.firstChild),br=u,Jn=!0,bc=null,ja=!0,m=Ug(u,null,y,m),u.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(pu(),y===M){u=Ur(l,u,m);break e}As(l,u,y,m)}u=u.child}return u;case 26:return Dh(l,u),l===null?(m=TD(u.type,null,u.pendingProps,null))?u.memoizedState=m:Jn||(m=u.type,l=u.pendingProps,y=H_(le.current).createElement(m),y[hi]=u,y[Y]=l,ma(y,m,l),J(y),u.stateNode=y):u.memoizedState=TD(u.type,l.memoizedProps,u.pendingProps,l.memoizedState),null;case 27:return et(u),l===null&&Jn&&(y=u.stateNode=wD(u.type,u.pendingProps,le.current),br=u,ja=!0,M=Qi,id(u.type)?(u3=M,Qi=Xl(y.firstChild)):Qi=M),As(l,u,u.pendingProps.children,m),Dh(l,u),l===null&&(u.flags|=4194304),u.child;case 5:return l===null&&Jn&&((M=y=Qi)&&(y=KH(y,u.type,u.pendingProps,ja),y!==null?(u.stateNode=y,br=u,Qi=Xl(y.firstChild),ja=!1,M=!0):M=!1),M||Ll(u)),et(u),M=u.type,I=u.pendingProps,G=l!==null?l.memoizedProps:null,y=I.children,s3(M,I)?y=null:G!==null&&s3(M,G)&&(u.flags|=32),u.memoizedState!==null&&(M=Og(l,u,Ih,null,null,m),Qy._currentValue=M),Dh(l,u),As(l,u,y,m),u.child;case 6:return l===null&&Jn&&((l=m=Qi)&&(m=$H(m,u.pendingProps,ja),m!==null?(u.stateNode=m,br=u,Qi=null,l=!0):l=!1),l||Ll(u)),null;case 13:return P_(l,u,m);case 4:return _e(u,u.stateNode.containerInfo),y=u.pendingProps,l===null?u.child=Sc(u,null,y,m):As(l,u,y,m),u.child;case 11:return Ry(l,u,u.type,u.pendingProps,m);case 7:return As(l,u,u.pendingProps,m),u.child;case 8:return As(l,u,u.pendingProps.children,m),u.child;case 12:return As(l,u,u.pendingProps.children,m),u.child;case 10:return y=u.pendingProps,xc(u,u.type,y.value),As(l,u,y.children,m),u.child;case 9:return M=u.type._context,y=u.pendingProps.children,gu(u),M=En(M),y=y(M),u.flags|=1,As(l,u,y,m),u.child;case 14:return Rh(l,u,u.type,u.pendingProps,m);case 15:return Xg(l,u,u.type,u.pendingProps,m);case 19:return Ta(l,u,m);case 31:return Kg(l,u,m);case 22:return Bh(l,u,m,u.pendingProps);case 24:return gu(u),y=En(Yr),l===null?(M=Bg(),M===null&&(M=Cn,I=qv(),M.pooledCache=I,I.refCount++,I!==null&&(M.pooledCacheLanes|=m),M=I),u.memoizedState={parent:y,cache:M},yp(u),xc(u,Yr,M)):((l.lanes&m)!==0&&(Jv(l,u),Gf(u,null,null,m),bp()),M=l.memoizedState,I=u.memoizedState,M.parent!==y?(M={parent:y,cache:y},u.memoizedState=M,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=M),xc(u,Yr,y)):(y=I.cache,xc(u,Yr,y),y!==M.cache&&Ig(u,[Yr],m,!0))),As(l,u,u.pendingProps.children,m),u.child;case 29:throw u.pendingProps}throw Error(i(156,u.tag))}function zl(l){l.flags|=4}function Tp(l,u,m,y,M){if((u=(l.mode&32)!==0)&&(u=!1),u){if(l.flags|=16777216,(M&335544128)===M)if(l.stateNode.complete)l.flags|=8192;else if(dr())l.flags|=8192;else throw Ol=Dg,Ap}else l.flags&=-16777217}function Ly(l,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!LD(u))if(dr())l.flags|=8192;else throw Ol=Dg,Ap}function Cc(l,u){u!==null&&(l.flags|=4),l.flags&16384&&(u=l.tag!==22?kt():536870912,l.lanes|=u,Yi|=u)}function Gl(l,u){if(!Jn)switch(l.tailMode){case"hidden":u=l.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?l.tail=null:m.sibling=null;break;case"collapsed":m=l.tail;for(var y=null;m!==null;)m.alternate!==null&&(y=m),m=m.sibling;y===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:y.sibling=null}}function Li(l){var u=l.alternate!==null&&l.alternate.child===l.child,m=0,y=0;if(u)for(var M=l.child;M!==null;)m|=M.lanes|M.childLanes,y|=M.subtreeFlags&65011712,y|=M.flags&65011712,M.return=l,M=M.sibling;else for(M=l.child;M!==null;)m|=M.lanes|M.childLanes,y|=M.subtreeFlags,y|=M.flags,M.return=l,M=M.sibling;return l.subtreeFlags|=y,l.childLanes=m,u}function Ip(l,u,m){var y=u.pendingProps;switch(wg(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Li(u),null;case 1:return Li(u),null;case 3:return m=u.stateNode,y=null,l!==null&&(y=l.memoizedState.cache),u.memoizedState.cache!==y&&(u.flags|=2048),Fl(Yr),Pe(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(l===null||l.child===null)&&(Pf(u)?zl(u):l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Cg())),Li(u),null;case 26:var M=u.type,I=u.memoizedState;return l===null?(zl(u),I!==null?(Li(u),Ly(u,I)):(Li(u),Tp(u,M,null,y,m))):I?I!==l.memoizedState?(zl(u),Li(u),Ly(u,I)):(Li(u),u.flags&=-16777217):(l=l.memoizedProps,l!==y&&zl(u),Li(u),Tp(u,M,l,y,m)),null;case 27:if(ot(u),m=le.current,M=u.type,l!==null&&u.stateNode!=null)l.memoizedProps!==y&&zl(u);else{if(!y){if(u.stateNode===null)throw Error(i(166));return Li(u),null}l=he.current,Pf(u)?Wx(u):(l=wD(M,y,m),u.stateNode=l,zl(u))}return Li(u),null;case 5:if(ot(u),M=u.type,l!==null&&u.stateNode!=null)l.memoizedProps!==y&&zl(u);else{if(!y){if(u.stateNode===null)throw Error(i(166));return Li(u),null}if(I=he.current,Pf(u))Wx(u);else{var G=H_(le.current);switch(I){case 1:I=G.createElementNS("http://www.w3.org/2000/svg",M);break;case 2:I=G.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;default:switch(M){case"svg":I=G.createElementNS("http://www.w3.org/2000/svg",M);break;case"math":I=G.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;case"script":I=G.createElement("div"),I.innerHTML="<script><\/script>",I=I.removeChild(I.firstChild);break;case"select":I=typeof y.is=="string"?G.createElement("select",{is:y.is}):G.createElement("select"),y.multiple?I.multiple=!0:y.size&&(I.size=y.size);break;default:I=typeof y.is=="string"?G.createElement(M,{is:y.is}):G.createElement(M)}}I[hi]=u,I[Y]=y;e:for(G=u.child;G!==null;){if(G.tag===5||G.tag===6)I.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===u)break e;for(;G.sibling===null;){if(G.return===null||G.return===u)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}u.stateNode=I;e:switch(ma(I,M,y),M){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}y&&zl(u)}}return Li(u),Tp(u,u.type,l===null?null:l.memoizedProps,u.pendingProps,m),null;case 6:if(l&&u.stateNode!=null)l.memoizedProps!==y&&zl(u);else{if(typeof y!="string"&&u.stateNode===null)throw Error(i(166));if(l=le.current,Pf(u)){if(l=u.stateNode,m=u.memoizedProps,y=null,M=br,M!==null)switch(M.tag){case 27:case 5:y=M.memoizedProps}l[hi]=u,l=!!(l.nodeValue===m||y!==null&&y.suppressHydrationWarning===!0||pD(l.nodeValue,m)),l||Ll(u,!0)}else l=H_(l).createTextNode(y),l[hi]=u,u.stateNode=l}return Li(u),null;case 31:if(m=u.memoizedState,l===null||l.memoizedState!==null){if(y=Pf(u),m!==null){if(l===null){if(!y)throw Error(i(318));if(l=u.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(i(557));l[hi]=u}else pu(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Li(u),l=!1}else m=Cg(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=m),l=!0;if(!l)return u.flags&256?(Lr(u),u):(Lr(u),null);if((u.flags&128)!==0)throw Error(i(558))}return Li(u),null;case 13:if(y=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(M=Pf(u),y!==null&&y.dehydrated!==null){if(l===null){if(!M)throw Error(i(318));if(M=u.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(i(317));M[hi]=u}else pu(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Li(u),M=!1}else M=Cg(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=M),M=!0;if(!M)return u.flags&256?(Lr(u),u):(Lr(u),null)}return Lr(u),(u.flags&128)!==0?(u.lanes=m,u):(m=y!==null,l=l!==null&&l.memoizedState!==null,m&&(y=u.child,M=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(M=y.alternate.memoizedState.cachePool.pool),I=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(I=y.memoizedState.cachePool.pool),I!==M&&(y.flags|=2048)),m!==l&&m&&(u.child.flags|=8192),Cc(u,u.updateQueue),Li(u),null);case 4:return Pe(),l===null&&e3(u.stateNode.containerInfo),Li(u),null;case 10:return Fl(u.type),Li(u),null;case 19:if($(Zn),y=u.memoizedState,y===null)return Li(u),null;if(M=(u.flags&128)!==0,I=y.rendering,I===null)if(M)Gl(y,!1);else{if(hr!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(I=qa(l),I!==null){for(u.flags|=128,Gl(y,!1),l=I.updateQueue,u.updateQueue=l,Cc(u,l),u.subtreeFlags=0,l=m,m=u.child;m!==null;)Df(m,l),m=m.sibling;return ae(Zn,Zn.current&1|2),Jn&&Bl(u,y.treeForkCount),u.child}l=l.sibling}y.tail!==null&&H()>Fr&&(u.flags|=128,M=!0,Gl(y,!1),u.lanes=4194304)}else{if(!M)if(l=qa(I),l!==null){if(u.flags|=128,M=!0,l=l.updateQueue,u.updateQueue=l,Cc(u,l),Gl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!I.alternate&&!Jn)return Li(u),null}else 2*H()-y.renderingStartTime>Fr&&m!==536870912&&(u.flags|=128,M=!0,Gl(y,!1),u.lanes=4194304);y.isBackwards?(I.sibling=u.child,u.child=I):(l=y.last,l!==null?l.sibling=I:u.child=I,y.last=I)}return y.tail!==null?(l=y.tail,y.rendering=l,y.tail=l.sibling,y.renderingStartTime=H(),l.sibling=null,m=Zn.current,ae(Zn,M?m&1|2:m&1),Jn&&Bl(u,y.treeForkCount),l):(Li(u),null);case 22:case 23:return Lr(u),xp(),y=u.memoizedState!==null,l!==null?l.memoizedState!==null!==y&&(u.flags|=8192):y&&(u.flags|=8192),y?(m&536870912)!==0&&(u.flags&128)===0&&(Li(u),u.subtreeFlags&6&&(u.flags|=8192)):Li(u),m=u.updateQueue,m!==null&&Cc(u,m.retryQueue),m=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==m&&(u.flags|=2048),l!==null&&$(Au),null;case 24:return m=null,l!==null&&(m=l.memoizedState.cache),u.memoizedState.cache!==m&&(u.flags|=2048),Fl(Yr),Li(u),null;case 25:return null;case 30:return null}throw Error(i(156,u.tag))}function _o(l,u){switch(wg(u),u.tag){case 1:return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return Fl(Yr),Pe(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 26:case 27:case 5:return ot(u),null;case 31:if(u.memoizedState!==null){if(Lr(u),u.alternate===null)throw Error(i(340));pu()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 13:if(Lr(u),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(i(340));pu()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return $(Zn),null;case 4:return Pe(),null;case 10:return Fl(u.type),null;case 22:case 23:return Lr(u),xp(),l!==null&&$(Au),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 24:return Fl(Yr),null;case 25:return null;default:return null}}function Xa(l,u){switch(wg(u),u.tag){case 3:Fl(Yr),Pe();break;case 26:case 27:case 5:ot(u);break;case 4:Pe();break;case 31:u.memoizedState!==null&&Lr(u);break;case 13:Lr(u);break;case 19:$(Zn);break;case 10:Fl(u.type);break;case 22:case 23:Lr(u),xp(),l!==null&&$(Au);break;case 24:Fl(Yr)}}function So(l,u){try{var m=u.updateQueue,y=m!==null?m.lastEffect:null;if(y!==null){var M=y.next;m=M;do{if((m.tag&l)===l){y=void 0;var I=m.create,G=m.inst;y=I(),G.destroy=y}m=m.next}while(m!==M)}}catch(ie){fi(u,u.return,ie)}}function Ts(l,u,m){try{var y=u.updateQueue,M=y!==null?y.lastEffect:null;if(M!==null){var I=M.next;y=I;do{if((y.tag&l)===l){var G=y.inst,ie=G.destroy;if(ie!==void 0){G.destroy=void 0,M=u;var Ae=m,Oe=ie;try{Oe()}catch(lt){fi(M,Ae,lt)}}}y=y.next}while(y!==I)}}catch(lt){fi(u,u.return,lt)}}function qo(l){var u=l.updateQueue;if(u!==null){var m=l.stateNode;try{$x(u,m)}catch(y){fi(l,l.return,y)}}}function vs(l,u,m){m.props=_u(l.type,l.memoizedProps),m.state=l.memoizedState;try{m.componentWillUnmount()}catch(y){fi(l,u,y)}}function Tc(l,u){try{var m=l.ref;if(m!==null){switch(l.tag){case 26:case 27:case 5:var y=l.stateNode;break;case 30:y=l.stateNode;break;default:y=l.stateNode}typeof m=="function"?l.refCleanup=m(y):m.current=y}}catch(M){fi(l,u,M)}}function Is(l,u){var m=l.ref,y=l.refCleanup;if(m!==null)if(typeof y=="function")try{y()}catch(M){fi(l,u,M)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(M){fi(l,u,M)}else m.current=null}function Rp(l){var u=l.type,m=l.memoizedProps,y=l.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":m.autoFocus&&y.focus();break e;case"img":m.src?y.src=m.src:m.srcSet&&(y.srcset=m.srcSet)}}catch(M){fi(l,l.return,M)}}function ss(l,u,m){try{var y=l.stateNode;VH(y,l.type,m,u),y[Y]=u}catch(M){fi(l,l.return,M)}}function ir(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&id(l.type)||l.tag===4}function Xn(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||ir(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&id(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Hl(l,u,m){var y=l.tag;if(y===5||y===6)l=l.stateNode,u?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(l,u):(u=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,u.appendChild(l),m=m._reactRootContainer,m!=null||u.onclick!==null||(u.onclick=Gs));else if(y!==4&&(y===27&&id(l.type)&&(m=l.stateNode,u=null),l=l.child,l!==null))for(Hl(l,u,m),l=l.sibling;l!==null;)Hl(l,u,m),l=l.sibling}function ha(l,u,m){var y=l.tag;if(y===5||y===6)l=l.stateNode,u?m.insertBefore(l,u):m.appendChild(l);else if(y!==4&&(y===27&&id(l.type)&&(m=l.stateNode),l=l.child,l!==null))for(ha(l,u,m),l=l.sibling;l!==null;)ha(l,u,m),l=l.sibling}function nA(l){var u=l.stateNode,m=l.memoizedProps;try{for(var y=l.type,M=u.attributes;M.length;)u.removeAttributeNode(M[0]);ma(u,y,m),u[hi]=l,u[Y]=m}catch(I){fi(l,l.return,I)}}var Eo=!1,Vi=!1,Xo=!1,k_=typeof WeakSet=="function"?WeakSet:Set,ys=null;function $C(l,u){if(l=l.containerInfo,i3=Y_,l=Gx(l),Hv(l)){if("selectionStart"in l)var m={start:l.selectionStart,end:l.selectionEnd};else e:{m=(m=l.ownerDocument)&&m.defaultView||window;var y=m.getSelection&&m.getSelection();if(y&&y.rangeCount!==0){m=y.anchorNode;var M=y.anchorOffset,I=y.focusNode;y=y.focusOffset;try{m.nodeType,I.nodeType}catch{m=null;break e}var G=0,ie=-1,Ae=-1,Oe=0,lt=0,mt=l,Ge=null;t:for(;;){for(var $e;mt!==m||M!==0&&mt.nodeType!==3||(ie=G+M),mt!==I||y!==0&&mt.nodeType!==3||(Ae=G+y),mt.nodeType===3&&(G+=mt.nodeValue.length),($e=mt.firstChild)!==null;)Ge=mt,mt=$e;for(;;){if(mt===l)break t;if(Ge===m&&++Oe===M&&(ie=G),Ge===I&&++lt===y&&(Ae=G),($e=mt.nextSibling)!==null)break;mt=Ge,Ge=mt.parentNode}mt=$e}m=ie===-1||Ae===-1?null:{start:ie,end:Ae}}else m=null}m=m||{start:0,end:0}}else m=null;for(r3={focusedElem:l,selectionRange:m},Y_=!1,ys=u;ys!==null;)if(u=ys,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,ys=l;else for(;ys!==null;){switch(u=ys,I=u.alternate,l=u.flags,u.tag){case 0:if((l&4)!==0&&(l=u.updateQueue,l=l!==null?l.events:null,l!==null))for(m=0;m<l.length;m++)M=l[m],M.ref.impl=M.nextImpl;break;case 11:case 15:break;case 1:if((l&1024)!==0&&I!==null){l=void 0,m=u,M=I.memoizedProps,I=I.memoizedState,y=m.stateNode;try{var Jt=_u(m.type,M);l=y.getSnapshotBeforeUpdate(Jt,I),y.__reactInternalSnapshotBeforeUpdate=l}catch(bn){fi(m,m.return,bn)}}break;case 3:if((l&1024)!==0){if(l=u.stateNode.containerInfo,m=l.nodeType,m===9)o3(l);else if(m===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":o3(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(i(163))}if(l=u.sibling,l!==null){l.return=u.return,ys=l;break}ys=u.return}}function rr(l,u,m){var y=m.flags;switch(m.tag){case 0:case 11:case 15:Co(l,m),y&4&&So(5,m);break;case 1:if(Co(l,m),y&4)if(l=m.stateNode,u===null)try{l.componentDidMount()}catch(G){fi(m,m.return,G)}else{var M=_u(m.type,u.memoizedProps);u=u.memoizedState;try{l.componentDidUpdate(M,u,l.__reactInternalSnapshotBeforeUpdate)}catch(G){fi(m,m.return,G)}}y&64&&qo(m),y&512&&Tc(m,m.return);break;case 3:if(Co(l,m),y&64&&(l=m.updateQueue,l!==null)){if(u=null,m.child!==null)switch(m.child.tag){case 27:case 5:u=m.child.stateNode;break;case 1:u=m.child.stateNode}try{$x(l,u)}catch(G){fi(m,m.return,G)}}break;case 27:u===null&&y&4&&nA(m);case 26:case 5:Co(l,m),u===null&&y&4&&Rp(m),y&512&&Tc(m,m.return);break;case 12:Co(l,m);break;case 31:Co(l,m),y&4&&Su(l,m);break;case 13:Co(l,m),y&4&&Xf(l,m),y&64&&(l=m.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(m=b.bind(null,m),JH(l,m))));break;case 22:if(y=m.memoizedState!==null||Eo,!y){u=u!==null&&u.memoizedState!==null||Vi,M=Eo;var I=Vi;Eo=y,(Vi=u)&&!I?fa(l,m,(m.subtreeFlags&8772)!==0):Co(l,m),Eo=M,Vi=I}break;case 30:break;default:Co(l,m)}}function Bp(l){var u=l.alternate;u!==null&&(l.alternate=null,Bp(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&At(u)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var Ei=null,Ws=!1;function wo(l,u,m){for(m=m.child;m!==null;)iA(l,u,m),m=m.sibling}function iA(l,u,m){if(Ve&&typeof Ve.onCommitFiberUnmount=="function")try{Ve.onCommitFiberUnmount(Qe,m)}catch{}switch(m.tag){case 26:Vi||Is(m,u),wo(l,u,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:Vi||Is(m,u);var y=Ei,M=Ws;id(m.type)&&(Ei=m.stateNode,Ws=!1),wo(l,u,m),zy(m.stateNode),Ei=y,Ws=M;break;case 5:Vi||Is(m,u);case 6:if(y=Ei,M=Ws,Ei=null,wo(l,u,m),Ei=y,Ws=M,Ei!==null)if(Ws)try{(Ei.nodeType===9?Ei.body:Ei.nodeName==="HTML"?Ei.ownerDocument.body:Ei).removeChild(m.stateNode)}catch(I){fi(m,u,I)}else try{Ei.removeChild(m.stateNode)}catch(I){fi(m,u,I)}break;case 18:Ei!==null&&(Ws?(l=Ei,bD(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,m.stateNode),hA(l)):bD(Ei,m.stateNode));break;case 4:y=Ei,M=Ws,Ei=m.stateNode.containerInfo,Ws=!0,wo(l,u,m),Ei=y,Ws=M;break;case 0:case 11:case 14:case 15:Ts(2,m,u),Vi||Ts(4,m,u),wo(l,u,m);break;case 1:Vi||(Is(m,u),y=m.stateNode,typeof y.componentWillUnmount=="function"&&vs(m,u,y)),wo(l,u,m);break;case 21:wo(l,u,m);break;case 22:Vi=(y=Vi)||m.memoizedState!==null,wo(l,u,m),Vi=y;break;default:wo(l,u,m)}}function Su(l,u){if(u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{hA(l)}catch(m){fi(u,u.return,m)}}}function Xf(l,u){if(u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{hA(l)}catch(m){fi(u,u.return,m)}}function Ny(l){switch(l.tag){case 31:case 13:case 19:var u=l.stateNode;return u===null&&(u=l.stateNode=new k_),u;case 22:return l=l.stateNode,u=l._retryCache,u===null&&(u=l._retryCache=new k_),u;default:throw Error(i(435,l.tag))}}function Ic(l,u){var m=Ny(l);u.forEach(function(y){if(!m.has(y)){m.add(y);var M=w.bind(null,l,y);y.then(M,M)}})}function as(l,u){var m=u.deletions;if(m!==null)for(var y=0;y<m.length;y++){var M=m[y],I=l,G=u,ie=G;e:for(;ie!==null;){switch(ie.tag){case 27:if(id(ie.type)){Ei=ie.stateNode,Ws=!1;break e}break;case 5:Ei=ie.stateNode,Ws=!1;break e;case 3:case 4:Ei=ie.stateNode.containerInfo,Ws=!0;break e}ie=ie.return}if(Ei===null)throw Error(i(160));iA(I,G,M),Ei=null,Ws=!1,I=M.alternate,I!==null&&(I.return=null),M.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)Eu(u,l),u=u.sibling}var Mo=null;function Eu(l,u){var m=l.alternate,y=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:as(u,l),os(l),y&4&&(Ts(3,l,l.return),So(3,l),Ts(5,l,l.return));break;case 1:as(u,l),os(l),y&512&&(Vi||m===null||Is(m,m.return)),y&64&&Eo&&(l=l.updateQueue,l!==null&&(y=l.callbacks,y!==null&&(m=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=m===null?y:m.concat(y))));break;case 26:var M=Mo;if(as(u,l),os(l),y&512&&(Vi||m===null||Is(m,m.return)),y&4){var I=m!==null?m.memoizedState:null;if(y=l.memoizedState,m===null)if(y===null)if(l.stateNode===null){e:{y=l.type,m=l.memoizedProps,M=M.ownerDocument||M;t:switch(y){case"title":I=M.getElementsByTagName("title")[0],(!I||I[xt]||I[hi]||I.namespaceURI==="http://www.w3.org/2000/svg"||I.hasAttribute("itemprop"))&&(I=M.createElement(y),M.head.insertBefore(I,M.querySelector("head > title"))),ma(I,y,m),I[hi]=l,J(I),y=I;break e;case"link":var G=BD("link","href",M).get(y+(m.href||""));if(G){for(var ie=0;ie<G.length;ie++)if(I=G[ie],I.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&I.getAttribute("rel")===(m.rel==null?null:m.rel)&&I.getAttribute("title")===(m.title==null?null:m.title)&&I.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){G.splice(ie,1);break t}}I=M.createElement(y),ma(I,y,m),M.head.appendChild(I);break;case"meta":if(G=BD("meta","content",M).get(y+(m.content||""))){for(ie=0;ie<G.length;ie++)if(I=G[ie],I.getAttribute("content")===(m.content==null?null:""+m.content)&&I.getAttribute("name")===(m.name==null?null:m.name)&&I.getAttribute("property")===(m.property==null?null:m.property)&&I.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&I.getAttribute("charset")===(m.charSet==null?null:m.charSet)){G.splice(ie,1);break t}}I=M.createElement(y),ma(I,y,m),M.head.appendChild(I);break;default:throw Error(i(468,y))}I[hi]=l,J(I),y=I}l.stateNode=y}else DD(M,l.type,l.stateNode);else l.stateNode=RD(M,y,l.memoizedProps);else I!==y?(I===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):I.count--,y===null?DD(M,l.type,l.stateNode):RD(M,y,l.memoizedProps)):y===null&&l.stateNode!==null&&ss(l,l.memoizedProps,m.memoizedProps)}break;case 27:as(u,l),os(l),y&512&&(Vi||m===null||Is(m,m.return)),m!==null&&y&4&&ss(l,l.memoizedProps,m.memoizedProps);break;case 5:if(as(u,l),os(l),y&512&&(Vi||m===null||Is(m,m.return)),l.flags&32){M=l.stateNode;try{Zi(M,"")}catch(Jt){fi(l,l.return,Jt)}}y&4&&l.stateNode!=null&&(M=l.memoizedProps,ss(l,M,m!==null?m.memoizedProps:M)),y&1024&&(Xo=!0);break;case 6:if(as(u,l),os(l),y&4){if(l.stateNode===null)throw Error(i(162));y=l.memoizedProps,m=l.stateNode;try{m.nodeValue=y}catch(Jt){fi(l,l.return,Jt)}}break;case 3:if(j_=null,M=Mo,Mo=Q_(u.containerInfo),as(u,l),Mo=M,os(l),y&4&&m!==null&&m.memoizedState.isDehydrated)try{hA(u.containerInfo)}catch(Jt){fi(l,l.return,Jt)}Xo&&(Xo=!1,rA(l));break;case 4:y=Mo,Mo=Q_(l.stateNode.containerInfo),as(u,l),os(l),Mo=y;break;case 12:as(u,l),os(l);break;case 31:as(u,l),os(l),y&4&&(y=l.updateQueue,y!==null&&(l.updateQueue=null,Ic(l,y)));break;case 13:as(u,l),os(l),l.child.flags&8192&&l.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(Yf=H()),y&4&&(y=l.updateQueue,y!==null&&(l.updateQueue=null,Ic(l,y)));break;case 22:M=l.memoizedState!==null;var Ae=m!==null&&m.memoizedState!==null,Oe=Eo,lt=Vi;if(Eo=Oe||M,Vi=lt||Ae,as(u,l),Vi=lt,Eo=Oe,os(l),y&8192)e:for(u=l.stateNode,u._visibility=M?u._visibility&-2:u._visibility|1,M&&(m===null||Ae||Eo||Vi||Ql(l)),m=null,u=l;;){if(u.tag===5||u.tag===26){if(m===null){Ae=m=u;try{if(I=Ae.stateNode,M)G=I.style,typeof G.setProperty=="function"?G.setProperty("display","none","important"):G.display="none";else{ie=Ae.stateNode;var mt=Ae.memoizedProps.style,Ge=mt!=null&&mt.hasOwnProperty("display")?mt.display:null;ie.style.display=Ge==null||typeof Ge=="boolean"?"":(""+Ge).trim()}}catch(Jt){fi(Ae,Ae.return,Jt)}}}else if(u.tag===6){if(m===null){Ae=u;try{Ae.stateNode.nodeValue=M?"":Ae.memoizedProps}catch(Jt){fi(Ae,Ae.return,Jt)}}}else if(u.tag===18){if(m===null){Ae=u;try{var $e=Ae.stateNode;M?xD($e,!0):xD(Ae.stateNode,!1)}catch(Jt){fi(Ae,Ae.return,Jt)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===l)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break e;for(;u.sibling===null;){if(u.return===null||u.return===l)break e;m===u&&(m=null),u=u.return}m===u&&(m=null),u.sibling.return=u.return,u=u.sibling}y&4&&(y=l.updateQueue,y!==null&&(m=y.retryQueue,m!==null&&(y.retryQueue=null,Ic(l,m))));break;case 19:as(u,l),os(l),y&4&&(y=l.updateQueue,y!==null&&(l.updateQueue=null,Ic(l,y)));break;case 30:break;case 21:break;default:as(u,l),os(l)}}function os(l){var u=l.flags;if(u&2){try{for(var m,y=l.return;y!==null;){if(ir(y)){m=y;break}y=y.return}if(m==null)throw Error(i(160));switch(m.tag){case 27:var M=m.stateNode,I=Xn(l);ha(l,I,M);break;case 5:var G=m.stateNode;m.flags&32&&(Zi(G,""),m.flags&=-33);var ie=Xn(l);ha(l,ie,G);break;case 3:case 4:var Ae=m.stateNode.containerInfo,Oe=Xn(l);Hl(l,Oe,Ae);break;default:throw Error(i(161))}}catch(lt){fi(l,l.return,lt)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function rA(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var u=l;rA(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),l=l.sibling}}function Co(l,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)rr(l,u.alternate,u),u=u.sibling}function Ql(l){for(l=l.child;l!==null;){var u=l;switch(u.tag){case 0:case 11:case 14:case 15:Ts(4,u,u.return),Ql(u);break;case 1:Is(u,u.return);var m=u.stateNode;typeof m.componentWillUnmount=="function"&&vs(u,u.return,m),Ql(u);break;case 27:zy(u.stateNode);case 26:case 5:Is(u,u.return),Ql(u);break;case 22:u.memoizedState===null&&Ql(u);break;case 30:Ql(u);break;default:Ql(u)}l=l.sibling}}function fa(l,u,m){for(m=m&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var y=u.alternate,M=l,I=u,G=I.flags;switch(I.tag){case 0:case 11:case 15:fa(M,I,m),So(4,I);break;case 1:if(fa(M,I,m),y=I,M=y.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(Oe){fi(y,y.return,Oe)}if(y=I,M=y.updateQueue,M!==null){var ie=y.stateNode;try{var Ae=M.shared.hiddenCallbacks;if(Ae!==null)for(M.shared.hiddenCallbacks=null,M=0;M<Ae.length;M++)Hf(Ae[M],ie)}catch(Oe){fi(y,y.return,Oe)}}m&&G&64&&qo(I),Tc(I,I.return);break;case 27:nA(I);case 26:case 5:fa(M,I,m),m&&y===null&&G&4&&Rp(I),Tc(I,I.return);break;case 12:fa(M,I,m);break;case 31:fa(M,I,m),m&&G&4&&Su(M,I);break;case 13:fa(M,I,m),m&&G&4&&Xf(M,I);break;case 22:I.memoizedState===null&&fa(M,I,m),Tc(I,I.return);break;case 30:break;default:fa(M,I,m)}u=u.sibling}}function wu(l,u){var m=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),l=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(l=u.memoizedState.cachePool.pool),l!==m&&(l!=null&&l.refCount++,m!=null&&bh(m))}function Nh(l,u){l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&bh(l))}function Rs(l,u,m,y){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Uy(l,u,m,y),u=u.sibling}function Uy(l,u,m,y){var M=u.flags;switch(u.tag){case 0:case 11:case 15:Rs(l,u,m,y),M&2048&&So(9,u);break;case 1:Rs(l,u,m,y);break;case 3:Rs(l,u,m,y),M&2048&&(l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&bh(l)));break;case 12:if(M&2048){Rs(l,u,m,y),l=u.stateNode;try{var I=u.memoizedProps,G=I.id,ie=I.onPostCommit;typeof ie=="function"&&ie(G,u.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(Ae){fi(u,u.return,Ae)}}else Rs(l,u,m,y);break;case 31:Rs(l,u,m,y);break;case 13:Rs(l,u,m,y);break;case 23:break;case 22:I=u.stateNode,G=u.alternate,u.memoizedState!==null?I._visibility&2?Rs(l,u,m,y):Vl(l,u):I._visibility&2?Rs(l,u,m,y):(I._visibility|=2,Bs(l,u,m,y,(u.subtreeFlags&10256)!==0||!1)),M&2048&&wu(G,u);break;case 24:Rs(l,u,m,y),M&2048&&Nh(u.alternate,u);break;default:Rs(l,u,m,y)}}function Bs(l,u,m,y,M){for(M=M&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var I=l,G=u,ie=m,Ae=y,Oe=G.flags;switch(G.tag){case 0:case 11:case 15:Bs(I,G,ie,Ae,M),So(8,G);break;case 23:break;case 22:var lt=G.stateNode;G.memoizedState!==null?lt._visibility&2?Bs(I,G,ie,Ae,M):Vl(I,G):(lt._visibility|=2,Bs(I,G,ie,Ae,M)),M&&Oe&2048&&wu(G.alternate,G);break;case 24:Bs(I,G,ie,Ae,M),M&&Oe&2048&&Nh(G.alternate,G);break;default:Bs(I,G,ie,Ae,M)}u=u.sibling}}function Vl(l,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var m=l,y=u,M=y.flags;switch(y.tag){case 22:Vl(m,y),M&2048&&wu(y.alternate,y);break;case 24:Vl(m,y),M&2048&&Nh(y.alternate,y);break;default:Vl(m,y)}u=u.sibling}}var Uh=8192;function Ya(l,u,m){if(l.subtreeFlags&Uh)for(l=l.child;l!==null;)sA(l,u,m),l=l.sibling}function sA(l,u,m){switch(l.tag){case 26:Ya(l,u,m),l.flags&Uh&&l.memoizedState!==null&&uQ(m,Mo,l.memoizedState,l.memoizedProps);break;case 5:Ya(l,u,m);break;case 3:case 4:var y=Mo;Mo=Q_(l.stateNode.containerInfo),Ya(l,u,m),Mo=y;break;case 22:l.memoizedState===null&&(y=l.alternate,y!==null&&y.memoizedState!==null?(y=Uh,Uh=16777216,Ya(l,u,m),Uh=y):Ya(l,u,m));break;default:Ya(l,u,m)}}function Fh(l){var u=l.alternate;if(u!==null&&(l=u.child,l!==null)){u.child=null;do u=l.sibling,l.sibling=null,l=u;while(l!==null)}}function Mu(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var y=u[m];ys=y,xr(y,l)}Fh(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Ia(l),l=l.sibling}function Ia(l){switch(l.tag){case 0:case 11:case 15:Mu(l),l.flags&2048&&Ts(9,l,l.return);break;case 3:Mu(l);break;case 12:Mu(l);break;case 22:var u=l.stateNode;l.memoizedState!==null&&u._visibility&2&&(l.return===null||l.return.tag!==13)?(u._visibility&=-3,Ra(l)):Mu(l);break;default:Mu(l)}}function Ra(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var y=u[m];ys=y,xr(y,l)}Fh(l)}for(l=l.child;l!==null;){switch(u=l,u.tag){case 0:case 11:case 15:Ts(8,u,u.return),Ra(u);break;case 22:m=u.stateNode,m._visibility&2&&(m._visibility&=-3,Ra(u));break;default:Ra(u)}l=l.sibling}}function xr(l,u){for(;ys!==null;){var m=ys;switch(m.tag){case 0:case 11:case 15:Ts(8,m,u);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var y=m.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:bh(m.memoizedState.cache)}if(y=m.child,y!==null)y.return=m,ys=y;else e:for(m=l;ys!==null;){y=ys;var M=y.sibling,I=y.return;if(Bp(y),y===m){ys=null;break e}if(M!==null){M.return=I,ys=M;break e}ys=I}}}var Rc={getCacheForType:function(l){var u=En(Yr),m=u.data.get(l);return m===void 0&&(m=l(),u.data.set(l,m)),m},cacheSignal:function(){return En(Yr).controller.signal}},Ln=typeof WeakMap=="function"?WeakMap:Map,an=0,Cn=null,Pn=null,Un=0,ii=0,qs=null,To=!1,Yo=!1,Fy=!1,Ka=0,hr=0,jl=0,Cu=0,Dp=0,da=0,Yi=0,Ph=null,_r=null,Sr=!1,Yf=0,Py=0,Fr=1/0,fr=null,Pr=null,wi=0,$a=null,Kf=null,Io=0,$f=0,Jf=null,Lp=null,Tu=0,Oh=null;function Ja(){return(an&2)!==0&&Un!==0?Un&-Un:Q.T!==null?We():Rr()}function Qn(){if(da===0)if((Un&536870912)===0||Jn){var l=rt;rt<<=1,(rt&3932160)===0&&(rt=262144),da=l}else da=536870912;return l=wa.current,l!==null&&(l.flags|=32),da}function On(l,u,m){(l===Cn&&(ii===2||ii===9)||l.cancelPendingCommit!==null)&&(Ru(l,0),$r(l,Un,da,!1)),ti(l,m),((an&2)===0||l!==Cn)&&(l===Cn&&((an&2)===0&&(Cu|=m),hr===4&&$r(l,Un,da,!1)),Et(l))}function Vn(l,u,m){if((an&6)!==0)throw Error(i(327));var y=!m&&(u&127)===0&&(u&l.expiredLanes)===0||gt(l,u),M=y?Np(l,u):pa(l,u,!0),I=y;do{if(M===0){Yo&&!y&&$r(l,u,0,!1);break}else{if(m=l.current.alternate,I&&!Mi(m)){M=pa(l,u,!1),I=!1;continue}if(M===2){if(I=u,l.errorRecoveryDisabledLanes&I)var G=0;else G=l.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){u=G;e:{var ie=l;M=Ph;var Ae=ie.current.memoizedState.isDehydrated;if(Ae&&(Ru(ie,G).flags|=256),G=pa(ie,G,!1),G!==2){if(Fy&&!Ae){ie.errorRecoveryDisabledLanes|=I,Cu|=I,M=4;break e}I=_r,_r=M,I!==null&&(_r===null?_r=I:_r.push.apply(_r,I))}M=G}if(I=!1,M!==2)continue}}if(M===1){Ru(l,0),$r(l,u,0,!0);break}e:{switch(y=l,I=M,I){case 0:case 1:throw Error(i(345));case 4:if((u&4194048)!==u)break;case 6:$r(y,u,da,!To);break e;case 2:_r=null;break;case 3:case 5:break;default:throw Error(i(329))}if((u&62914560)===u&&(M=Yf+300-H(),10<M)){if($r(y,u,da,!To),ke(y,0,!0)!==0)break e;Io=u,y.timeoutHandle=vD(Yn.bind(null,y,m,_r,fr,Sr,u,da,Cu,Yi,To,I,"Throttled",-0,0),M);break e}Yn(y,m,_r,fr,Sr,u,da,Cu,Yi,To,I,null,-0,0)}}break}while(!0);Et(l)}function Yn(l,u,m,y,M,I,G,ie,Ae,Oe,lt,mt,Ge,$e){if(l.timeoutHandle=-1,mt=u.subtreeFlags,mt&8192||(mt&16785408)===16785408){mt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gs},sA(u,I,mt);var Jt=(I&62914560)===I?Yf-H():(I&4194048)===I?Py-H():0;if(Jt=hQ(mt,Jt),Jt!==null){Io=I,l.cancelPendingCommit=Jt(Dc.bind(null,l,u,I,m,y,M,G,ie,Ae,lt,mt,null,Ge,$e)),$r(l,I,G,!Oe);return}}Dc(l,u,I,m,y,M,G,ie,Ae)}function Mi(l){for(var u=l;;){var m=u.tag;if((m===0||m===11||m===15)&&u.flags&16384&&(m=u.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var y=0;y<m.length;y++){var M=m[y],I=M.getSnapshot;M=M.value;try{if(!oa(I(),M))return!1}catch{return!1}}if(m=u.child,u.subtreeFlags&16384&&m!==null)m.return=u,u=m;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function $r(l,u,m,y){u&=~Dp,u&=~Cu,l.suspendedLanes|=u,l.pingedLanes&=~u,y&&(l.warmLanes|=u),y=l.expirationTimes;for(var M=u;0<M;){var I=31-bt(M),G=1<<I;y[I]=-1,M&=~G}m!==0&&vi(l,m,u)}function Ko(){return(an&6)===0?(Xt(0),!1):!0}function Iu(){if(Pn!==null){if(ii===0)var l=Pn.return;else l=Pn,Ul=mu=null,ay(l),wh=null,Mh=0,l=Pn;for(;l!==null;)Xa(l.alternate,l),l=l.return;Pn=null}}function Ru(l,u){var m=l.timeoutHandle;m!==-1&&(l.timeoutHandle=-1,qH(m)),m=l.cancelPendingCommit,m!==null&&(l.cancelPendingCommit=null,m()),Io=0,Iu(),Cn=l,Pn=m=_a(l.current,null),Un=u,ii=0,qs=null,To=!1,Yo=gt(l,u),Fy=!1,Yi=da=Dp=Cu=jl=hr=0,_r=Ph=null,Sr=!1,(u&8)!==0&&(u|=u&32);var y=l.entangledLanes;if(y!==0)for(l=l.entanglements,y&=u;0<y;){var M=31-bt(y),I=1<<M;u|=l[M],y&=~I}return Ka=u,dp(),m}function Wl(l,u){Dn=null,Q.H=Wf,u===xh||u===Fn?(u=Sh(),ii=3):u===Ap?(u=Sh(),ii=4):ii=u===qg?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,qs=u,Pn===null&&(hr=1,Wg(l,Va(u,l.current)))}function dr(){var l=wa.current;return l===null?!0:(Un&4194048)===Un?ua===null:(Un&62914560)===Un||(Un&536870912)!==0?l===ua:!1}function Bc(){var l=Q.H;return Q.H=Wf,l===null?Wf:l}function Bu(){var l=Q.A;return Q.A=Rc,l}function Zf(){hr=4,To||(Un&4194048)!==Un&&wa.current!==null||(Yo=!0),(jl&134217727)===0&&(Cu&134217727)===0||Cn===null||$r(Cn,Un,da,!1)}function pa(l,u,m){var y=an;an|=2;var M=Bc(),I=Bu();(Cn!==l||Un!==u)&&(fr=null,Ru(l,u)),u=!1;var G=hr;e:do try{if(ii!==0&&Pn!==null){var ie=Pn,Ae=qs;switch(ii){case 8:Iu(),G=6;break e;case 3:case 2:case 9:case 6:wa.current===null&&(u=!0);var Oe=ii;if(ii=0,qs=null,kh(l,ie,Ae,Oe),m&&Yo){G=0;break e}break;default:Oe=ii,ii=0,qs=null,kh(l,ie,Ae,Oe)}}ed(),G=hr;break}catch(lt){Wl(l,lt)}while(!0);return u&&l.shellSuspendCounter++,Ul=mu=null,an=y,Q.H=M,Q.A=I,Pn===null&&(Cn=null,Un=0,dp()),G}function ed(){for(;Pn!==null;)aA(Pn)}function Np(l,u){var m=an;an|=2;var y=Bc(),M=Bu();Cn!==l||Un!==u?(fr=null,Fr=H()+500,Ru(l,u)):Yo=gt(l,u);e:do try{if(ii!==0&&Pn!==null){u=Pn;var I=qs;t:switch(ii){case 1:ii=0,qs=null,kh(l,u,I,1);break;case 2:case 9:if(Ea(I)){ii=0,qs=null,Up(u);break}u=function(){ii!==2&&ii!==9||Cn!==l||(ii=7),Et(l)},I.then(u,u);break e;case 3:ii=7;break e;case 4:ii=5;break e;case 7:Ea(I)?(ii=0,qs=null,Up(u)):(ii=0,qs=null,kh(l,u,I,7));break;case 5:var G=null;switch(Pn.tag){case 26:G=Pn.memoizedState;case 5:case 27:var ie=Pn;if(G?LD(G):ie.stateNode.complete){ii=0,qs=null;var Ae=ie.sibling;if(Ae!==null)Pn=Ae;else{var Oe=ie.return;Oe!==null?(Pn=Oe,Du(Oe)):Pn=null}break t}}ii=0,qs=null,kh(l,u,I,5);break;case 6:ii=0,qs=null,kh(l,u,I,6);break;case 8:Iu(),hr=6;break e;default:throw Error(i(462))}}Ba();break}catch(lt){Wl(l,lt)}while(!0);return Ul=mu=null,Q.H=y,Q.A=M,an=m,Pn!==null?0:(Cn=null,Un=0,dp(),hr)}function Ba(){for(;Pn!==null&&!tt();)aA(Pn)}function aA(l){var u=tA(l.alternate,l,Ka);l.memoizedProps=l.pendingProps,u===null?Du(l):Pn=u}function Up(l){var u=l,m=u.alternate;switch(u.tag){case 15:case 0:u=Mp(m,u,u.pendingProps,u.type,void 0,Un);break;case 11:u=Mp(m,u,u.pendingProps,u.type.render,u.ref,Un);break;case 5:ay(u);default:Xa(m,u),u=Pn=Df(u,Ka),u=tA(m,u,Ka)}l.memoizedProps=l.pendingProps,u===null?Du(l):Pn=u}function kh(l,u,m,y){Ul=mu=null,ay(u),wh=null,Mh=0;var M=u.return;try{if(rs(l,M,u,m,Un)){hr=1,Wg(l,Va(m,l.current)),Pn=null;return}}catch(I){if(M!==null)throw Pn=M,I;hr=1,Wg(l,Va(m,l.current)),Pn=null;return}u.flags&32768?(Jn||y===1?l=!0:Yo||(Un&536870912)!==0?l=!1:(To=l=!0,(y===2||y===9||y===3||y===6)&&(y=wa.current,y!==null&&y.tag===13&&(y.flags|=16384))),Fp(u,l)):Du(u)}function Du(l){var u=l;do{if((u.flags&32768)!==0){Fp(u,To);return}l=u.return;var m=Ip(u.alternate,u,Ka);if(m!==null){Pn=m;return}if(u=u.sibling,u!==null){Pn=u;return}Pn=u=l}while(u!==null);hr===0&&(hr=5)}function Fp(l,u){do{var m=_o(l.alternate,l);if(m!==null){m.flags&=32767,Pn=m;return}if(m=l.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!u&&(l=l.sibling,l!==null)){Pn=l;return}Pn=l=m}while(l!==null);hr=6,Pn=null}function Dc(l,u,m,y,M,I,G,ie,Ae){l.cancelPendingCommit=null;do td();while(wi!==0);if((an&6)!==0)throw Error(i(327));if(u!==null){if(u===l.current)throw Error(i(177));if(I=u.lanes|u.childLanes,I|=ms,ui(l,m,I,G,ie,Ae),l===Cn&&(Pn=Cn=null,Un=0),Kf=u,$a=l,Io=m,$f=I,Jf=M,Lp=y,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,N(we,function(){return oA(),null})):(l.callbackNode=null,l.callbackPriority=0),y=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||y){y=Q.T,Q.T=null,M=K.p,K.p=2,G=an,an|=4;try{$C(l,u,m)}finally{an=G,K.p=M,Q.T=y}}wi=1,Jr(),Lc(),zh()}}function Jr(){if(wi===1){wi=0;var l=$a,u=Kf,m=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||m){m=Q.T,Q.T=null;var y=K.p;K.p=2;var M=an;an|=4;try{Eu(u,l);var I=r3,G=Gx(l.containerInfo),ie=I.focusedElem,Ae=I.selectionRange;if(G!==ie&&ie&&ie.ownerDocument&&Hi(ie.ownerDocument.documentElement,ie)){if(Ae!==null&&Hv(ie)){var Oe=Ae.start,lt=Ae.end;if(lt===void 0&&(lt=Oe),"selectionStart"in ie)ie.selectionStart=Oe,ie.selectionEnd=Math.min(lt,ie.value.length);else{var mt=ie.ownerDocument||document,Ge=mt&&mt.defaultView||window;if(Ge.getSelection){var $e=Ge.getSelection(),Jt=ie.textContent.length,bn=Math.min(Ae.start,Jt),Wi=Ae.end===void 0?bn:Math.min(Ae.end,Jt);!$e.extend&&bn>Wi&&(G=Wi,Wi=bn,bn=G);var Ce=If(ie,bn),Ee=If(ie,Wi);if(Ce&&Ee&&($e.rangeCount!==1||$e.anchorNode!==Ce.node||$e.anchorOffset!==Ce.offset||$e.focusNode!==Ee.node||$e.focusOffset!==Ee.offset)){var Fe=mt.createRange();Fe.setStart(Ce.node,Ce.offset),$e.removeAllRanges(),bn>Wi?($e.addRange(Fe),$e.extend(Ee.node,Ee.offset)):(Fe.setEnd(Ee.node,Ee.offset),$e.addRange(Fe))}}}}for(mt=[],$e=ie;$e=$e.parentNode;)$e.nodeType===1&&mt.push({element:$e,left:$e.scrollLeft,top:$e.scrollTop});for(typeof ie.focus=="function"&&ie.focus(),ie=0;ie<mt.length;ie++){var dt=mt[ie];dt.element.scrollLeft=dt.left,dt.element.scrollTop=dt.top}}Y_=!!i3,r3=i3=null}finally{an=M,K.p=y,Q.T=m}}l.current=u,wi=2}}function Lc(){if(wi===2){wi=0;var l=$a,u=Kf,m=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||m){m=Q.T,Q.T=null;var y=K.p;K.p=2;var M=an;an|=4;try{rr(l,u.alternate,u)}finally{an=M,K.p=y,Q.T=m}}wi=3}}function zh(){if(wi===4||wi===3){wi=0,Z();var l=$a,u=Kf,m=Io,y=Lp;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?wi=5:(wi=0,Kf=$a=null,ql(l,l.pendingLanes));var M=l.pendingLanes;if(M===0&&(Pr=null),Ki(m),u=u.stateNode,Ve&&typeof Ve.onCommitFiberRoot=="function")try{Ve.onCommitFiberRoot(Qe,u,void 0,(u.current.flags&128)===128)}catch{}if(y!==null){u=Q.T,M=K.p,K.p=2,Q.T=null;try{for(var I=l.onRecoverableError,G=0;G<y.length;G++){var ie=y[G];I(ie.value,{componentStack:ie.stack})}}finally{Q.T=u,K.p=M}}(Io&3)!==0&&td(),Et(l),M=l.pendingLanes,(m&261930)!==0&&(M&42)!==0?l===Oh?Tu++:(Tu=0,Oh=l):Tu=0,Xt(0)}}function ql(l,u){(l.pooledCacheLanes&=u)===0&&(u=l.pooledCache,u!=null&&(l.pooledCache=null,bh(u)))}function td(){return Jr(),Lc(),zh(),oA()}function oA(){if(wi!==5)return!1;var l=$a,u=$f;$f=0;var m=Ki(Io),y=Q.T,M=K.p;try{K.p=32>m?32:m,Q.T=null,m=Jf,Jf=null;var I=$a,G=Io;if(wi=0,Kf=$a=null,Io=0,(an&6)!==0)throw Error(i(331));var ie=an;if(an|=4,Ia(I.current),Uy(I,I.current,G,m),an=ie,Xt(0,!1),Ve&&typeof Ve.onPostCommitFiberRoot=="function")try{Ve.onPostCommitFiberRoot(Qe,I)}catch{}return!0}finally{K.p=M,Q.T=y,ql(l,u)}}function Oy(l,u,m){u=Va(m,u),u=Ty(l.stateNode,u,2),l=vu(l,u,2),l!==null&&(ti(l,2),Et(l))}function fi(l,u,m){if(l.tag===3)Oy(l,l,m);else for(;u!==null;){if(u.tag===3){Oy(u,l,m);break}else if(u.tag===1){var y=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Pr===null||!Pr.has(y))){l=Va(m,l),m=Iy(2),y=vu(u,m,2),y!==null&&(N_(m,y,u,l),ti(y,2),Et(y));break}}u=u.return}}function Pp(l,u,m){var y=l.pingCache;if(y===null){y=l.pingCache=new Ln;var M=new Set;y.set(u,M)}else M=y.get(u),M===void 0&&(M=new Set,y.set(u,M));M.has(m)||(Fy=!0,M.add(m),l=f.bind(null,l,u,m),u.then(l,l))}function f(l,u,m){var y=l.pingCache;y!==null&&y.delete(u),l.pingedLanes|=l.suspendedLanes&m,l.warmLanes&=~m,Cn===l&&(Un&m)===m&&(hr===4||hr===3&&(Un&62914560)===Un&&300>H()-Yf?(an&2)===0&&Ru(l,0):Dp|=m,Yi===Un&&(Yi=0)),Et(l)}function d(l,u){u===0&&(u=kt()),l=la(l,u),l!==null&&(ti(l,u),Et(l))}function b(l){var u=l.memoizedState,m=0;u!==null&&(m=u.retryLane),d(l,m)}function w(l,u){var m=0;switch(l.tag){case 31:case 13:var y=l.stateNode,M=l.memoizedState;M!==null&&(m=M.retryLane);break;case 19:y=l.stateNode;break;case 22:y=l.stateNode._retryCache;break;default:throw Error(i(314))}y!==null&&y.delete(u),d(l,m)}function N(l,u){return qe(l,u)}var k=null,te=null,ye=!1,Ke=!1,vt=!1,Pt=0;function Et(l){l!==te&&l.next===null&&(te===null?k=te=l:te=te.next=l),Ke=!0,ye||(ye=!0,Re())}function Xt(l,u){if(!vt&&Ke){vt=!0;do for(var m=!1,y=k;y!==null;){if(l!==0){var M=y.pendingLanes;if(M===0)var I=0;else{var G=y.suspendedLanes,ie=y.pingedLanes;I=(1<<31-bt(42|l)+1)-1,I&=M&~(G&~ie),I=I&201326741?I&201326741|1:I?I|2:0}I!==0&&(m=!0,ze(y,I))}else I=Un,I=ke(y,y===Cn?I:0,y.cancelPendingCommit!==null||y.timeoutHandle!==-1),(I&3)===0||gt(y,I)||(m=!0,ze(y,I));y=y.next}while(m);vt=!1}}function Bn(){Or()}function Or(){Ke=ye=!1;var l=0;Pt!==0&&WH()&&(l=Pt);for(var u=H(),m=null,y=k;y!==null;){var M=y.next,I=nd(y,u);I===0?(y.next=null,m===null?k=M:m.next=M,M===null&&(te=m)):(m=y,(l!==0||(I&3)!==0)&&(Ke=!0)),y=M}wi!==0&&wi!==5||Xt(l),Pt!==0&&(Pt=0)}function nd(l,u){for(var m=l.suspendedLanes,y=l.pingedLanes,M=l.expirationTimes,I=l.pendingLanes&-62914561;0<I;){var G=31-bt(I),ie=1<<G,Ae=M[G];Ae===-1?((ie&m)===0||(ie&y)!==0)&&(M[G]=Qt(ie,u)):Ae<=u&&(l.expiredLanes|=ie),I&=~ie}if(u=Cn,m=Un,m=ke(l,l===u?m:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),y=l.callbackNode,m===0||l===u&&(ii===2||ii===9)||l.cancelPendingCommit!==null)return y!==null&&y!==null&&Ne(y),l.callbackNode=null,l.callbackPriority=0;if((m&3)===0||gt(l,m)){if(u=m&-m,u===l.callbackPriority)return u;switch(y!==null&&Ne(y),Ki(m)){case 2:case 8:m=Ie;break;case 32:m=we;break;case 268435456:m=it;break;default:m=we}return y=Lu.bind(null,l),m=qe(m,y),l.callbackPriority=u,l.callbackNode=m,u}return y!==null&&y!==null&&Ne(y),l.callbackPriority=2,l.callbackNode=null,2}function Lu(l,u){if(wi!==0&&wi!==5)return l.callbackNode=null,l.callbackPriority=0,null;var m=l.callbackNode;if(td()&&l.callbackNode!==m)return null;var y=Un;return y=ke(l,l===Cn?y:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),y===0?null:(Vn(l,y,u),nd(l,H()),l.callbackNode!=null&&l.callbackNode===m?Lu.bind(null,l):null)}function ze(l,u){if(td())return null;Vn(l,u,!0)}function Re(){XH(function(){(an&6)!==0?qe(De,Bn):Or()})}function We(){if(Pt===0){var l=_c;l===0&&(l=Me,Me<<=1,(Me&261888)===0&&(Me=256)),Pt=l}return Pt}function Nt(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:co(""+l)}function pn(l,u){var m=u.ownerDocument.createElement("input");return m.name=u.name,m.value=u.value,l.id&&m.setAttribute("form",l.id),u.parentNode.insertBefore(m,u),l=new FormData(l),m.parentNode.removeChild(m),l}function pr(l,u,m,y,M){if(u==="submit"&&m&&m.stateNode===M){var I=Nt((M[Y]||null).action),G=y.submitter;G&&(u=(u=G[Y]||null)?Nt(u.formAction):G.getAttribute("formAction"),u!==null&&(I=u,G=null));var ie=new gc("action","action",null,y,M);l.push({event:ie,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(Pt!==0){var Ae=G?pn(M,G):new FormData(M);by(m,{pending:!0,data:Ae,method:M.method,action:I},null,Ae)}}else typeof I=="function"&&(ie.preventDefault(),Ae=G?pn(M,G):new FormData(M),by(m,{pending:!0,data:Ae,method:M.method,action:I},I,Ae))},currentTarget:M}]})}}for(var gn=0;gn<hp.length;gn++){var oi=hp[gn],bs=oi.toLowerCase(),pi=oi[0].toUpperCase()+oi.slice(1);mo(bs,"on"+pi)}mo(bg,"onAnimationEnd"),mo(up,"onAnimationIteration"),mo(Vv,"onAnimationStart"),mo("dblclick","onDoubleClick"),mo("focusin","onFocus"),mo("focusout","onBlur"),mo(Qx,"onTransitionRun"),mo(QC,"onTransitionStart"),mo(Vx,"onTransitionCancel"),mo(jv,"onTransitionEnd"),be("onMouseEnter",["mouseout","mouseover"]),be("onMouseLeave",["mouseout","mouseover"]),be("onPointerEnter",["pointerout","pointerover"]),be("onPointerLeave",["pointerout","pointerover"]),Se("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Se("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Se("onBeforeInput",["compositionend","keypress","textInput","paste"]),Se("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Se("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Se("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ro="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ro));function uD(l,u){u=(u&4)!==0;for(var m=0;m<l.length;m++){var y=l[m],M=y.event;y=y.listeners;e:{var I=void 0;if(u)for(var G=y.length-1;0<=G;G--){var ie=y[G],Ae=ie.instance,Oe=ie.currentTarget;if(ie=ie.listener,Ae!==I&&M.isPropagationStopped())break e;I=ie,M.currentTarget=Oe;try{I(M)}catch(lt){fp(lt)}M.currentTarget=null,I=Ae}else for(G=0;G<y.length;G++){if(ie=y[G],Ae=ie.instance,Oe=ie.currentTarget,ie=ie.listener,Ae!==I&&M.isPropagationStopped())break e;I=ie,M.currentTarget=Oe;try{I(M)}catch(lt){fp(lt)}M.currentTarget=null,I=Ae}}}}function ri(l,u){var m=u[ge];m===void 0&&(m=u[ge]=new Set);var y=l+"__bubble";m.has(y)||(hD(u,l,2,!1),m.add(y))}function ZC(l,u,m){var y=0;u&&(y|=4),hD(m,l,y,u)}var z_="_reactListening"+Math.random().toString(36).slice(2);function e3(l){if(!l[z_]){l[z_]=!0,pe.forEach(function(m){m!=="selectionchange"&&(JC.has(m)||ZC(m,!1,l),ZC(m,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[z_]||(u[z_]=!0,ZC("selectionchange",!1,u))}}function hD(l,u,m,y){switch(zD(u)){case 2:var M=pQ;break;case 8:M=mQ;break;default:M=m3}m=M.bind(null,u,m,l),M=void 0,!aa||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(M=!0),y?M!==void 0?l.addEventListener(u,m,{capture:!0,passive:M}):l.addEventListener(u,m,!0):M!==void 0?l.addEventListener(u,m,{passive:M}):l.addEventListener(u,m,!1)}function t3(l,u,m,y,M){var I=y;if((u&1)===0&&(u&2)===0&&y!==null)e:for(;;){if(y===null)return;var G=y.tag;if(G===3||G===4){var ie=y.stateNode.containerInfo;if(ie===M)break;if(G===4)for(G=y.return;G!==null;){var Ae=G.tag;if((Ae===3||Ae===4)&&G.stateNode.containerInfo===M)return;G=G.return}for(;ie!==null;){if(G=Ct(ie),G===null)return;if(Ae=G.tag,Ae===5||Ae===6||Ae===26||Ae===27){y=I=G;continue e}ie=ie.parentNode}}y=y.return}tu(function(){var Oe=I,lt=ch(m),mt=[];e:{var Ge=po.get(l);if(Ge!==void 0){var $e=gc,Jt=l;switch(l){case"keypress":if(iu(m)===0)break e;case"keydown":case"keyup":$e=mh;break;case"focusin":Jt="focus",$e=wf;break;case"focusout":Jt="blur",$e=wf;break;case"beforeblur":case"afterblur":$e=wf;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$e=rp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$e=ph;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$e=Ix;break;case bg:case up:case Vv:$e=Qa;break;case jv:$e=HC;break;case"scroll":case"scrollend":$e=su;break;case"wheel":$e=Bx;break;case"copy":case"cut":case"paste":$e=jo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$e=Rv;break;case"toggle":case"beforetoggle":$e=Lx}var bn=(u&4)!==0,Wi=!bn&&(l==="scroll"||l==="scrollend"),Ce=bn?Ge!==null?Ge+"Capture":null:Ge;bn=[];for(var Ee=Oe,Fe;Ee!==null;){var dt=Ee;if(Fe=dt.stateNode,dt=dt.tag,dt!==5&&dt!==26&&dt!==27||Fe===null||Ce===null||(dt=_l(Ee,Ce),dt!=null&&bn.push(ky(Ee,dt,Fe))),Wi)break;Ee=Ee.return}0<bn.length&&(Ge=new $e(Ge,Jt,null,m,lt),mt.push({event:Ge,listeners:bn}))}}if((u&7)===0){e:{if(Ge=l==="mouseover"||l==="pointerover",$e=l==="mouseout"||l==="pointerout",Ge&&m!==xl&&(Jt=m.relatedTarget||m.fromElement)&&(Ct(Jt)||Jt[se]))break e;if(($e||Ge)&&(Ge=lt.window===lt?lt:(Ge=lt.ownerDocument)?Ge.defaultView||Ge.parentWindow:window,$e?(Jt=m.relatedTarget||m.toElement,$e=Oe,Jt=Jt?Ct(Jt):null,Jt!==null&&(Wi=s(Jt),bn=Jt.tag,Jt!==Wi||bn!==5&&bn!==27&&bn!==6)&&(Jt=null)):($e=null,Jt=Oe),$e!==Jt)){if(bn=rp,dt="onMouseLeave",Ce="onMouseEnter",Ee="mouse",(l==="pointerout"||l==="pointerover")&&(bn=Rv,dt="onPointerLeave",Ce="onPointerEnter",Ee="pointer"),Wi=$e==null?Ge:Dt($e),Fe=Jt==null?Ge:Dt(Jt),Ge=new bn(dt,Ee+"leave",$e,m,lt),Ge.target=Wi,Ge.relatedTarget=Fe,dt=null,Ct(lt)===Oe&&(bn=new bn(Ce,Ee+"enter",Jt,m,lt),bn.target=Fe,bn.relatedTarget=Wi,dt=bn),Wi=dt,$e&&Jt)t:{for(bn=GH,Ce=$e,Ee=Jt,Fe=0,dt=Ce;dt;dt=bn(dt))Fe++;dt=0;for(var fn=Ee;fn;fn=bn(fn))dt++;for(;0<Fe-dt;)Ce=bn(Ce),Fe--;for(;0<dt-Fe;)Ee=bn(Ee),dt--;for(;Fe--;){if(Ce===Ee||Ee!==null&&Ce===Ee.alternate){bn=Ce;break t}Ce=bn(Ce),Ee=bn(Ee)}bn=null}else bn=null;$e!==null&&fD(mt,Ge,$e,bn,!1),Jt!==null&&Wi!==null&&fD(mt,Wi,Jt,bn,!0)}}e:{if(Ge=Oe?Dt(Oe):window,$e=Ge.nodeName&&Ge.nodeName.toLowerCase(),$e==="select"||$e==="input"&&Ge.type==="file")var yi=Pv;else if(Fv(Ge))if(Cl)yi=zx;else{yi=zv;var sn=Ox}else $e=Ge.nodeName,!$e||$e.toLowerCase()!=="input"||Ge.type!=="checkbox"&&Ge.type!=="radio"?Oe&&ps(Oe.elementType)&&(yi=Pv):yi=kx;if(yi&&(yi=yi(l,Oe))){vg(mt,yi,m,lt);break e}sn&&sn(l,Ge,Oe),l==="focusout"&&Oe&&Ge.type==="number"&&Oe.memoizedProps.value!=null&&In(Ge,"number",Ge.value)}switch(sn=Oe?Dt(Oe):window,l){case"focusin":(Fv(sn)||sn.contentEditable==="true")&&(Tl=sn,Il=Oe,Rf=null);break;case"focusout":Rf=Il=Tl=null;break;case"mousedown":yg=!0;break;case"contextmenu":case"mouseup":case"dragend":yg=!1,Bf(mt,m,lt);break;case"selectionchange":if(Hx)break;case"keydown":case"keyup":Bf(mt,m,lt)}var Hn;if(gh)e:{switch(l){case"compositionstart":var li="onCompositionStart";break e;case"compositionend":li="onCompositionEnd";break e;case"compositionupdate":li="onCompositionUpdate";break e}li=void 0}else Ah?Ag(l,m)&&(li="onCompositionEnd"):l==="keydown"&&m.keyCode===229&&(li="onCompositionStart");li&&(Dv&&m.locale!=="ko"&&(Ah||li!=="onCompositionStart"?li==="onCompositionEnd"&&Ah&&(Hn=nu()):(Hs=lt,fh="value"in Hs?Hs.value:Hs.textContent,Ah=!0)),sn=G_(Oe,li),0<sn.length&&(li=new fg(li,l,null,m,lt),mt.push({event:li,listeners:sn}),Hn?li.data=Hn:(Hn=Lv(m),Hn!==null&&(li.data=Hn)))),(Hn=gg?Fx(l,m):Nv(l,m))&&(li=G_(Oe,"onBeforeInput"),0<li.length&&(sn=new fg("onBeforeInput","beforeinput",null,m,lt),mt.push({event:sn,listeners:li}),sn.data=Hn)),pr(mt,l,Oe,m,lt)}uD(mt,u)})}function ky(l,u,m){return{instance:l,listener:u,currentTarget:m}}function G_(l,u){for(var m=u+"Capture",y=[];l!==null;){var M=l,I=M.stateNode;if(M=M.tag,M!==5&&M!==26&&M!==27||I===null||(M=_l(l,m),M!=null&&y.unshift(ky(l,M,I)),M=_l(l,u),M!=null&&y.push(ky(l,M,I))),l.tag===3)return y;l=l.return}return[]}function GH(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function fD(l,u,m,y,M){for(var I=u._reactName,G=[];m!==null&&m!==y;){var ie=m,Ae=ie.alternate,Oe=ie.stateNode;if(ie=ie.tag,Ae!==null&&Ae===y)break;ie!==5&&ie!==26&&ie!==27||Oe===null||(Ae=Oe,M?(Oe=_l(m,I),Oe!=null&&G.unshift(ky(m,Oe,Ae))):M||(Oe=_l(m,I),Oe!=null&&G.push(ky(m,Oe,Ae)))),m=m.return}G.length!==0&&l.push({event:u,listeners:G})}var HH=/\r\n?/g,QH=/\u0000|\uFFFD/g;function dD(l){return(typeof l=="string"?l:""+l).replace(HH,`
`).replace(QH,"")}function pD(l,u){return u=dD(u),dD(l)===u}function ji(l,u,m,y,M,I){switch(m){case"children":typeof y=="string"?u==="body"||u==="textarea"&&y===""||Zi(l,y):(typeof y=="number"||typeof y=="bigint")&&u!=="body"&&Zi(l,""+y);break;case"className":Yt(l,"class",y);break;case"tabIndex":Yt(l,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":Yt(l,m,y);break;case"style":Ho(l,y,I);break;case"data":if(u!=="object"){Yt(l,"data",y);break}case"src":case"href":if(y===""&&(u!=="a"||m!=="href")){l.removeAttribute(m);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){l.removeAttribute(m);break}y=co(""+y),l.setAttribute(m,y);break;case"action":case"formAction":if(typeof y=="function"){l.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof I=="function"&&(m==="formAction"?(u!=="input"&&ji(l,u,"name",M.name,M,null),ji(l,u,"formEncType",M.formEncType,M,null),ji(l,u,"formMethod",M.formMethod,M,null),ji(l,u,"formTarget",M.formTarget,M,null)):(ji(l,u,"encType",M.encType,M,null),ji(l,u,"method",M.method,M,null),ji(l,u,"target",M.target,M,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){l.removeAttribute(m);break}y=co(""+y),l.setAttribute(m,y);break;case"onClick":y!=null&&(l.onclick=Gs);break;case"onScroll":y!=null&&ri("scroll",l);break;case"onScrollEnd":y!=null&&ri("scrollend",l);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(i(61));if(m=y.__html,m!=null){if(M.children!=null)throw Error(i(60));l.innerHTML=m}}break;case"multiple":l.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":l.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){l.removeAttribute("xlink:href");break}m=co(""+y),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?l.setAttribute(m,""+y):l.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?l.setAttribute(m,""):l.removeAttribute(m);break;case"capture":case"download":y===!0?l.setAttribute(m,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?l.setAttribute(m,y):l.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?l.setAttribute(m,y):l.removeAttribute(m);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?l.removeAttribute(m):l.setAttribute(m,y);break;case"popover":ri("beforetoggle",l),ri("toggle",l),wt(l,"popover",y);break;case"xlinkActuate":Bt(l,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":Bt(l,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":Bt(l,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":Bt(l,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":Bt(l,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":Bt(l,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":Bt(l,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":Bt(l,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":Bt(l,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":wt(l,"is",y);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=ip.get(m)||m,wt(l,m,y))}}function n3(l,u,m,y,M,I){switch(m){case"style":Ho(l,y,I);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(i(61));if(m=y.__html,m!=null){if(M.children!=null)throw Error(i(60));l.innerHTML=m}}break;case"children":typeof y=="string"?Zi(l,y):(typeof y=="number"||typeof y=="bigint")&&Zi(l,""+y);break;case"onScroll":y!=null&&ri("scroll",l);break;case"onScrollEnd":y!=null&&ri("scrollend",l);break;case"onClick":y!=null&&(l.onclick=Gs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xe.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(M=m.endsWith("Capture"),u=m.slice(2,M?m.length-7:void 0),I=l[Y]||null,I=I!=null?I[m]:null,typeof I=="function"&&l.removeEventListener(u,I,M),typeof y=="function")){typeof I!="function"&&I!==null&&(m in l?l[m]=null:l.hasAttribute(m)&&l.removeAttribute(m)),l.addEventListener(u,y,M);break e}m in l?l[m]=y:y===!0?l.setAttribute(m,""):wt(l,m,y)}}}function ma(l,u,m){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ri("error",l),ri("load",l);var y=!1,M=!1,I;for(I in m)if(m.hasOwnProperty(I)){var G=m[I];if(G!=null)switch(I){case"src":y=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,u));default:ji(l,u,I,G,m,null)}}M&&ji(l,u,"srcSet",m.srcSet,m,null),y&&ji(l,u,"src",m.src,m,null);return;case"input":ri("invalid",l);var ie=I=G=M=null,Ae=null,Oe=null;for(y in m)if(m.hasOwnProperty(y)){var lt=m[y];if(lt!=null)switch(y){case"name":M=lt;break;case"type":G=lt;break;case"checked":Ae=lt;break;case"defaultChecked":Oe=lt;break;case"value":I=lt;break;case"defaultValue":ie=lt;break;case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(i(137,u));break;default:ji(l,u,y,lt,m,null)}}$i(l,I,ie,Ae,Oe,G,M,!1);return;case"select":ri("invalid",l),y=G=I=null;for(M in m)if(m.hasOwnProperty(M)&&(ie=m[M],ie!=null))switch(M){case"value":I=ie;break;case"defaultValue":G=ie;break;case"multiple":y=ie;default:ji(l,u,M,ie,m,null)}u=I,m=G,l.multiple=!!y,u!=null?Oi(l,!!y,u,!1):m!=null&&Oi(l,!!y,m,!0);return;case"textarea":ri("invalid",l),I=M=y=null;for(G in m)if(m.hasOwnProperty(G)&&(ie=m[G],ie!=null))switch(G){case"value":y=ie;break;case"defaultValue":M=ie;break;case"children":I=ie;break;case"dangerouslySetInnerHTML":if(ie!=null)throw Error(i(91));break;default:ji(l,u,G,ie,m,null)}Ji(l,y,M,I);return;case"option":for(Ae in m)m.hasOwnProperty(Ae)&&(y=m[Ae],y!=null)&&(Ae==="selected"?l.selected=y&&typeof y!="function"&&typeof y!="symbol":ji(l,u,Ae,y,m,null));return;case"dialog":ri("beforetoggle",l),ri("toggle",l),ri("cancel",l),ri("close",l);break;case"iframe":case"object":ri("load",l);break;case"video":case"audio":for(y=0;y<Ro.length;y++)ri(Ro[y],l);break;case"image":ri("error",l),ri("load",l);break;case"details":ri("toggle",l);break;case"embed":case"source":case"link":ri("error",l),ri("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Oe in m)if(m.hasOwnProperty(Oe)&&(y=m[Oe],y!=null))switch(Oe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,u));default:ji(l,u,Oe,y,m,null)}return;default:if(ps(u)){for(lt in m)m.hasOwnProperty(lt)&&(y=m[lt],y!==void 0&&n3(l,u,lt,y,m,void 0));return}}for(ie in m)m.hasOwnProperty(ie)&&(y=m[ie],y!=null&&ji(l,u,ie,y,m,null))}function VH(l,u,m,y){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,I=null,G=null,ie=null,Ae=null,Oe=null,lt=null;for($e in m){var mt=m[$e];if(m.hasOwnProperty($e)&&mt!=null)switch($e){case"checked":break;case"value":break;case"defaultValue":Ae=mt;default:y.hasOwnProperty($e)||ji(l,u,$e,null,y,mt)}}for(var Ge in y){var $e=y[Ge];if(mt=m[Ge],y.hasOwnProperty(Ge)&&($e!=null||mt!=null))switch(Ge){case"type":I=$e;break;case"name":M=$e;break;case"checked":Oe=$e;break;case"defaultChecked":lt=$e;break;case"value":G=$e;break;case"defaultValue":ie=$e;break;case"children":case"dangerouslySetInnerHTML":if($e!=null)throw Error(i(137,u));break;default:$e!==mt&&ji(l,u,Ge,$e,y,mt)}}ni(l,G,ie,Ae,Oe,lt,I,M);return;case"select":$e=G=ie=Ge=null;for(I in m)if(Ae=m[I],m.hasOwnProperty(I)&&Ae!=null)switch(I){case"value":break;case"multiple":$e=Ae;default:y.hasOwnProperty(I)||ji(l,u,I,null,y,Ae)}for(M in y)if(I=y[M],Ae=m[M],y.hasOwnProperty(M)&&(I!=null||Ae!=null))switch(M){case"value":Ge=I;break;case"defaultValue":ie=I;break;case"multiple":G=I;default:I!==Ae&&ji(l,u,M,I,y,Ae)}u=ie,m=G,y=$e,Ge!=null?Oi(l,!!m,Ge,!1):!!y!=!!m&&(u!=null?Oi(l,!!m,u,!0):Oi(l,!!m,m?[]:"",!1));return;case"textarea":$e=Ge=null;for(ie in m)if(M=m[ie],m.hasOwnProperty(ie)&&M!=null&&!y.hasOwnProperty(ie))switch(ie){case"value":break;case"children":break;default:ji(l,u,ie,null,y,M)}for(G in y)if(M=y[G],I=m[G],y.hasOwnProperty(G)&&(M!=null||I!=null))switch(G){case"value":Ge=M;break;case"defaultValue":$e=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(i(91));break;default:M!==I&&ji(l,u,G,M,y,I)}$n(l,Ge,$e);return;case"option":for(var Jt in m)Ge=m[Jt],m.hasOwnProperty(Jt)&&Ge!=null&&!y.hasOwnProperty(Jt)&&(Jt==="selected"?l.selected=!1:ji(l,u,Jt,null,y,Ge));for(Ae in y)Ge=y[Ae],$e=m[Ae],y.hasOwnProperty(Ae)&&Ge!==$e&&(Ge!=null||$e!=null)&&(Ae==="selected"?l.selected=Ge&&typeof Ge!="function"&&typeof Ge!="symbol":ji(l,u,Ae,Ge,y,$e));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var bn in m)Ge=m[bn],m.hasOwnProperty(bn)&&Ge!=null&&!y.hasOwnProperty(bn)&&ji(l,u,bn,null,y,Ge);for(Oe in y)if(Ge=y[Oe],$e=m[Oe],y.hasOwnProperty(Oe)&&Ge!==$e&&(Ge!=null||$e!=null))switch(Oe){case"children":case"dangerouslySetInnerHTML":if(Ge!=null)throw Error(i(137,u));break;default:ji(l,u,Oe,Ge,y,$e)}return;default:if(ps(u)){for(var Wi in m)Ge=m[Wi],m.hasOwnProperty(Wi)&&Ge!==void 0&&!y.hasOwnProperty(Wi)&&n3(l,u,Wi,void 0,y,Ge);for(lt in y)Ge=y[lt],$e=m[lt],!y.hasOwnProperty(lt)||Ge===$e||Ge===void 0&&$e===void 0||n3(l,u,lt,Ge,y,$e);return}}for(var Ce in m)Ge=m[Ce],m.hasOwnProperty(Ce)&&Ge!=null&&!y.hasOwnProperty(Ce)&&ji(l,u,Ce,null,y,Ge);for(mt in y)Ge=y[mt],$e=m[mt],!y.hasOwnProperty(mt)||Ge===$e||Ge==null&&$e==null||ji(l,u,mt,Ge,y,$e)}function mD(l){switch(l){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function jH(){if(typeof performance.getEntriesByType=="function"){for(var l=0,u=0,m=performance.getEntriesByType("resource"),y=0;y<m.length;y++){var M=m[y],I=M.transferSize,G=M.initiatorType,ie=M.duration;if(I&&ie&&mD(G)){for(G=0,ie=M.responseEnd,y+=1;y<m.length;y++){var Ae=m[y],Oe=Ae.startTime;if(Oe>ie)break;var lt=Ae.transferSize,mt=Ae.initiatorType;lt&&mD(mt)&&(Ae=Ae.responseEnd,G+=lt*(Ae<ie?1:(ie-Oe)/(Ae-Oe)))}if(--y,u+=8*(I+G)/(M.duration/1e3),l++,10<l)break}}if(0<l)return u/l/1e6}return navigator.connection&&(l=navigator.connection.downlink,typeof l=="number")?l:5}var i3=null,r3=null;function H_(l){return l.nodeType===9?l:l.ownerDocument}function gD(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function AD(l,u){if(l===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&u==="foreignObject"?0:l}function s3(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var a3=null;function WH(){var l=window.event;return l&&l.type==="popstate"?l===a3?!1:(a3=l,!0):(a3=null,!1)}var vD=typeof setTimeout=="function"?setTimeout:void 0,qH=typeof clearTimeout=="function"?clearTimeout:void 0,yD=typeof Promise=="function"?Promise:void 0,XH=typeof queueMicrotask=="function"?queueMicrotask:typeof yD<"u"?function(l){return yD.resolve(null).then(l).catch(YH)}:vD;function YH(l){setTimeout(function(){throw l})}function id(l){return l==="head"}function bD(l,u){var m=u,y=0;do{var M=m.nextSibling;if(l.removeChild(m),M&&M.nodeType===8)if(m=M.data,m==="/$"||m==="/&"){if(y===0){l.removeChild(M),hA(u);return}y--}else if(m==="$"||m==="$?"||m==="$~"||m==="$!"||m==="&")y++;else if(m==="html")zy(l.ownerDocument.documentElement);else if(m==="head"){m=l.ownerDocument.head,zy(m);for(var I=m.firstChild;I;){var G=I.nextSibling,ie=I.nodeName;I[xt]||ie==="SCRIPT"||ie==="STYLE"||ie==="LINK"&&I.rel.toLowerCase()==="stylesheet"||m.removeChild(I),I=G}}else m==="body"&&zy(l.ownerDocument.body);m=M}while(m);hA(u)}function xD(l,u){var m=l;l=0;do{var y=m.nextSibling;if(m.nodeType===1?u?(m._stashedDisplay=m.style.display,m.style.display="none"):(m.style.display=m._stashedDisplay||"",m.getAttribute("style")===""&&m.removeAttribute("style")):m.nodeType===3&&(u?(m._stashedText=m.nodeValue,m.nodeValue=""):m.nodeValue=m._stashedText||""),y&&y.nodeType===8)if(m=y.data,m==="/$"){if(l===0)break;l--}else m!=="$"&&m!=="$?"&&m!=="$~"&&m!=="$!"||l++;m=y}while(m)}function o3(l){var u=l.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var m=u;switch(u=u.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":o3(m),At(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}l.removeChild(m)}}function KH(l,u,m,y){for(;l.nodeType===1;){var M=m;if(l.nodeName.toLowerCase()!==u.toLowerCase()){if(!y&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(y){if(!l[xt])switch(u){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(I=l.getAttribute("rel"),I==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(I!==M.rel||l.getAttribute("href")!==(M.href==null||M.href===""?null:M.href)||l.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||l.getAttribute("title")!==(M.title==null?null:M.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(I=l.getAttribute("src"),(I!==(M.src==null?null:M.src)||l.getAttribute("type")!==(M.type==null?null:M.type)||l.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&I&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(u==="input"&&l.type==="hidden"){var I=M.name==null?null:""+M.name;if(M.type==="hidden"&&l.getAttribute("name")===I)return l}else return l;if(l=Xl(l.nextSibling),l===null)break}return null}function $H(l,u,m){if(u==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!m||(l=Xl(l.nextSibling),l===null))return null;return l}function _D(l,u){for(;l.nodeType!==8;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!u||(l=Xl(l.nextSibling),l===null))return null;return l}function l3(l){return l.data==="$?"||l.data==="$~"}function c3(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState!=="loading"}function JH(l,u){var m=l.ownerDocument;if(l.data==="$~")l._reactRetry=u;else if(l.data!=="$?"||m.readyState!=="loading")u();else{var y=function(){u(),m.removeEventListener("DOMContentLoaded",y)};m.addEventListener("DOMContentLoaded",y),l._reactRetry=y}}function Xl(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return l}var u3=null;function SD(l){l=l.nextSibling;for(var u=0;l;){if(l.nodeType===8){var m=l.data;if(m==="/$"||m==="/&"){if(u===0)return Xl(l.nextSibling);u--}else m!=="$"&&m!=="$!"&&m!=="$?"&&m!=="$~"&&m!=="&"||u++}l=l.nextSibling}return null}function ED(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var m=l.data;if(m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"){if(u===0)return l;u--}else m!=="/$"&&m!=="/&"||u++}l=l.previousSibling}return null}function wD(l,u,m){switch(u=H_(m),l){case"html":if(l=u.documentElement,!l)throw Error(i(452));return l;case"head":if(l=u.head,!l)throw Error(i(453));return l;case"body":if(l=u.body,!l)throw Error(i(454));return l;default:throw Error(i(451))}}function zy(l){for(var u=l.attributes;u.length;)l.removeAttributeNode(u[0]);At(l)}var Yl=new Map,MD=new Set;function Q_(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var Gh=K.d;K.d={f:ZH,r:eQ,D:tQ,C:nQ,L:iQ,m:rQ,X:aQ,S:sQ,M:oQ};function ZH(){var l=Gh.f(),u=Ko();return l||u}function eQ(l){var u=Tt(l);u!==null&&u.tag===5&&u.type==="form"?w_(u):Gh.r(l)}var lA=typeof document>"u"?null:document;function CD(l,u,m){var y=lA;if(y&&typeof u=="string"&&u){var M=Lt(u);M='link[rel="'+l+'"][href="'+M+'"]',typeof m=="string"&&(M+='[crossorigin="'+m+'"]'),MD.has(M)||(MD.add(M),l={rel:l,crossOrigin:m,href:u},y.querySelector(M)===null&&(u=y.createElement("link"),ma(u,"link",l),J(u),y.head.appendChild(u)))}}function tQ(l){Gh.D(l),CD("dns-prefetch",l,null)}function nQ(l,u){Gh.C(l,u),CD("preconnect",l,u)}function iQ(l,u,m){Gh.L(l,u,m);var y=lA;if(y&&l&&u){var M='link[rel="preload"][as="'+Lt(u)+'"]';u==="image"&&m&&m.imageSrcSet?(M+='[imagesrcset="'+Lt(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(M+='[imagesizes="'+Lt(m.imageSizes)+'"]')):M+='[href="'+Lt(l)+'"]';var I=M;switch(u){case"style":I=cA(l);break;case"script":I=uA(l)}Yl.has(I)||(l=g({rel:"preload",href:u==="image"&&m&&m.imageSrcSet?void 0:l,as:u},m),Yl.set(I,l),y.querySelector(M)!==null||u==="style"&&y.querySelector(Gy(I))||u==="script"&&y.querySelector(Hy(I))||(u=y.createElement("link"),ma(u,"link",l),J(u),y.head.appendChild(u)))}}function rQ(l,u){Gh.m(l,u);var m=lA;if(m&&l){var y=u&&typeof u.as=="string"?u.as:"script",M='link[rel="modulepreload"][as="'+Lt(y)+'"][href="'+Lt(l)+'"]',I=M;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":I=uA(l)}if(!Yl.has(I)&&(l=g({rel:"modulepreload",href:l},u),Yl.set(I,l),m.querySelector(M)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(Hy(I)))return}y=m.createElement("link"),ma(y,"link",l),J(y),m.head.appendChild(y)}}}function sQ(l,u,m){Gh.S(l,u,m);var y=lA;if(y&&l){var M=He(y).hoistableStyles,I=cA(l);u=u||"default";var G=M.get(I);if(!G){var ie={loading:0,preload:null};if(G=y.querySelector(Gy(I)))ie.loading=5;else{l=g({rel:"stylesheet",href:l,"data-precedence":u},m),(m=Yl.get(I))&&h3(l,m);var Ae=G=y.createElement("link");J(Ae),ma(Ae,"link",l),Ae._p=new Promise(function(Oe,lt){Ae.onload=Oe,Ae.onerror=lt}),Ae.addEventListener("load",function(){ie.loading|=1}),Ae.addEventListener("error",function(){ie.loading|=2}),ie.loading|=4,V_(G,u,y)}G={type:"stylesheet",instance:G,count:1,state:ie},M.set(I,G)}}}function aQ(l,u){Gh.X(l,u);var m=lA;if(m&&l){var y=He(m).hoistableScripts,M=uA(l),I=y.get(M);I||(I=m.querySelector(Hy(M)),I||(l=g({src:l,async:!0},u),(u=Yl.get(M))&&f3(l,u),I=m.createElement("script"),J(I),ma(I,"link",l),m.head.appendChild(I)),I={type:"script",instance:I,count:1,state:null},y.set(M,I))}}function oQ(l,u){Gh.M(l,u);var m=lA;if(m&&l){var y=He(m).hoistableScripts,M=uA(l),I=y.get(M);I||(I=m.querySelector(Hy(M)),I||(l=g({src:l,async:!0,type:"module"},u),(u=Yl.get(M))&&f3(l,u),I=m.createElement("script"),J(I),ma(I,"link",l),m.head.appendChild(I)),I={type:"script",instance:I,count:1,state:null},y.set(M,I))}}function TD(l,u,m,y){var M=(M=le.current)?Q_(M):null;if(!M)throw Error(i(446));switch(l){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(u=cA(m.href),m=He(M).hoistableStyles,y=m.get(u),y||(y={type:"style",instance:null,count:0,state:null},m.set(u,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){l=cA(m.href);var I=He(M).hoistableStyles,G=I.get(l);if(G||(M=M.ownerDocument||M,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},I.set(l,G),(I=M.querySelector(Gy(l)))&&!I._p&&(G.instance=I,G.state.loading=5),Yl.has(l)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Yl.set(l,m),I||lQ(M,l,m,G.state))),u&&y===null)throw Error(i(528,""));return G}if(u&&y!==null)throw Error(i(529,""));return null;case"script":return u=m.async,m=m.src,typeof m=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=uA(m),m=He(M).hoistableScripts,y=m.get(u),y||(y={type:"script",instance:null,count:0,state:null},m.set(u,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,l))}}function cA(l){return'href="'+Lt(l)+'"'}function Gy(l){return'link[rel="stylesheet"]['+l+"]"}function ID(l){return g({},l,{"data-precedence":l.precedence,precedence:null})}function lQ(l,u,m,y){l.querySelector('link[rel="preload"][as="style"]['+u+"]")?y.loading=1:(u=l.createElement("link"),y.preload=u,u.addEventListener("load",function(){return y.loading|=1}),u.addEventListener("error",function(){return y.loading|=2}),ma(u,"link",m),J(u),l.head.appendChild(u))}function uA(l){return'[src="'+Lt(l)+'"]'}function Hy(l){return"script[async]"+l}function RD(l,u,m){if(u.count++,u.instance===null)switch(u.type){case"style":var y=l.querySelector('style[data-href~="'+Lt(m.href)+'"]');if(y)return u.instance=y,J(y),y;var M=g({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return y=(l.ownerDocument||l).createElement("style"),J(y),ma(y,"style",M),V_(y,m.precedence,l),u.instance=y;case"stylesheet":M=cA(m.href);var I=l.querySelector(Gy(M));if(I)return u.state.loading|=4,u.instance=I,J(I),I;y=ID(m),(M=Yl.get(M))&&h3(y,M),I=(l.ownerDocument||l).createElement("link"),J(I);var G=I;return G._p=new Promise(function(ie,Ae){G.onload=ie,G.onerror=Ae}),ma(I,"link",y),u.state.loading|=4,V_(I,m.precedence,l),u.instance=I;case"script":return I=uA(m.src),(M=l.querySelector(Hy(I)))?(u.instance=M,J(M),M):(y=m,(M=Yl.get(I))&&(y=g({},m),f3(y,M)),l=l.ownerDocument||l,M=l.createElement("script"),J(M),ma(M,"link",y),l.head.appendChild(M),u.instance=M);case"void":return null;default:throw Error(i(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(y=u.instance,u.state.loading|=4,V_(y,m.precedence,l));return u.instance}function V_(l,u,m){for(var y=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=y.length?y[y.length-1]:null,I=M,G=0;G<y.length;G++){var ie=y[G];if(ie.dataset.precedence===u)I=ie;else if(I!==M)break}I?I.parentNode.insertBefore(l,I.nextSibling):(u=m.nodeType===9?m.head:m,u.insertBefore(l,u.firstChild))}function h3(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.title==null&&(l.title=u.title)}function f3(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.integrity==null&&(l.integrity=u.integrity)}var j_=null;function BD(l,u,m){if(j_===null){var y=new Map,M=j_=new Map;M.set(m,y)}else M=j_,y=M.get(m),y||(y=new Map,M.set(m,y));if(y.has(l))return y;for(y.set(l,null),m=m.getElementsByTagName(l),M=0;M<m.length;M++){var I=m[M];if(!(I[xt]||I[hi]||l==="link"&&I.getAttribute("rel")==="stylesheet")&&I.namespaceURI!=="http://www.w3.org/2000/svg"){var G=I.getAttribute(u)||"";G=l+G;var ie=y.get(G);ie?ie.push(I):y.set(G,[I])}}return y}function DD(l,u,m){l=l.ownerDocument||l,l.head.insertBefore(m,u==="title"?l.querySelector("head > title"):null)}function cQ(l,u,m){if(m===1||u.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;return u.rel==="stylesheet"?(l=u.disabled,typeof u.precedence=="string"&&l==null):!0;case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function LD(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}function uQ(l,u,m,y){if(m.type==="stylesheet"&&(typeof y.media!="string"||matchMedia(y.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var M=cA(y.href),I=u.querySelector(Gy(M));if(I){u=I._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(l.count++,l=W_.bind(l),u.then(l,l)),m.state.loading|=4,m.instance=I,J(I);return}I=u.ownerDocument||u,y=ID(y),(M=Yl.get(M))&&h3(y,M),I=I.createElement("link"),J(I);var G=I;G._p=new Promise(function(ie,Ae){G.onload=ie,G.onerror=Ae}),ma(I,"link",y),m.instance=I}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(m,u),(u=m.state.preload)&&(m.state.loading&3)===0&&(l.count++,m=W_.bind(l),u.addEventListener("load",m),u.addEventListener("error",m))}}var d3=0;function hQ(l,u){return l.stylesheets&&l.count===0&&X_(l,l.stylesheets),0<l.count||0<l.imgCount?function(m){var y=setTimeout(function(){if(l.stylesheets&&X_(l,l.stylesheets),l.unsuspend){var I=l.unsuspend;l.unsuspend=null,I()}},6e4+u);0<l.imgBytes&&d3===0&&(d3=62500*jH());var M=setTimeout(function(){if(l.waitingForImages=!1,l.count===0&&(l.stylesheets&&X_(l,l.stylesheets),l.unsuspend)){var I=l.unsuspend;l.unsuspend=null,I()}},(l.imgBytes>d3?50:800)+u);return l.unsuspend=m,function(){l.unsuspend=null,clearTimeout(y),clearTimeout(M)}}:null}function W_(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)X_(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var q_=null;function X_(l,u){l.stylesheets=null,l.unsuspend!==null&&(l.count++,q_=new Map,u.forEach(fQ,l),q_=null,W_.call(l))}function fQ(l,u){if(!(u.state.loading&4)){var m=q_.get(l);if(m)var y=m.get(null);else{m=new Map,q_.set(l,m);for(var M=l.querySelectorAll("link[data-precedence],style[data-precedence]"),I=0;I<M.length;I++){var G=M[I];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(m.set(G.dataset.precedence,G),y=G)}y&&m.set(null,y)}M=u.instance,G=M.getAttribute("data-precedence"),I=m.get(G)||y,I===y&&m.set(null,M),m.set(G,M),this.count++,y=W_.bind(this),M.addEventListener("load",y),M.addEventListener("error",y),I?I.parentNode.insertBefore(M,I.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(M,l.firstChild)),u.state.loading|=4}}var Qy={$$typeof:T,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function dQ(l,u,m,y,M,I,G,ie,Ae){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=rn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rn(0),this.hiddenUpdates=rn(null),this.identifierPrefix=y,this.onUncaughtError=M,this.onCaughtError=I,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ae,this.incompleteTransitions=new Map}function ND(l,u,m,y,M,I,G,ie,Ae,Oe,lt,mt){return l=new dQ(l,u,m,G,Ae,Oe,lt,mt,ie),u=1,I===!0&&(u|=24),I=lr(3,null,null,u),l.current=I,I.stateNode=l,u=qv(),u.refCount++,l.pooledCache=u,u.refCount++,I.memoizedState={element:y,isDehydrated:m,cache:u},yp(I),l}function UD(l){return l?(l=uu,l):uu}function FD(l,u,m,y,M,I){M=UD(M),y.context===null?y.context=M:y.pendingContext=M,y=Ec(u),y.payload={element:m},I=I===void 0?null:I,I!==null&&(y.callback=I),m=vu(l,y,u),m!==null&&(On(m,l,u),yu(m,l,u))}function PD(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var m=l.retryLane;l.retryLane=m!==0&&m<u?m:u}}function p3(l,u){PD(l,u),(l=l.alternate)&&PD(l,u)}function OD(l){if(l.tag===13||l.tag===31){var u=la(l,67108864);u!==null&&On(u,l,67108864),p3(l,67108864)}}function kD(l){if(l.tag===13||l.tag===31){var u=Ja();u=qr(u);var m=la(l,u);m!==null&&On(m,l,u),p3(l,u)}}var Y_=!0;function pQ(l,u,m,y){var M=Q.T;Q.T=null;var I=K.p;try{K.p=2,m3(l,u,m,y)}finally{K.p=I,Q.T=M}}function mQ(l,u,m,y){var M=Q.T;Q.T=null;var I=K.p;try{K.p=8,m3(l,u,m,y)}finally{K.p=I,Q.T=M}}function m3(l,u,m,y){if(Y_){var M=g3(y);if(M===null)t3(l,u,y,K_,m),GD(l,y);else if(AQ(M,l,u,m,y))y.stopPropagation();else if(GD(l,y),u&4&&-1<gQ.indexOf(l)){for(;M!==null;){var I=Tt(M);if(I!==null)switch(I.tag){case 3:if(I=I.stateNode,I.current.memoizedState.isDehydrated){var G=nt(I.pendingLanes);if(G!==0){var ie=I;for(ie.pendingLanes|=2,ie.entangledLanes|=2;G;){var Ae=1<<31-bt(G);ie.entanglements[1]|=Ae,G&=~Ae}Et(I),(an&6)===0&&(Fr=H()+500,Xt(0))}}break;case 31:case 13:ie=la(I,2),ie!==null&&On(ie,I,2),Ko(),p3(I,2)}if(I=g3(y),I===null&&t3(l,u,y,K_,m),I===M)break;M=I}M!==null&&y.stopPropagation()}else t3(l,u,y,null,m)}}function g3(l){return l=ch(l),A3(l)}var K_=null;function A3(l){if(K_=null,l=Ct(l),l!==null){var u=s(l);if(u===null)l=null;else{var m=u.tag;if(m===13){if(l=a(u),l!==null)return l;l=null}else if(m===31){if(l=o(u),l!==null)return l;l=null}else if(m===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null)}}return K_=l,null}function zD(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(de()){case De:return 2;case Ie:return 8;case we:case st:return 32;case it:return 268435456;default:return 32}default:return 32}}var v3=!1,rd=null,sd=null,ad=null,Vy=new Map,jy=new Map,od=[],gQ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function GD(l,u){switch(l){case"focusin":case"focusout":rd=null;break;case"dragenter":case"dragleave":sd=null;break;case"mouseover":case"mouseout":ad=null;break;case"pointerover":case"pointerout":Vy.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":jy.delete(u.pointerId)}}function Wy(l,u,m,y,M,I){return l===null||l.nativeEvent!==I?(l={blockedOn:u,domEventName:m,eventSystemFlags:y,nativeEvent:I,targetContainers:[M]},u!==null&&(u=Tt(u),u!==null&&OD(u)),l):(l.eventSystemFlags|=y,u=l.targetContainers,M!==null&&u.indexOf(M)===-1&&u.push(M),l)}function AQ(l,u,m,y,M){switch(u){case"focusin":return rd=Wy(rd,l,u,m,y,M),!0;case"dragenter":return sd=Wy(sd,l,u,m,y,M),!0;case"mouseover":return ad=Wy(ad,l,u,m,y,M),!0;case"pointerover":var I=M.pointerId;return Vy.set(I,Wy(Vy.get(I)||null,l,u,m,y,M)),!0;case"gotpointercapture":return I=M.pointerId,jy.set(I,Wy(jy.get(I)||null,l,u,m,y,M)),!0}return!1}function HD(l){var u=Ct(l.target);if(u!==null){var m=s(u);if(m!==null){if(u=m.tag,u===13){if(u=a(m),u!==null){l.blockedOn=u,en(l.priority,function(){kD(m)});return}}else if(u===31){if(u=o(m),u!==null){l.blockedOn=u,en(l.priority,function(){kD(m)});return}}else if(u===3&&m.stateNode.current.memoizedState.isDehydrated){l.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}l.blockedOn=null}function $_(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var m=g3(l.nativeEvent);if(m===null){m=l.nativeEvent;var y=new m.constructor(m.type,m);xl=y,m.target.dispatchEvent(y),xl=null}else return u=Tt(m),u!==null&&OD(u),l.blockedOn=m,!1;u.shift()}return!0}function QD(l,u,m){$_(l)&&m.delete(u)}function vQ(){v3=!1,rd!==null&&$_(rd)&&(rd=null),sd!==null&&$_(sd)&&(sd=null),ad!==null&&$_(ad)&&(ad=null),Vy.forEach(QD),jy.forEach(QD)}function J_(l,u){l.blockedOn===u&&(l.blockedOn=null,v3||(v3=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,vQ)))}var Z_=null;function VD(l){Z_!==l&&(Z_=l,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Z_===l&&(Z_=null);for(var u=0;u<l.length;u+=3){var m=l[u],y=l[u+1],M=l[u+2];if(typeof y!="function"){if(A3(y||m)===null)continue;break}var I=Tt(m);I!==null&&(l.splice(u,3),u-=3,by(I,{pending:!0,data:M,method:m.method,action:y},y,M))}}))}function hA(l){function u(Ae){return J_(Ae,l)}rd!==null&&J_(rd,l),sd!==null&&J_(sd,l),ad!==null&&J_(ad,l),Vy.forEach(u),jy.forEach(u);for(var m=0;m<od.length;m++){var y=od[m];y.blockedOn===l&&(y.blockedOn=null)}for(;0<od.length&&(m=od[0],m.blockedOn===null);)HD(m),m.blockedOn===null&&od.shift();if(m=(l.ownerDocument||l).$$reactFormReplay,m!=null)for(y=0;y<m.length;y+=3){var M=m[y],I=m[y+1],G=M[Y]||null;if(typeof I=="function")G||VD(m);else if(G){var ie=null;if(I&&I.hasAttribute("formAction")){if(M=I,G=I[Y]||null)ie=G.formAction;else if(A3(M)!==null)continue}else ie=G.action;typeof ie=="function"?m[y+1]=ie:(m.splice(y,3),y-=3),VD(m)}}}function jD(){function l(I){I.canIntercept&&I.info==="react-transition"&&I.intercept({handler:function(){return new Promise(function(G){return M=G})},focusReset:"manual",scroll:"manual"})}function u(){M!==null&&(M(),M=null),y||setTimeout(m,20)}function m(){if(!y&&!navigation.transition){var I=navigation.currentEntry;I&&I.url!=null&&navigation.navigate(I.url,{state:I.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var y=!1,M=null;return navigation.addEventListener("navigate",l),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(m,100),function(){y=!0,navigation.removeEventListener("navigate",l),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),M!==null&&(M(),M=null)}}}function y3(l){this._internalRoot=l}eS.prototype.render=y3.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(i(409));var m=u.current,y=Ja();FD(m,y,l,u,null,null)},eS.prototype.unmount=y3.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;FD(l.current,2,null,l,null,null),Ko(),u[se]=null}};function eS(l){this._internalRoot=l}eS.prototype.unstable_scheduleHydration=function(l){if(l){var u=Rr();l={blockedOn:null,target:l,priority:u};for(var m=0;m<od.length&&u!==0&&u<od[m].priority;m++);od.splice(m,0,l),m===0&&HD(l)}};var WD=e.version;if(WD!=="19.2.4")throw Error(i(527,WD,"19.2.4"));K.findDOMNode=function(l){var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(i(188)):(l=Object.keys(l).join(","),Error(i(268,l)));return l=h(u),l=l!==null?p(l):null,l=l===null?null:l.stateNode,l};var yQ={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tS.isDisabled&&tS.supportsFiber)try{Qe=tS.inject(yQ),Ve=tS}catch{}}return Xy.createRoot=function(l,u){if(!r(l))throw Error(i(299));var m=!1,y="",M=D_,I=My,G=Cy;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(M=u.onUncaughtError),u.onCaughtError!==void 0&&(I=u.onCaughtError),u.onRecoverableError!==void 0&&(G=u.onRecoverableError)),u=ND(l,1,!1,null,null,m,y,null,M,I,G,jD),l[se]=u.current,e3(l),new y3(u)},Xy.hydrateRoot=function(l,u,m){if(!r(l))throw Error(i(299));var y=!1,M="",I=D_,G=My,ie=Cy,Ae=null;return m!=null&&(m.unstable_strictMode===!0&&(y=!0),m.identifierPrefix!==void 0&&(M=m.identifierPrefix),m.onUncaughtError!==void 0&&(I=m.onUncaughtError),m.onCaughtError!==void 0&&(G=m.onCaughtError),m.onRecoverableError!==void 0&&(ie=m.onRecoverableError),m.formState!==void 0&&(Ae=m.formState)),u=ND(l,1,!0,u,m??null,y,M,Ae,I,G,ie,jD),u.context=UD(null),m=u.current,y=Ja(),y=qr(y),M=Ec(y),M.callback=null,vu(m,M,y),m=y,u.current.lanes=m,ti(u,m),Et(u),l[se]=u.current,e3(l),new eS(u)},Xy.version="19.2.4",Xy}var nL;function TQ(){if(nL)return _3.exports;nL=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),_3.exports=CQ(),_3.exports}var mk=TQ();var iL="popstate";function IQ(n={}){function e(i,r){let{pathname:s,search:a,hash:o}=i.location;return MR("",{pathname:s,search:a,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:hb(r)}return BQ(e,t,null,n)}function Qr(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Ju(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function RQ(){return Math.random().toString(36).substring(2,10)}function rL(n,e){return{usr:n.state,key:n.key,idx:e}}function MR(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?tv(e):e,state:t,key:e&&e.key||i||RQ()}}function hb({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function tv(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function BQ(n,e,t,i={}){let{window:r=document.defaultView,v5Compat:s=!1}=i,a=r.history,o="POP",c=null,h=p();h==null&&(h=0,a.replaceState({...a.state,idx:h},""));function p(){return(a.state||{idx:null}).idx}function g(){o="POP";let _=p(),E=_==null?null:_-h;h=_,c&&c({action:o,location:S.location,delta:E})}function A(_,E){o="PUSH";let C=MR(S.location,_,E);h=p()+1;let T=rL(C,h),R=S.createHref(C);try{a.pushState(T,"",R)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;r.location.assign(R)}s&&c&&c({action:o,location:S.location,delta:1})}function v(_,E){o="REPLACE";let C=MR(S.location,_,E);h=p();let T=rL(C,h),R=S.createHref(C);a.replaceState(T,"",R),s&&c&&c({action:o,location:S.location,delta:0})}function x(_){return DQ(_)}let S={get action(){return o},get location(){return n(r,a)},listen(_){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(iL,g),c=_,()=>{r.removeEventListener(iL,g),c=null}},createHref(_){return e(r,_)},createURL:x,encodeLocation(_){let E=x(_);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:A,replace:v,go(_){return a.go(_)}};return S}function DQ(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Qr(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:hb(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function gk(n,e,t="/"){return LQ(n,e,t,!1)}function LQ(n,e,t,i){let r=typeof e=="string"?tv(e):e,s=pf(r.pathname||"/",t);if(s==null)return null;let a=Ak(n);NQ(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let h=jQ(s);o=QQ(a[c],h,i)}return o}function Ak(n,e=[],t=[],i="",r=!1){let s=(a,o,c=r,h)=>{let p={relativePath:h===void 0?a.path||"":h,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(i)&&c)return;Qr(p.relativePath.startsWith(i),`Absolute route path "${p.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(i.length)}let g=cf([i,p.relativePath]),A=t.concat(p);a.children&&a.children.length>0&&(Qr(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),Ak(a.children,e,A,g,c)),!(a.path==null&&!a.index)&&e.push({path:g,score:GQ(g,a.index),routesMeta:A})};return n.forEach((a,o)=>{if(a.path===""||!a.path?.includes("?"))s(a,o);else for(let c of vk(a.path))s(a,o,!0,c)}),e}function vk(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let a=vk(i.join("/")),o=[];return o.push(...a.map(c=>c===""?s:[s,c].join("/"))),r&&o.push(...a),o.map(c=>n.startsWith("/")&&c===""?"/":c)}function NQ(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:HQ(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var UQ=/^:[\w-]+$/,FQ=3,PQ=2,OQ=1,kQ=10,zQ=-2,sL=n=>n==="*";function GQ(n,e){let t=n.split("/"),i=t.length;return t.some(sL)&&(i+=zQ),e&&(i+=PQ),t.filter(r=>!sL(r)).reduce((r,s)=>r+(UQ.test(s)?FQ:s===""?OQ:kQ),i)}function HQ(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function QQ(n,e,t=!1){let{routesMeta:i}=n,r={},s="/",a=[];for(let o=0;o<i.length;++o){let c=i[o],h=o===i.length-1,p=s==="/"?e:e.slice(s.length)||"/",g=sw({path:c.relativePath,caseSensitive:c.caseSensitive,end:h},p),A=c.route;if(!g&&h&&t&&!i[i.length-1].route.index&&(g=sw({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},p)),!g)return null;Object.assign(r,g.params),a.push({params:r,pathname:cf([s,g.pathname]),pathnameBase:YQ(cf([s,g.pathnameBase])),route:A}),g.pathnameBase!=="/"&&(s=cf([s,g.pathnameBase]))}return a}function sw(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=VQ(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:i.reduce((h,{paramName:p,isOptional:g},A)=>{if(p==="*"){let x=o[A]||"";a=s.slice(0,s.length-x.length).replace(/(.)\/+$/,"$1")}const v=o[A];return g&&!v?h[p]=void 0:h[p]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:a,pattern:n}}function VQ(n,e=!1,t=!0){Ju(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(i.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function jQ(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ju(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function pf(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var WQ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function qQ(n,e="/"){let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?tv(n):n,s;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?s=aL(t.substring(1),"/"):s=aL(t,e)):s=e,{pathname:s,search:KQ(i),hash:$Q(r)}}function aL(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function M3(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function XQ(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function yk(n){let e=XQ(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function bk(n,e,t,i=!1){let r;typeof n=="string"?r=tv(n):(r={...n},Qr(!r.pathname||!r.pathname.includes("?"),M3("?","pathname","search",r)),Qr(!r.pathname||!r.pathname.includes("#"),M3("#","pathname","hash",r)),Qr(!r.search||!r.search.includes("#"),M3("#","search","hash",r)));let s=n===""||r.pathname==="",a=s?"/":r.pathname,o;if(a==null)o=t;else{let g=e.length-1;if(!i&&a.startsWith("..")){let A=a.split("/");for(;A[0]==="..";)A.shift(),g-=1;r.pathname=A.join("/")}o=g>=0?e[g]:"/"}let c=qQ(r,o),h=a&&a!=="/"&&a.endsWith("/"),p=(s||a===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(h||p)&&(c.pathname+="/"),c}var cf=n=>n.join("/").replace(/\/\/+/g,"/"),YQ=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),KQ=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,$Q=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,JQ=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function ZQ(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function eV(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var xk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function _k(n,e){let t=n;if(typeof t!="string"||!WQ.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,r=!1;if(xk)try{let s=new URL(window.location.href),a=t.startsWith("//")?new URL(s.protocol+t):new URL(t),o=pf(a.pathname,e);a.origin===s.origin&&o!=null?t=o+a.search+a.hash:r=!0}catch{Ju(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:r,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Sk=["POST","PUT","PATCH","DELETE"];new Set(Sk);var tV=["GET",...Sk];new Set(tV);var nv=X.createContext(null);nv.displayName="DataRouter";var uM=X.createContext(null);uM.displayName="DataRouterState";var nV=X.createContext(!1),Ek=X.createContext({isTransitioning:!1});Ek.displayName="ViewTransition";var iV=X.createContext(new Map);iV.displayName="Fetchers";var rV=X.createContext(null);rV.displayName="Await";var fc=X.createContext(null);fc.displayName="Navigation";var Wb=X.createContext(null);Wb.displayName="Location";var Sf=X.createContext({outlet:null,matches:[],isDataRoute:!1});Sf.displayName="Route";var W2=X.createContext(null);W2.displayName="RouteError";var wk="REACT_ROUTER_ERROR",sV="REDIRECT",aV="ROUTE_ERROR_RESPONSE";function oV(n){if(n.startsWith(`${wk}:${sV}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function lV(n){if(n.startsWith(`${wk}:${aV}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new JQ(e.status,e.statusText,e.data)}catch{}}function cV(n,{relative:e}={}){Qr(qb(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=X.useContext(fc),{hash:r,pathname:s,search:a}=Xb(n,{relative:e}),o=s;return t!=="/"&&(o=s==="/"?t:cf([t,s])),i.createHref({pathname:o,search:a,hash:r})}function qb(){return X.useContext(Wb)!=null}function sg(){return Qr(qb(),"useLocation() may be used only in the context of a <Router> component."),X.useContext(Wb).location}var Mk="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ck(n){X.useContext(fc).static||X.useLayoutEffect(n)}function uV(){let{isDataRoute:n}=X.useContext(Sf);return n?SV():hV()}function hV(){Qr(qb(),"useNavigate() may be used only in the context of a <Router> component.");let n=X.useContext(nv),{basename:e,navigator:t}=X.useContext(fc),{matches:i}=X.useContext(Sf),{pathname:r}=sg(),s=JSON.stringify(yk(i)),a=X.useRef(!1);return Ck(()=>{a.current=!0}),X.useCallback((c,h={})=>{if(Ju(a.current,Mk),!a.current)return;if(typeof c=="number"){t.go(c);return}let p=bk(c,JSON.parse(s),r,h.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:cf([e,p.pathname])),(h.replace?t.replace:t.push)(p,h.state,h)},[e,t,s,r,n])}X.createContext(null);function Xb(n,{relative:e}={}){let{matches:t}=X.useContext(Sf),{pathname:i}=sg(),r=JSON.stringify(yk(t));return X.useMemo(()=>bk(n,JSON.parse(r),i,e==="path"),[n,r,i,e])}function fV(n,e){return Tk(n,e)}function Tk(n,e,t,i,r){Qr(qb(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=X.useContext(fc),{matches:a}=X.useContext(Sf),o=a[a.length-1],c=o?o.params:{},h=o?o.pathname:"/",p=o?o.pathnameBase:"/",g=o&&o.route;{let C=g&&g.path||"";Rk(h,!g||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let A=sg(),v;if(e){let C=typeof e=="string"?tv(e):e;Qr(p==="/"||C.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${C.pathname}" was given in the \`location\` prop.`),v=C}else v=A;let x=v.pathname||"/",S=x;if(p!=="/"){let C=p.replace(/^\//,"").split("/");S="/"+x.replace(/^\//,"").split("/").slice(C.length).join("/")}let _=gk(n,{pathname:S});Ju(g||_!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Ju(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=AV(_&&_.map(C=>Object.assign({},C,{params:Object.assign({},c,C.params),pathname:cf([p,s.encodeLocation?s.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?p:cf([p,s.encodeLocation?s.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),a,t,i,r);return e&&E?X.createElement(Wb.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function dV(){let n=_V(),e=ZQ(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},s={padding:"2px 4px",backgroundColor:i},a=null;return console.error("Error handled by React Router default ErrorBoundary:",n),a=X.createElement(X.Fragment,null,X.createElement("p",null," Hey developer "),X.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",X.createElement("code",{style:s},"ErrorBoundary")," or"," ",X.createElement("code",{style:s},"errorElement")," prop on your route.")),X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},e),t?X.createElement("pre",{style:r},t):null,a)}var pV=X.createElement(dV,null),Ik=class extends X.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=lV(n.digest);t&&(n=t)}let e=n!==void 0?X.createElement(Sf.Provider,{value:this.props.routeContext},X.createElement(W2.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?X.createElement(mV,{error:n},e):e}};Ik.contextType=nV;var C3=new WeakMap;function mV({children:n,error:e}){let{basename:t}=X.useContext(fc);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=oV(e.digest);if(i){let r=C3.get(e);if(r)throw r;let s=_k(i.location,t);if(xk&&!C3.get(e))if(s.isExternal||i.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const a=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:i.replace}));throw C3.set(e,a),a}return X.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return n}function gV({routeContext:n,match:e,children:t}){let i=X.useContext(nv);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),X.createElement(Sf.Provider,{value:n},t)}function AV(n,e=[],t=null,i=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let s=n,a=t?.errors;if(a!=null){let p=s.findIndex(g=>g.route.id&&a?.[g.route.id]!==void 0);Qr(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,p+1))}let o=!1,c=-1;if(t)for(let p=0;p<s.length;p++){let g=s[p];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(c=p),g.route.id){let{loaderData:A,errors:v}=t,x=g.route.loader&&!A.hasOwnProperty(g.route.id)&&(!v||v[g.route.id]===void 0);if(g.route.lazy||x){o=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}let h=t&&i?(p,g)=>{i(p,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:eV(t.matches),errorInfo:g})}:void 0;return s.reduceRight((p,g,A)=>{let v,x=!1,S=null,_=null;t&&(v=a&&g.route.id?a[g.route.id]:void 0,S=g.route.errorElement||pV,o&&(c<0&&A===0?(Rk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,_=null):c===A&&(x=!0,_=g.route.hydrateFallbackElement||null)));let E=e.concat(s.slice(0,A+1)),C=()=>{let T;return v?T=S:x?T=_:g.route.Component?T=X.createElement(g.route.Component,null):g.route.element?T=g.route.element:T=p,X.createElement(gV,{match:g,routeContext:{outlet:p,matches:E,isDataRoute:t!=null},children:T})};return t&&(g.route.ErrorBoundary||g.route.errorElement||A===0)?X.createElement(Ik,{location:t.location,revalidation:t.revalidation,component:S,error:v,children:C(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:h}):C()},null)}function q2(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vV(n){let e=X.useContext(nv);return Qr(e,q2(n)),e}function yV(n){let e=X.useContext(uM);return Qr(e,q2(n)),e}function bV(n){let e=X.useContext(Sf);return Qr(e,q2(n)),e}function X2(n){let e=bV(n),t=e.matches[e.matches.length-1];return Qr(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function xV(){return X2("useRouteId")}function _V(){let n=X.useContext(W2),e=yV("useRouteError"),t=X2("useRouteError");return n!==void 0?n:e.errors?.[t]}function SV(){let{router:n}=vV("useNavigate"),e=X2("useNavigate"),t=X.useRef(!1);return Ck(()=>{t.current=!0}),X.useCallback(async(r,s={})=>{Ju(t.current,Mk),t.current&&(typeof r=="number"?await n.navigate(r):await n.navigate(r,{fromRouteId:e,...s}))},[n,e])}var oL={};function Rk(n,e,t){!e&&!oL[n]&&(oL[n]=!0,Ju(!1,t))}X.memo(EV);function EV({routes:n,future:e,state:t,onError:i}){return Tk(n,void 0,t,i,e)}function CR(n){Qr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function wV({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:r,static:s=!1,unstable_useTransitions:a}){Qr(!qb(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=n.replace(/^\/*/,"/"),c=X.useMemo(()=>({basename:o,navigator:r,static:s,unstable_useTransitions:a,future:{}}),[o,r,s,a]);typeof t=="string"&&(t=tv(t));let{pathname:h="/",search:p="",hash:g="",state:A=null,key:v="default"}=t,x=X.useMemo(()=>{let S=pf(h,o);return S==null?null:{location:{pathname:S,search:p,hash:g,state:A,key:v},navigationType:i}},[o,h,p,g,A,v,i]);return Ju(x!=null,`<Router basename="${o}"> is not able to match the URL "${h}${p}${g}" because it does not start with the basename, so the <Router> won't render anything.`),x==null?null:X.createElement(fc.Provider,{value:c},X.createElement(Wb.Provider,{children:e,value:x}))}function MV({children:n,location:e}){return fV(TR(n),e)}function TR(n,e=[]){let t=[];return X.Children.forEach(n,(i,r)=>{if(!X.isValidElement(i))return;let s=[...e,r];if(i.type===X.Fragment){t.push.apply(t,TR(i.props.children,s));return}Qr(i.type===CR,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qr(!i.props.index||!i.props.children,"An index route cannot have child routes.");let a={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=TR(i.props.children,s)),t.push(a)}),t}var kE="get",zE="application/x-www-form-urlencoded";function hM(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function CV(n){return hM(n)&&n.tagName.toLowerCase()==="button"}function TV(n){return hM(n)&&n.tagName.toLowerCase()==="form"}function IV(n){return hM(n)&&n.tagName.toLowerCase()==="input"}function RV(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function BV(n,e){return n.button===0&&(!e||e==="_self")&&!RV(n)}var nS=null;function DV(){if(nS===null)try{new FormData(document.createElement("form"),0),nS=!1}catch{nS=!0}return nS}var LV=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function T3(n){return n!=null&&!LV.has(n)?(Ju(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${zE}"`),null):n}function NV(n,e){let t,i,r,s,a;if(TV(n)){let o=n.getAttribute("action");i=o?pf(o,e):null,t=n.getAttribute("method")||kE,r=T3(n.getAttribute("enctype"))||zE,s=new FormData(n)}else if(CV(n)||IV(n)&&(n.type==="submit"||n.type==="image")){let o=n.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=n.getAttribute("formaction")||o.getAttribute("action");if(i=c?pf(c,e):null,t=n.getAttribute("formmethod")||o.getAttribute("method")||kE,r=T3(n.getAttribute("formenctype"))||T3(o.getAttribute("enctype"))||zE,s=new FormData(o,n),!DV()){let{name:h,type:p,value:g}=n;if(p==="image"){let A=h?`${h}.`:"";s.append(`${A}x`,"0"),s.append(`${A}y`,"0")}else h&&s.append(h,g)}}else{if(hM(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=kE,i=null,r=zE,a=n}return s&&r==="text/plain"&&(a=s,s=void 0),{action:i,method:t.toLowerCase(),encType:r,formData:s,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Y2(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function UV(n,e,t,i){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?r.pathname.endsWith("/")?r.pathname=`${r.pathname}_.${i}`:r.pathname=`${r.pathname}.${i}`:r.pathname==="/"?r.pathname=`_root.${i}`:e&&pf(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${i}`,r}async function FV(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function PV(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function OV(n,e,t){let i=await Promise.all(n.map(async r=>{let s=e.routes[r.route.id];if(s){let a=await FV(s,t);return a.links?a.links():[]}return[]}));return HV(i.flat(1).filter(PV).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function lL(n,e,t,i,r,s){let a=(c,h)=>t[h]?c.route.id!==t[h].route.id:!0,o=(c,h)=>t[h].pathname!==c.pathname||t[h].route.path?.endsWith("*")&&t[h].params["*"]!==c.params["*"];return s==="assets"?e.filter((c,h)=>a(c,h)||o(c,h)):s==="data"?e.filter((c,h)=>{let p=i.routes[c.route.id];if(!p||!p.hasLoader)return!1;if(a(c,h)||o(c,h))return!0;if(c.route.shouldRevalidate){let g=c.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function kV(n,e,{includeHydrateFallback:t}={}){return zV(n.map(i=>{let r=e.routes[i.route.id];if(!r)return[];let s=[r.module];return r.clientActionModule&&(s=s.concat(r.clientActionModule)),r.clientLoaderModule&&(s=s.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(s=s.concat(r.hydrateFallbackModule)),r.imports&&(s=s.concat(r.imports)),s}).flat(1))}function zV(n){return[...new Set(n)]}function GV(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function HV(n,e){let t=new Set;return new Set(e),n.reduce((i,r)=>{let s=JSON.stringify(GV(r));return t.has(s)||(t.add(s),i.push({key:s,link:r})),i},[])}function Bk(){let n=X.useContext(nv);return Y2(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function QV(){let n=X.useContext(uM);return Y2(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var K2=X.createContext(void 0);K2.displayName="FrameworkContext";function Dk(){let n=X.useContext(K2);return Y2(n,"You must render this element inside a <HydratedRouter> element"),n}function VV(n,e){let t=X.useContext(K2),[i,r]=X.useState(!1),[s,a]=X.useState(!1),{onFocus:o,onBlur:c,onMouseEnter:h,onMouseLeave:p,onTouchStart:g}=e,A=X.useRef(null);X.useEffect(()=>{if(n==="render"&&a(!0),n==="viewport"){let S=E=>{E.forEach(C=>{a(C.isIntersecting)})},_=new IntersectionObserver(S,{threshold:.5});return A.current&&_.observe(A.current),()=>{_.disconnect()}}},[n]),X.useEffect(()=>{if(i){let S=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(S)}}},[i]);let v=()=>{r(!0)},x=()=>{r(!1),a(!1)};return t?n!=="intent"?[s,A,{}]:[s,A,{onFocus:Yy(o,v),onBlur:Yy(c,x),onMouseEnter:Yy(h,v),onMouseLeave:Yy(p,x),onTouchStart:Yy(g,v)}]:[!1,A,{}]}function Yy(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function jV({page:n,...e}){let{router:t}=Bk(),i=X.useMemo(()=>gk(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?X.createElement(qV,{page:n,matches:i,...e}):null}function WV(n){let{manifest:e,routeModules:t}=Dk(),[i,r]=X.useState([]);return X.useEffect(()=>{let s=!1;return OV(n,e,t).then(a=>{s||r(a)}),()=>{s=!0}},[n,e,t]),i}function qV({page:n,matches:e,...t}){let i=sg(),{future:r,manifest:s,routeModules:a}=Dk(),{basename:o}=Bk(),{loaderData:c,matches:h}=QV(),p=X.useMemo(()=>lL(n,e,h,s,i,"data"),[n,e,h,s,i]),g=X.useMemo(()=>lL(n,e,h,s,i,"assets"),[n,e,h,s,i]),A=X.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let S=new Set,_=!1;if(e.forEach(C=>{let T=s.routes[C.route.id];!T||!T.hasLoader||(!p.some(R=>R.route.id===C.route.id)&&C.route.id in c&&a[C.route.id]?.shouldRevalidate||T.hasClientLoader?_=!0:S.add(C.route.id))}),S.size===0)return[];let E=UV(n,o,r.unstable_trailingSlashAwareDataRequests,"data");return _&&S.size>0&&E.searchParams.set("_routes",e.filter(C=>S.has(C.route.id)).map(C=>C.route.id).join(",")),[E.pathname+E.search]},[o,r.unstable_trailingSlashAwareDataRequests,c,i,s,p,e,n,a]),v=X.useMemo(()=>kV(g,s),[g,s]),x=WV(g);return X.createElement(X.Fragment,null,A.map(S=>X.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),v.map(S=>X.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),x.map(({key:S,link:_})=>X.createElement("link",{key:S,nonce:t.nonce,..._,crossOrigin:_.crossOrigin??t.crossOrigin})))}function XV(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var YV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{YV&&(window.__reactRouterVersion="7.13.0")}catch{}function KV({basename:n,children:e,unstable_useTransitions:t,window:i}){let r=X.useRef();r.current==null&&(r.current=IQ({window:i,v5Compat:!0}));let s=r.current,[a,o]=X.useState({action:s.action,location:s.location}),c=X.useCallback(h=>{t===!1?o(h):X.startTransition(()=>o(h))},[t]);return X.useLayoutEffect(()=>s.listen(c),[s,c]),X.createElement(wV,{basename:n,children:e,location:a.location,navigationType:a.action,navigator:s,unstable_useTransitions:t})}var Lk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nh=X.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:r,reloadDocument:s,replace:a,state:o,target:c,to:h,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:A,...v},x){let{basename:S,unstable_useTransitions:_}=X.useContext(fc),E=typeof h=="string"&&Lk.test(h),C=_k(h,S);h=C.to;let T=cV(h,{relative:r}),[R,B,U]=VV(i,v),O=ej(h,{replace:a,state:o,target:c,preventScrollReset:p,relative:r,viewTransition:g,unstable_defaultShouldRevalidate:A,unstable_useTransitions:_});function F(P){e&&e(P),P.defaultPrevented||O(P)}let L=X.createElement("a",{...v,...U,href:C.absoluteURL||T,onClick:C.isExternal||s?e:F,ref:XV(x,B),target:c,"data-discover":!E&&t==="render"?"true":void 0});return R&&!E?X.createElement(X.Fragment,null,L,X.createElement(jV,{page:T})):L});nh.displayName="Link";var $V=X.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:r=!1,style:s,to:a,viewTransition:o,children:c,...h},p){let g=Xb(a,{relative:h.relative}),A=sg(),v=X.useContext(uM),{navigator:x,basename:S}=X.useContext(fc),_=v!=null&&sj(g)&&o===!0,E=x.encodeLocation?x.encodeLocation(g).pathname:g.pathname,C=A.pathname,T=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(C=C.toLowerCase(),T=T?T.toLowerCase():null,E=E.toLowerCase()),T&&S&&(T=pf(T,S)||T);const R=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let B=C===E||!r&&C.startsWith(E)&&C.charAt(R)==="/",U=T!=null&&(T===E||!r&&T.startsWith(E)&&T.charAt(E.length)==="/"),O={isActive:B,isPending:U,isTransitioning:_},F=B?e:void 0,L;typeof i=="function"?L=i(O):L=[i,B?"active":null,U?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let P=typeof s=="function"?s(O):s;return X.createElement(nh,{...h,"aria-current":F,className:L,ref:p,style:P,to:a,viewTransition:o},typeof c=="function"?c(O):c)});$V.displayName="NavLink";var JV=X.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:r,state:s,method:a=kE,action:o,onSubmit:c,relative:h,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:A,...v},x)=>{let{unstable_useTransitions:S}=X.useContext(fc),_=ij(),E=rj(o,{relative:h}),C=a.toLowerCase()==="get"?"get":"post",T=typeof o=="string"&&Lk.test(o),R=B=>{if(c&&c(B),B.defaultPrevented)return;B.preventDefault();let U=B.nativeEvent.submitter,O=U?.getAttribute("formmethod")||a,F=()=>_(U||B.currentTarget,{fetcherKey:e,method:O,navigate:t,replace:r,state:s,relative:h,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:A});S&&t!==!1?X.startTransition(()=>F()):F()};return X.createElement("form",{ref:x,method:C,action:E,onSubmit:i?c:R,...v,"data-discover":!T&&n==="render"?"true":void 0})});JV.displayName="Form";function ZV(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Nk(n){let e=X.useContext(nv);return Qr(e,ZV(n)),e}function ej(n,{target:e,replace:t,state:i,preventScrollReset:r,relative:s,viewTransition:a,unstable_defaultShouldRevalidate:o,unstable_useTransitions:c}={}){let h=uV(),p=sg(),g=Xb(n,{relative:s});return X.useCallback(A=>{if(BV(A,e)){A.preventDefault();let v=t!==void 0?t:hb(p)===hb(g),x=()=>h(n,{replace:v,state:i,preventScrollReset:r,relative:s,viewTransition:a,unstable_defaultShouldRevalidate:o});c?X.startTransition(()=>x()):x()}},[p,h,g,t,i,e,n,r,s,a,o,c])}var tj=0,nj=()=>`__${String(++tj)}__`;function ij(){let{router:n}=Nk("useSubmit"),{basename:e}=X.useContext(fc),t=xV(),i=n.fetch,r=n.navigate;return X.useCallback(async(s,a={})=>{let{action:o,method:c,encType:h,formData:p,body:g}=NV(s,e);if(a.navigate===!1){let A=a.fetcherKey||nj();await i(A,t,a.action||o,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:p,body:g,formMethod:a.method||c,formEncType:a.encType||h,flushSync:a.flushSync})}else await r(a.action||o,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:p,body:g,formMethod:a.method||c,formEncType:a.encType||h,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[i,r,e,t])}function rj(n,{relative:e}={}){let{basename:t}=X.useContext(fc),i=X.useContext(Sf);Qr(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),s={...Xb(n||".",{relative:e})},a=sg();if(n==null){s.search=a.search;let o=new URLSearchParams(s.search),c=o.getAll("index");if(c.some(p=>p==="")){o.delete("index"),c.filter(g=>g).forEach(g=>o.append("index",g));let p=o.toString();s.search=p?`?${p}`:""}}return(!n||n===".")&&r.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:cf([t,s.pathname])),hb(s)}function sj(n,{relative:e}={}){let t=X.useContext(Ek);Qr(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Nk("useViewTransitionState"),r=Xb(n,{relative:e});if(!t.isTransitioning)return!1;let s=pf(t.currentLocation.pathname,i)||t.currentLocation.pathname,a=pf(t.nextLocation.pathname,i)||t.nextLocation.pathname;return sw(r.pathname,a)!=null||sw(r.pathname,s)!=null}const aj="modulepreload",oj=function(n){return"/ar-lab/"+n},cL={},Uk=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let c=function(h){return Promise.all(h.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");r=c(t.map(h=>{if(h=oj(h),h in cL)return;cL[h]=!0;const p=h.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const A=document.createElement("link");if(A.rel=p?"stylesheet":aj,p||(A.as="script"),A.crossOrigin="",A.href=h,o&&A.setAttribute("nonce",o),document.head.appendChild(A),p)return new Promise((v,x)=>{A.addEventListener("load",v),A.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};const GE=globalThis,$2=GE.ShadowRoot&&(GE.ShadyCSS===void 0||GE.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Fk=Symbol(),uL=new WeakMap;let lj=class{constructor(e,t,i){if(this._$cssResult$=!0,i!==Fk)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if($2&&e===void 0){const i=t!==void 0&&t.length===1;i&&(e=uL.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&uL.set(t,e))}return e}toString(){return this.cssText}};const cj=n=>new lj(typeof n=="string"?n:n+"",void 0,Fk),uj=(n,e)=>{if($2)n.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const i=document.createElement("style"),r=GE.litNonce;r!==void 0&&i.setAttribute("nonce",r),i.textContent=t.cssText,n.appendChild(i)}},hL=$2?n=>n:n=>n instanceof CSSStyleSheet?(e=>{let t="";for(const i of e.cssRules)t+=i.cssText;return cj(t)})(n):n;const{is:hj,defineProperty:fj,getOwnPropertyDescriptor:dj,getOwnPropertyNames:pj,getOwnPropertySymbols:mj,getPrototypeOf:gj}=Object,fM=globalThis,fL=fM.trustedTypes,Aj=fL?fL.emptyScript:"",vj=fM.reactiveElementPolyfillSupport,$1=(n,e)=>n,aw={toAttribute(n,e){switch(e){case Boolean:n=n?Aj:null;break;case Object:case Array:n=n==null?n:JSON.stringify(n)}return n},fromAttribute(n,e){let t=n;switch(e){case Boolean:t=n!==null;break;case Number:t=n===null?null:Number(n);break;case Object:case Array:try{t=JSON.parse(n)}catch{t=null}}return t}},J2=(n,e)=>!hj(n,e),dL={attribute:!0,type:String,converter:aw,reflect:!1,useDefault:!1,hasChanged:J2};Symbol.metadata??=Symbol("metadata"),fM.litPropertyMetadata??=new WeakMap;let dm=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=dL){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const i=Symbol(),r=this.getPropertyDescriptor(e,i,t);r!==void 0&&fj(this.prototype,e,r)}}static getPropertyDescriptor(e,t,i){const{get:r,set:s}=dj(this.prototype,e)??{get(){return this[t]},set(a){this[t]=a}};return{get:r,set(a){const o=r?.call(this);s?.call(this,a),this.requestUpdate(e,o,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??dL}static _$Ei(){if(this.hasOwnProperty($1("elementProperties")))return;const e=gj(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty($1("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty($1("properties"))){const t=this.properties,i=[...pj(t),...mj(t)];for(const r of i)this.createProperty(r,t[r])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[i,r]of t)this.elementProperties.set(i,r)}this._$Eh=new Map;for(const[t,i]of this.elementProperties){const r=this._$Eu(t,i);r!==void 0&&this._$Eh.set(r,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const r of i)t.unshift(hL(r))}else e!==void 0&&t.push(hL(e));return t}static _$Eu(e,t){const i=t.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const i of t.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return uj(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,i){this._$AK(e,i)}_$ET(e,t){const i=this.constructor.elementProperties.get(e),r=this.constructor._$Eu(e,i);if(r!==void 0&&i.reflect===!0){const s=(i.converter?.toAttribute!==void 0?i.converter:aw).toAttribute(t,i.type);this._$Em=e,s==null?this.removeAttribute(r):this.setAttribute(r,s),this._$Em=null}}_$AK(e,t){const i=this.constructor,r=i._$Eh.get(e);if(r!==void 0&&this._$Em!==r){const s=i.getPropertyOptions(r),a=typeof s.converter=="function"?{fromAttribute:s.converter}:s.converter?.fromAttribute!==void 0?s.converter:aw;this._$Em=r;const o=a.fromAttribute(t,s.type);this[r]=o??this._$Ej?.get(r)??o,this._$Em=null}}requestUpdate(e,t,i,r=!1,s){if(e!==void 0){const a=this.constructor;if(r===!1&&(s=this[e]),i??=a.getPropertyOptions(e),!((i.hasChanged??J2)(s,t)||i.useDefault&&i.reflect&&s===this._$Ej?.get(e)&&!this.hasAttribute(a._$Eu(e,i))))return;this.C(e,t,i)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,t,{useDefault:i,reflect:r,wrapped:s},a){i&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,a??t??this[e]),s!==!0||a!==void 0)||(this._$AL.has(e)||(this.hasUpdated||i||(t=void 0),this._$AL.set(e,t)),r===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[r,s]of this._$Ep)this[r]=s;this._$Ep=void 0}const i=this.constructor.elementProperties;if(i.size>0)for(const[r,s]of i){const{wrapped:a}=s,o=this[r];a!==!0||this._$AL.has(r)||o===void 0||this.C(r,void 0,s,o)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach(i=>i.hostUpdate?.()),this.update(t)):this._$EM()}catch(i){throw e=!1,this._$EM(),i}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(t=>this._$ET(t,this[t])),this._$EM()}updated(e){}firstUpdated(e){}};dm.elementStyles=[],dm.shadowRootOptions={mode:"open"},dm[$1("elementProperties")]=new Map,dm[$1("finalized")]=new Map,vj?.({ReactiveElement:dm}),(fM.reactiveElementVersions??=[]).push("2.1.2");const yj={attribute:!0,type:String,converter:aw,reflect:!1,hasChanged:J2},bj=(n=yj,e,t)=>{const{kind:i,metadata:r}=t;let s=globalThis.litPropertyMetadata.get(r);if(s===void 0&&globalThis.litPropertyMetadata.set(r,s=new Map),i==="setter"&&((n=Object.create(n)).wrapped=!0),s.set(t.name,n),i==="accessor"){const{name:a}=t;return{set(o){const c=e.get.call(this);e.set.call(this,o),this.requestUpdate(a,c,n,!0,o)},init(o){return o!==void 0&&this.C(a,void 0,n,o),o}}}if(i==="setter"){const{name:a}=t;return function(o){const c=this[a];e.call(this,o),this.requestUpdate(a,c,n,!0,o)}}throw Error("Unsupported decorator location: "+i)};function wn(n){return(e,t)=>typeof t=="object"?bj(n,e,t):((i,r,s)=>{const a=r.hasOwnProperty(s);return r.constructor.createProperty(s,i),a?Object.getOwnPropertyDescriptor(r,s):void 0})(n,e,t)}const ag="182",xj={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},_j={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Pk=0,IR=1,Ok=2,Sj=3,kk=0,h0=1,J1=2,mm=3,cc=0,ia=1,gi=2,lc=0,Em=1,RR=2,BR=3,DR=4,zk=5,Md=100,Gk=101,Hk=102,Qk=103,Vk=104,jk=200,Wk=201,qk=202,Xk=203,ow=204,lw=205,Yk=206,Kk=207,$k=208,Jk=209,Zk=210,e8=211,t8=212,n8=213,i8=214,cw=0,uw=1,hw=2,Fm=3,fw=4,dw=5,pw=6,mw=7,Yb=0,r8=1,s8=2,ko=0,dM=1,pM=2,mM=3,Kb=4,Z2=5,gM=6,Pm=7,LR="attached",a8="detached",Hd=300,jc=301,Qd=302,Om=303,fb=304,iv=306,hl=1e3,or=1001,mf=1002,Ri=1003,Kd=1004,Ej=1004,Wu=1005,wj=1005,mn=1006,uf=1007,Mj=1007,ya=1008,NR=1008,xn=1009,AM=1010,vM=1011,_0=1012,$b=1013,fl=1014,Si=1015,ci=1016,yM=1017,bM=1018,S0=1020,Jb=35902,Zb=35899,e4=1021,E0=1022,Fi=1023,Zu=1026,Bd=1027,qu=1028,ex=1029,ac=1030,xM=1031,Cj=1032,_M=1033,wm=33776,Ud=33777,Mm=33778,f0=33779,db=35840,gw=35841,km=35842,w0=35843,pb=36196,M0=37492,C0=37496,mb=37488,gb=37489,Ab=37490,vb=37491,Fd=37808,Aw=37809,vw=37810,yw=37811,Cm=37812,bw=37813,xw=37814,_w=37815,Sw=37816,Ew=37817,ww=37818,Mw=37819,Cw=37820,Tw=37821,zm=36492,Iw=36494,yb=36495,bb=36283,xb=36284,_b=36285,Sb=36286,T0=2200,Tm=2201,Eb=2202,Gm=2300,Hm=2301,HE=2302,gm=2400,Am=2401,wb=2402,SM=2500,t4=2501,o8=0,n4=1,Rw=2,l8=3200,c8=3201,Tj=3202,Ij=3203,$d=0,u8=1,nl="",xi="srgb",Xi="srgb-linear",Mb="linear",Ui="srgb",Rj="",Bj="rg",Dj="ga",Lj=0,om=7680,Nj=7681,Uj=7682,Fj=7683,Pj=34055,Oj=34056,kj=5386,zj=512,Gj=513,Hj=514,Qj=515,Vj=516,jj=517,Wj=518,UR=519,h8=512,f8=513,d8=514,EM=515,p8=516,m8=517,wM=518,g8=519,Cb=35044,qj=35048,Xj=35040,Yj=35045,Kj=35049,$j=35041,Jj=35046,Zj=35050,eW=35042,tW="100",FR="300 es",rl=2e3,I0=2001,nW={COMPUTE:"compute",RENDER:"render"},iW={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},rW={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function A8(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const sW={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function a0(n,e){return new sW[n](e)}function v8(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Tb(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function y8(){const n=Tb("canvas");return n.style.display="block",n}const pL={};let Vd=null;function aW(n){Vd=n}function oW(){return Vd}function Ib(...n){const e="THREE."+n.shift();Vd?Vd("log",e,...n):console.log(e,...n)}function Gt(...n){const e="THREE."+n.shift();Vd?Vd("warn",e,...n):console.warn(e,...n)}function on(...n){const e="THREE."+n.shift();Vd?Vd("error",e,...n):console.error(e,...n)}function R0(...n){const e=n.join(" ");e in pL||(pL[e]=!0,Gt(...n))}function lW(n,e,t){return new Promise(function(i,r){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:i()}}setTimeout(s,t)})}class zo{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){const i=this._listeners;if(i===void 0)return;const r=i[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const i=t[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}const La=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let mL=1234567;const Im=Math.PI/180,B0=180/Math.PI;function ol(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(La[n&255]+La[n>>8&255]+La[n>>16&255]+La[n>>24&255]+"-"+La[e&255]+La[e>>8&255]+"-"+La[e>>16&15|64]+La[e>>24&255]+"-"+La[t&63|128]+La[t>>8&255]+"-"+La[t>>16&255]+La[t>>24&255]+La[i&255]+La[i>>8&255]+La[i>>16&255]+La[i>>24&255]).toLowerCase()}function Mn(n,e,t){return Math.max(e,Math.min(t,n))}function i4(n,e){return(n%e+e)%e}function cW(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function uW(n,e,t){return n!==e?(t-n)/(e-n):0}function Z1(n,e,t){return(1-t)*n+t*e}function hW(n,e,t,i){return Z1(n,e,1-Math.exp(-t*i))}function fW(n,e=1){return e-Math.abs(i4(n,e*2)-e)}function dW(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function pW(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function mW(n,e){return n+Math.floor(Math.random()*(e-n+1))}function gW(n,e){return n+Math.random()*(e-n)}function AW(n){return n*(.5-Math.random())}function vW(n){n!==void 0&&(mL=n);let e=mL+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function yW(n){return n*Im}function bW(n){return n*B0}function xW(n){return(n&n-1)===0&&n!==0}function _W(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function SW(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function EW(n,e,t,i,r){const s=Math.cos,a=Math.sin,o=s(t/2),c=a(t/2),h=s((e+i)/2),p=a((e+i)/2),g=s((e-i)/2),A=a((e-i)/2),v=s((i-e)/2),x=a((i-e)/2);switch(r){case"XYX":n.set(o*p,c*g,c*A,o*h);break;case"YZY":n.set(c*A,o*p,c*g,o*h);break;case"ZXZ":n.set(c*g,c*A,o*p,o*h);break;case"XZX":n.set(o*p,c*x,c*v,o*h);break;case"YXY":n.set(c*v,o*p,c*x,o*h);break;case"ZYZ":n.set(c*x,c*v,o*p,o*h);break;default:Gt("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function oo(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function zn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const D0={DEG2RAD:Im,RAD2DEG:B0,generateUUID:ol,clamp:Mn,euclideanModulo:i4,mapLinear:cW,inverseLerp:uW,lerp:Z1,damp:hW,pingpong:fW,smoothstep:dW,smootherstep:pW,randInt:mW,randFloat:gW,randFloatSpread:AW,seededRandom:vW,degToRad:yW,radToDeg:bW,isPowerOfTwo:xW,ceilPowerOfTwo:_W,floorPowerOfTwo:SW,setQuaternionFromProperEuler:EW,normalize:zn,denormalize:oo};class Ze{constructor(e=0,t=0){Ze.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Mn(this.x,e.x,t.x),this.y=Mn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Mn(this.x,e,t),this.y=Mn(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Mn(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Mn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*i-a*r+e.x,this.y=s*r+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Bi{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,a,o){let c=i[r+0],h=i[r+1],p=i[r+2],g=i[r+3],A=s[a+0],v=s[a+1],x=s[a+2],S=s[a+3];if(o<=0){e[t+0]=c,e[t+1]=h,e[t+2]=p,e[t+3]=g;return}if(o>=1){e[t+0]=A,e[t+1]=v,e[t+2]=x,e[t+3]=S;return}if(g!==S||c!==A||h!==v||p!==x){let _=c*A+h*v+p*x+g*S;_<0&&(A=-A,v=-v,x=-x,S=-S,_=-_);let E=1-o;if(_<.9995){const C=Math.acos(_),T=Math.sin(C);E=Math.sin(E*C)/T,o=Math.sin(o*C)/T,c=c*E+A*o,h=h*E+v*o,p=p*E+x*o,g=g*E+S*o}else{c=c*E+A*o,h=h*E+v*o,p=p*E+x*o,g=g*E+S*o;const C=1/Math.sqrt(c*c+h*h+p*p+g*g);c*=C,h*=C,p*=C,g*=C}}e[t]=c,e[t+1]=h,e[t+2]=p,e[t+3]=g}static multiplyQuaternionsFlat(e,t,i,r,s,a){const o=i[r],c=i[r+1],h=i[r+2],p=i[r+3],g=s[a],A=s[a+1],v=s[a+2],x=s[a+3];return e[t]=o*x+p*g+c*v-h*A,e[t+1]=c*x+p*A+h*g-o*v,e[t+2]=h*x+p*v+o*A-c*g,e[t+3]=p*x-o*g-c*A-h*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,a=e._order,o=Math.cos,c=Math.sin,h=o(i/2),p=o(r/2),g=o(s/2),A=c(i/2),v=c(r/2),x=c(s/2);switch(a){case"XYZ":this._x=A*p*g+h*v*x,this._y=h*v*g-A*p*x,this._z=h*p*x+A*v*g,this._w=h*p*g-A*v*x;break;case"YXZ":this._x=A*p*g+h*v*x,this._y=h*v*g-A*p*x,this._z=h*p*x-A*v*g,this._w=h*p*g+A*v*x;break;case"ZXY":this._x=A*p*g-h*v*x,this._y=h*v*g+A*p*x,this._z=h*p*x+A*v*g,this._w=h*p*g-A*v*x;break;case"ZYX":this._x=A*p*g-h*v*x,this._y=h*v*g+A*p*x,this._z=h*p*x-A*v*g,this._w=h*p*g+A*v*x;break;case"YZX":this._x=A*p*g+h*v*x,this._y=h*v*g+A*p*x,this._z=h*p*x-A*v*g,this._w=h*p*g-A*v*x;break;case"XZY":this._x=A*p*g-h*v*x,this._y=h*v*g-A*p*x,this._z=h*p*x+A*v*g,this._w=h*p*g+A*v*x;break;default:Gt("Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],a=t[1],o=t[5],c=t[9],h=t[2],p=t[6],g=t[10],A=i+o+g;if(A>0){const v=.5/Math.sqrt(A+1);this._w=.25/v,this._x=(p-c)*v,this._y=(s-h)*v,this._z=(a-r)*v}else if(i>o&&i>g){const v=2*Math.sqrt(1+i-o-g);this._w=(p-c)/v,this._x=.25*v,this._y=(r+a)/v,this._z=(s+h)/v}else if(o>g){const v=2*Math.sqrt(1+o-i-g);this._w=(s-h)/v,this._x=(r+a)/v,this._y=.25*v,this._z=(c+p)/v}else{const v=2*Math.sqrt(1+g-i-o);this._w=(a-r)/v,this._x=(s+h)/v,this._y=(c+p)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<1e-8?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Mn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,a=e._w,o=t._x,c=t._y,h=t._z,p=t._w;return this._x=i*p+a*o+r*h-s*c,this._y=r*p+a*c+s*o-i*h,this._z=s*p+a*h+i*c-r*o,this._w=a*p-i*o-r*c-s*h,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let i=e._x,r=e._y,s=e._z,a=e._w,o=this.dot(e);o<0&&(i=-i,r=-r,s=-s,a=-a,o=-o);let c=1-t;if(o<.9995){const h=Math.acos(o),p=Math.sin(h);c=Math.sin(c*h)/p,t=Math.sin(t*h)/p,this._x=this._x*c+i*t,this._y=this._y*c+r*t,this._z=this._z*c+s*t,this._w=this._w*c+a*t,this._onChangeCallback()}else this._x=this._x*c+i*t,this._y=this._y*c+r*t,this._z=this._z*c+s*t,this._w=this._w*c+a*t,this.normalize();return this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ee{constructor(e=0,t=0,i=0){ee.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(gL.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(gL.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,a=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*a,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*a,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*a,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,a=e.y,o=e.z,c=e.w,h=2*(a*r-o*i),p=2*(o*t-s*r),g=2*(s*i-a*t);return this.x=t+c*h+a*g-o*p,this.y=i+c*p+o*h-s*g,this.z=r+c*g+s*p-a*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Mn(this.x,e.x,t.x),this.y=Mn(this.y,e.y,t.y),this.z=Mn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Mn(this.x,e,t),this.y=Mn(this.y,e,t),this.z=Mn(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Mn(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,a=t.x,o=t.y,c=t.z;return this.x=r*c-s*o,this.y=s*a-i*c,this.z=i*o-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return I3.copy(this).projectOnVector(e),this.sub(I3)}reflect(e){return this.sub(I3.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Mn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const I3=new ee,gL=new Bi;class Rn{constructor(e,t,i,r,s,a,o,c,h){Rn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,a,o,c,h)}set(e,t,i,r,s,a,o,c,h){const p=this.elements;return p[0]=e,p[1]=r,p[2]=o,p[3]=t,p[4]=s,p[5]=c,p[6]=i,p[7]=a,p[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,a=i[0],o=i[3],c=i[6],h=i[1],p=i[4],g=i[7],A=i[2],v=i[5],x=i[8],S=r[0],_=r[3],E=r[6],C=r[1],T=r[4],R=r[7],B=r[2],U=r[5],O=r[8];return s[0]=a*S+o*C+c*B,s[3]=a*_+o*T+c*U,s[6]=a*E+o*R+c*O,s[1]=h*S+p*C+g*B,s[4]=h*_+p*T+g*U,s[7]=h*E+p*R+g*O,s[2]=A*S+v*C+x*B,s[5]=A*_+v*T+x*U,s[8]=A*E+v*R+x*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],h=e[7],p=e[8];return t*a*p-t*o*h-i*s*p+i*o*c+r*s*h-r*a*c}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],h=e[7],p=e[8],g=p*a-o*h,A=o*c-p*s,v=h*s-a*c,x=t*g+i*A+r*v;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const S=1/x;return e[0]=g*S,e[1]=(r*h-p*i)*S,e[2]=(o*i-r*a)*S,e[3]=A*S,e[4]=(p*t-r*c)*S,e[5]=(r*s-o*t)*S,e[6]=v*S,e[7]=(i*c-h*t)*S,e[8]=(a*t-i*s)*S,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,a,o){const c=Math.cos(s),h=Math.sin(s);return this.set(i*c,i*h,-i*(c*a+h*o)+a+e,-r*h,r*c,-r*(-h*a+c*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(R3.makeScale(e,t)),this}rotate(e){return this.premultiply(R3.makeRotation(-e)),this}translate(e,t){return this.premultiply(R3.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const R3=new Rn,AL=new Rn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),vL=new Rn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function wW(){const n={enabled:!0,workingColorSpace:Xi,spaces:{},convert:function(r,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===Ui&&(r.r=hf(r.r),r.g=hf(r.g),r.b=hf(r.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Ui&&(r.r=d0(r.r),r.g=d0(r.g),r.b=d0(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===nl?Mb:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,a){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return R0("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),n.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return R0("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),n.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[Xi]:{primaries:e,whitePoint:i,transfer:Mb,toXYZ:AL,fromXYZ:vL,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:xi},outputColorSpaceConfig:{drawingBufferColorSpace:xi}},[xi]:{primaries:e,whitePoint:i,transfer:Ui,toXYZ:AL,fromXYZ:vL,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:xi}}}),n}const Wn=wW();function hf(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function d0(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let fA;class r4{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{fA===void 0&&(fA=Tb("canvas")),fA.width=e.width,fA.height=e.height;const r=fA.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=fA}return i.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Tb("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=hf(s[a]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(hf(t[i]/255)*255):t[i]=hf(t[i]);return{data:t,width:e.width,height:e.height}}else return Gt("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let MW=0;class of{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:MW++}),this.uuid=ol(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,o=r.length;a<o;a++)r[a].isDataTexture?s.push(B3(r[a].image)):s.push(B3(r[a]))}else s=B3(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function B3(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?r4.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(Gt("Texture: Unable to serialize Texture."),{})}let CW=0;const D3=new ee;let Pi=class QE extends zo{constructor(e=QE.DEFAULT_IMAGE,t=QE.DEFAULT_MAPPING,i=or,r=or,s=mn,a=ya,o=Fi,c=xn,h=QE.DEFAULT_ANISOTROPY,p=nl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:CW++}),this.uuid=ol(),this.name="",this.source=new of(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=h,this.format=o,this.internalFormat=null,this.type=c,this.offset=new Ze(0,0),this.repeat=new Ze(1,1),this.center=new Ze(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Rn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=p,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(D3).x}get height(){return this.source.getSize(D3).y}get depth(){return this.source.getSize(D3).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const i=e[t];if(i===void 0){Gt(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Gt(`Texture.setValues(): property '${t}' does not exist.`);continue}r&&i&&r.isVector2&&i.isVector2||r&&i&&r.isVector3&&i.isVector3||r&&i&&r.isMatrix3&&i.isMatrix3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Hd)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case hl:e.x=e.x-Math.floor(e.x);break;case or:e.x=e.x<0?0:1;break;case mf:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case hl:e.y=e.y-Math.floor(e.y);break;case or:e.y=e.y<0?0:1;break;case mf:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};Pi.DEFAULT_IMAGE=null;Pi.DEFAULT_MAPPING=Hd;Pi.DEFAULT_ANISOTROPY=1;class Ii{constructor(e=0,t=0,i=0,r=1){Ii.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*r+a[12]*s,this.y=a[1]*t+a[5]*i+a[9]*r+a[13]*s,this.z=a[2]*t+a[6]*i+a[10]*r+a[14]*s,this.w=a[3]*t+a[7]*i+a[11]*r+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const c=e.elements,h=c[0],p=c[4],g=c[8],A=c[1],v=c[5],x=c[9],S=c[2],_=c[6],E=c[10];if(Math.abs(p-A)<.01&&Math.abs(g-S)<.01&&Math.abs(x-_)<.01){if(Math.abs(p+A)<.1&&Math.abs(g+S)<.1&&Math.abs(x+_)<.1&&Math.abs(h+v+E-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const T=(h+1)/2,R=(v+1)/2,B=(E+1)/2,U=(p+A)/4,O=(g+S)/4,F=(x+_)/4;return T>R&&T>B?T<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(T),r=U/i,s=O/i):R>B?R<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(R),i=U/r,s=F/r):B<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(B),i=O/s,r=F/s),this.set(i,r,s,t),this}let C=Math.sqrt((_-x)*(_-x)+(g-S)*(g-S)+(A-p)*(A-p));return Math.abs(C)<.001&&(C=1),this.x=(_-x)/C,this.y=(g-S)/C,this.z=(A-p)/C,this.w=Math.acos((h+v+E-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Mn(this.x,e.x,t.x),this.y=Mn(this.y,e.y,t.y),this.z=Mn(this.z,e.z,t.z),this.w=Mn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Mn(this.x,e,t),this.y=Mn(this.y,e,t),this.z=Mn(this.z,e,t),this.w=Mn(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Mn(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class s4 extends zo{constructor(e=1,t=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:mn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=i.depth,this.scissor=new Ii(0,0,e,t),this.scissorTest=!1,this.viewport=new Ii(0,0,e,t);const r={width:e,height:t,depth:i.depth},s=new Pi(r);this.textures=[];const a=i.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(e={}){const t={minFilter:mn,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let i=0;i<this.textures.length;i++)this.textures[i].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,i=e.textures.length;t<i;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new of(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Vr extends s4{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class MM extends Pi{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ri,this.minFilter=Ri,this.wrapR=or,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class TW extends Vr{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new MM(null,e,t,i),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class tx extends Pi{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ri,this.minFilter=Ri,this.wrapR=or,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class IW extends Vr{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new tx(null,e,t,i),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class gr{constructor(e=new ee(1/0,1/0,1/0),t=new ee(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Nc.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Nc.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Nc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,Nc):Nc.fromBufferAttribute(s,a),Nc.applyMatrix4(e.matrixWorld),this.expandByPoint(Nc);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),iS.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),iS.copy(i.boundingBox)),iS.applyMatrix4(e.matrixWorld),this.union(iS)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Nc),Nc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ky),rS.subVectors(this.max,Ky),dA.subVectors(e.a,Ky),pA.subVectors(e.b,Ky),mA.subVectors(e.c,Ky),cd.subVectors(pA,dA),ud.subVectors(mA,pA),Op.subVectors(dA,mA);let t=[0,-cd.z,cd.y,0,-ud.z,ud.y,0,-Op.z,Op.y,cd.z,0,-cd.x,ud.z,0,-ud.x,Op.z,0,-Op.x,-cd.y,cd.x,0,-ud.y,ud.x,0,-Op.y,Op.x,0];return!L3(t,dA,pA,mA,rS)||(t=[1,0,0,0,1,0,0,0,1],!L3(t,dA,pA,mA,rS))?!1:(sS.crossVectors(cd,ud),t=[sS.x,sS.y,sS.z],L3(t,dA,pA,mA,rS))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Nc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Nc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Hh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Hh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Hh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Hh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Hh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Hh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Hh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Hh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Hh),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Hh=[new ee,new ee,new ee,new ee,new ee,new ee,new ee,new ee],Nc=new ee,iS=new gr,dA=new ee,pA=new ee,mA=new ee,cd=new ee,ud=new ee,Op=new ee,Ky=new ee,rS=new ee,sS=new ee,kp=new ee;function L3(n,e,t,i,r){for(let s=0,a=n.length-3;s<=a;s+=3){kp.fromArray(n,s);const o=r.x*Math.abs(kp.x)+r.y*Math.abs(kp.y)+r.z*Math.abs(kp.z),c=e.dot(kp),h=t.dot(kp),p=i.dot(kp);if(Math.max(-Math.max(c,h,p),Math.min(c,h,p))>o)return!1}return!0}const RW=new gr,$y=new ee,N3=new ee;class jr{constructor(e=new ee,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):RW.setFromPoints(e).getCenter(i);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;$y.subVectors(e,this.center);const t=$y.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector($y,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(N3.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint($y.copy(e.center).add(N3)),this.expandByPoint($y.copy(e.center).sub(N3))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Qh=new ee,U3=new ee,aS=new ee,hd=new ee,F3=new ee,oS=new ee,P3=new ee;class gf{constructor(e=new ee,t=new ee(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Qh)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Qh.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Qh.copy(this.origin).addScaledVector(this.direction,t),Qh.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){U3.copy(e).add(t).multiplyScalar(.5),aS.copy(t).sub(e).normalize(),hd.copy(this.origin).sub(U3);const s=e.distanceTo(t)*.5,a=-this.direction.dot(aS),o=hd.dot(this.direction),c=-hd.dot(aS),h=hd.lengthSq(),p=Math.abs(1-a*a);let g,A,v,x;if(p>0)if(g=a*c-o,A=a*o-c,x=s*p,g>=0)if(A>=-x)if(A<=x){const S=1/p;g*=S,A*=S,v=g*(g+a*A+2*o)+A*(a*g+A+2*c)+h}else A=s,g=Math.max(0,-(a*A+o)),v=-g*g+A*(A+2*c)+h;else A=-s,g=Math.max(0,-(a*A+o)),v=-g*g+A*(A+2*c)+h;else A<=-x?(g=Math.max(0,-(-a*s+o)),A=g>0?-s:Math.min(Math.max(-s,-c),s),v=-g*g+A*(A+2*c)+h):A<=x?(g=0,A=Math.min(Math.max(-s,-c),s),v=A*(A+2*c)+h):(g=Math.max(0,-(a*s+o)),A=g>0?s:Math.min(Math.max(-s,-c),s),v=-g*g+A*(A+2*c)+h);else A=a>0?-s:s,g=Math.max(0,-(a*A+o)),v=-g*g+A*(A+2*c)+h;return i&&i.copy(this.origin).addScaledVector(this.direction,g),r&&r.copy(U3).addScaledVector(aS,A),v}intersectSphere(e,t){Qh.subVectors(e.center,this.origin);const i=Qh.dot(this.direction),r=Qh.dot(Qh)-i*i,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),o=i-a,c=i+a;return c<0?null:o<0?this.at(c,t):this.at(o,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,a,o,c;const h=1/this.direction.x,p=1/this.direction.y,g=1/this.direction.z,A=this.origin;return h>=0?(i=(e.min.x-A.x)*h,r=(e.max.x-A.x)*h):(i=(e.max.x-A.x)*h,r=(e.min.x-A.x)*h),p>=0?(s=(e.min.y-A.y)*p,a=(e.max.y-A.y)*p):(s=(e.max.y-A.y)*p,a=(e.min.y-A.y)*p),i>a||s>r||((s>i||isNaN(i))&&(i=s),(a<r||isNaN(r))&&(r=a),g>=0?(o=(e.min.z-A.z)*g,c=(e.max.z-A.z)*g):(o=(e.max.z-A.z)*g,c=(e.min.z-A.z)*g),i>c||o>r)||((o>i||i!==i)&&(i=o),(c<r||r!==r)&&(r=c),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,Qh)!==null}intersectTriangle(e,t,i,r,s){F3.subVectors(t,e),oS.subVectors(i,e),P3.crossVectors(F3,oS);let a=this.direction.dot(P3),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;hd.subVectors(this.origin,e);const c=o*this.direction.dot(oS.crossVectors(hd,oS));if(c<0)return null;const h=o*this.direction.dot(F3.cross(hd));if(h<0||c+h>a)return null;const p=-o*hd.dot(P3);return p<0?null:this.at(p/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class qt{constructor(e,t,i,r,s,a,o,c,h,p,g,A,v,x,S,_){qt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,a,o,c,h,p,g,A,v,x,S,_)}set(e,t,i,r,s,a,o,c,h,p,g,A,v,x,S,_){const E=this.elements;return E[0]=e,E[4]=t,E[8]=i,E[12]=r,E[1]=s,E[5]=a,E[9]=o,E[13]=c,E[2]=h,E[6]=p,E[10]=g,E[14]=A,E[3]=v,E[7]=x,E[11]=S,E[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new qt().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),i.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this)}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,i=e.elements,r=1/gA.setFromMatrixColumn(e,0).length(),s=1/gA.setFromMatrixColumn(e,1).length(),a=1/gA.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*a,t[9]=i[9]*a,t[10]=i[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,a=Math.cos(i),o=Math.sin(i),c=Math.cos(r),h=Math.sin(r),p=Math.cos(s),g=Math.sin(s);if(e.order==="XYZ"){const A=a*p,v=a*g,x=o*p,S=o*g;t[0]=c*p,t[4]=-c*g,t[8]=h,t[1]=v+x*h,t[5]=A-S*h,t[9]=-o*c,t[2]=S-A*h,t[6]=x+v*h,t[10]=a*c}else if(e.order==="YXZ"){const A=c*p,v=c*g,x=h*p,S=h*g;t[0]=A+S*o,t[4]=x*o-v,t[8]=a*h,t[1]=a*g,t[5]=a*p,t[9]=-o,t[2]=v*o-x,t[6]=S+A*o,t[10]=a*c}else if(e.order==="ZXY"){const A=c*p,v=c*g,x=h*p,S=h*g;t[0]=A-S*o,t[4]=-a*g,t[8]=x+v*o,t[1]=v+x*o,t[5]=a*p,t[9]=S-A*o,t[2]=-a*h,t[6]=o,t[10]=a*c}else if(e.order==="ZYX"){const A=a*p,v=a*g,x=o*p,S=o*g;t[0]=c*p,t[4]=x*h-v,t[8]=A*h+S,t[1]=c*g,t[5]=S*h+A,t[9]=v*h-x,t[2]=-h,t[6]=o*c,t[10]=a*c}else if(e.order==="YZX"){const A=a*c,v=a*h,x=o*c,S=o*h;t[0]=c*p,t[4]=S-A*g,t[8]=x*g+v,t[1]=g,t[5]=a*p,t[9]=-o*p,t[2]=-h*p,t[6]=v*g+x,t[10]=A-S*g}else if(e.order==="XZY"){const A=a*c,v=a*h,x=o*c,S=o*h;t[0]=c*p,t[4]=-g,t[8]=h*p,t[1]=A*g+S,t[5]=a*p,t[9]=v*g-x,t[2]=x*g-v,t[6]=o*p,t[10]=S*g+A}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(BW,e,DW)}lookAt(e,t,i){const r=this.elements;return $o.subVectors(e,t),$o.lengthSq()===0&&($o.z=1),$o.normalize(),fd.crossVectors(i,$o),fd.lengthSq()===0&&(Math.abs(i.z)===1?$o.x+=1e-4:$o.z+=1e-4,$o.normalize(),fd.crossVectors(i,$o)),fd.normalize(),lS.crossVectors($o,fd),r[0]=fd.x,r[4]=lS.x,r[8]=$o.x,r[1]=fd.y,r[5]=lS.y,r[9]=$o.y,r[2]=fd.z,r[6]=lS.z,r[10]=$o.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,a=i[0],o=i[4],c=i[8],h=i[12],p=i[1],g=i[5],A=i[9],v=i[13],x=i[2],S=i[6],_=i[10],E=i[14],C=i[3],T=i[7],R=i[11],B=i[15],U=r[0],O=r[4],F=r[8],L=r[12],P=r[1],W=r[5],j=r[9],V=r[13],q=r[2],re=r[6],Q=r[10],K=r[14],ce=r[3],ue=r[7],oe=r[11],z=r[15];return s[0]=a*U+o*P+c*q+h*ce,s[4]=a*O+o*W+c*re+h*ue,s[8]=a*F+o*j+c*Q+h*oe,s[12]=a*L+o*V+c*K+h*z,s[1]=p*U+g*P+A*q+v*ce,s[5]=p*O+g*W+A*re+v*ue,s[9]=p*F+g*j+A*Q+v*oe,s[13]=p*L+g*V+A*K+v*z,s[2]=x*U+S*P+_*q+E*ce,s[6]=x*O+S*W+_*re+E*ue,s[10]=x*F+S*j+_*Q+E*oe,s[14]=x*L+S*V+_*K+E*z,s[3]=C*U+T*P+R*q+B*ce,s[7]=C*O+T*W+R*re+B*ue,s[11]=C*F+T*j+R*Q+B*oe,s[15]=C*L+T*V+R*K+B*z,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],a=e[1],o=e[5],c=e[9],h=e[13],p=e[2],g=e[6],A=e[10],v=e[14],x=e[3],S=e[7],_=e[11],E=e[15],C=c*v-h*A,T=o*v-h*g,R=o*A-c*g,B=a*v-h*p,U=a*A-c*p,O=a*g-o*p;return t*(S*C-_*T+E*R)-i*(x*C-_*B+E*U)+r*(x*T-S*B+E*O)-s*(x*R-S*U+_*O)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],h=e[7],p=e[8],g=e[9],A=e[10],v=e[11],x=e[12],S=e[13],_=e[14],E=e[15],C=g*_*h-S*A*h+S*c*v-o*_*v-g*c*E+o*A*E,T=x*A*h-p*_*h-x*c*v+a*_*v+p*c*E-a*A*E,R=p*S*h-x*g*h+x*o*v-a*S*v-p*o*E+a*g*E,B=x*g*c-p*S*c-x*o*A+a*S*A+p*o*_-a*g*_,U=t*C+i*T+r*R+s*B;if(U===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const O=1/U;return e[0]=C*O,e[1]=(S*A*s-g*_*s-S*r*v+i*_*v+g*r*E-i*A*E)*O,e[2]=(o*_*s-S*c*s+S*r*h-i*_*h-o*r*E+i*c*E)*O,e[3]=(g*c*s-o*A*s-g*r*h+i*A*h+o*r*v-i*c*v)*O,e[4]=T*O,e[5]=(p*_*s-x*A*s+x*r*v-t*_*v-p*r*E+t*A*E)*O,e[6]=(x*c*s-a*_*s-x*r*h+t*_*h+a*r*E-t*c*E)*O,e[7]=(a*A*s-p*c*s+p*r*h-t*A*h-a*r*v+t*c*v)*O,e[8]=R*O,e[9]=(x*g*s-p*S*s-x*i*v+t*S*v+p*i*E-t*g*E)*O,e[10]=(a*S*s-x*o*s+x*i*h-t*S*h-a*i*E+t*o*E)*O,e[11]=(p*o*s-a*g*s-p*i*h+t*g*h+a*i*v-t*o*v)*O,e[12]=B*O,e[13]=(p*S*r-x*g*r+x*i*A-t*S*A-p*i*_+t*g*_)*O,e[14]=(x*o*r-a*S*r-x*i*c+t*S*c+a*i*_-t*o*_)*O,e[15]=(a*g*r-p*o*r+p*i*c-t*g*c-a*i*A+t*o*A)*O,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,a=e.x,o=e.y,c=e.z,h=s*a,p=s*o;return this.set(h*a+i,h*o-r*c,h*c+r*o,0,h*o+r*c,p*o+i,p*c-r*a,0,h*c-r*o,p*c+r*a,s*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,a){return this.set(1,i,s,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,a=t._y,o=t._z,c=t._w,h=s+s,p=a+a,g=o+o,A=s*h,v=s*p,x=s*g,S=a*p,_=a*g,E=o*g,C=c*h,T=c*p,R=c*g,B=i.x,U=i.y,O=i.z;return r[0]=(1-(S+E))*B,r[1]=(v+R)*B,r[2]=(x-T)*B,r[3]=0,r[4]=(v-R)*U,r[5]=(1-(A+E))*U,r[6]=(_+C)*U,r[7]=0,r[8]=(x+T)*O,r[9]=(_-C)*O,r[10]=(1-(A+S))*O,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],this.determinant()===0)return i.set(1,1,1),t.identity(),this;let s=gA.set(r[0],r[1],r[2]).length();const a=gA.set(r[4],r[5],r[6]).length(),o=gA.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),Uc.copy(this);const h=1/s,p=1/a,g=1/o;return Uc.elements[0]*=h,Uc.elements[1]*=h,Uc.elements[2]*=h,Uc.elements[4]*=p,Uc.elements[5]*=p,Uc.elements[6]*=p,Uc.elements[8]*=g,Uc.elements[9]*=g,Uc.elements[10]*=g,t.setFromRotationMatrix(Uc),i.x=s,i.y=a,i.z=o,this}makePerspective(e,t,i,r,s,a,o=rl,c=!1){const h=this.elements,p=2*s/(t-e),g=2*s/(i-r),A=(t+e)/(t-e),v=(i+r)/(i-r);let x,S;if(c)x=s/(a-s),S=a*s/(a-s);else if(o===rl)x=-(a+s)/(a-s),S=-2*a*s/(a-s);else if(o===I0)x=-a/(a-s),S=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return h[0]=p,h[4]=0,h[8]=A,h[12]=0,h[1]=0,h[5]=g,h[9]=v,h[13]=0,h[2]=0,h[6]=0,h[10]=x,h[14]=S,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,i,r,s,a,o=rl,c=!1){const h=this.elements,p=2/(t-e),g=2/(i-r),A=-(t+e)/(t-e),v=-(i+r)/(i-r);let x,S;if(c)x=1/(a-s),S=a/(a-s);else if(o===rl)x=-2/(a-s),S=-(a+s)/(a-s);else if(o===I0)x=-1/(a-s),S=-s/(a-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return h[0]=p,h[4]=0,h[8]=0,h[12]=A,h[1]=0,h[5]=g,h[9]=0,h[13]=v,h[2]=0,h[6]=0,h[10]=x,h[14]=S,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const gA=new ee,Uc=new qt,BW=new ee(0,0,0),DW=new ee(1,1,1),fd=new ee,lS=new ee,$o=new ee,yL=new qt,bL=new Bi;class Us{constructor(e=0,t=0,i=0,r=Us.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],a=r[4],o=r[8],c=r[1],h=r[5],p=r[9],g=r[2],A=r[6],v=r[10];switch(t){case"XYZ":this._y=Math.asin(Mn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-p,v),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(A,h),this._z=0);break;case"YXZ":this._x=Math.asin(-Mn(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(o,v),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-g,s),this._z=0);break;case"ZXY":this._x=Math.asin(Mn(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(-g,v),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-Mn(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(A,v),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-a,h));break;case"YZX":this._z=Math.asin(Mn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-p,h),this._y=Math.atan2(-g,s)):(this._x=0,this._y=Math.atan2(o,v));break;case"XZY":this._z=Math.asin(-Mn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(A,h),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-p,v),this._y=0);break;default:Gt("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return yL.makeRotationFromQuaternion(e),this.setFromRotationMatrix(yL,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return bL.setFromEuler(this),this.setFromQuaternion(bL,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Us.DEFAULT_ORDER="XYZ";class L0{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let LW=0;const xL=new ee,AA=new Bi,Vh=new qt,cS=new ee,Jy=new ee,NW=new ee,UW=new Bi,_L=new ee(1,0,0),SL=new ee(0,1,0),EL=new ee(0,0,1),wL={type:"added"},FW={type:"removed"},vA={type:"childadded",child:null},O3={type:"childremoved",child:null};class Gn extends zo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:LW++}),this.uuid=ol(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Gn.DEFAULT_UP.clone();const e=new ee,t=new Us,i=new Bi,r=new ee(1,1,1);function s(){i.setFromEuler(t,!1)}function a(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new qt},normalMatrix:{value:new Rn}}),this.matrix=new qt,this.matrixWorld=new qt,this.matrixAutoUpdate=Gn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Gn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new L0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return AA.setFromAxisAngle(e,t),this.quaternion.multiply(AA),this}rotateOnWorldAxis(e,t){return AA.setFromAxisAngle(e,t),this.quaternion.premultiply(AA),this}rotateX(e){return this.rotateOnAxis(_L,e)}rotateY(e){return this.rotateOnAxis(SL,e)}rotateZ(e){return this.rotateOnAxis(EL,e)}translateOnAxis(e,t){return xL.copy(e).applyQuaternion(this.quaternion),this.position.add(xL.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(_L,e)}translateY(e){return this.translateOnAxis(SL,e)}translateZ(e){return this.translateOnAxis(EL,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Vh.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?cS.copy(e):cS.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Jy.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Vh.lookAt(Jy,cS,this.up):Vh.lookAt(cS,Jy,this.up),this.quaternion.setFromRotationMatrix(Vh),r&&(Vh.extractRotation(r.matrixWorld),AA.setFromRotationMatrix(Vh),this.quaternion.premultiply(AA.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(on("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(wL),vA.child=e,this.dispatchEvent(vA),vA.child=null):on("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(FW),O3.child=e,this.dispatchEvent(O3),O3.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Vh.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Vh.multiply(e.parent.matrixWorld)),e.applyMatrix4(Vh),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(wL),vA.child=e,this.dispatchEvent(vA),vA.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const a=this.children[i].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Jy,e,NW),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Jy,UW,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?o.boundingBox.toJSON():void 0,boundingSphere:o.boundingSphere?o.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(o=>({...o})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function s(o,c){return o[c.uuid]===void 0&&(o[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const c=o.shapes;if(Array.isArray(c))for(let h=0,p=c.length;h<p;h++){const g=c[h];s(e.shapes,g)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let c=0,h=this.material.length;c<h;c++)o.push(s(e.materials,this.material[c]));r.material=o}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++){const c=this.animations[o];r.animations.push(s(e.animations,c))}}if(t){const o=a(e.geometries),c=a(e.materials),h=a(e.textures),p=a(e.images),g=a(e.shapes),A=a(e.skeletons),v=a(e.animations),x=a(e.nodes);o.length>0&&(i.geometries=o),c.length>0&&(i.materials=c),h.length>0&&(i.textures=h),p.length>0&&(i.images=p),g.length>0&&(i.shapes=g),A.length>0&&(i.skeletons=A),v.length>0&&(i.animations=v),x.length>0&&(i.nodes=x)}return i.object=r,i;function a(o){const c=[];for(const h in o){const p=o[h];delete p.metadata,c.push(p)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Gn.DEFAULT_UP=new ee(0,1,0);Gn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Gn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Fc=new ee,jh=new ee,k3=new ee,Wh=new ee,yA=new ee,bA=new ee,ML=new ee,z3=new ee,G3=new ee,H3=new ee,Q3=new Ii,V3=new Ii,j3=new Ii;class ea{constructor(e=new ee,t=new ee,i=new ee){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Fc.subVectors(e,t),r.cross(Fc);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Fc.subVectors(r,t),jh.subVectors(i,t),k3.subVectors(e,t);const a=Fc.dot(Fc),o=Fc.dot(jh),c=Fc.dot(k3),h=jh.dot(jh),p=jh.dot(k3),g=a*h-o*o;if(g===0)return s.set(0,0,0),null;const A=1/g,v=(h*c-o*p)*A,x=(a*p-o*c)*A;return s.set(1-v-x,x,v)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Wh)===null?!1:Wh.x>=0&&Wh.y>=0&&Wh.x+Wh.y<=1}static getInterpolation(e,t,i,r,s,a,o,c){return this.getBarycoord(e,t,i,r,Wh)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(s,Wh.x),c.addScaledVector(a,Wh.y),c.addScaledVector(o,Wh.z),c)}static getInterpolatedAttribute(e,t,i,r,s,a){return Q3.setScalar(0),V3.setScalar(0),j3.setScalar(0),Q3.fromBufferAttribute(e,t),V3.fromBufferAttribute(e,i),j3.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(Q3,s.x),a.addScaledVector(V3,s.y),a.addScaledVector(j3,s.z),a}static isFrontFacing(e,t,i,r){return Fc.subVectors(i,t),jh.subVectors(e,t),Fc.cross(jh).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Fc.subVectors(this.c,this.b),jh.subVectors(this.a,this.b),Fc.cross(jh).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ea.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ea.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return ea.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return ea.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ea.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let a,o;yA.subVectors(r,i),bA.subVectors(s,i),z3.subVectors(e,i);const c=yA.dot(z3),h=bA.dot(z3);if(c<=0&&h<=0)return t.copy(i);G3.subVectors(e,r);const p=yA.dot(G3),g=bA.dot(G3);if(p>=0&&g<=p)return t.copy(r);const A=c*g-p*h;if(A<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(i).addScaledVector(yA,a);H3.subVectors(e,s);const v=yA.dot(H3),x=bA.dot(H3);if(x>=0&&v<=x)return t.copy(s);const S=v*h-c*x;if(S<=0&&h>=0&&x<=0)return o=h/(h-x),t.copy(i).addScaledVector(bA,o);const _=p*x-v*g;if(_<=0&&g-p>=0&&v-x>=0)return ML.subVectors(s,r),o=(g-p)/(g-p+(v-x)),t.copy(r).addScaledVector(ML,o);const E=1/(_+S+A);return a=S*E,o=A*E,t.copy(i).addScaledVector(yA,a).addScaledVector(bA,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const b8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},dd={h:0,s:0,l:0},uS={h:0,s:0,l:0};function W3(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class Mt{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=xi){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Wn.colorSpaceToWorking(this,t),this}setRGB(e,t,i,r=Wn.workingColorSpace){return this.r=e,this.g=t,this.b=i,Wn.colorSpaceToWorking(this,r),this}setHSL(e,t,i,r=Wn.workingColorSpace){if(e=i4(e,1),t=Mn(t,0,1),i=Mn(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,a=2*i-s;this.r=W3(a,s,e+1/3),this.g=W3(a,s,e),this.b=W3(a,s,e-1/3)}return Wn.colorSpaceToWorking(this,r),this}setStyle(e,t=xi){function i(s){s!==void 0&&parseFloat(s)<1&&Gt("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:Gt("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);Gt("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=xi){const i=b8[e.toLowerCase()];return i!==void 0?this.setHex(i,t):Gt("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=hf(e.r),this.g=hf(e.g),this.b=hf(e.b),this}copyLinearToSRGB(e){return this.r=d0(e.r),this.g=d0(e.g),this.b=d0(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=xi){return Wn.workingToColorSpace(Na.copy(this),e),Math.round(Mn(Na.r*255,0,255))*65536+Math.round(Mn(Na.g*255,0,255))*256+Math.round(Mn(Na.b*255,0,255))}getHexString(e=xi){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Wn.workingColorSpace){Wn.workingToColorSpace(Na.copy(this),t);const i=Na.r,r=Na.g,s=Na.b,a=Math.max(i,r,s),o=Math.min(i,r,s);let c,h;const p=(o+a)/2;if(o===a)c=0,h=0;else{const g=a-o;switch(h=p<=.5?g/(a+o):g/(2-a-o),a){case i:c=(r-s)/g+(r<s?6:0);break;case r:c=(s-i)/g+2;break;case s:c=(i-r)/g+4;break}c/=6}return e.h=c,e.s=h,e.l=p,e}getRGB(e,t=Wn.workingColorSpace){return Wn.workingToColorSpace(Na.copy(this),t),e.r=Na.r,e.g=Na.g,e.b=Na.b,e}getStyle(e=xi){Wn.workingToColorSpace(Na.copy(this),e);const t=Na.r,i=Na.g,r=Na.b;return e!==xi?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(dd),this.setHSL(dd.h+e,dd.s+t,dd.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(dd),e.getHSL(uS);const i=Z1(dd.h,uS.h,t),r=Z1(dd.s,uS.s,t),s=Z1(dd.l,uS.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Na=new Mt;Mt.NAMES=b8;let PW=0,ts=class extends zo{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:PW++}),this.uuid=ol(),this.name="",this.type="Material",this.blending=Em,this.side=cc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=ow,this.blendDst=lw,this.blendEquation=Md,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Mt(0,0,0),this.blendAlpha=0,this.depthFunc=Fm,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=UR,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=om,this.stencilZFail=om,this.stencilZPass=om,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){Gt(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Gt(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(i.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(i.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Em&&(i.blending=this.blending),this.side!==cc&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==ow&&(i.blendSrc=this.blendSrc),this.blendDst!==lw&&(i.blendDst=this.blendDst),this.blendEquation!==Md&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Fm&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==UR&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==om&&(i.stencilFail=this.stencilFail),this.stencilZFail!==om&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==om&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.allowOverride===!1&&(i.allowOverride=!1),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const a=[];for(const o in s){const c=s[o];delete c.metadata,a.push(c)}return a}if(t){const s=r(e.textures),a=r(e.images);s.length>0&&(i.textures=s),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}};class ar extends ts{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Mt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Us,this.combine=Yb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const sf=OW();function OW(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let c=0;c<256;++c){const h=c-127;h<-27?(i[c]=0,i[c|256]=32768,r[c]=24,r[c|256]=24):h<-14?(i[c]=1024>>-h-14,i[c|256]=1024>>-h-14|32768,r[c]=-h-1,r[c|256]=-h-1):h<=15?(i[c]=h+15<<10,i[c|256]=h+15<<10|32768,r[c]=13,r[c|256]=13):h<128?(i[c]=31744,i[c|256]=64512,r[c]=24,r[c|256]=24):(i[c]=31744,i[c|256]=64512,r[c]=13,r[c|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let c=1;c<1024;++c){let h=c<<13,p=0;for(;(h&8388608)===0;)h<<=1,p-=8388608;h&=-8388609,p+=947912704,s[c]=h|p}for(let c=1024;c<2048;++c)s[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)a[c]=c<<23;a[31]=1199570944,a[32]=2147483648;for(let c=33;c<63;++c)a[c]=2147483648+(c-32<<23);a[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(o[c]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:o}}function Uo(n){Math.abs(n)>65504&&Gt("DataUtils.toHalfFloat(): Value out of range."),n=Mn(n,-65504,65504),sf.floatView[0]=n;const e=sf.uint32View[0],t=e>>23&511;return sf.baseTable[t]+((e&8388607)>>sf.shiftTable[t])}function O1(n){const e=n>>10;return sf.uint32View[0]=sf.mantissaTable[sf.offsetTable[e]+(n&1023)]+sf.exponentTable[e],sf.floatView[0]}class Gc{static toHalfFloat(e){return Uo(e)}static fromHalfFloat(e){return O1(e)}}const xs=new ee,hS=new Ze;let kW=0;class An{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:kW++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Cb,this.updateRanges=[],this.gpuType=Si,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)hS.fromBufferAttribute(this,t),hS.applyMatrix3(e),this.setXY(t,hS.x,hS.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)xs.fromBufferAttribute(this,t),xs.applyMatrix3(e),this.setXYZ(t,xs.x,xs.y,xs.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)xs.fromBufferAttribute(this,t),xs.applyMatrix4(e),this.setXYZ(t,xs.x,xs.y,xs.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)xs.fromBufferAttribute(this,t),xs.applyNormalMatrix(e),this.setXYZ(t,xs.x,xs.y,xs.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)xs.fromBufferAttribute(this,t),xs.transformDirection(e),this.setXYZ(t,xs.x,xs.y,xs.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=oo(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=zn(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=oo(t,this.array)),t}setX(e,t){return this.normalized&&(t=zn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=oo(t,this.array)),t}setY(e,t){return this.normalized&&(t=zn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=oo(t,this.array)),t}setZ(e,t){return this.normalized&&(t=zn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=oo(t,this.array)),t}setW(e,t){return this.normalized&&(t=zn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=zn(t,this.array),i=zn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=zn(t,this.array),i=zn(i,this.array),r=zn(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=zn(t,this.array),i=zn(i,this.array),r=zn(r,this.array),s=zn(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Cb&&(e.usage=this.usage),e}}class zW extends An{constructor(e,t,i){super(new Int8Array(e),t,i)}}class GW extends An{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class HW extends An{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class QW extends An{constructor(e,t,i){super(new Int16Array(e),t,i)}}class a4 extends An{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class VW extends An{constructor(e,t,i){super(new Int32Array(e),t,i)}}class o4 extends An{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class jW extends An{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=O1(this.array[e*this.itemSize]);return this.normalized&&(t=oo(t,this.array)),t}setX(e,t){return this.normalized&&(t=zn(t,this.array)),this.array[e*this.itemSize]=Uo(t),this}getY(e){let t=O1(this.array[e*this.itemSize+1]);return this.normalized&&(t=oo(t,this.array)),t}setY(e,t){return this.normalized&&(t=zn(t,this.array)),this.array[e*this.itemSize+1]=Uo(t),this}getZ(e){let t=O1(this.array[e*this.itemSize+2]);return this.normalized&&(t=oo(t,this.array)),t}setZ(e,t){return this.normalized&&(t=zn(t,this.array)),this.array[e*this.itemSize+2]=Uo(t),this}getW(e){let t=O1(this.array[e*this.itemSize+3]);return this.normalized&&(t=oo(t,this.array)),t}setW(e,t){return this.normalized&&(t=zn(t,this.array)),this.array[e*this.itemSize+3]=Uo(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=zn(t,this.array),i=zn(i,this.array)),this.array[e+0]=Uo(t),this.array[e+1]=Uo(i),this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=zn(t,this.array),i=zn(i,this.array),r=zn(r,this.array)),this.array[e+0]=Uo(t),this.array[e+1]=Uo(i),this.array[e+2]=Uo(r),this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=zn(t,this.array),i=zn(i,this.array),r=zn(r,this.array),s=zn(s,this.array)),this.array[e+0]=Uo(t),this.array[e+1]=Uo(i),this.array[e+2]=Uo(r),this.array[e+3]=Uo(s),this}}class Kt extends An{constructor(e,t,i){super(new Float32Array(e),t,i)}}let WW=0;const Kl=new qt,q3=new Gn,xA=new ee,Jo=new gr,Zy=new gr,Xs=new ee;class vn extends zo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:WW++}),this.uuid=ol(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(A8(e)?o4:a4)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Rn().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Kl.makeRotationFromQuaternion(e),this.applyMatrix4(Kl),this}rotateX(e){return Kl.makeRotationX(e),this.applyMatrix4(Kl),this}rotateY(e){return Kl.makeRotationY(e),this.applyMatrix4(Kl),this}rotateZ(e){return Kl.makeRotationZ(e),this.applyMatrix4(Kl),this}translate(e,t,i){return Kl.makeTranslation(e,t,i),this.applyMatrix4(Kl),this}scale(e,t,i){return Kl.makeScale(e,t,i),this.applyMatrix4(Kl),this}lookAt(e){return q3.lookAt(e),q3.updateMatrix(),this.applyMatrix4(q3.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(xA).negate(),this.translate(xA.x,xA.y,xA.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const i=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];i.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Kt(i,3))}else{const i=Math.min(e.length,t.count);for(let r=0;r<i;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&Gt("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){on("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ee(-1/0,-1/0,-1/0),new ee(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];Jo.setFromBufferAttribute(s),this.morphTargetsRelative?(Xs.addVectors(this.boundingBox.min,Jo.min),this.boundingBox.expandByPoint(Xs),Xs.addVectors(this.boundingBox.max,Jo.max),this.boundingBox.expandByPoint(Xs)):(this.boundingBox.expandByPoint(Jo.min),this.boundingBox.expandByPoint(Jo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&on('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new jr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){on("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ee,1/0);return}if(e){const i=this.boundingSphere.center;if(Jo.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];Zy.setFromBufferAttribute(o),this.morphTargetsRelative?(Xs.addVectors(Jo.min,Zy.min),Jo.expandByPoint(Xs),Xs.addVectors(Jo.max,Zy.max),Jo.expandByPoint(Xs)):(Jo.expandByPoint(Zy.min),Jo.expandByPoint(Zy.max))}Jo.getCenter(i);let r=0;for(let s=0,a=e.count;s<a;s++)Xs.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Xs));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],c=this.morphTargetsRelative;for(let h=0,p=o.count;h<p;h++)Xs.fromBufferAttribute(o,h),c&&(xA.fromBufferAttribute(e,h),Xs.add(xA)),r=Math.max(r,i.distanceToSquared(Xs))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&on('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){on("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new An(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),o=[],c=[];for(let F=0;F<i.count;F++)o[F]=new ee,c[F]=new ee;const h=new ee,p=new ee,g=new ee,A=new Ze,v=new Ze,x=new Ze,S=new ee,_=new ee;function E(F,L,P){h.fromBufferAttribute(i,F),p.fromBufferAttribute(i,L),g.fromBufferAttribute(i,P),A.fromBufferAttribute(s,F),v.fromBufferAttribute(s,L),x.fromBufferAttribute(s,P),p.sub(h),g.sub(h),v.sub(A),x.sub(A);const W=1/(v.x*x.y-x.x*v.y);isFinite(W)&&(S.copy(p).multiplyScalar(x.y).addScaledVector(g,-v.y).multiplyScalar(W),_.copy(g).multiplyScalar(v.x).addScaledVector(p,-x.x).multiplyScalar(W),o[F].add(S),o[L].add(S),o[P].add(S),c[F].add(_),c[L].add(_),c[P].add(_))}let C=this.groups;C.length===0&&(C=[{start:0,count:e.count}]);for(let F=0,L=C.length;F<L;++F){const P=C[F],W=P.start,j=P.count;for(let V=W,q=W+j;V<q;V+=3)E(e.getX(V+0),e.getX(V+1),e.getX(V+2))}const T=new ee,R=new ee,B=new ee,U=new ee;function O(F){B.fromBufferAttribute(r,F),U.copy(B);const L=o[F];T.copy(L),T.sub(B.multiplyScalar(B.dot(L))).normalize(),R.crossVectors(U,L);const W=R.dot(c[F])<0?-1:1;a.setXYZW(F,T.x,T.y,T.z,W)}for(let F=0,L=C.length;F<L;++F){const P=C[F],W=P.start,j=P.count;for(let V=W,q=W+j;V<q;V+=3)O(e.getX(V+0)),O(e.getX(V+1)),O(e.getX(V+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new An(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let A=0,v=i.count;A<v;A++)i.setXYZ(A,0,0,0);const r=new ee,s=new ee,a=new ee,o=new ee,c=new ee,h=new ee,p=new ee,g=new ee;if(e)for(let A=0,v=e.count;A<v;A+=3){const x=e.getX(A+0),S=e.getX(A+1),_=e.getX(A+2);r.fromBufferAttribute(t,x),s.fromBufferAttribute(t,S),a.fromBufferAttribute(t,_),p.subVectors(a,s),g.subVectors(r,s),p.cross(g),o.fromBufferAttribute(i,x),c.fromBufferAttribute(i,S),h.fromBufferAttribute(i,_),o.add(p),c.add(p),h.add(p),i.setXYZ(x,o.x,o.y,o.z),i.setXYZ(S,c.x,c.y,c.z),i.setXYZ(_,h.x,h.y,h.z)}else for(let A=0,v=t.count;A<v;A+=3)r.fromBufferAttribute(t,A+0),s.fromBufferAttribute(t,A+1),a.fromBufferAttribute(t,A+2),p.subVectors(a,s),g.subVectors(r,s),p.cross(g),i.setXYZ(A+0,p.x,p.y,p.z),i.setXYZ(A+1,p.x,p.y,p.z),i.setXYZ(A+2,p.x,p.y,p.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Xs.fromBufferAttribute(e,t),Xs.normalize(),e.setXYZ(t,Xs.x,Xs.y,Xs.z)}toNonIndexed(){function e(o,c){const h=o.array,p=o.itemSize,g=o.normalized,A=new h.constructor(c.length*p);let v=0,x=0;for(let S=0,_=c.length;S<_;S++){o.isInterleavedBufferAttribute?v=c[S]*o.data.stride+o.offset:v=c[S]*p;for(let E=0;E<p;E++)A[x++]=h[v++]}return new An(A,p,g)}if(this.index===null)return Gt("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new vn,i=this.index.array,r=this.attributes;for(const o in r){const c=r[o],h=e(c,i);t.setAttribute(o,h)}const s=this.morphAttributes;for(const o in s){const c=[],h=s[o];for(let p=0,g=h.length;p<g;p++){const A=h[p],v=e(A,i);c.push(v)}t.morphAttributes[o]=c}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,c=a.length;o<c;o++){const h=a[o];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const h in c)c[h]!==void 0&&(e[h]=c[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const c in i){const h=i[c];e.data.attributes[c]=h.toJSON(e.data)}const r={};let s=!1;for(const c in this.morphAttributes){const h=this.morphAttributes[c],p=[];for(let g=0,A=h.length;g<A;g++){const v=h[g];p.push(v.toJSON(e.data))}p.length>0&&(r[c]=p,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere=o.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const r=e.attributes;for(const h in r){const p=r[h];this.setAttribute(h,p.clone(t))}const s=e.morphAttributes;for(const h in s){const p=[],g=s[h];for(let A=0,v=g.length;A<v;A++)p.push(g[A].clone(t));this.morphAttributes[h]=p}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let h=0,p=a.length;h<p;h++){const g=a[h];this.addGroup(g.start,g.count,g.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const CL=new qt,zp=new gf,fS=new jr,TL=new ee,dS=new ee,pS=new ee,mS=new ee,X3=new ee,gS=new ee,IL=new ee,AS=new ee;class Wt extends Gn{constructor(e=new vn,t=new ar){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,a=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(s&&o){gS.set(0,0,0);for(let c=0,h=s.length;c<h;c++){const p=o[c],g=s[c];p!==0&&(X3.fromBufferAttribute(g,e),a?gS.addScaledVector(X3,p):gS.addScaledVector(X3.sub(t),p))}t.add(gS)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),fS.copy(i.boundingSphere),fS.applyMatrix4(s),zp.copy(e.ray).recast(e.near),!(fS.containsPoint(zp.origin)===!1&&(zp.intersectSphere(fS,TL)===null||zp.origin.distanceToSquared(TL)>(e.far-e.near)**2))&&(CL.copy(s).invert(),zp.copy(e.ray).applyMatrix4(CL),!(i.boundingBox!==null&&zp.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,zp)))}_computeIntersections(e,t,i){let r;const s=this.geometry,a=this.material,o=s.index,c=s.attributes.position,h=s.attributes.uv,p=s.attributes.uv1,g=s.attributes.normal,A=s.groups,v=s.drawRange;if(o!==null)if(Array.isArray(a))for(let x=0,S=A.length;x<S;x++){const _=A[x],E=a[_.materialIndex],C=Math.max(_.start,v.start),T=Math.min(o.count,Math.min(_.start+_.count,v.start+v.count));for(let R=C,B=T;R<B;R+=3){const U=o.getX(R),O=o.getX(R+1),F=o.getX(R+2);r=vS(this,E,e,i,h,p,g,U,O,F),r&&(r.faceIndex=Math.floor(R/3),r.face.materialIndex=_.materialIndex,t.push(r))}}else{const x=Math.max(0,v.start),S=Math.min(o.count,v.start+v.count);for(let _=x,E=S;_<E;_+=3){const C=o.getX(_),T=o.getX(_+1),R=o.getX(_+2);r=vS(this,a,e,i,h,p,g,C,T,R),r&&(r.faceIndex=Math.floor(_/3),t.push(r))}}else if(c!==void 0)if(Array.isArray(a))for(let x=0,S=A.length;x<S;x++){const _=A[x],E=a[_.materialIndex],C=Math.max(_.start,v.start),T=Math.min(c.count,Math.min(_.start+_.count,v.start+v.count));for(let R=C,B=T;R<B;R+=3){const U=R,O=R+1,F=R+2;r=vS(this,E,e,i,h,p,g,U,O,F),r&&(r.faceIndex=Math.floor(R/3),r.face.materialIndex=_.materialIndex,t.push(r))}}else{const x=Math.max(0,v.start),S=Math.min(c.count,v.start+v.count);for(let _=x,E=S;_<E;_+=3){const C=_,T=_+1,R=_+2;r=vS(this,a,e,i,h,p,g,C,T,R),r&&(r.faceIndex=Math.floor(_/3),t.push(r))}}}}function qW(n,e,t,i,r,s,a,o){let c;if(e.side===ia?c=i.intersectTriangle(a,s,r,!0,o):c=i.intersectTriangle(r,s,a,e.side===cc,o),c===null)return null;AS.copy(o),AS.applyMatrix4(n.matrixWorld);const h=t.ray.origin.distanceTo(AS);return h<t.near||h>t.far?null:{distance:h,point:AS.clone(),object:n}}function vS(n,e,t,i,r,s,a,o,c,h){n.getVertexPosition(o,dS),n.getVertexPosition(c,pS),n.getVertexPosition(h,mS);const p=qW(n,e,t,i,dS,pS,mS,IL);if(p){const g=new ee;ea.getBarycoord(IL,dS,pS,mS,g),r&&(p.uv=ea.getInterpolatedAttribute(r,o,c,h,g,new Ze)),s&&(p.uv1=ea.getInterpolatedAttribute(s,o,c,h,g,new Ze)),a&&(p.normal=ea.getInterpolatedAttribute(a,o,c,h,g,new ee),p.normal.dot(i.direction)>0&&p.normal.multiplyScalar(-1));const A={a:o,b:c,c:h,normal:new ee,materialIndex:0};ea.getNormal(dS,pS,mS,A.normal),p.face=A,p.barycoord=g}return p}class ba extends vn{constructor(e=1,t=1,i=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:a};const o=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const c=[],h=[],p=[],g=[];let A=0,v=0;x("z","y","x",-1,-1,i,t,e,a,s,0),x("z","y","x",1,-1,i,t,-e,a,s,1),x("x","z","y",1,1,e,i,t,r,a,2),x("x","z","y",1,-1,e,i,-t,r,a,3),x("x","y","z",1,-1,e,t,i,r,s,4),x("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new Kt(h,3)),this.setAttribute("normal",new Kt(p,3)),this.setAttribute("uv",new Kt(g,2));function x(S,_,E,C,T,R,B,U,O,F,L){const P=R/O,W=B/F,j=R/2,V=B/2,q=U/2,re=O+1,Q=F+1;let K=0,ce=0;const ue=new ee;for(let oe=0;oe<Q;oe++){const z=oe*W-V;for(let $=0;$<re;$++){const ae=$*P-j;ue[S]=ae*C,ue[_]=z*T,ue[E]=q,h.push(ue.x,ue.y,ue.z),ue[S]=0,ue[_]=0,ue[E]=U>0?1:-1,p.push(ue.x,ue.y,ue.z),g.push($/O),g.push(1-oe/F),K+=1}}for(let oe=0;oe<F;oe++)for(let z=0;z<O;z++){const $=A+z+re*oe,ae=A+z+re*(oe+1),he=A+(z+1)+re*(oe+1),me=A+(z+1)+re*oe;c.push($,ae,me),c.push(ae,he,me),ce+=6}o.addGroup(v,ce,L),v+=ce,A+=K}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ba(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function N0(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(Gt("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function to(n){const e={};for(let t=0;t<n.length;t++){const i=N0(n[t]);for(const r in i)e[r]=i[r]}return e}function XW(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function x8(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Wn.workingColorSpace}const l4={clone:N0,merge:to};var YW=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,KW=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Fs extends ts{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=YW,this.fragmentShader=KW,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=N0(e.uniforms),this.uniformsGroups=XW(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?t.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[r]={type:"m4",value:a.toArray()}:t.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class CM extends Gn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new qt,this.projectionMatrix=new qt,this.projectionMatrixInverse=new qt,this.coordinateSystem=rl,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const pd=new ee,RL=new Ze,BL=new Ze;class Gr extends CM{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=B0*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Im*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return B0*2*Math.atan(Math.tan(Im*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){pd.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(pd.x,pd.y).multiplyScalar(-e/pd.z),pd.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(pd.x,pd.y).multiplyScalar(-e/pd.z)}getViewSize(e,t){return this.getViewBounds(e,RL,BL),t.subVectors(BL,RL)}setViewOffset(e,t,i,r,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Im*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const c=a.fullWidth,h=a.fullHeight;s+=a.offsetX*r/c,t-=a.offsetY*i/h,r*=a.width/c,i*=a.height/h}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const _A=-90,SA=1;class Bw extends Gn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Gr(_A,SA,e,t);r.layers=this.layers,this.add(r);const s=new Gr(_A,SA,e,t);s.layers=this.layers,this.add(s);const a=new Gr(_A,SA,e,t);a.layers=this.layers,this.add(a);const o=new Gr(_A,SA,e,t);o.layers=this.layers,this.add(o);const c=new Gr(_A,SA,e,t);c.layers=this.layers,this.add(c);const h=new Gr(_A,SA,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,a,o,c]=t;for(const h of t)this.remove(h);if(e===rl)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===I0)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,c,h,p]=this.children,g=e.getRenderTarget(),A=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),x=e.xr.enabled;e.xr.enabled=!1;const S=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,a),e.setRenderTarget(i,2,r),e.render(t,o),e.setRenderTarget(i,3,r),e.render(t,c),e.setRenderTarget(i,4,r),e.render(t,h),i.texture.generateMipmaps=S,e.setRenderTarget(i,5,r),e.render(t,p),e.setRenderTarget(g,A,v),e.xr.enabled=x,i.texture.needsPMREMUpdate=!0}}class nx extends Pi{constructor(e=[],t=jc,i,r,s,a,o,c,h,p){super(e,t,i,r,s,a,o,c,h,p),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class rv extends Vr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new nx(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new ba(5,5,5),s=new Fs({name:"CubemapFromEquirect",uniforms:N0(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:ia,blending:lc});s.uniforms.tEquirect.value=t;const a=new Wt(r,s),o=t.minFilter;return t.minFilter===ya&&(t.minFilter=mn),new Bw(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,i=!0,r=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,i,r);e.setRenderTarget(s)}}class Ds extends Gn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const $W={type:"move"};class VE{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Ds,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Ds,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ee,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ee),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Ds,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ee,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ee),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,a=null;const o=this._targetRay,c=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){a=!0;for(const S of e.hand.values()){const _=t.getJointPose(S,i),E=this._getHandJoint(h,S);_!==null&&(E.matrix.fromArray(_.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.matrixWorldNeedsUpdate=!0,E.jointRadius=_.radius),E.visible=_!==null}const p=h.joints["index-finger-tip"],g=h.joints["thumb-tip"],A=p.position.distanceTo(g.position),v=.02,x=.005;h.inputState.pinching&&A>v+x?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&A<=v-x&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));o!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent($W)))}return o!==null&&(o.visible=r!==null),c!==null&&(c.visible=s!==null),h!==null&&(h.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new Ds;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class TM{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Mt(e),this.density=t}clone(){return new TM(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class IM{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Mt(e),this.near=t,this.far=i}clone(){return new IM(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}let uc=class extends Gn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Us,this.environmentIntensity=1,this.environmentRotation=new Us,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};class sv{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Cb,this.updateRanges=[],this.version=0,this.uuid=ol()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ol()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ol()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Za=new ee;class Af{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Za.fromBufferAttribute(this,t),Za.applyMatrix4(e),this.setXYZ(t,Za.x,Za.y,Za.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Za.fromBufferAttribute(this,t),Za.applyNormalMatrix(e),this.setXYZ(t,Za.x,Za.y,Za.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Za.fromBufferAttribute(this,t),Za.transformDirection(e),this.setXYZ(t,Za.x,Za.y,Za.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=oo(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=zn(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=zn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=zn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=zn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=zn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=oo(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=oo(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=oo(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=oo(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=zn(t,this.array),i=zn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=zn(t,this.array),i=zn(i,this.array),r=zn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=zn(t,this.array),i=zn(i,this.array),r=zn(r,this.array),s=zn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){Ib("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new An(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Af(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){Ib("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class c4 extends ts{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Mt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let EA;const e1=new ee,wA=new ee,MA=new ee,CA=new Ze,t1=new Ze,_8=new qt,yS=new ee,n1=new ee,bS=new ee,DL=new Ze,Y3=new Ze,LL=new Ze;class S8 extends Gn{constructor(e=new c4){if(super(),this.isSprite=!0,this.type="Sprite",EA===void 0){EA=new vn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new sv(t,5);EA.setIndex([0,1,2,0,2,3]),EA.setAttribute("position",new Af(i,3,0,!1)),EA.setAttribute("uv",new Af(i,2,3,!1))}this.geometry=EA,this.material=e,this.center=new Ze(.5,.5),this.count=1}raycast(e,t){e.camera===null&&on('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),wA.setFromMatrixScale(this.matrixWorld),_8.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),MA.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&wA.multiplyScalar(-MA.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const a=this.center;xS(yS.set(-.5,-.5,0),MA,a,wA,r,s),xS(n1.set(.5,-.5,0),MA,a,wA,r,s),xS(bS.set(.5,.5,0),MA,a,wA,r,s),DL.set(0,0),Y3.set(1,0),LL.set(1,1);let o=e.ray.intersectTriangle(yS,n1,bS,!1,e1);if(o===null&&(xS(n1.set(-.5,.5,0),MA,a,wA,r,s),Y3.set(0,1),o=e.ray.intersectTriangle(yS,bS,n1,!1,e1),o===null))return;const c=e.ray.origin.distanceTo(e1);c<e.near||c>e.far||t.push({distance:c,point:e1.clone(),uv:ea.getInterpolation(e1,yS,n1,bS,DL,Y3,LL,new Ze),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function xS(n,e,t,i,r,s){CA.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(t1.x=s*CA.x-r*CA.y,t1.y=r*CA.x+s*CA.y):t1.copy(CA),n.copy(e),n.x+=t1.x,n.y+=t1.y,n.applyMatrix4(_8)}const _S=new ee,NL=new ee;class E8 extends Gn{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let i=0;i<t.length;i++)if(t[i].distance===e){const r=t.splice(i,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let s=t[i].distance;if(t[i].object.visible&&(s-=s*t[i].hysteresis),e<s)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){_S.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(_S);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){_S.setFromMatrixPosition(e.matrixWorld),NL.setFromMatrixPosition(this.matrixWorld);const i=_S.distanceTo(NL)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let a=t[r].distance;if(t[r].object.visible&&(a-=a*t[r].hysteresis),i>=a)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const a=i[r];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const UL=new ee,FL=new Ii,PL=new Ii,JW=new ee,OL=new qt,SS=new ee,K3=new jr,kL=new qt,$3=new gf;class u4 extends Wt{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=LR,this.bindMatrix=new qt,this.bindMatrixInverse=new qt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new gr),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,SS),this.boundingBox.expandByPoint(SS)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new jr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,SS),this.boundingSphere.expandByPoint(SS)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),K3.copy(this.boundingSphere),K3.applyMatrix4(r),e.ray.intersectsSphere(K3)!==!1&&(kL.copy(r).invert(),$3.copy(e.ray).applyMatrix4(kL),!(this.boundingBox!==null&&$3.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,$3)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ii,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===LR?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===a8?this.bindMatrixInverse.copy(this.bindMatrix).invert():Gt("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;FL.fromBufferAttribute(r.attributes.skinIndex,e),PL.fromBufferAttribute(r.attributes.skinWeight,e),UL.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=PL.getComponent(s);if(a!==0){const o=FL.getComponent(s);OL.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),t.addScaledVector(JW.copy(UL).applyMatrix4(OL),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class RM extends Gn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ll extends Pi{constructor(e=null,t=1,i=1,r,s,a,o,c,h=Ri,p=Ri,g,A){super(null,a,o,c,h,p,r,s,g,A),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const zL=new qt,ZW=new qt;class ix{constructor(e=[],t=[]){this.uuid=ol(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){Gt("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new qt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new qt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:ZW;zL.multiplyMatrices(o,t[s]),zL.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new ix(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new ll(t,e,e,Fi,Si);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let a=t[s];a===void 0&&(Gt("Skeleton: No bone found with UUID:",s),a=new RM),this.bones.push(a),this.boneInverses.push(new qt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const a=t[r];e.bones.push(a.uuid);const o=i[r];e.boneInverses.push(o.toArray())}return e}}class jd extends An{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const TA=new qt,GL=new qt,ES=[],HL=new gr,eq=new qt,i1=new Wt,r1=new jr;class BM extends Wt{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new jd(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,eq)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new gr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,TA),HL.copy(e.boundingBox).applyMatrix4(TA),this.boundingBox.union(HL)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new jr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,TA),r1.copy(e.boundingSphere).applyMatrix4(TA),this.boundingSphere.union(r1)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const i=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=i.length+1,a=e*s+1;for(let o=0;o<i.length;o++)i[o]=r[a+o]}raycast(e,t){const i=this.matrixWorld,r=this.count;if(i1.geometry=this.geometry,i1.material=this.material,i1.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),r1.copy(this.boundingSphere),r1.applyMatrix4(i),e.ray.intersectsSphere(r1)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,TA),GL.multiplyMatrices(i,TA),i1.matrixWorld=GL,i1.raycast(e,ES);for(let a=0,o=ES.length;a<o;a++){const c=ES[a];c.instanceId=s,c.object=this,t.push(c)}ES.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new jd(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const i=t.morphTargetInfluences,r=i.length+1;this.morphTexture===null&&(this.morphTexture=new ll(new Float32Array(r*this.count),r,this.count,qu,Si));const s=this.morphTexture.source.data.data;let a=0;for(let h=0;h<i.length;h++)a+=i[h];const o=this.geometry.morphTargetsRelative?1:1-a,c=r*e;s[c]=o,s.set(i,c+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const J3=new ee,tq=new ee,nq=new Rn;class nc{constructor(e=new ee(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=J3.subVectors(i,t).cross(tq.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(J3),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||nq.getNormalMatrix(e),r=this.coplanarPoint(J3).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Gp=new jr,iq=new Ze(.5,.5),wS=new ee;class av{constructor(e=new nc,t=new nc,i=new nc,r=new nc,s=new nc,a=new nc){this.planes=[e,t,i,r,s,a]}set(e,t,i,r,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(i),o[3].copy(r),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=rl,i=!1){const r=this.planes,s=e.elements,a=s[0],o=s[1],c=s[2],h=s[3],p=s[4],g=s[5],A=s[6],v=s[7],x=s[8],S=s[9],_=s[10],E=s[11],C=s[12],T=s[13],R=s[14],B=s[15];if(r[0].setComponents(h-a,v-p,E-x,B-C).normalize(),r[1].setComponents(h+a,v+p,E+x,B+C).normalize(),r[2].setComponents(h+o,v+g,E+S,B+T).normalize(),r[3].setComponents(h-o,v-g,E-S,B-T).normalize(),i)r[4].setComponents(c,A,_,R).normalize(),r[5].setComponents(h-c,v-A,E-_,B-R).normalize();else if(r[4].setComponents(h-c,v-A,E-_,B-R).normalize(),t===rl)r[5].setComponents(h+c,v+A,E+_,B+R).normalize();else if(t===I0)r[5].setComponents(c,A,_,R).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Gp.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Gp.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Gp)}intersectsSprite(e){Gp.center.set(0,0,0);const t=iq.distanceTo(e.center);return Gp.radius=.7071067811865476+t,Gp.applyMatrix4(e.matrixWorld),this.intersectsSphere(Gp)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(wS.x=r.normal.x>0?e.max.x:e.min.x,wS.y=r.normal.y>0?e.max.y:e.min.y,wS.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(wS)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Nu=new qt,Uu=new av;class DM{constructor(){this.coordinateSystem=rl}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(Nu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Uu.setFromProjectionMatrix(Nu,r.coordinateSystem,r.reversedDepth),Uu.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(Nu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Uu.setFromProjectionMatrix(Nu,r.coordinateSystem,r.reversedDepth),Uu.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(Nu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Uu.setFromProjectionMatrix(Nu,r.coordinateSystem,r.reversedDepth),Uu.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(Nu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Uu.setFromProjectionMatrix(Nu,r.coordinateSystem,r.reversedDepth),Uu.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(Nu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Uu.setFromProjectionMatrix(Nu,r.coordinateSystem,r.reversedDepth),Uu.containsPoint(e))return!0}return!1}clone(){return new DM}}function Z3(n,e){return n-e}function rq(n,e){return n.z-e.z}function sq(n,e){return e.z-n.z}class aq{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,i,r){const s=this.pool,a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const o=s[this.index];a.push(o),this.index++,o.start=e,o.count=t,o.z=i,o.index=r}reset(){this.list.length=0,this.index=0}}const Bo=new qt,oq=new Mt(1,1,1),QL=new av,lq=new DM,MS=new gr,Hp=new jr,s1=new ee,VL=new ee,cq=new ee,eT=new aq,Ua=new Wt,CS=[];function uq(n,e,t=0){const i=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const r=n.count;for(let s=0;s<r;s++)for(let a=0;a<i;a++)e.setComponent(s+t,a,n.getComponent(s,a))}else e.array.set(n.array,t*i);e.needsUpdate=!0}function Qp(n,e){if(n.constructor!==e.constructor){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++)e[i]=n[i]}else{const t=Math.min(n.length,e.length);e.set(new n.constructor(n.buffer,0,t))}}class w8 extends Wt{constructor(e,t,i=t*2,r){super(new vn,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),i=new ll(t,e,e,Fi,Si);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),i=new ll(t,e,e,ex,fl);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),i=new ll(t,e,e,Fi,Si);i.colorSpace=Wn.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const t=this.geometry,i=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:o,itemSize:c,normalized:h}=a,p=new o.constructor(i*c),g=new An(p,c,h);t.setAttribute(s,g)}if(e.getIndex()!==null){const s=i>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new An(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const i in t.attributes){if(!e.hasAttribute(i))throw new Error(`THREE.BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=t.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gr);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let i=0,r=t.length;i<r;i++){if(t[i].active===!1)continue;const s=t[i].geometryIndex;this.getMatrixAt(i,Bo),this.getBoundingBoxAt(s,MS).applyMatrix4(Bo),e.union(MS)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new jr);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let i=0,r=t.length;i<r;i++){if(t[i].active===!1)continue;const s=t[i].geometryIndex;this.getMatrixAt(i,Bo),this.getBoundingSphereAt(s,Hp).applyMatrix4(Bo),e.union(Hp)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const i={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(Z3),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=i):(r=this._instanceInfo.length,this._instanceInfo.push(i));const s=this._matricesTexture;Bo.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(oq.toArray(a.image.data,r*4),a.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,t=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const a=e.getIndex();if(a!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=i===-1?a.count:i),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let c;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(Z3),c=this._availableGeometryIds.shift(),s[c]=r):(c=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(c,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,c}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const i=this.geometry,r=i.getIndex()!==null,s=i.getIndex(),a=t.getIndex(),o=this._geometryInfo[e];if(r&&a.count>o.reservedIndexCount||t.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const c=o.vertexStart,h=o.reservedVertexCount;o.vertexCount=t.getAttribute("position").count;for(const p in i.attributes){const g=t.getAttribute(p),A=i.getAttribute(p);uq(g,A,c);const v=g.itemSize;for(let x=g.count,S=h;x<S;x++){const _=c+x;for(let E=0;E<v;E++)A.setComponent(_,E,0)}A.needsUpdate=!0,A.addUpdateRange(c*v,h*v)}if(r){const p=o.indexStart,g=o.reservedIndexCount;o.indexCount=t.getIndex().count;for(let A=0;A<a.count;A++)s.setX(p+A,c+a.getX(A));for(let A=a.count,v=g;A<v;A++)s.setX(p+A,c);s.needsUpdate=!0,s.addUpdateRange(p,o.reservedIndexCount)}return o.start=r?o.indexStart:o.vertexStart,o.count=r?o.indexCount:o.vertexCount,o.boundingBox=null,t.boundingBox!==null&&(o.boundingBox=t.boundingBox.clone()),o.boundingSphere=null,t.boundingSphere!==null&&(o.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const i=this._instanceInfo;for(let r=0,s=i.length;r<s;r++)i[r].active&&i[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const i=this._geometryInfo,r=i.map((a,o)=>o).sort((a,o)=>i[a].vertexStart-i[o].vertexStart),s=this.geometry;for(let a=0,o=i.length;a<o;a++){const c=r[a],h=i[c];if(h.active!==!1){if(s.index!==null){if(h.indexStart!==t){const{indexStart:p,vertexStart:g,reservedIndexCount:A}=h,v=s.index,x=v.array,S=e-g;for(let _=p;_<p+A;_++)x[_]=x[_]+S;v.array.copyWithin(t,p,p+A),v.addUpdateRange(t,A),v.needsUpdate=!0,h.indexStart=t}t+=h.reservedIndexCount}if(h.vertexStart!==e){const{vertexStart:p,reservedVertexCount:g}=h,A=s.attributes;for(const v in A){const x=A[v],{array:S,itemSize:_}=x;S.copyWithin(e*_,p*_,(p+g)*_),x.addUpdateRange(e*_,g*_),x.needsUpdate=!0}h.vertexStart=e}e+=h.reservedVertexCount,h.start=s.index?h.indexStart:h.vertexStart,this._nextIndexStart=s.index?h.indexStart+h.reservedIndexCount:0,this._nextVertexStart=h.vertexStart+h.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const s=new gr,a=i.index,o=i.attributes.position;for(let c=r.start,h=r.start+r.count;c<h;c++){let p=c;a&&(p=a.getX(p)),s.expandByPoint(s1.fromBufferAttribute(o,p))}r.boundingBox=s}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const s=new jr;this.getBoundingBoxAt(e,MS),MS.getCenter(s.center);const a=i.index,o=i.attributes.position;let c=0;for(let h=r.start,p=r.start+r.count;h<p;h++){let g=h;a&&(g=a.getX(g)),s1.fromBufferAttribute(o,g),c=Math.max(c,s.center.distanceToSquared(s1))}s.radius=Math.sqrt(c),r.boundingSphere=s}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const i=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,e*16),i.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const i=this._geometryInfo[e];return t.vertexStart=i.vertexStart,t.vertexCount=i.vertexCount,t.reservedVertexCount=i.reservedVertexCount,t.indexStart=i.indexStart,t.indexCount=i.indexCount,t.reservedIndexCount=i.reservedIndexCount,t.start=i.start,t.count=i.count,t}setInstanceCount(e){const t=this._availableInstanceIds,i=this._instanceInfo;for(t.sort(Z3);t[t.length-1]===i.length-1;)i.pop(),t.pop();if(e<i.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),s=new Int32Array(e);Qp(this._multiDrawCounts,r),Qp(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,c=this._colorsTexture;a.dispose(),this._initIndirectTexture(),Qp(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),Qp(o.image.data,this._matricesTexture.image.data),c&&(c.dispose(),this._initColorsTexture(),Qp(c.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const i=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...i.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...i.map(c=>c.indexStart+c.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new vn,this._initializeGeometry(s));const a=this.geometry;s.index&&Qp(s.index.array,a.index.array);for(const o in s.attributes)Qp(s.attributes[o].array,a.attributes[o].array)}raycast(e,t){const i=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,a=this.geometry;Ua.material=this.material,Ua.geometry.index=a.index,Ua.geometry.attributes=a.attributes,Ua.geometry.boundingBox===null&&(Ua.geometry.boundingBox=new gr),Ua.geometry.boundingSphere===null&&(Ua.geometry.boundingSphere=new jr);for(let o=0,c=i.length;o<c;o++){if(!i[o].visible||!i[o].active)continue;const h=i[o].geometryIndex,p=r[h];Ua.geometry.setDrawRange(p.start,p.count),this.getMatrixAt(o,Ua.matrixWorld).premultiply(s),this.getBoundingBoxAt(h,Ua.geometry.boundingBox),this.getBoundingSphereAt(h,Ua.geometry.boundingSphere),Ua.raycast(e,CS);for(let g=0,A=CS.length;g<A;g++){const v=CS[g];v.object=this,v.batchId=o,t.push(v)}CS.length=0}Ua.material=null,Ua.geometry.index=null,Ua.geometry.attributes={},Ua.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,c=this._instanceInfo,h=this._multiDrawStarts,p=this._multiDrawCounts,g=this._geometryInfo,A=this.perObjectFrustumCulled,v=this._indirectTexture,x=v.image.data,S=i.isArrayCamera?lq:QL;A&&!i.isArrayCamera&&(Bo.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),QL.setFromProjectionMatrix(Bo,i.coordinateSystem,i.reversedDepth));let _=0;if(this.sortObjects){Bo.copy(this.matrixWorld).invert(),s1.setFromMatrixPosition(i.matrixWorld).applyMatrix4(Bo),VL.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(Bo);for(let T=0,R=c.length;T<R;T++)if(c[T].visible&&c[T].active){const B=c[T].geometryIndex;this.getMatrixAt(T,Bo),this.getBoundingSphereAt(B,Hp).applyMatrix4(Bo);let U=!1;if(A&&(U=!S.intersectsSphere(Hp,i)),!U){const O=g[B],F=cq.subVectors(Hp.center,s1).dot(VL);eT.push(O.start,O.count,F,T)}}const E=eT.list,C=this.customSort;C===null?E.sort(s.transparent?sq:rq):C.call(this,E,i);for(let T=0,R=E.length;T<R;T++){const B=E[T];h[_]=B.start*o,p[_]=B.count,x[_]=B.index,_++}eT.reset()}else for(let E=0,C=c.length;E<C;E++)if(c[E].visible&&c[E].active){const T=c[E].geometryIndex;let R=!1;if(A&&(this.getMatrixAt(E,Bo),this.getBoundingSphereAt(T,Hp).applyMatrix4(Bo),R=!S.intersectsSphere(Hp,i)),!R){const B=g[T];h[_]=B.start*o,p[_]=B.count,x[_]=E,_++}}v.needsUpdate=!0,this._multiDrawCount=_,this._visibilityChanged=!1}onBeforeShadow(e,t,i,r,s,a){this.onBeforeRender(e,null,r,s,a)}}class za extends ts{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Mt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Dw=new ee,Lw=new ee,jL=new qt,a1=new gf,TS=new jr,tT=new ee,WL=new ee;class Wc extends Gn{constructor(e=new vn,t=new za){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)Dw.fromBufferAttribute(t,r-1),Lw.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=Dw.distanceTo(Lw);e.setAttribute("lineDistance",new Kt(i,1))}else Gt("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),TS.copy(i.boundingSphere),TS.applyMatrix4(r),TS.radius+=s,e.ray.intersectsSphere(TS)===!1)return;jL.copy(r).invert(),a1.copy(e.ray).applyMatrix4(jL);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,h=this.isLineSegments?2:1,p=i.index,A=i.attributes.position;if(p!==null){const v=Math.max(0,a.start),x=Math.min(p.count,a.start+a.count);for(let S=v,_=x-1;S<_;S+=h){const E=p.getX(S),C=p.getX(S+1),T=IS(this,e,a1,c,E,C,S);T&&t.push(T)}if(this.isLineLoop){const S=p.getX(x-1),_=p.getX(v),E=IS(this,e,a1,c,S,_,x-1);E&&t.push(E)}}else{const v=Math.max(0,a.start),x=Math.min(A.count,a.start+a.count);for(let S=v,_=x-1;S<_;S+=h){const E=IS(this,e,a1,c,S,S+1,S);E&&t.push(E)}if(this.isLineLoop){const S=IS(this,e,a1,c,x-1,v,x-1);S&&t.push(S)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function IS(n,e,t,i,r,s,a){const o=n.geometry.attributes.position;if(Dw.fromBufferAttribute(o,r),Lw.fromBufferAttribute(o,s),t.distanceSqToSegment(Dw,Lw,tT,WL)>i)return;tT.applyMatrix4(n.matrixWorld);const h=e.ray.origin.distanceTo(tT);if(!(h<e.near||h>e.far))return{distance:h,point:WL.clone().applyMatrix4(n.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:n}}const qL=new ee,XL=new ee;class qc extends Wc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)qL.fromBufferAttribute(t,r),XL.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+qL.distanceTo(XL);e.setAttribute("lineDistance",new Kt(i,1))}else Gt("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class h4 extends Wc{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class LM extends ts{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Mt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const YL=new qt,PR=new gf,RS=new jr,BS=new ee;class f4 extends Gn{constructor(e=new vn,t=new LM){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),RS.copy(i.boundingSphere),RS.applyMatrix4(r),RS.radius+=s,e.ray.intersectsSphere(RS)===!1)return;YL.copy(r).invert(),PR.copy(e.ray).applyMatrix4(YL);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,h=i.index,g=i.attributes.position;if(h!==null){const A=Math.max(0,a.start),v=Math.min(h.count,a.start+a.count);for(let x=A,S=v;x<S;x++){const _=h.getX(x);BS.fromBufferAttribute(g,_),KL(BS,_,c,r,e,t,this)}}else{const A=Math.max(0,a.start),v=Math.min(g.count,a.start+a.count);for(let x=A,S=v;x<S;x++)BS.fromBufferAttribute(g,x),KL(BS,x,c,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function KL(n,e,t,i,r,s,a){const o=PR.distanceSqToPoint(n);if(o<t){const c=new ee;PR.closestPointToPoint(n,c),c.applyMatrix4(i);const h=r.ray.origin.distanceTo(c);if(h<r.near||h>r.far)return;s.push({distance:h,distanceToRay:Math.sqrt(o),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class NM extends Pi{constructor(e,t,i,r,s=mn,a=mn,o,c,h){super(e,t,i,r,s,a,o,c,h),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const p=this;function g(){p.needsUpdate=!0,p._requestVideoFrameCallbackId=e.requestVideoFrameCallback(g)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(g))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class hq extends NM{constructor(e,t,i,r,s,a,o,c){super({},e,t,i,r,s,a,o,c),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class fq extends Pi{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ri,this.minFilter=Ri,this.generateMipmaps=!1,this.needsUpdate=!0}}class ff extends Pi{constructor(e,t,i,r,s,a,o,c,h,p,g,A){super(null,a,o,c,h,p,r,s,g,A),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class M8 extends ff{constructor(e,t,i,r,s,a){super(e,t,i,s,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=or,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class C8 extends ff{constructor(e,t,i){super(void 0,e[0].width,e[0].height,t,i,jc),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class d4 extends Pi{constructor(e,t,i,r,s,a,o,c,h){super(e,t,i,r,s,a,o,c,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Qm extends Pi{constructor(e,t,i=fl,r,s,a,o=Ri,c=Ri,h,p=Zu,g=1){if(p!==Zu&&p!==Bd)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const A={width:e,height:t,depth:g};super(A,r,s,a,o,c,p,i,h),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new of(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class T8 extends Qm{constructor(e,t=fl,i=jc,r,s,a=Ri,o=Ri,c,h=Zu){const p={width:e,height:e,depth:1},g=[p,p,p,p,p,p];super(e,e,t,i,r,s,a,o,c,h),this.image=g,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class p4 extends Pi{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class UM extends vn{constructor(e=1,t=1,i=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:i,radialSegments:r,heightSegments:s},t=Math.max(0,t),i=Math.max(1,Math.floor(i)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));const a=[],o=[],c=[],h=[],p=t/2,g=Math.PI/2*e,A=t,v=2*g+A,x=i*2+s,S=r+1,_=new ee,E=new ee;for(let C=0;C<=x;C++){let T=0,R=0,B=0,U=0;if(C<=i){const L=C/i,P=L*Math.PI/2;R=-p-e*Math.cos(P),B=e*Math.sin(P),U=-e*Math.cos(P),T=L*g}else if(C<=i+s){const L=(C-i)/s;R=-p+L*t,B=e,U=0,T=g+L*A}else{const L=(C-i-s)/i,P=L*Math.PI/2;R=p+e*Math.sin(P),B=e*Math.cos(P),U=e*Math.sin(P),T=g+A+L*g}const O=Math.max(0,Math.min(1,T/v));let F=0;C===0?F=.5/r:C===x&&(F=-.5/r);for(let L=0;L<=r;L++){const P=L/r,W=P*Math.PI*2,j=Math.sin(W),V=Math.cos(W);E.x=-B*V,E.y=R,E.z=B*j,o.push(E.x,E.y,E.z),_.set(-B*V,U,B*j),_.normalize(),c.push(_.x,_.y,_.z),h.push(P+F,O)}if(C>0){const L=(C-1)*S;for(let P=0;P<r;P++){const W=L+P,j=L+P+1,V=C*S+P,q=C*S+P+1;a.push(W,j,V),a.push(j,q,V)}}}this.setIndex(a),this.setAttribute("position",new Kt(o,3)),this.setAttribute("normal",new Kt(c,3)),this.setAttribute("uv",new Kt(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new UM(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class Vm extends vn{constructor(e=1,t=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],a=[],o=[],c=[],h=new ee,p=new Ze;a.push(0,0,0),o.push(0,0,1),c.push(.5,.5);for(let g=0,A=3;g<=t;g++,A+=3){const v=i+g/t*r;h.x=e*Math.cos(v),h.y=e*Math.sin(v),a.push(h.x,h.y,h.z),o.push(0,0,1),p.x=(a[A]/e+1)/2,p.y=(a[A+1]/e+1)/2,c.push(p.x,p.y)}for(let g=1;g<=t;g++)s.push(g,g+1,0);this.setIndex(s),this.setAttribute("position",new Kt(a,3)),this.setAttribute("normal",new Kt(o,3)),this.setAttribute("uv",new Kt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Vm(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Wd extends vn{constructor(e=1,t=1,i=1,r=32,s=1,a=!1,o=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:c};const h=this;r=Math.floor(r),s=Math.floor(s);const p=[],g=[],A=[],v=[];let x=0;const S=[],_=i/2;let E=0;C(),a===!1&&(e>0&&T(!0),t>0&&T(!1)),this.setIndex(p),this.setAttribute("position",new Kt(g,3)),this.setAttribute("normal",new Kt(A,3)),this.setAttribute("uv",new Kt(v,2));function C(){const R=new ee,B=new ee;let U=0;const O=(t-e)/i;for(let F=0;F<=s;F++){const L=[],P=F/s,W=P*(t-e)+e;for(let j=0;j<=r;j++){const V=j/r,q=V*c+o,re=Math.sin(q),Q=Math.cos(q);B.x=W*re,B.y=-P*i+_,B.z=W*Q,g.push(B.x,B.y,B.z),R.set(re,O,Q).normalize(),A.push(R.x,R.y,R.z),v.push(V,1-P),L.push(x++)}S.push(L)}for(let F=0;F<r;F++)for(let L=0;L<s;L++){const P=S[L][F],W=S[L+1][F],j=S[L+1][F+1],V=S[L][F+1];(e>0||L!==0)&&(p.push(P,W,V),U+=3),(t>0||L!==s-1)&&(p.push(W,j,V),U+=3)}h.addGroup(E,U,0),E+=U}function T(R){const B=x,U=new Ze,O=new ee;let F=0;const L=R===!0?e:t,P=R===!0?1:-1;for(let j=1;j<=r;j++)g.push(0,_*P,0),A.push(0,P,0),v.push(.5,.5),x++;const W=x;for(let j=0;j<=r;j++){const q=j/r*c+o,re=Math.cos(q),Q=Math.sin(q);O.x=L*Q,O.y=_*P,O.z=L*re,g.push(O.x,O.y,O.z),A.push(0,P,0),U.x=re*.5+.5,U.y=Q*.5*P+.5,v.push(U.x,U.y),x++}for(let j=0;j<r;j++){const V=B+j,q=W+j;R===!0?p.push(q,q+1,V):p.push(q+1,q,V),F+=3}h.addGroup(E,F,R===!0?1:2),E+=F}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Wd(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ov extends Wd{constructor(e=1,t=1,i=32,r=1,s=!1,a=0,o=Math.PI*2){super(0,e,t,i,r,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new ov(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Jd extends vn{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],a=[];o(r),h(i),p(),this.setAttribute("position",new Kt(s,3)),this.setAttribute("normal",new Kt(s.slice(),3)),this.setAttribute("uv",new Kt(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function o(C){const T=new ee,R=new ee,B=new ee;for(let U=0;U<t.length;U+=3)v(t[U+0],T),v(t[U+1],R),v(t[U+2],B),c(T,R,B,C)}function c(C,T,R,B){const U=B+1,O=[];for(let F=0;F<=U;F++){O[F]=[];const L=C.clone().lerp(R,F/U),P=T.clone().lerp(R,F/U),W=U-F;for(let j=0;j<=W;j++)j===0&&F===U?O[F][j]=L:O[F][j]=L.clone().lerp(P,j/W)}for(let F=0;F<U;F++)for(let L=0;L<2*(U-F)-1;L++){const P=Math.floor(L/2);L%2===0?(A(O[F][P+1]),A(O[F+1][P]),A(O[F][P])):(A(O[F][P+1]),A(O[F+1][P+1]),A(O[F+1][P]))}}function h(C){const T=new ee;for(let R=0;R<s.length;R+=3)T.x=s[R+0],T.y=s[R+1],T.z=s[R+2],T.normalize().multiplyScalar(C),s[R+0]=T.x,s[R+1]=T.y,s[R+2]=T.z}function p(){const C=new ee;for(let T=0;T<s.length;T+=3){C.x=s[T+0],C.y=s[T+1],C.z=s[T+2];const R=_(C)/2/Math.PI+.5,B=E(C)/Math.PI+.5;a.push(R,1-B)}x(),g()}function g(){for(let C=0;C<a.length;C+=6){const T=a[C+0],R=a[C+2],B=a[C+4],U=Math.max(T,R,B),O=Math.min(T,R,B);U>.9&&O<.1&&(T<.2&&(a[C+0]+=1),R<.2&&(a[C+2]+=1),B<.2&&(a[C+4]+=1))}}function A(C){s.push(C.x,C.y,C.z)}function v(C,T){const R=C*3;T.x=e[R+0],T.y=e[R+1],T.z=e[R+2]}function x(){const C=new ee,T=new ee,R=new ee,B=new ee,U=new Ze,O=new Ze,F=new Ze;for(let L=0,P=0;L<s.length;L+=9,P+=6){C.set(s[L+0],s[L+1],s[L+2]),T.set(s[L+3],s[L+4],s[L+5]),R.set(s[L+6],s[L+7],s[L+8]),U.set(a[P+0],a[P+1]),O.set(a[P+2],a[P+3]),F.set(a[P+4],a[P+5]),B.copy(C).add(T).add(R).divideScalar(3);const W=_(B);S(U,P+0,C,W),S(O,P+2,T,W),S(F,P+4,R,W)}}function S(C,T,R,B){B<0&&C.x===1&&(a[T]=C.x-1),R.x===0&&R.z===0&&(a[T]=B/2/Math.PI+.5)}function _(C){return Math.atan2(C.z,-C.x)}function E(C){return Math.atan2(-C.y,Math.sqrt(C.x*C.x+C.z*C.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jd(e.vertices,e.indices,e.radius,e.detail)}}class FM extends Jd{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new FM(e.radius,e.detail)}}const DS=new ee,LS=new ee,nT=new ee,NS=new ea;class I8 extends vn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(Im*t),a=e.getIndex(),o=e.getAttribute("position"),c=a?a.count:o.count,h=[0,0,0],p=["a","b","c"],g=new Array(3),A={},v=[];for(let x=0;x<c;x+=3){a?(h[0]=a.getX(x),h[1]=a.getX(x+1),h[2]=a.getX(x+2)):(h[0]=x,h[1]=x+1,h[2]=x+2);const{a:S,b:_,c:E}=NS;if(S.fromBufferAttribute(o,h[0]),_.fromBufferAttribute(o,h[1]),E.fromBufferAttribute(o,h[2]),NS.getNormal(nT),g[0]=`${Math.round(S.x*r)},${Math.round(S.y*r)},${Math.round(S.z*r)}`,g[1]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,g[2]=`${Math.round(E.x*r)},${Math.round(E.y*r)},${Math.round(E.z*r)}`,!(g[0]===g[1]||g[1]===g[2]||g[2]===g[0]))for(let C=0;C<3;C++){const T=(C+1)%3,R=g[C],B=g[T],U=NS[p[C]],O=NS[p[T]],F=`${R}_${B}`,L=`${B}_${R}`;L in A&&A[L]?(nT.dot(A[L].normal)<=s&&(v.push(U.x,U.y,U.z),v.push(O.x,O.y,O.z)),A[L]=null):F in A||(A[F]={index0:h[C],index1:h[T],normal:nT.clone()})}}for(const x in A)if(A[x]){const{index0:S,index1:_}=A[x];DS.fromBufferAttribute(o,S),LS.fromBufferAttribute(o,_),v.push(DS.x,DS.y,DS.z),v.push(LS.x,LS.y,LS.z)}this.setAttribute("position",new Kt(v,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Xc{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){Gt("Curve: .getPoint() not implemented.")}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const i=this.getLengths();let r=0;const s=i.length;let a;t?a=t:a=e*i[s-1];let o=0,c=s-1,h;for(;o<=c;)if(r=Math.floor(o+(c-o)/2),h=i[r]-a,h<0)o=r+1;else if(h>0)c=r-1;else{c=r;break}if(r=c,i[r]===a)return r/(s-1);const p=i[r],A=i[r+1]-p,v=(a-p)/A;return(r+v)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),o=this.getPoint(s),c=t||(a.isVector2?new Ze:new ee);return c.copy(o).sub(a).normalize(),c}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t=!1){const i=new ee,r=[],s=[],a=[],o=new ee,c=new qt;for(let v=0;v<=e;v++){const x=v/e;r[v]=this.getTangentAt(x,new ee)}s[0]=new ee,a[0]=new ee;let h=Number.MAX_VALUE;const p=Math.abs(r[0].x),g=Math.abs(r[0].y),A=Math.abs(r[0].z);p<=h&&(h=p,i.set(1,0,0)),g<=h&&(h=g,i.set(0,1,0)),A<=h&&i.set(0,0,1),o.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],o),a[0].crossVectors(r[0],s[0]);for(let v=1;v<=e;v++){if(s[v]=s[v-1].clone(),a[v]=a[v-1].clone(),o.crossVectors(r[v-1],r[v]),o.length()>Number.EPSILON){o.normalize();const x=Math.acos(Mn(r[v-1].dot(r[v]),-1,1));s[v].applyMatrix4(c.makeRotationAxis(o,x))}a[v].crossVectors(r[v],s[v])}if(t===!0){let v=Math.acos(Mn(s[0].dot(s[e]),-1,1));v/=e,r[0].dot(o.crossVectors(s[0],s[e]))>0&&(v=-v);for(let x=1;x<=e;x++)s[x].applyMatrix4(c.makeRotationAxis(r[x],v*x)),a[x].crossVectors(r[x],s[x])}return{tangents:r,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class PM extends Xc{constructor(e=0,t=0,i=1,r=1,s=0,a=Math.PI*2,o=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=c}getPoint(e,t=new Ze){const i=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(a?s=0:s=r),this.aClockwise===!0&&!a&&(s===r?s=-r:s=s-r);const o=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(o),h=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const p=Math.cos(this.aRotation),g=Math.sin(this.aRotation),A=c-this.aX,v=h-this.aY;c=A*p-v*g+this.aX,h=A*g+v*p+this.aY}return i.set(c,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class R8 extends PM{constructor(e,t,i,r,s,a){super(e,t,i,i,r,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function m4(){let n=0,e=0,t=0,i=0;function r(s,a,o,c){n=s,e=o,t=-3*s+3*a-2*o-c,i=2*s-2*a+o+c}return{initCatmullRom:function(s,a,o,c,h){r(a,o,h*(o-s),h*(c-a))},initNonuniformCatmullRom:function(s,a,o,c,h,p,g){let A=(a-s)/h-(o-s)/(h+p)+(o-a)/p,v=(o-a)/p-(c-a)/(p+g)+(c-o)/g;A*=p,v*=p,r(a,o,A,v)},calc:function(s){const a=s*s,o=a*s;return n+e*s+t*a+i*o}}}const US=new ee,iT=new m4,rT=new m4,sT=new m4;class B8 extends Xc{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new ee){const i=t,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),c=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:c===0&&o===s-1&&(o=s-2,c=1);let h,p;this.closed||o>0?h=r[(o-1)%s]:(US.subVectors(r[0],r[1]).add(r[0]),h=US);const g=r[o%s],A=r[(o+1)%s];if(this.closed||o+2<s?p=r[(o+2)%s]:(US.subVectors(r[s-1],r[s-2]).add(r[s-1]),p=US),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let x=Math.pow(h.distanceToSquared(g),v),S=Math.pow(g.distanceToSquared(A),v),_=Math.pow(A.distanceToSquared(p),v);S<1e-4&&(S=1),x<1e-4&&(x=S),_<1e-4&&(_=S),iT.initNonuniformCatmullRom(h.x,g.x,A.x,p.x,x,S,_),rT.initNonuniformCatmullRom(h.y,g.y,A.y,p.y,x,S,_),sT.initNonuniformCatmullRom(h.z,g.z,A.z,p.z,x,S,_)}else this.curveType==="catmullrom"&&(iT.initCatmullRom(h.x,g.x,A.x,p.x,this.tension),rT.initCatmullRom(h.y,g.y,A.y,p.y,this.tension),sT.initCatmullRom(h.z,g.z,A.z,p.z,this.tension));return i.set(iT.calc(c),rT.calc(c),sT.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new ee().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function $L(n,e,t,i,r){const s=(i-e)*.5,a=(r-t)*.5,o=n*n,c=n*o;return(2*t-2*i+s+a)*c+(-3*t+3*i-2*s-a)*o+s*n+t}function dq(n,e){const t=1-n;return t*t*e}function pq(n,e){return 2*(1-n)*n*e}function mq(n,e){return n*n*e}function eb(n,e,t,i){return dq(n,e)+pq(n,t)+mq(n,i)}function gq(n,e){const t=1-n;return t*t*t*e}function Aq(n,e){const t=1-n;return 3*t*t*n*e}function vq(n,e){return 3*(1-n)*n*n*e}function yq(n,e){return n*n*n*e}function tb(n,e,t,i,r){return gq(n,e)+Aq(n,t)+vq(n,i)+yq(n,r)}class g4 extends Xc{constructor(e=new Ze,t=new Ze,i=new Ze,r=new Ze){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Ze){const i=t,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(tb(e,r.x,s.x,a.x,o.x),tb(e,r.y,s.y,a.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class D8 extends Xc{constructor(e=new ee,t=new ee,i=new ee,r=new ee){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new ee){const i=t,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(tb(e,r.x,s.x,a.x,o.x),tb(e,r.y,s.y,a.y,o.y),tb(e,r.z,s.z,a.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class A4 extends Xc{constructor(e=new Ze,t=new Ze){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ze){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ze){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class L8 extends Xc{constructor(e=new ee,t=new ee){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ee){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ee){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class v4 extends Xc{constructor(e=new Ze,t=new Ze,i=new Ze){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Ze){const i=t,r=this.v0,s=this.v1,a=this.v2;return i.set(eb(e,r.x,s.x,a.x),eb(e,r.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class OM extends Xc{constructor(e=new ee,t=new ee,i=new ee){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new ee){const i=t,r=this.v0,s=this.v1,a=this.v2;return i.set(eb(e,r.x,s.x,a.x),eb(e,r.y,s.y,a.y),eb(e,r.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class y4 extends Xc{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ze){const i=t,r=this.points,s=(r.length-1)*e,a=Math.floor(s),o=s-a,c=r[a===0?a:a-1],h=r[a],p=r[a>r.length-2?r.length-1:a+1],g=r[a>r.length-3?r.length-1:a+2];return i.set($L(o,c.x,h.x,p.x,g.x),$L(o,c.y,h.y,p.y,g.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new Ze().fromArray(r))}return this}}var Nw=Object.freeze({__proto__:null,ArcCurve:R8,CatmullRomCurve3:B8,CubicBezierCurve:g4,CubicBezierCurve3:D8,EllipseCurve:PM,LineCurve:A4,LineCurve3:L8,QuadraticBezierCurve:v4,QuadraticBezierCurve3:OM,SplineCurve:y4});class N8 extends Xc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Nw[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const a=r[s]-i,o=this.curves[s],c=o.getLength(),h=c===0?0:1-a/c;return o.getPointAt(h,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const a=s[r],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,c=a.getPoints(o);for(let h=0;h<c.length;h++){const p=c[h];i&&i.equals(p)||(t.push(p),i=p)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new Nw[r.type]().fromJSON(r))}return this}}class Uw extends N8{constructor(e){super(),this.type="Path",this.currentPoint=new Ze,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new A4(this.currentPoint.clone(),new Ze(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new v4(this.currentPoint.clone(),new Ze(e,t),new Ze(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,a){const o=new g4(this.currentPoint.clone(),new Ze(e,t),new Ze(i,r),new Ze(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new y4(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,a){const o=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+o,t+c,i,r,s,a),this}absarc(e,t,i,r,s,a){return this.absellipse(e,t,i,i,r,s,a),this}ellipse(e,t,i,r,s,a,o,c){const h=this.currentPoint.x,p=this.currentPoint.y;return this.absellipse(e+h,t+p,i,r,s,a,o,c),this}absellipse(e,t,i,r,s,a,o,c){const h=new PM(e,t,i,r,s,a,o,c);if(this.curves.length>0){const g=h.getPoint(0);g.equals(this.currentPoint)||this.lineTo(g.x,g.y)}this.curves.push(h);const p=h.getPoint(1);return this.currentPoint.copy(p),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class df extends Uw{constructor(e){super(e),this.uuid=ol(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new Uw().fromJSON(r))}return this}}function bq(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=U8(n,0,r,t,!0);const a=[];if(!s||s.next===s.prev)return a;let o,c,h;if(i&&(s=wq(n,e,s,t)),n.length>80*t){o=n[0],c=n[1];let p=o,g=c;for(let A=t;A<r;A+=t){const v=n[A],x=n[A+1];v<o&&(o=v),x<c&&(c=x),v>p&&(p=v),x>g&&(g=x)}h=Math.max(p-o,g-c),h=h!==0?32767/h:0}return Rb(s,a,t,o,c,h,0),a}function U8(n,e,t,i,r){let s;if(r===Fq(n,e,t,i)>0)for(let a=e;a<t;a+=i)s=JL(a/i|0,n[a],n[a+1],s);else for(let a=t-i;a>=e;a-=i)s=JL(a/i|0,n[a],n[a+1],s);return s&&U0(s,s.next)&&(Db(s),s=s.next),s}function jm(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(U0(t,t.next)||Hr(t.prev,t,t.next)===0)){if(Db(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Rb(n,e,t,i,r,s,a){if(!n)return;!a&&s&&Rq(n,i,r,s);let o=n;for(;n.prev!==n.next;){const c=n.prev,h=n.next;if(s?_q(n,i,r,s):xq(n)){e.push(c.i,n.i,h.i),Db(n),n=h.next,o=h.next;continue}if(n=h,n===o){a?a===1?(n=Sq(jm(n),e),Rb(n,e,t,i,r,s,2)):a===2&&Eq(n,e,t,i,r,s):Rb(jm(n),e,t,i,r,s,1);break}}}function xq(n){const e=n.prev,t=n,i=n.next;if(Hr(e,t,i)>=0)return!1;const r=e.x,s=t.x,a=i.x,o=e.y,c=t.y,h=i.y,p=Math.min(r,s,a),g=Math.min(o,c,h),A=Math.max(r,s,a),v=Math.max(o,c,h);let x=i.next;for(;x!==e;){if(x.x>=p&&x.x<=A&&x.y>=g&&x.y<=v&&k1(r,o,s,c,a,h,x.x,x.y)&&Hr(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function _q(n,e,t,i){const r=n.prev,s=n,a=n.next;if(Hr(r,s,a)>=0)return!1;const o=r.x,c=s.x,h=a.x,p=r.y,g=s.y,A=a.y,v=Math.min(o,c,h),x=Math.min(p,g,A),S=Math.max(o,c,h),_=Math.max(p,g,A),E=OR(v,x,e,t,i),C=OR(S,_,e,t,i);let T=n.prevZ,R=n.nextZ;for(;T&&T.z>=E&&R&&R.z<=C;){if(T.x>=v&&T.x<=S&&T.y>=x&&T.y<=_&&T!==r&&T!==a&&k1(o,p,c,g,h,A,T.x,T.y)&&Hr(T.prev,T,T.next)>=0||(T=T.prevZ,R.x>=v&&R.x<=S&&R.y>=x&&R.y<=_&&R!==r&&R!==a&&k1(o,p,c,g,h,A,R.x,R.y)&&Hr(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;T&&T.z>=E;){if(T.x>=v&&T.x<=S&&T.y>=x&&T.y<=_&&T!==r&&T!==a&&k1(o,p,c,g,h,A,T.x,T.y)&&Hr(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;R&&R.z<=C;){if(R.x>=v&&R.x<=S&&R.y>=x&&R.y<=_&&R!==r&&R!==a&&k1(o,p,c,g,h,A,R.x,R.y)&&Hr(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function Sq(n,e){let t=n;do{const i=t.prev,r=t.next.next;!U0(i,r)&&P8(i,t,t.next,r)&&Bb(i,r)&&Bb(r,i)&&(e.push(i.i,t.i,r.i),Db(t),Db(t.next),t=n=r),t=t.next}while(t!==n);return jm(t)}function Eq(n,e,t,i,r,s){let a=n;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&Lq(a,o)){let c=O8(a,o);a=jm(a,a.next),c=jm(c,c.next),Rb(a,e,t,i,r,s,0),Rb(c,e,t,i,r,s,0);return}o=o.next}a=a.next}while(a!==n)}function wq(n,e,t,i){const r=[];for(let s=0,a=e.length;s<a;s++){const o=e[s]*i,c=s<a-1?e[s+1]*i:n.length,h=U8(n,o,c,i,!1);h===h.next&&(h.steiner=!0),r.push(Dq(h))}r.sort(Mq);for(let s=0;s<r.length;s++)t=Cq(r[s],t);return t}function Mq(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const i=(n.next.y-n.y)/(n.next.x-n.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=i-r}return t}function Cq(n,e){const t=Tq(n,e);if(!t)return e;const i=O8(t,n);return jm(i,i.next),jm(t,t.next)}function Tq(n,e){let t=e;const i=n.x,r=n.y;let s=-1/0,a;if(U0(n,t))return t;do{if(U0(n,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const g=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(g<=i&&g>s&&(s=g,a=t.x<t.next.x?t:t.next,g===i))return a}t=t.next}while(t!==e);if(!a)return null;const o=a,c=a.x,h=a.y;let p=1/0;t=a;do{if(i>=t.x&&t.x>=c&&i!==t.x&&F8(r<h?i:s,r,c,h,r<h?s:i,r,t.x,t.y)){const g=Math.abs(r-t.y)/(i-t.x);Bb(t,n)&&(g<p||g===p&&(t.x>a.x||t.x===a.x&&Iq(a,t)))&&(a=t,p=g)}t=t.next}while(t!==o);return a}function Iq(n,e){return Hr(n.prev,n,e.prev)<0&&Hr(e.next,n,n.next)<0}function Rq(n,e,t,i){let r=n;do r.z===0&&(r.z=OR(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,Bq(r)}function Bq(n){let e,t=1;do{let i=n,r;n=null;let s=null;for(e=0;i;){e++;let a=i,o=0;for(let h=0;h<t&&(o++,a=a.nextZ,!!a);h++);let c=t;for(;o>0||c>0&&a;)o!==0&&(c===0||!a||i.z<=a.z)?(r=i,i=i.nextZ,o--):(r=a,a=a.nextZ,c--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;i=a}s.nextZ=null,t*=2}while(e>1);return n}function OR(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function Dq(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function F8(n,e,t,i,r,s,a,o){return(r-a)*(e-o)>=(n-a)*(s-o)&&(n-a)*(i-o)>=(t-a)*(e-o)&&(t-a)*(s-o)>=(r-a)*(i-o)}function k1(n,e,t,i,r,s,a,o){return!(n===a&&e===o)&&F8(n,e,t,i,r,s,a,o)}function Lq(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!Nq(n,e)&&(Bb(n,e)&&Bb(e,n)&&Uq(n,e)&&(Hr(n.prev,n,e.prev)||Hr(n,e.prev,e))||U0(n,e)&&Hr(n.prev,n,n.next)>0&&Hr(e.prev,e,e.next)>0)}function Hr(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function U0(n,e){return n.x===e.x&&n.y===e.y}function P8(n,e,t,i){const r=PS(Hr(n,e,t)),s=PS(Hr(n,e,i)),a=PS(Hr(t,i,n)),o=PS(Hr(t,i,e));return!!(r!==s&&a!==o||r===0&&FS(n,t,e)||s===0&&FS(n,i,e)||a===0&&FS(t,n,i)||o===0&&FS(t,e,i))}function FS(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function PS(n){return n>0?1:n<0?-1:0}function Nq(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&P8(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Bb(n,e){return Hr(n.prev,n,n.next)<0?Hr(n,e,n.next)>=0&&Hr(n,n.prev,e)>=0:Hr(n,e,n.prev)<0||Hr(n,n.next,e)<0}function Uq(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function O8(n,e){const t=kR(n.i,n.x,n.y),i=kR(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function JL(n,e,t,i){const r=kR(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Db(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function kR(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Fq(n,e,t,i){let r=0;for(let s=e,a=t-i;s<t;s+=i)r+=(n[a]-n[s])*(n[s+1]+n[a+1]),a=s;return r}class Pq{static triangulate(e,t,i=2){return bq(e,t,i)}}class Hc{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return Hc.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];ZL(e),eN(i,e);let a=e.length;t.forEach(ZL);for(let c=0;c<t.length;c++)r.push(a),a+=t[c].length,eN(i,t[c]);const o=Pq.triangulate(i,r);for(let c=0;c<o.length;c+=3)s.push(o.slice(c,c+3));return s}}function ZL(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function eN(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class kM extends vn{constructor(e=new df([new Ze(.5,.5),new Ze(-.5,.5),new Ze(-.5,-.5),new Ze(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let o=0,c=e.length;o<c;o++){const h=e[o];a(h)}this.setAttribute("position",new Kt(r,3)),this.setAttribute("uv",new Kt(s,2)),this.computeVertexNormals();function a(o){const c=[],h=t.curveSegments!==void 0?t.curveSegments:12,p=t.steps!==void 0?t.steps:1,g=t.depth!==void 0?t.depth:1;let A=t.bevelEnabled!==void 0?t.bevelEnabled:!0,v=t.bevelThickness!==void 0?t.bevelThickness:.2,x=t.bevelSize!==void 0?t.bevelSize:v-.1,S=t.bevelOffset!==void 0?t.bevelOffset:0,_=t.bevelSegments!==void 0?t.bevelSegments:3;const E=t.extrudePath,C=t.UVGenerator!==void 0?t.UVGenerator:Oq;let T,R=!1,B,U,O,F;if(E){T=E.getSpacedPoints(p),R=!0,A=!1;const Be=E.isCatmullRomCurve3?E.closed:!1;B=E.computeFrenetFrames(p,Be),U=new ee,O=new ee,F=new ee}A||(_=0,v=0,x=0,S=0);const L=o.extractPoints(h);let P=L.shape;const W=L.holes;if(!Hc.isClockWise(P)){P=P.reverse();for(let Be=0,Le=W.length;Be<Le;Be++){const Te=W[Be];Hc.isClockWise(Te)&&(W[Be]=Te.reverse())}}function V(Be){const Te=10000000000000001e-36;let Ye=Be[0];for(let ne=1;ne<=Be.length;ne++){const ft=ne%Be.length,qe=Be[ft],Ne=qe.x-Ye.x,tt=qe.y-Ye.y,Z=Ne*Ne+tt*tt,H=Math.max(Math.abs(qe.x),Math.abs(qe.y),Math.abs(Ye.x),Math.abs(Ye.y)),de=Te*H*H;if(Z<=de){Be.splice(ft,1),ne--;continue}Ye=qe}}V(P),W.forEach(V);const q=W.length,re=P;for(let Be=0;Be<q;Be++){const Le=W[Be];P=P.concat(Le)}function Q(Be,Le,Te){return Le||on("ExtrudeGeometry: vec does not exist"),Be.clone().addScaledVector(Le,Te)}const K=P.length;function ce(Be,Le,Te){let Ye,ne,ft;const qe=Be.x-Le.x,Ne=Be.y-Le.y,tt=Te.x-Be.x,Z=Te.y-Be.y,H=qe*qe+Ne*Ne,de=qe*Z-Ne*tt;if(Math.abs(de)>Number.EPSILON){const De=Math.sqrt(H),Ie=Math.sqrt(tt*tt+Z*Z),we=Le.x-Ne/De,st=Le.y+qe/De,it=Te.x-Z/Ie,It=Te.y+tt/Ie,Ot=((it-we)*Z-(It-st)*tt)/(qe*Z-Ne*tt);Ye=we+qe*Ot-Be.x,ne=st+Ne*Ot-Be.y;const Qe=Ye*Ye+ne*ne;if(Qe<=2)return new Ze(Ye,ne);ft=Math.sqrt(Qe/2)}else{let De=!1;qe>Number.EPSILON?tt>Number.EPSILON&&(De=!0):qe<-Number.EPSILON?tt<-Number.EPSILON&&(De=!0):Math.sign(Ne)===Math.sign(Z)&&(De=!0),De?(Ye=-Ne,ne=qe,ft=Math.sqrt(H)):(Ye=qe,ne=Ne,ft=Math.sqrt(H/2))}return new Ze(Ye/ft,ne/ft)}const ue=[];for(let Be=0,Le=re.length,Te=Le-1,Ye=Be+1;Be<Le;Be++,Te++,Ye++)Te===Le&&(Te=0),Ye===Le&&(Ye=0),ue[Be]=ce(re[Be],re[Te],re[Ye]);const oe=[];let z,$=ue.concat();for(let Be=0,Le=q;Be<Le;Be++){const Te=W[Be];z=[];for(let Ye=0,ne=Te.length,ft=ne-1,qe=Ye+1;Ye<ne;Ye++,ft++,qe++)ft===ne&&(ft=0),qe===ne&&(qe=0),z[Ye]=ce(Te[Ye],Te[ft],Te[qe]);oe.push(z),$=$.concat(z)}let ae;if(_===0)ae=Hc.triangulateShape(re,W);else{const Be=[],Le=[];for(let Te=0;Te<_;Te++){const Ye=Te/_,ne=v*Math.cos(Ye*Math.PI/2),ft=x*Math.sin(Ye*Math.PI/2)+S;for(let qe=0,Ne=re.length;qe<Ne;qe++){const tt=Q(re[qe],ue[qe],ft);Pe(tt.x,tt.y,-ne),Ye===0&&Be.push(tt)}for(let qe=0,Ne=q;qe<Ne;qe++){const tt=W[qe];z=oe[qe];const Z=[];for(let H=0,de=tt.length;H<de;H++){const De=Q(tt[H],z[H],ft);Pe(De.x,De.y,-ne),Ye===0&&Z.push(De)}Ye===0&&Le.push(Z)}}ae=Hc.triangulateShape(Be,Le)}const he=ae.length,me=x+S;for(let Be=0;Be<K;Be++){const Le=A?Q(P[Be],$[Be],me):P[Be];R?(O.copy(B.normals[0]).multiplyScalar(Le.x),U.copy(B.binormals[0]).multiplyScalar(Le.y),F.copy(T[0]).add(O).add(U),Pe(F.x,F.y,F.z)):Pe(Le.x,Le.y,0)}for(let Be=1;Be<=p;Be++)for(let Le=0;Le<K;Le++){const Te=A?Q(P[Le],$[Le],me):P[Le];R?(O.copy(B.normals[Be]).multiplyScalar(Te.x),U.copy(B.binormals[Be]).multiplyScalar(Te.y),F.copy(T[Be]).add(O).add(U),Pe(F.x,F.y,F.z)):Pe(Te.x,Te.y,g/p*Be)}for(let Be=_-1;Be>=0;Be--){const Le=Be/_,Te=v*Math.cos(Le*Math.PI/2),Ye=x*Math.sin(Le*Math.PI/2)+S;for(let ne=0,ft=re.length;ne<ft;ne++){const qe=Q(re[ne],ue[ne],Ye);Pe(qe.x,qe.y,g+Te)}for(let ne=0,ft=W.length;ne<ft;ne++){const qe=W[ne];z=oe[ne];for(let Ne=0,tt=qe.length;Ne<tt;Ne++){const Z=Q(qe[Ne],z[Ne],Ye);R?Pe(Z.x,Z.y+T[p-1].y,T[p-1].x+Te):Pe(Z.x,Z.y,g+Te)}}}le(),fe();function le(){const Be=r.length/3;if(A){let Le=0,Te=K*Le;for(let Ye=0;Ye<he;Ye++){const ne=ae[Ye];et(ne[2]+Te,ne[1]+Te,ne[0]+Te)}Le=p+_*2,Te=K*Le;for(let Ye=0;Ye<he;Ye++){const ne=ae[Ye];et(ne[0]+Te,ne[1]+Te,ne[2]+Te)}}else{for(let Le=0;Le<he;Le++){const Te=ae[Le];et(Te[2],Te[1],Te[0])}for(let Le=0;Le<he;Le++){const Te=ae[Le];et(Te[0]+K*p,Te[1]+K*p,Te[2]+K*p)}}i.addGroup(Be,r.length/3-Be,0)}function fe(){const Be=r.length/3;let Le=0;_e(re,Le),Le+=re.length;for(let Te=0,Ye=W.length;Te<Ye;Te++){const ne=W[Te];_e(ne,Le),Le+=ne.length}i.addGroup(Be,r.length/3-Be,1)}function _e(Be,Le){let Te=Be.length;for(;--Te>=0;){const Ye=Te;let ne=Te-1;ne<0&&(ne=Be.length-1);for(let ft=0,qe=p+_*2;ft<qe;ft++){const Ne=K*ft,tt=K*(ft+1),Z=Le+Ye+Ne,H=Le+ne+Ne,de=Le+ne+tt,De=Le+Ye+tt;ot(Z,H,de,De)}}}function Pe(Be,Le,Te){c.push(Be),c.push(Le),c.push(Te)}function et(Be,Le,Te){Je(Be),Je(Le),Je(Te);const Ye=r.length/3,ne=C.generateTopUV(i,r,Ye-3,Ye-2,Ye-1);_t(ne[0]),_t(ne[1]),_t(ne[2])}function ot(Be,Le,Te,Ye){Je(Be),Je(Le),Je(Ye),Je(Le),Je(Te),Je(Ye);const ne=r.length/3,ft=C.generateSideWallUV(i,r,ne-6,ne-3,ne-2,ne-1);_t(ft[0]),_t(ft[1]),_t(ft[3]),_t(ft[1]),_t(ft[2]),_t(ft[3])}function Je(Be){r.push(c[Be*3+0]),r.push(c[Be*3+1]),r.push(c[Be*3+2])}function _t(Be){s.push(Be.x),s.push(Be.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return kq(t,i,e)}static fromJSON(e,t){const i=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=t[e.shapes[s]];i.push(o)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new Nw[r.type]().fromJSON(r)),new kM(i,e.options)}}const Oq={generateTopUV:function(n,e,t,i,r){const s=e[t*3],a=e[t*3+1],o=e[i*3],c=e[i*3+1],h=e[r*3],p=e[r*3+1];return[new Ze(s,a),new Ze(o,c),new Ze(h,p)]},generateSideWallUV:function(n,e,t,i,r,s){const a=e[t*3],o=e[t*3+1],c=e[t*3+2],h=e[i*3],p=e[i*3+1],g=e[i*3+2],A=e[r*3],v=e[r*3+1],x=e[r*3+2],S=e[s*3],_=e[s*3+1],E=e[s*3+2];return Math.abs(o-p)<Math.abs(a-h)?[new Ze(a,1-c),new Ze(h,1-g),new Ze(A,1-x),new Ze(S,1-E)]:[new Ze(o,1-c),new Ze(p,1-g),new Ze(v,1-x),new Ze(_,1-E)]}};function kq(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){const s=n[i];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class rx extends Jd{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new rx(e.radius,e.detail)}}class zM extends vn{constructor(e=[new Ze(0,-.5),new Ze(.5,0),new Ze(0,.5)],t=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=Mn(r,0,Math.PI*2);const s=[],a=[],o=[],c=[],h=[],p=1/t,g=new ee,A=new Ze,v=new ee,x=new ee,S=new ee;let _=0,E=0;for(let C=0;C<=e.length-1;C++)switch(C){case 0:_=e[C+1].x-e[C].x,E=e[C+1].y-e[C].y,v.x=E*1,v.y=-_,v.z=E*0,S.copy(v),v.normalize(),c.push(v.x,v.y,v.z);break;case e.length-1:c.push(S.x,S.y,S.z);break;default:_=e[C+1].x-e[C].x,E=e[C+1].y-e[C].y,v.x=E*1,v.y=-_,v.z=E*0,x.copy(v),v.x+=S.x,v.y+=S.y,v.z+=S.z,v.normalize(),c.push(v.x,v.y,v.z),S.copy(x)}for(let C=0;C<=t;C++){const T=i+C*p*r,R=Math.sin(T),B=Math.cos(T);for(let U=0;U<=e.length-1;U++){g.x=e[U].x*R,g.y=e[U].y,g.z=e[U].x*B,a.push(g.x,g.y,g.z),A.x=C/t,A.y=U/(e.length-1),o.push(A.x,A.y);const O=c[3*U+0]*R,F=c[3*U+1],L=c[3*U+0]*B;h.push(O,F,L)}}for(let C=0;C<t;C++)for(let T=0;T<e.length-1;T++){const R=T+C*e.length,B=R,U=R+e.length,O=R+e.length+1,F=R+1;s.push(B,U,F),s.push(O,F,U)}this.setIndex(s),this.setAttribute("position",new Kt(a,3)),this.setAttribute("uv",new Kt(o,2)),this.setAttribute("normal",new Kt(h,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zM(e.points,e.segments,e.phiStart,e.phiLength)}}class lv extends Jd{constructor(e=1,t=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new lv(e.radius,e.detail)}}class ra extends vn{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,a=t/2,o=Math.floor(i),c=Math.floor(r),h=o+1,p=c+1,g=e/o,A=t/c,v=[],x=[],S=[],_=[];for(let E=0;E<p;E++){const C=E*A-a;for(let T=0;T<h;T++){const R=T*g-s;x.push(R,-C,0),S.push(0,0,1),_.push(T/o),_.push(1-E/c)}}for(let E=0;E<c;E++)for(let C=0;C<o;C++){const T=C+h*E,R=C+h*(E+1),B=C+1+h*(E+1),U=C+1+h*E;v.push(T,R,U),v.push(R,B,U)}this.setIndex(v),this.setAttribute("position",new Kt(x,3)),this.setAttribute("normal",new Kt(S,3)),this.setAttribute("uv",new Kt(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ra(e.width,e.height,e.widthSegments,e.heightSegments)}}class GM extends vn{constructor(e=.5,t=1,i=32,r=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:a},i=Math.max(3,i),r=Math.max(1,r);const o=[],c=[],h=[],p=[];let g=e;const A=(t-e)/r,v=new ee,x=new Ze;for(let S=0;S<=r;S++){for(let _=0;_<=i;_++){const E=s+_/i*a;v.x=g*Math.cos(E),v.y=g*Math.sin(E),c.push(v.x,v.y,v.z),h.push(0,0,1),x.x=(v.x/t+1)/2,x.y=(v.y/t+1)/2,p.push(x.x,x.y)}g+=A}for(let S=0;S<r;S++){const _=S*(i+1);for(let E=0;E<i;E++){const C=E+_,T=C,R=C+i+1,B=C+i+2,U=C+1;o.push(T,R,U),o.push(R,B,U)}}this.setIndex(o),this.setAttribute("position",new Kt(c,3)),this.setAttribute("normal",new Kt(h,3)),this.setAttribute("uv",new Kt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new GM(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class cv extends vn{constructor(e=new df([new Ze(0,.5),new Ze(-.5,-.5),new Ze(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],a=[];let o=0,c=0;if(Array.isArray(e)===!1)h(e);else for(let p=0;p<e.length;p++)h(e[p]),this.addGroup(o,c,p),o+=c,c=0;this.setIndex(i),this.setAttribute("position",new Kt(r,3)),this.setAttribute("normal",new Kt(s,3)),this.setAttribute("uv",new Kt(a,2));function h(p){const g=r.length/3,A=p.extractPoints(t);let v=A.shape;const x=A.holes;Hc.isClockWise(v)===!1&&(v=v.reverse());for(let _=0,E=x.length;_<E;_++){const C=x[_];Hc.isClockWise(C)===!0&&(x[_]=C.reverse())}const S=Hc.triangulateShape(v,x);for(let _=0,E=x.length;_<E;_++){const C=x[_];v=v.concat(C)}for(let _=0,E=v.length;_<E;_++){const C=v[_];r.push(C.x,C.y,0),s.push(0,0,1),a.push(C.x,C.y)}for(let _=0,E=S.length;_<E;_++){const C=S[_],T=C[0]+g,R=C[1]+g,B=C[2]+g;i.push(T,R,B),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return zq(t,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const a=t[e.shapes[r]];i.push(a)}return new cv(i,e.curveSegments)}}function zq(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const r=n[t];e.shapes.push(r.uuid)}else e.shapes.push(n.uuid);return e}class hc extends vn{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const c=Math.min(a+o,Math.PI);let h=0;const p=[],g=new ee,A=new ee,v=[],x=[],S=[],_=[];for(let E=0;E<=i;E++){const C=[],T=E/i;let R=0;E===0&&a===0?R=.5/t:E===i&&c===Math.PI&&(R=-.5/t);for(let B=0;B<=t;B++){const U=B/t;g.x=-e*Math.cos(r+U*s)*Math.sin(a+T*o),g.y=e*Math.cos(a+T*o),g.z=e*Math.sin(r+U*s)*Math.sin(a+T*o),x.push(g.x,g.y,g.z),A.copy(g).normalize(),S.push(A.x,A.y,A.z),_.push(U+R,1-T),C.push(h++)}p.push(C)}for(let E=0;E<i;E++)for(let C=0;C<t;C++){const T=p[E][C+1],R=p[E][C],B=p[E+1][C],U=p[E+1][C+1];(E!==0||a>0)&&v.push(T,R,U),(E!==i-1||c<Math.PI)&&v.push(R,B,U)}this.setIndex(v),this.setAttribute("position",new Kt(x,3)),this.setAttribute("normal",new Kt(S,3)),this.setAttribute("uv",new Kt(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class HM extends Jd{constructor(e=1,t=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new HM(e.radius,e.detail)}}class Qu extends vn{constructor(e=1,t=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const a=[],o=[],c=[],h=[],p=new ee,g=new ee,A=new ee;for(let v=0;v<=i;v++)for(let x=0;x<=r;x++){const S=x/r*s,_=v/i*Math.PI*2;g.x=(e+t*Math.cos(_))*Math.cos(S),g.y=(e+t*Math.cos(_))*Math.sin(S),g.z=t*Math.sin(_),o.push(g.x,g.y,g.z),p.x=e*Math.cos(S),p.y=e*Math.sin(S),A.subVectors(g,p).normalize(),c.push(A.x,A.y,A.z),h.push(x/r),h.push(v/i)}for(let v=1;v<=i;v++)for(let x=1;x<=r;x++){const S=(r+1)*v+x-1,_=(r+1)*(v-1)+x-1,E=(r+1)*(v-1)+x,C=(r+1)*v+x;a.push(S,_,C),a.push(_,E,C)}this.setIndex(a),this.setAttribute("position",new Kt(o,3)),this.setAttribute("normal",new Kt(c,3)),this.setAttribute("uv",new Kt(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qu(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class QM extends vn{constructor(e=1,t=.4,i=64,r=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:a},i=Math.floor(i),r=Math.floor(r);const o=[],c=[],h=[],p=[],g=new ee,A=new ee,v=new ee,x=new ee,S=new ee,_=new ee,E=new ee;for(let T=0;T<=i;++T){const R=T/i*s*Math.PI*2;C(R,s,a,e,v),C(R+.01,s,a,e,x),_.subVectors(x,v),E.addVectors(x,v),S.crossVectors(_,E),E.crossVectors(S,_),S.normalize(),E.normalize();for(let B=0;B<=r;++B){const U=B/r*Math.PI*2,O=-t*Math.cos(U),F=t*Math.sin(U);g.x=v.x+(O*E.x+F*S.x),g.y=v.y+(O*E.y+F*S.y),g.z=v.z+(O*E.z+F*S.z),c.push(g.x,g.y,g.z),A.subVectors(g,v).normalize(),h.push(A.x,A.y,A.z),p.push(T/i),p.push(B/r)}}for(let T=1;T<=i;T++)for(let R=1;R<=r;R++){const B=(r+1)*(T-1)+(R-1),U=(r+1)*T+(R-1),O=(r+1)*T+R,F=(r+1)*(T-1)+R;o.push(B,U,F),o.push(U,O,F)}this.setIndex(o),this.setAttribute("position",new Kt(c,3)),this.setAttribute("normal",new Kt(h,3)),this.setAttribute("uv",new Kt(p,2));function C(T,R,B,U,O){const F=Math.cos(T),L=Math.sin(T),P=B/R*T,W=Math.cos(P);O.x=U*(2+W)*.5*F,O.y=U*(2+W)*L*.5,O.z=U*Math.sin(P)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new QM(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class VM extends vn{constructor(e=new OM(new ee(-1,-1,0),new ee(-1,1,0),new ee(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new ee,c=new ee,h=new Ze;let p=new ee;const g=[],A=[],v=[],x=[];S(),this.setIndex(x),this.setAttribute("position",new Kt(g,3)),this.setAttribute("normal",new Kt(A,3)),this.setAttribute("uv",new Kt(v,2));function S(){for(let T=0;T<t;T++)_(T);_(s===!1?t:0),C(),E()}function _(T){p=e.getPointAt(T/t,p);const R=a.normals[T],B=a.binormals[T];for(let U=0;U<=r;U++){const O=U/r*Math.PI*2,F=Math.sin(O),L=-Math.cos(O);c.x=L*R.x+F*B.x,c.y=L*R.y+F*B.y,c.z=L*R.z+F*B.z,c.normalize(),A.push(c.x,c.y,c.z),o.x=p.x+i*c.x,o.y=p.y+i*c.y,o.z=p.z+i*c.z,g.push(o.x,o.y,o.z)}}function E(){for(let T=1;T<=t;T++)for(let R=1;R<=r;R++){const B=(r+1)*(T-1)+(R-1),U=(r+1)*T+(R-1),O=(r+1)*T+R,F=(r+1)*(T-1)+R;x.push(B,U,F),x.push(U,O,F)}}function C(){for(let T=0;T<=t;T++)for(let R=0;R<=r;R++)h.x=T/t,h.y=R/r,v.push(h.x,h.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new VM(new Nw[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class k8 extends vn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new ee,s=new ee;if(e.index!==null){const a=e.attributes.position,o=e.index;let c=e.groups;c.length===0&&(c=[{start:0,count:o.count,materialIndex:0}]);for(let h=0,p=c.length;h<p;++h){const g=c[h],A=g.start,v=g.count;for(let x=A,S=A+v;x<S;x+=3)for(let _=0;_<3;_++){const E=o.getX(x+_),C=o.getX(x+(_+1)%3);r.fromBufferAttribute(a,E),s.fromBufferAttribute(a,C),tN(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let o=0,c=a.count/3;o<c;o++)for(let h=0;h<3;h++){const p=3*o+h,g=3*o+(h+1)%3;r.fromBufferAttribute(a,p),s.fromBufferAttribute(a,g),tN(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Kt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function tN(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}var nN=Object.freeze({__proto__:null,BoxGeometry:ba,CapsuleGeometry:UM,CircleGeometry:Vm,ConeGeometry:ov,CylinderGeometry:Wd,DodecahedronGeometry:FM,EdgesGeometry:I8,ExtrudeGeometry:kM,IcosahedronGeometry:rx,LatheGeometry:zM,OctahedronGeometry:lv,PlaneGeometry:ra,PolyhedronGeometry:Jd,RingGeometry:GM,ShapeGeometry:cv,SphereGeometry:hc,TetrahedronGeometry:HM,TorusGeometry:Qu,TorusKnotGeometry:QM,TubeGeometry:VM,WireframeGeometry:k8});class z8 extends ts{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Mt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class b4 extends Fs{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Ks extends ts{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Mt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$d,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Us,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class vl extends Ks{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ze(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Mn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Mt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Mt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Mt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class G8 extends ts{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Mt(16777215),this.specular=new Mt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$d,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Us,this.combine=Yb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class H8 extends ts{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Mt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$d,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Q8 extends ts{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$d,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class V8 extends ts{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Mt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$d,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Us,this.combine=Yb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class sx extends ts{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=l8,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class jM extends ts{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class j8 extends ts{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Mt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$d,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class W8 extends za{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function vm(n,e){return!n||n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function q8(n){function e(r,s){return n[r]-n[s]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function zR(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,a=0;a!==i;++s){const o=t[s]*e;for(let c=0;c!==e;++c)r[a++]=n[o+c]}return r}function x4(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let a=s[i];if(a!==void 0)if(Array.isArray(a))do a=s[i],a!==void 0&&(e.push(s.time),t.push(...a)),s=n[r++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[i],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do a=s[i],a!==void 0&&(e.push(s.time),t.push(a)),s=n[r++];while(s!==void 0)}function Gq(n,e,t,i,r=30){const s=n.clone();s.name=e;const a=[];for(let c=0;c<s.tracks.length;++c){const h=s.tracks[c],p=h.getValueSize(),g=[],A=[];for(let v=0;v<h.times.length;++v){const x=h.times[v]*r;if(!(x<t||x>=i)){g.push(h.times[v]);for(let S=0;S<p;++S)A.push(h.values[v*p+S])}}g.length!==0&&(h.times=vm(g,h.times.constructor),h.values=vm(A,h.values.constructor),a.push(h))}s.tracks=a;let o=1/0;for(let c=0;c<s.tracks.length;++c)o>s.tracks[c].times[0]&&(o=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*o);return s.resetDuration(),s}function Hq(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let a=0;a<r;++a){const o=t.tracks[a],c=o.ValueTypeName;if(c==="bool"||c==="string")continue;const h=n.tracks.find(function(E){return E.name===o.name&&E.ValueTypeName===c});if(h===void 0)continue;let p=0;const g=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=g/3);let A=0;const v=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(A=v/3);const x=o.times.length-1;let S;if(s<=o.times[0]){const E=p,C=g-p;S=o.values.slice(E,C)}else if(s>=o.times[x]){const E=x*g+p,C=E+g-p;S=o.values.slice(E,C)}else{const E=o.createInterpolant(),C=p,T=g-p;E.evaluate(s),S=E.resultBuffer.slice(C,T)}c==="quaternion"&&new Bi().fromArray(S).normalize().conjugate().toArray(S);const _=h.times.length;for(let E=0;E<_;++E){const C=E*v+A;if(c==="quaternion")Bi.multiplyQuaternionsFlat(h.values,C,S,0,h.values,C);else{const T=v-A*2;for(let R=0;R<T;++R)h.values[C+R]-=S[R]}}}return n.blendMode=t4,n}class Qq{static convertArray(e,t){return vm(e,t)}static isTypedArray(e){return v8(e)}static getKeyframeOrder(e){return q8(e)}static sortedArray(e,t,i){return zR(e,t,i)}static flattenJSON(e,t,i,r){x4(e,t,i,r)}static subclip(e,t,i,r,s=30){return Gq(e,t,i,r,s)}static makeClipAdditive(e,t=0,i=e,r=30){return Hq(e,t,i,r)}}class uv{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let a;n:{i:if(!(e<r)){for(let o=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===o)break;if(s=r,r=t[++i],e<r)break t}a=t.length;break n}if(!(e>=s)){const o=t[1];e<o&&(i=2,s=o);for(let c=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=t[--i-1],e>=s)break t}a=i,i=0;break n}break e}for(;i<a;){const o=i+a>>>1;e<t[o]?a=o:i=o+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)t[a]=i[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class X8 extends uv{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:gm,endingEnd:gm}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,a=e+1,o=r[s],c=r[a];if(o===void 0)switch(this.getSettings_().endingStart){case Am:s=e,o=2*t-i;break;case wb:s=r.length-2,o=t+r[s]-r[s+1];break;default:s=e,o=i}if(c===void 0)switch(this.getSettings_().endingEnd){case Am:a=e,c=2*i-t;break;case wb:a=1,c=i+r[1]-r[0];break;default:a=e-1,c=t}const h=(i-t)*.5,p=this.valueSize;this._weightPrev=h/(t-o),this._weightNext=h/(c-i),this._offsetPrev=s*p,this._offsetNext=a*p}interpolate_(e,t,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,h=c-o,p=this._offsetPrev,g=this._offsetNext,A=this._weightPrev,v=this._weightNext,x=(i-t)/(r-t),S=x*x,_=S*x,E=-A*_+2*A*S-A*x,C=(1+A)*_+(-1.5-2*A)*S+(-.5+A)*x+1,T=(-1-v)*_+(1.5+v)*S+.5*x,R=v*_-v*S;for(let B=0;B!==o;++B)s[B]=E*a[p+B]+C*a[h+B]+T*a[c+B]+R*a[g+B];return s}}class _4 extends uv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,h=c-o,p=(i-t)/(r-t),g=1-p;for(let A=0;A!==o;++A)s[A]=a[h+A]*g+a[c+A]*p;return s}}class Y8 extends uv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class dc{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=vm(t,this.TimeBufferType),this.values=vm(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:vm(e.times,Array),values:vm(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Y8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new _4(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new X8(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Gm:t=this.InterpolantFactoryMethodDiscrete;break;case Hm:t=this.InterpolantFactoryMethodLinear;break;case HE:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return Gt("KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Gm;case this.InterpolantFactoryMethodLinear:return Hm;case this.InterpolantFactoryMethodSmooth:return HE}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,a=r-1;for(;s!==r&&i[s]<e;)++s;for(;a!==-1&&i[a]>t;)--a;if(++a,s!==0||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=i.slice(s,a),this.values=this.values.slice(s*o,a*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(on("KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(on("KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const c=i[o];if(typeof c=="number"&&isNaN(c)){on("KeyframeTrack: Time is not a valid number.",this,o,c),e=!1;break}if(a!==null&&a>c){on("KeyframeTrack: Out of order keys.",this,o,c,a),e=!1;break}a=c}if(r!==void 0&&v8(r))for(let o=0,c=r.length;o!==c;++o){const h=r[o];if(isNaN(h)){on("KeyframeTrack: Value is not a valid number.",this,o,h),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===HE,s=e.length-1;let a=1;for(let o=1;o<s;++o){let c=!1;const h=e[o],p=e[o+1];if(h!==p&&(o!==1||h!==e[0]))if(r)c=!0;else{const g=o*i,A=g-i,v=g+i;for(let x=0;x!==i;++x){const S=t[g+x];if(S!==t[A+x]||S!==t[v+x]){c=!0;break}}}if(c){if(o!==a){e[a]=e[o];const g=o*i,A=a*i;for(let v=0;v!==i;++v)t[A+v]=t[g+v]}++a}}if(s>0){e[a]=e[s];for(let o=s*i,c=a*i,h=0;h!==i;++h)t[c+h]=t[o+h];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}dc.prototype.ValueTypeName="";dc.prototype.TimeBufferType=Float32Array;dc.prototype.ValueBufferType=Float32Array;dc.prototype.DefaultInterpolation=Hm;class og extends dc{constructor(e,t,i){super(e,t,i)}}og.prototype.ValueTypeName="bool";og.prototype.ValueBufferType=Array;og.prototype.DefaultInterpolation=Gm;og.prototype.InterpolantFactoryMethodLinear=void 0;og.prototype.InterpolantFactoryMethodSmooth=void 0;class S4 extends dc{constructor(e,t,i,r){super(e,t,i,r)}}S4.prototype.ValueTypeName="color";class Wm extends dc{constructor(e,t,i,r){super(e,t,i,r)}}Wm.prototype.ValueTypeName="number";class K8 extends uv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=(i-t)/(r-t);let h=e*o;for(let p=h+o;h!==p;h+=4)Bi.slerpFlat(s,0,a,h-o,a,h,c);return s}}class qm extends dc{constructor(e,t,i,r){super(e,t,i,r)}InterpolantFactoryMethodLinear(e){return new K8(this.times,this.values,this.getValueSize(),e)}}qm.prototype.ValueTypeName="quaternion";qm.prototype.InterpolantFactoryMethodSmooth=void 0;class lg extends dc{constructor(e,t,i){super(e,t,i)}}lg.prototype.ValueTypeName="string";lg.prototype.ValueBufferType=Array;lg.prototype.DefaultInterpolation=Gm;lg.prototype.InterpolantFactoryMethodLinear=void 0;lg.prototype.InterpolantFactoryMethodSmooth=void 0;class Xm extends dc{constructor(e,t,i,r){super(e,t,i,r)}}Xm.prototype.ValueTypeName="vector";class F0{constructor(e="",t=-1,i=[],r=SM){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=ol(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let a=0,o=i.length;a!==o;++a)t.push(jq(i[a]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s.userData=JSON.parse(e.userData||"{}"),s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let s=0,a=i.length;s!==a;++s)t.push(dc.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,a=[];for(let o=0;o<s;o++){let c=[],h=[];c.push((o+s-1)%s,o,(o+1)%s),h.push(0,1,0);const p=q8(c);c=zR(c,1,p),h=zR(h,1,p),!r&&c[0]===0&&(c.push(s),h.push(h[0])),a.push(new Wm(".morphTargetInfluences["+t[o].name+"]",c,h).scale(1/i))}return new this(e,-1,a)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,c=e.length;o<c;o++){const h=e[o],p=h.name.match(s);if(p&&p.length>1){const g=p[1];let A=r[g];A||(r[g]=A=[]),A.push(h)}}const a=[];for(const o in r)a.push(this.CreateFromMorphTargetSequence(o,r[o],t,i));return a}static parseAnimation(e,t){if(Gt("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return on("AnimationClip: No animation in JSONLoader data."),null;const i=function(g,A,v,x,S){if(v.length!==0){const _=[],E=[];x4(v,_,E,x),_.length!==0&&S.push(new g(A,_,E))}},r=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let c=e.length||-1;const h=e.hierarchy||[];for(let g=0;g<h.length;g++){const A=h[g].keys;if(!(!A||A.length===0))if(A[0].morphTargets){const v={};let x;for(x=0;x<A.length;x++)if(A[x].morphTargets)for(let S=0;S<A[x].morphTargets.length;S++)v[A[x].morphTargets[S]]=-1;for(const S in v){const _=[],E=[];for(let C=0;C!==A[x].morphTargets.length;++C){const T=A[x];_.push(T.time),E.push(T.morphTarget===S?1:0)}r.push(new Wm(".morphTargetInfluence["+S+"]",_,E))}c=v.length*a}else{const v=".bones["+t[g].name+"]";i(Xm,v+".position",A,"pos",r),i(qm,v+".quaternion",A,"rot",r),i(Xm,v+".scale",A,"scl",r)}}return r.length===0?null:new this(s,c,r,o)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function Vq(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Wm;case"vector":case"vector2":case"vector3":case"vector4":return Xm;case"color":return S4;case"quaternion":return qm;case"bool":case"boolean":return og;case"string":return lg}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function jq(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Vq(n.type);if(n.times===void 0){const t=[],i=[];x4(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Xu={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class WM{constructor(e,t,i){const r=this;let s=!1,a=0,o=0,c;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this._abortController=null,this.itemStart=function(p){o++,s===!1&&r.onStart!==void 0&&r.onStart(p,a,o),s=!0},this.itemEnd=function(p){a++,r.onProgress!==void 0&&r.onProgress(p,a,o),a===o&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(p){r.onError!==void 0&&r.onError(p)},this.resolveURL=function(p){return c?c(p):p},this.setURLModifier=function(p){return c=p,this},this.addHandler=function(p,g){return h.push(p,g),this},this.removeHandler=function(p){const g=h.indexOf(p);return g!==-1&&h.splice(g,2),this},this.getHandler=function(p){for(let g=0,A=h.length;g<A;g+=2){const v=h[g],x=h[g+1];if(v.global&&(v.lastIndex=0),v.test(p))return x}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const $8=new WM;class zs{constructor(e){this.manager=e!==void 0?e:$8,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}zs.DEFAULT_MATERIAL_NAME="__DEFAULT";const qh={};class Wq extends Error{constructor(e,t){super(e),this.response=t}}class fs extends zs{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Xu.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(qh[e]!==void 0){qh[e].push({onLoad:t,onProgress:i,onError:r});return}qh[e]=[],qh[e].push({onLoad:t,onProgress:i,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),o=this.mimeType,c=this.responseType;fetch(a).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&Gt("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const p=qh[e],g=h.body.getReader(),A=h.headers.get("X-File-Size")||h.headers.get("Content-Length"),v=A?parseInt(A):0,x=v!==0;let S=0;const _=new ReadableStream({start(E){C();function C(){g.read().then(({done:T,value:R})=>{if(T)E.close();else{S+=R.byteLength;const B=new ProgressEvent("progress",{lengthComputable:x,loaded:S,total:v});for(let U=0,O=p.length;U<O;U++){const F=p[U];F.onProgress&&F.onProgress(B)}E.enqueue(R),C()}},T=>{E.error(T)})}}});return new Response(_)}else throw new Wq(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(c){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(p=>new DOMParser().parseFromString(p,o));case"json":return h.json();default:if(o==="")return h.text();{const g=/charset="?([^;"\s]*)"?/i.exec(o),A=g&&g[1]?g[1].toLowerCase():void 0,v=new TextDecoder(A);return h.arrayBuffer().then(x=>v.decode(x))}}}).then(h=>{Xu.add(`file:${e}`,h);const p=qh[e];delete qh[e];for(let g=0,A=p.length;g<A;g++){const v=p[g];v.onLoad&&v.onLoad(h)}}).catch(h=>{const p=qh[e];if(p===void 0)throw this.manager.itemError(e),h;delete qh[e];for(let g=0,A=p.length;g<A;g++){const v=p[g];v.onError&&v.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class qq extends zs{constructor(e){super(e)}load(e,t,i,r){const s=this,a=new fs(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(c){r?r(c):on(c),s.manager.itemError(e)}},i,r)}parse(e){const t=[];for(let i=0;i<e.length;i++){const r=F0.parse(e[i]);t.push(r)}return t}}class Xq extends zs{constructor(e){super(e)}load(e,t,i,r){const s=this,a=[],o=new ff,c=new fs(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(s.withCredentials);let h=0;function p(g){c.load(e[g],function(A){const v=s.parse(A,!0);a[g]={width:v.width,height:v.height,format:v.format,mipmaps:v.mipmaps},h+=1,h===6&&(v.mipmapCount===1&&(o.minFilter=mn),o.image=a,o.format=v.format,o.needsUpdate=!0,t&&t(o))},i,r)}if(Array.isArray(e))for(let g=0,A=e.length;g<A;++g)p(g);else c.load(e,function(g){const A=s.parse(g,!0);if(A.isCubemap){const v=A.mipmaps.length/A.mipmapCount;for(let x=0;x<v;x++){a[x]={mipmaps:[]};for(let S=0;S<A.mipmapCount;S++)a[x].mipmaps.push(A.mipmaps[x*A.mipmapCount+S]),a[x].format=A.format,a[x].width=A.width,a[x].height=A.height}o.image=a}else o.image.width=A.width,o.image.height=A.height,o.mipmaps=A.mipmaps;A.mipmapCount===1&&(o.minFilter=mn),o.format=A.format,o.needsUpdate=!0,t&&t(o)},i,r);return o}}const IA=new WeakMap;class Lb extends zs{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Xu.get(`image:${e}`);if(a!==void 0){if(a.complete===!0)s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0);else{let g=IA.get(a);g===void 0&&(g=[],IA.set(a,g)),g.push({onLoad:t,onError:r})}return a}const o=Tb("img");function c(){p(),t&&t(this);const g=IA.get(this)||[];for(let A=0;A<g.length;A++){const v=g[A];v.onLoad&&v.onLoad(this)}IA.delete(this),s.manager.itemEnd(e)}function h(g){p(),r&&r(g),Xu.remove(`image:${e}`);const A=IA.get(this)||[];for(let v=0;v<A.length;v++){const x=A[v];x.onError&&x.onError(g)}IA.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function p(){o.removeEventListener("load",c,!1),o.removeEventListener("error",h,!1)}return o.addEventListener("load",c,!1),o.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),Xu.add(`image:${e}`,o),s.manager.itemStart(e),o.src=e,o}}class J8 extends zs{constructor(e){super(e)}load(e,t,i,r){const s=new nx;s.colorSpace=xi;const a=new Lb(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function c(h){a.load(e[h],function(p){s.images[h]=p,o++,o===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let h=0;h<e.length;++h)c(h);return s}}class qM extends zs{constructor(e){super(e)}load(e,t,i,r){const s=this,a=new ll,o=new fs(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,function(c){let h;try{h=s.parse(c)}catch(p){if(r!==void 0)r(p);else{p(p);return}}h.image!==void 0?a.image=h.image:h.data!==void 0&&(a.image.width=h.width,a.image.height=h.height,a.image.data=h.data),a.wrapS=h.wrapS!==void 0?h.wrapS:or,a.wrapT=h.wrapT!==void 0?h.wrapT:or,a.magFilter=h.magFilter!==void 0?h.magFilter:mn,a.minFilter=h.minFilter!==void 0?h.minFilter:mn,a.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.colorSpace!==void 0&&(a.colorSpace=h.colorSpace),h.flipY!==void 0&&(a.flipY=h.flipY),h.format!==void 0&&(a.format=h.format),h.type!==void 0&&(a.type=h.type),h.mipmaps!==void 0&&(a.mipmaps=h.mipmaps,a.minFilter=ya),h.mipmapCount===1&&(a.minFilter=mn),h.generateMipmaps!==void 0&&(a.generateMipmaps=h.generateMipmaps),a.needsUpdate=!0,t&&t(a,h)},i,r),a}}class E4 extends zs{constructor(e){super(e)}load(e,t,i,r){const s=new Pi,a=new Lb(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class Zd extends Gn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Mt(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class Z8 extends Zd{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Gn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Mt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const aT=new qt,iN=new ee,rN=new ee;class w4{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ze(512,512),this.mapType=xn,this.map=null,this.mapPass=null,this.matrix=new qt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new av,this._frameExtents=new Ze(1,1),this._viewportCount=1,this._viewports=[new Ii(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;iN.setFromMatrixPosition(e.matrixWorld),t.position.copy(iN),rN.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(rN),t.updateMatrixWorld(),aT.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(aT,t.coordinateSystem,t.reversedDepth),t.reversedDepth?i.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(aT)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Yq extends w4{constructor(){super(new Gr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,i=B0*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class M4 extends Zd{constructor(e,t,i=0,r=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Gn.DEFAULT_UP),this.updateMatrix(),this.target=new Gn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new Yq}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class Kq extends w4{constructor(){super(new Gr(90,1,.5,500)),this.isPointLightShadow=!0}}class XM extends Zd{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Kq}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class Yc extends CM{constructor(e=-1,t=1,i=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,a=i+e,o=r+t,c=r-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,a=s+h*this.view.width,o-=p*this.view.offsetY,c=o-p*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,c,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class $q extends w4{constructor(){super(new Yc(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class hv extends Zd{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Gn.DEFAULT_UP),this.updateMatrix(),this.target=new Gn,this.shadow=new $q}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class YM extends Zd{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class e6 extends Zd{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class C4{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ee)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*i),t.addScaledVector(a[4],1.092548*(i*r)),t.addScaledVector(a[5],1.092548*(r*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(i*s)),t.addScaledVector(a[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*r),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*i),t.addScaledVector(a[4],2*.429043*i*r),t.addScaledVector(a[5],2*.429043*r*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*i*s),t.addScaledVector(a[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class T4 extends Zd{constructor(e=new C4,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class KM extends zs{constructor(e){super(e),this.textures={}}load(e,t,i,r){const s=this,a=new fs(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(c){r?r(c):on(c),s.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(s){return t[s]===void 0&&Gt("MaterialLoader: Undefined texture",s),t[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new Mt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(r.allowOverride=e.allowOverride),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(r.uniforms[s]={},a.type){case"t":r.uniforms[s].value=i(a.value);break;case"c":r.uniforms[s].value=new Mt().setHex(a.value);break;case"v2":r.uniforms[s].value=new Ze().fromArray(a.value);break;case"v3":r.uniforms[s].value=new ee().fromArray(a.value);break;case"v4":r.uniforms[s].value=new Ii().fromArray(a.value);break;case"m3":r.uniforms[s].value=new Rn().fromArray(a.value);break;case"m4":r.uniforms[s].value=new qt().fromArray(a.value);break;default:r.uniforms[s].value=a.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Ze().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Ze().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return KM.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:z8,SpriteMaterial:c4,RawShaderMaterial:b4,ShaderMaterial:Fs,PointsMaterial:LM,MeshPhysicalMaterial:vl,MeshStandardMaterial:Ks,MeshPhongMaterial:G8,MeshToonMaterial:H8,MeshNormalMaterial:Q8,MeshLambertMaterial:V8,MeshDepthMaterial:sx,MeshDistanceMaterial:jM,MeshBasicMaterial:ar,MeshMatcapMaterial:j8,LineDashedMaterial:W8,LineBasicMaterial:za,Material:ts};return new t[e]}}class Pd{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class I4 extends vn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class t6 extends zs{constructor(e){super(e)}load(e,t,i,r){const s=this,a=new fs(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(c){r?r(c):on(c),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(v,x){if(t[x]!==void 0)return t[x];const _=v.interleavedBuffers[x],E=s(v,_.buffer),C=a0(_.type,E),T=new sv(C,_.stride);return T.uuid=_.uuid,t[x]=T,T}function s(v,x){if(i[x]!==void 0)return i[x];const _=v.arrayBuffers[x],E=new Uint32Array(_).buffer;return i[x]=E,E}const a=e.isInstancedBufferGeometry?new I4:new vn,o=e.data.index;if(o!==void 0){const v=a0(o.type,o.array);a.setIndex(new An(v,1))}const c=e.data.attributes;for(const v in c){const x=c[v];let S;if(x.isInterleavedBufferAttribute){const _=r(e.data,x.data);S=new Af(_,x.itemSize,x.offset,x.normalized)}else{const _=a0(x.type,x.array),E=x.isInstancedBufferAttribute?jd:An;S=new E(_,x.itemSize,x.normalized)}x.name!==void 0&&(S.name=x.name),x.usage!==void 0&&S.setUsage(x.usage),a.setAttribute(v,S)}const h=e.data.morphAttributes;if(h)for(const v in h){const x=h[v],S=[];for(let _=0,E=x.length;_<E;_++){const C=x[_];let T;if(C.isInterleavedBufferAttribute){const R=r(e.data,C.data);T=new Af(R,C.itemSize,C.offset,C.normalized)}else{const R=a0(C.type,C.array);T=new An(R,C.itemSize,C.normalized)}C.name!==void 0&&(T.name=C.name),S.push(T)}a.morphAttributes[v]=S}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const g=e.data.groups||e.data.drawcalls||e.data.offsets;if(g!==void 0)for(let v=0,x=g.length;v!==x;++v){const S=g[v];a.addGroup(S.start,S.count,S.materialIndex)}const A=e.data.boundingSphere;return A!==void 0&&(a.boundingSphere=new jr().fromJSON(A)),e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class Jq extends zs{constructor(e){super(e)}load(e,t,i,r){const s=this,a=this.path===""?Pd.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new fs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){let h=null;try{h=JSON.parse(c)}catch(g){r!==void 0&&r(g),g("ObjectLoader: Can't parse "+e+".",g.message);return}const p=h.metadata;if(p===void 0||p.type===void 0||p.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),on("ObjectLoader: Can't load "+e);return}s.parse(h,t)},i,r)}async loadAsync(e,t){const i=this,r=this.path===""?Pd.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new fs(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,t),o=JSON.parse(a),c=o.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(o)}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){t!==void 0&&t(h)}),o=this.parseTextures(e.textures,a),c=this.parseMaterials(e.materials,o),h=this.parseObject(e.object,s,c,o,i),p=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,p),this.bindLightTargets(h),t!==void 0){let g=!1;for(const A in a)if(a[A].data instanceof HTMLImageElement){g=!0;break}g===!1&&t(h)}return h}async parseAsync(e){const t=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,r,o,a,t),h=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,h),this.bindLightTargets(c),c}parseShapes(e){const t={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new df().fromJSON(e[i]);t[s.uuid]=s}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=new ix().fromJSON(e[s],r);i[o.uuid]=o}return i}parseGeometries(e,t){const i={};if(e!==void 0){const r=new t6;for(let s=0,a=e.length;s<a;s++){let o;const c=e[s];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(c);break;default:c.type in nN?o=nN[c.type].fromJSON(c,t):Gt(`ObjectLoader: Unsupported geometry type "${c.type}"`)}o.uuid=c.uuid,c.name!==void 0&&(o.name=c.name),c.userData!==void 0&&(o.userData=c.userData),i[c.uuid]=o}}return i}parseMaterials(e,t){const i={},r={};if(e!==void 0){const s=new KM;s.setTextures(t);for(let a=0,o=e.length;a<o;a++){const c=e[a];i[c.uuid]===void 0&&(i[c.uuid]=s.parse(c)),r[c.uuid]=i[c.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=F0.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const i=this,r={};let s;function a(c){return i.manager.itemStart(c),s.load(c,function(){i.manager.itemEnd(c)},void 0,function(){i.manager.itemError(c),i.manager.itemEnd(c)})}function o(c){if(typeof c=="string"){const h=c,p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:i.resourcePath+h;return a(p)}else return c.data?{data:a0(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new WM(t);s=new Lb(c),s.setCrossOrigin(this.crossOrigin);for(let h=0,p=e.length;h<p;h++){const g=e[h],A=g.url;if(Array.isArray(A)){const v=[];for(let x=0,S=A.length;x<S;x++){const _=A[x],E=o(_);E!==null&&(E instanceof HTMLImageElement?v.push(E):v.push(new ll(E.data,E.width,E.height)))}r[g.uuid]=new of(v)}else{const v=o(g.url);r[g.uuid]=new of(v)}}}return r}async parseImagesAsync(e){const t=this,i={};let r;async function s(a){if(typeof a=="string"){const o=a,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:t.resourcePath+o;return await r.loadAsync(c)}else return a.data?{data:a0(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){r=new Lb(this.manager),r.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const c=e[a],h=c.url;if(Array.isArray(h)){const p=[];for(let g=0,A=h.length;g<A;g++){const v=h[g],x=await s(v);x!==null&&(x instanceof HTMLImageElement?p.push(x):p.push(new ll(x.data,x.width,x.height)))}i[c.uuid]=new of(p)}else{const p=await s(c.url);i[c.uuid]=new of(p)}}}return i}parseTextures(e,t){function i(s,a){return typeof s=="number"?s:(Gt("ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const r={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=e[s];o.image===void 0&&Gt('ObjectLoader: No "image" specified for',o.uuid),t[o.image]===void 0&&Gt("ObjectLoader: Undefined image",o.image);const c=t[o.image],h=c.data;let p;Array.isArray(h)?(p=new nx,h.length===6&&(p.needsUpdate=!0)):(h&&h.data?p=new ll:p=new Pi,h&&(p.needsUpdate=!0)),p.source=c,p.uuid=o.uuid,o.name!==void 0&&(p.name=o.name),o.mapping!==void 0&&(p.mapping=i(o.mapping,Zq)),o.channel!==void 0&&(p.channel=o.channel),o.offset!==void 0&&p.offset.fromArray(o.offset),o.repeat!==void 0&&p.repeat.fromArray(o.repeat),o.center!==void 0&&p.center.fromArray(o.center),o.rotation!==void 0&&(p.rotation=o.rotation),o.wrap!==void 0&&(p.wrapS=i(o.wrap[0],sN),p.wrapT=i(o.wrap[1],sN)),o.format!==void 0&&(p.format=o.format),o.internalFormat!==void 0&&(p.internalFormat=o.internalFormat),o.type!==void 0&&(p.type=o.type),o.colorSpace!==void 0&&(p.colorSpace=o.colorSpace),o.minFilter!==void 0&&(p.minFilter=i(o.minFilter,aN)),o.magFilter!==void 0&&(p.magFilter=i(o.magFilter,aN)),o.anisotropy!==void 0&&(p.anisotropy=o.anisotropy),o.flipY!==void 0&&(p.flipY=o.flipY),o.generateMipmaps!==void 0&&(p.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(p.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(p.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(p.compareFunction=o.compareFunction),o.userData!==void 0&&(p.userData=o.userData),r[o.uuid]=p}return r}parseObject(e,t,i,r,s){let a;function o(A){return t[A]===void 0&&Gt("ObjectLoader: Undefined geometry",A),t[A]}function c(A){if(A!==void 0){if(Array.isArray(A)){const v=[];for(let x=0,S=A.length;x<S;x++){const _=A[x];i[_]===void 0&&Gt("ObjectLoader: Undefined material",_),v.push(i[_])}return v}return i[A]===void 0&&Gt("ObjectLoader: Undefined material",A),i[A]}}function h(A){return r[A]===void 0&&Gt("ObjectLoader: Undefined texture",A),r[A]}let p,g;switch(e.type){case"Scene":a=new uc,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new Mt(e.background):a.background=h(e.background)),e.environment!==void 0&&(a.environment=h(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new IM(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new TM(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Gr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Yc(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new YM(e.color,e.intensity);break;case"DirectionalLight":a=new hv(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new XM(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new e6(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new M4(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new Z8(e.color,e.groundColor,e.intensity);break;case"LightProbe":const A=new C4().fromArray(e.sh);a=new T4(A,e.intensity);break;case"SkinnedMesh":p=o(e.geometry),g=c(e.material),a=new u4(p,g),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":p=o(e.geometry),g=c(e.material),a=new Wt(p,g);break;case"InstancedMesh":p=o(e.geometry),g=c(e.material);const v=e.count,x=e.instanceMatrix,S=e.instanceColor;a=new BM(p,g,v),a.instanceMatrix=new jd(new Float32Array(x.array),16),S!==void 0&&(a.instanceColor=new jd(new Float32Array(S.array),S.itemSize));break;case"BatchedMesh":p=o(e.geometry),g=c(e.material),a=new w8(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,g),a.geometry=p,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(_=>{let E=null,C=null;return _.boundingBox!==void 0&&(E=new gr().fromJSON(_.boundingBox)),_.boundingSphere!==void 0&&(C=new jr().fromJSON(_.boundingSphere)),{..._,boundingBox:E,boundingSphere:C}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=h(e.matricesTexture.uuid),a._indirectTexture=h(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=h(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new jr().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(a.boundingBox=new gr().fromJSON(e.boundingBox));break;case"LOD":a=new E8;break;case"Line":a=new Wc(o(e.geometry),c(e.material));break;case"LineLoop":a=new h4(o(e.geometry),c(e.material));break;case"LineSegments":a=new qc(o(e.geometry),c(e.material));break;case"PointCloud":case"Points":a=new f4(o(e.geometry),c(e.material));break;case"Sprite":a=new S8(c(e.material));break;case"Group":a=new Ds;break;case"Bone":a=new RM;break;default:a=new Gn}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const A=e.children;for(let v=0;v<A.length;v++)a.add(this.parseObject(A[v],t,i,r,s))}if(e.animations!==void 0){const A=e.animations;for(let v=0;v<A.length;v++){const x=A[v];a.animations.push(s[x])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const A=e.levels;for(let v=0;v<A.length;v++){const x=A[v],S=a.getObjectByProperty("uuid",x.object);S!==void 0&&a.addLevel(S,x.distance,x.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=t[i.skeleton];r===void 0?Gt("ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const i=t.target,r=e.getObjectByProperty("uuid",i);r!==void 0?t.target=r:t.target=new Gn}})}}const Zq={UVMapping:Hd,CubeReflectionMapping:jc,CubeRefractionMapping:Qd,EquirectangularReflectionMapping:Om,EquirectangularRefractionMapping:fb,CubeUVReflectionMapping:iv},sN={RepeatWrapping:hl,ClampToEdgeWrapping:or,MirroredRepeatWrapping:mf},aN={NearestFilter:Ri,NearestMipmapNearestFilter:Kd,NearestMipmapLinearFilter:Wu,LinearFilter:mn,LinearMipmapNearestFilter:uf,LinearMipmapLinearFilter:ya},oT=new WeakMap;class n6 extends zs{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&Gt("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&Gt("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Xu.get(`image-bitmap:${e}`);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(h=>{if(oT.has(a)===!0)r&&r(oT.get(a)),s.manager.itemError(e),s.manager.itemEnd(e);else return t&&t(h),s.manager.itemEnd(e),h});return}return setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader,o.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const c=fetch(e,o).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(h){return Xu.add(`image-bitmap:${e}`,h),t&&t(h),s.manager.itemEnd(e),h}).catch(function(h){r&&r(h),oT.set(c,h),Xu.remove(`image-bitmap:${e}`),s.manager.itemError(e),s.manager.itemEnd(e)});Xu.add(`image-bitmap:${e}`,c),s.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let OS;class R4{static getContext(){return OS===void 0&&(OS=new(window.AudioContext||window.webkitAudioContext)),OS}static setContext(e){OS=e}}class eX extends zs{constructor(e){super(e)}load(e,t,i,r){const s=this,a=new fs(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){try{const h=c.slice(0);R4.getContext().decodeAudioData(h,function(g){t(g)}).catch(o)}catch(h){o(h)}},i,r);function o(c){r?r(c):on(c),s.manager.itemError(e)}}}const oN=new qt,lN=new qt,Vp=new qt;class tX{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Gr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Gr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Vp.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,a=t.near*Math.tan(Im*t.fov*.5)/t.zoom;let o,c;lN.elements[12]=-r,oN.elements[12]=r,o=-a*t.aspect+s,c=a*t.aspect+s,Vp.elements[0]=2*t.near/(c-o),Vp.elements[8]=(c+o)/(c-o),this.cameraL.projectionMatrix.copy(Vp),o=-a*t.aspect-s,c=a*t.aspect-s,Vp.elements[0]=2*t.near/(c-o),Vp.elements[8]=(c+o)/(c-o),this.cameraR.projectionMatrix.copy(Vp)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(lN),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(oN)}}class i6 extends Gr{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class B4{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const jp=new ee,lT=new Bi,nX=new ee,Wp=new ee,qp=new ee;class iX extends Gn{constructor(){super(),this.type="AudioListener",this.context=R4.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new B4}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(jp,lT,nX),Wp.set(0,0,-1).applyQuaternion(lT),qp.set(0,1,0).applyQuaternion(lT),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(jp.x,i),t.positionY.linearRampToValueAtTime(jp.y,i),t.positionZ.linearRampToValueAtTime(jp.z,i),t.forwardX.linearRampToValueAtTime(Wp.x,i),t.forwardY.linearRampToValueAtTime(Wp.y,i),t.forwardZ.linearRampToValueAtTime(Wp.z,i),t.upX.linearRampToValueAtTime(qp.x,i),t.upY.linearRampToValueAtTime(qp.y,i),t.upZ.linearRampToValueAtTime(qp.z,i)}else t.setPosition(jp.x,jp.y,jp.z),t.setOrientation(Wp.x,Wp.y,Wp.z,qp.x,qp.y,qp.z)}}class r6 extends Gn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){Gt("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){Gt("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){Gt("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){Gt("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){Gt("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(Gt("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){Gt("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(Gt("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Xp=new ee,cN=new Bi,rX=new ee,Yp=new ee;class sX extends r6{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Xp,cN,rX),Yp.set(0,0,1).applyQuaternion(cN);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Xp.x,i),t.positionY.linearRampToValueAtTime(Xp.y,i),t.positionZ.linearRampToValueAtTime(Xp.z,i),t.orientationX.linearRampToValueAtTime(Yp.x,i),t.orientationY.linearRampToValueAtTime(Yp.y,i),t.orientationZ.linearRampToValueAtTime(Yp.z,i)}else t.setPosition(Xp.x,Xp.y,Xp.z),t.setOrientation(Yp.x,Yp.y,Yp.z)}}class aX{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class s6{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,s,a;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==r;++o)i[s+o]=i[o];a=t}else{a+=t;const o=t/a;this._mixBufferRegion(i,s,0,o,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const c=t*this._origIndex;this._mixBufferRegion(i,r,c,1-s,t)}a>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let c=t,h=t+t;c!==h;++c)if(i[c]!==i[c+t]){o.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let s=i,a=r;s!==a;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let a=0;a!==s;++a)e[t+a]=e[i+a]}_slerp(e,t,i,r){Bi.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const a=this._workIndex*s;Bi.multiplyQuaternionsFlat(e,a,e,t,e,i),Bi.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,i,r,s){const a=1-r;for(let o=0;o!==s;++o){const c=t+o;e[c]=e[c]*a+e[i+o]*r}}_lerpAdditive(e,t,i,r,s){for(let a=0;a!==s;++a){const o=t+a;e[o]=e[o]+e[i+a]*r}}}const D4="\\[\\]\\.:\\/",oX=new RegExp("["+D4+"]","g"),L4="[^"+D4+"]",lX="[^"+D4.replace("\\.","")+"]",cX=/((?:WC+[\/:])*)/.source.replace("WC",L4),uX=/(WCOD+)?/.source.replace("WCOD",lX),hX=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",L4),fX=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",L4),dX=new RegExp("^"+cX+uX+hX+fX+"$"),pX=["material","materials","bones","map"];class mX{constructor(e,t,i){const r=i||ei.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class ei{constructor(e,t,i){this.path=t,this.parsedPath=i||ei.parseTrackName(t),this.node=ei.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new ei.Composite(e,t,i):new ei(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(oX,"")}static parseTrackName(e){const t=dX.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);pX.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===t||o.uuid===t)return o;const c=i(o.children);if(c)return c}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=ei.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){Gt("PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let h=t.objectIndex;switch(i){case"materials":if(!e.material){on("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){on("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){on("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let p=0;p<e.length;p++)if(e[p].name===h){h=p;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){on("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){on("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){on("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(h!==void 0){if(e[h]===void 0){on("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const a=e[r];if(a===void 0){const h=t.nodeName;on("PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?o=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){on("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){on("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ei.Composite=mX;ei.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ei.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ei.prototype.GetterByBindingType=[ei.prototype._getValue_direct,ei.prototype._getValue_array,ei.prototype._getValue_arrayElement,ei.prototype._getValue_toArray];ei.prototype.SetterByBindingTypeAndVersioning=[[ei.prototype._setValue_direct,ei.prototype._setValue_direct_setNeedsUpdate,ei.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ei.prototype._setValue_array,ei.prototype._setValue_array_setNeedsUpdate,ei.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ei.prototype._setValue_arrayElement,ei.prototype._setValue_arrayElement_setNeedsUpdate,ei.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ei.prototype._setValue_fromArray,ei.prototype._setValue_fromArray_setNeedsUpdate,ei.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class gX{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ol(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,a=s.length;let o,c=e.length,h=this.nCachedObjects_;for(let p=0,g=arguments.length;p!==g;++p){const A=arguments[p],v=A.uuid;let x=t[v];if(x===void 0){x=c++,t[v]=x,e.push(A);for(let S=0,_=a;S!==_;++S)s[S].push(new ei(A,i[S],r[S]))}else if(x<h){o=e[x];const S=--h,_=e[S];t[_.uuid]=x,e[x]=_,t[v]=S,e[S]=A;for(let E=0,C=a;E!==C;++E){const T=s[E],R=T[S];let B=T[x];T[x]=R,B===void 0&&(B=new ei(A,i[E],r[E])),T[S]=B}}else e[x]!==o&&on("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const c=arguments[a],h=c.uuid,p=t[h];if(p!==void 0&&p>=s){const g=s++,A=e[g];t[A.uuid]=p,e[p]=A,t[h]=g,e[g]=c;for(let v=0,x=r;v!==x;++v){const S=i[v],_=S[g],E=S[p];S[p]=_,S[g]=E}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,c=arguments.length;o!==c;++o){const h=arguments[o],p=h.uuid,g=t[p];if(g!==void 0)if(delete t[p],g<s){const A=--s,v=e[A],x=--a,S=e[x];t[v.uuid]=g,e[g]=v,t[S.uuid]=A,e[A]=S,e.pop();for(let _=0,E=r;_!==E;++_){const C=i[_],T=C[A],R=C[x];C[g]=T,C[A]=R,C.pop()}}else{const A=--a,v=e[A];A>0&&(t[v.uuid]=g),e[g]=v,e.pop();for(let x=0,S=r;x!==S;++x){const _=i[x];_[g]=_[A],_.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const a=this._paths,o=this._parsedPaths,c=this._objects,h=c.length,p=this.nCachedObjects_,g=new Array(h);r=s.length,i[e]=r,a.push(e),o.push(t),s.push(g);for(let A=p,v=c.length;A!==v;++A){const x=c[A];g[A]=new ei(x,e,t)}return g}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,c=a[o],h=e[o];t[h]=i,a[i]=c,a.pop(),s[i]=s[o],s.pop(),r[i]=r[o],r.pop()}}}class a6{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,a=s.length,o=new Array(a),c={endingStart:gm,endingEnd:gm};for(let h=0;h!==a;++h){const p=s[h].createInterpolant(null);o[h]=p,p.settings=c}this._interpolantSettings=c,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Tm,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i=!1){if(e.fadeOut(t),this.fadeIn(t),i===!0){const r=this._clip.duration,s=e._clip.duration,a=s/r,o=r/s;e.warp(1,a,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,i=!1){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);const c=o.parameterPositions,h=o.sampleValues;return c[0]=s,c[1]=s+i,h[0]=e/a,h[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const c=(e-s)*i;c<0||i===0?t=0:(this._startTime=null,t=i*c)}t*=this._updateTimeScale(e);const a=this._updateTime(t),o=this._updateWeight(e);if(o>0){const c=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case t4:for(let p=0,g=c.length;p!==g;++p)c[p].evaluate(a),h[p].accumulateAdditive(o);break;case SM:default:for(let p=0,g=c.length;p!==g;++p)c[p].evaluate(a),h[p].accumulate(r,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const a=i===Eb;if(e===0)return s===-1?r:a&&(s&1)===1?t-r:r;if(i===T0){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=t||r<0){const o=Math.floor(r/t);r-=t*o,s+=Math.abs(o);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const h=e<0;this._setEndings(h,!h,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&(s&1)===1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=Am,r.endingEnd=Am):(e?r.endingStart=this.zeroSlopeAtStart?Am:gm:r.endingStart=wb,t?r.endingEnd=this.zeroSlopeAtEnd?Am:gm:r.endingEnd=wb)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,c=a.sampleValues;return o[0]=s,c[0]=t,o[1]=s+e,c[1]=i,this}}const AX=new Float32Array(1);class o6 extends zo{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,a=e._propertyBindings,o=e._interpolants,c=i.uuid,h=this._bindingsByRootAndName;let p=h[c];p===void 0&&(p={},h[c]=p);for(let g=0;g!==s;++g){const A=r[g],v=A.name;let x=p[v];if(x!==void 0)++x.referenceCount,a[g]=x;else{if(x=a[g],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,c,v));continue}const S=t&&t._propertyBindings[g].binding.parsedPath;x=new s6(ei.create(i,v,S),A.ValueTypeName,A.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,c,v),a[g]=x}o[g].resultBuffer=x.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],c=o.knownActions,h=c[c.length-1],p=e._byClipCacheIndex;h._byClipCacheIndex=p,c[p]=h,c.pop(),e._byClipCacheIndex=null;const g=o.actionByRoot,A=(e._localRoot||this._root).uuid;delete g[A],c.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let a=r[t];a===void 0&&(a={},r[t]=a),a[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,a=this._bindingsByRootAndName,o=a[r],c=t[t.length-1],h=e._cacheIndex;c._cacheIndex=h,t[h]=c,t.pop(),delete o[s],Object.keys(o).length===0&&delete a[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new _4(new Float32Array(2),new Float32Array(2),1,AX),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let a=typeof e=="string"?F0.findByName(r,e):e;const o=a!==null?a.uuid:e,c=this._actionsByClip[o];let h=null;if(i===void 0&&(a!==null?i=a.blendMode:i=SM),c!==void 0){const g=c.actionByRoot[s];if(g!==void 0&&g.blendMode===i)return g;h=c.knownActions[0],a===null&&(a=h._clip)}if(a===null)return null;const p=new a6(this,a,t,i);return this._bindAction(p,h),this._addInactiveAction(p,o,s),p}existingAction(e,t){const i=t||this._root,r=i.uuid,s=typeof e=="string"?F0.findByName(i,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let h=0;h!==i;++h)t[h]._update(r,e,s,a);const o=this._bindings,c=this._nActiveBindings;for(let h=0;h!==c;++h)o[h].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const a=s.knownActions;for(let o=0,c=a.length;o!==c;++o){const h=a[o];this._deactivateAction(h);const p=h._cacheIndex,g=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,g._cacheIndex=p,t[p]=g,t.pop(),this._removeInactiveBindingsForAction(h)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const a in i){const o=i[a].actionByRoot,c=o[t];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class vX extends s4{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isRenderTarget3D=!0,this.depth=i,this.texture=new tx(null,e,t,i),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class N4{constructor(e){this.value=e}clone(){return new N4(this.value.clone===void 0?this.value:this.value.clone())}}let yX=0;class bX extends zo{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:yX++}),this.name="",this.usage=Cb,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let i=0,r=t.length;i<r;i++){const s=Array.isArray(t[i])?t[i]:[t[i]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class xX extends sv{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class _X{constructor(e,t,i,r,s,a=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=r,this.count=s,this.normalized=a,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const uN=new qt;class ep{constructor(e,t,i=0,r=1/0){this.ray=new gf(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new L0,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):on("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return uN.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(uN),this}intersectObject(e,t=!0,i=[]){return GR(e,this,i,t),i.sort(hN),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)GR(e[r],this,i,t);return i.sort(hN),i}}function hN(n,e){return n.distance-e.distance}function GR(n,e,t,i){let r=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(r=!1),r===!0&&i===!0){const s=n.children;for(let a=0,o=s.length;a<o;a++)GR(s[a],e,t,!0)}}class SX{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=EX.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function EX(){this._document.hidden===!1&&this.reset()}class nb{constructor(e=1,t=0,i=0){this.radius=e,this.phi=t,this.theta=i}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Mn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Mn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class wX{constructor(e=1,t=0,i=0){this.radius=e,this.theta=t,this.y=i}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}class U4{constructor(e,t,i,r){U4.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,i,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let i=0;i<4;i++)this.elements[i]=e[i+t];return this}set(e,t,i,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=i,s[3]=r,this}}const fN=new Ze;class l6{constructor(e=new Ze(1/0,1/0),t=new Ze(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=fN.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,fN).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const dN=new ee,kS=new ee,RA=new ee,BA=new ee,cT=new ee,MX=new ee,CX=new ee;class Fw{constructor(e=new ee,t=new ee){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){dN.subVectors(e,this.start),kS.subVectors(this.end,this.start);const i=kS.dot(kS);let s=kS.dot(dN)/i;return t&&(s=Mn(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,t=MX,i=CX){const r=10000000000000001e-32;let s,a;const o=this.start,c=e.start,h=this.end,p=e.end;RA.subVectors(h,o),BA.subVectors(p,c),cT.subVectors(o,c);const g=RA.dot(RA),A=BA.dot(BA),v=BA.dot(cT);if(g<=r&&A<=r)return t.copy(o),i.copy(c),t.sub(i),t.dot(t);if(g<=r)s=0,a=v/A,a=Mn(a,0,1);else{const x=RA.dot(cT);if(A<=r)a=0,s=Mn(-x/g,0,1);else{const S=RA.dot(BA),_=g*A-S*S;_!==0?s=Mn((S*v-x*A)/_,0,1):s=0,a=(S*s+v)/A,a<0?(a=0,s=Mn(-x/g,0,1)):a>1&&(a=1,s=Mn((S-x)/g,0,1))}}return t.copy(o).add(RA.multiplyScalar(s)),i.copy(c).add(BA.multiplyScalar(a)),t.sub(i),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const pN=new ee;class TX extends Gn{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const i=new vn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,c=32;a<c;a++,o++){const h=a/c*Math.PI*2,p=o/c*Math.PI*2;r.push(Math.cos(h),Math.sin(h),1,Math.cos(p),Math.sin(p),1)}i.setAttribute("position",new Kt(r,3));const s=new za({fog:!1,toneMapped:!1});this.cone=new qc(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),pN.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(pN),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const md=new ee,zS=new qt,uT=new qt;class IX extends qc{constructor(e){const t=c6(e),i=new vn,r=[],s=[];for(let h=0;h<t.length;h++){const p=t[h];p.parent&&p.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(0,0,0),s.push(0,0,0))}i.setAttribute("position",new Kt(r,3)),i.setAttribute("color",new Kt(s,3));const a=new za({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,a),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const o=new Mt(255),c=new Mt(65280);this.setColors(o,c)}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");uT.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const o=t[s];o.parent&&o.parent.isBone&&(zS.multiplyMatrices(uT,o.matrixWorld),md.setFromMatrixPosition(zS),r.setXYZ(a,md.x,md.y,md.z),zS.multiplyMatrices(uT,o.parent.matrixWorld),md.setFromMatrixPosition(zS),r.setXYZ(a+1,md.x,md.y,md.z),a+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const r=this.geometry.getAttribute("color");for(let s=0;s<r.count;s+=2)r.setXYZ(s,e.r,e.g,e.b),r.setXYZ(s+1,t.r,t.g,t.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function c6(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push(...c6(n.children[t]));return e}class RX extends Wt{constructor(e,t,i){const r=new hc(t,4,2),s=new ar({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const BX=new ee,mN=new Mt,gN=new Mt;class DX extends Gn{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new lv(t);r.rotateY(Math.PI*.5),this.material=new ar({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),a=new Float32Array(s.count*3);r.setAttribute("color",new An(a,3)),this.add(new Wt(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");mN.copy(this.light.color),gN.copy(this.light.groundColor);for(let i=0,r=t.count;i<r;i++){const s=i<r/2?mN:gN;t.setXYZ(i,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(BX.setFromMatrixPosition(this.light.matrixWorld).negate())}}class LX extends qc{constructor(e=10,t=10,i=4473924,r=8947848){i=new Mt(i),r=new Mt(r);const s=t/2,a=e/t,o=e/2,c=[],h=[];for(let A=0,v=0,x=-o;A<=t;A++,x+=a){c.push(-o,0,x,o,0,x),c.push(x,0,-o,x,0,o);const S=A===s?i:r;S.toArray(h,v),v+=3,S.toArray(h,v),v+=3,S.toArray(h,v),v+=3,S.toArray(h,v),v+=3}const p=new vn;p.setAttribute("position",new Kt(c,3)),p.setAttribute("color",new Kt(h,3));const g=new za({vertexColors:!0,toneMapped:!1});super(p,g),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class NX extends qc{constructor(e=10,t=16,i=8,r=64,s=4473924,a=8947848){s=new Mt(s),a=new Mt(a);const o=[],c=[];if(t>1)for(let g=0;g<t;g++){const A=g/t*(Math.PI*2),v=Math.sin(A)*e,x=Math.cos(A)*e;o.push(0,0,0),o.push(v,0,x);const S=g&1?s:a;c.push(S.r,S.g,S.b),c.push(S.r,S.g,S.b)}for(let g=0;g<i;g++){const A=g&1?s:a,v=e-e/i*g;for(let x=0;x<r;x++){let S=x/r*(Math.PI*2),_=Math.sin(S)*v,E=Math.cos(S)*v;o.push(_,0,E),c.push(A.r,A.g,A.b),S=(x+1)/r*(Math.PI*2),_=Math.sin(S)*v,E=Math.cos(S)*v,o.push(_,0,E),c.push(A.r,A.g,A.b)}}const h=new vn;h.setAttribute("position",new Kt(o,3)),h.setAttribute("color",new Kt(c,3));const p=new za({vertexColors:!0,toneMapped:!1});super(h,p),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const AN=new ee,GS=new ee,vN=new ee;class UX extends Gn{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new vn;r.setAttribute("position",new Kt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new za({fog:!1,toneMapped:!1});this.lightPlane=new Wc(r,s),this.add(this.lightPlane),r=new vn,r.setAttribute("position",new Kt([0,0,0,0,0,1],3)),this.targetLine=new Wc(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),AN.setFromMatrixPosition(this.light.matrixWorld),GS.setFromMatrixPosition(this.light.target.matrixWorld),vN.subVectors(GS,AN),this.lightPlane.lookAt(GS),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(GS),this.targetLine.scale.z=vN.length()}}const HS=new ee,Zr=new CM;class FX extends qc{constructor(e){const t=new vn,i=new za({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(x,S){c(x),c(S)}function c(x){r.push(0,0,0),s.push(0,0,0),a[x]===void 0&&(a[x]=[]),a[x].push(r.length/3-1)}t.setAttribute("position",new Kt(r,3)),t.setAttribute("color",new Kt(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const h=new Mt(16755200),p=new Mt(16711680),g=new Mt(43775),A=new Mt(16777215),v=new Mt(3355443);this.setColors(h,p,g,A,v)}setColors(e,t,i,r,s){const o=this.geometry.getAttribute("color");return o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,t.r,t.g,t.b),o.setXYZ(25,t.r,t.g,t.b),o.setXYZ(26,t.r,t.g,t.b),o.setXYZ(27,t.r,t.g,t.b),o.setXYZ(28,t.r,t.g,t.b),o.setXYZ(29,t.r,t.g,t.b),o.setXYZ(30,t.r,t.g,t.b),o.setXYZ(31,t.r,t.g,t.b),o.setXYZ(32,i.r,i.g,i.b),o.setXYZ(33,i.r,i.g,i.b),o.setXYZ(34,i.r,i.g,i.b),o.setXYZ(35,i.r,i.g,i.b),o.setXYZ(36,i.r,i.g,i.b),o.setXYZ(37,i.r,i.g,i.b),o.setXYZ(38,r.r,r.g,r.b),o.setXYZ(39,r.r,r.g,r.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,i=1,r=1;let s,a;if(Zr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)s=1,a=0;else if(this.camera.coordinateSystem===rl)s=-1,a=1;else if(this.camera.coordinateSystem===I0)s=0,a=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);ls("c",t,e,Zr,0,0,s),ls("t",t,e,Zr,0,0,a),ls("n1",t,e,Zr,-i,-r,s),ls("n2",t,e,Zr,i,-r,s),ls("n3",t,e,Zr,-i,r,s),ls("n4",t,e,Zr,i,r,s),ls("f1",t,e,Zr,-i,-r,a),ls("f2",t,e,Zr,i,-r,a),ls("f3",t,e,Zr,-i,r,a),ls("f4",t,e,Zr,i,r,a),ls("u1",t,e,Zr,i*.7,r*1.1,s),ls("u2",t,e,Zr,-i*.7,r*1.1,s),ls("u3",t,e,Zr,0,r*2,s),ls("cf1",t,e,Zr,-i,0,a),ls("cf2",t,e,Zr,i,0,a),ls("cf3",t,e,Zr,0,-r,a),ls("cf4",t,e,Zr,0,r,a),ls("cn1",t,e,Zr,-i,0,s),ls("cn2",t,e,Zr,i,0,s),ls("cn3",t,e,Zr,0,-r,s),ls("cn4",t,e,Zr,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ls(n,e,t,i,r,s,a){HS.set(r,s,a).unproject(i);const o=e[n];if(o!==void 0){const c=t.getAttribute("position");for(let h=0,p=o.length;h<p;h++)c.setXYZ(o[h],HS.x,HS.y,HS.z)}}const QS=new gr;class PX extends qc{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new vn;s.setIndex(new An(i,1)),s.setAttribute("position",new An(r,3)),super(s,new za({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&QS.setFromObject(this.object),QS.isEmpty())return;const e=QS.min,t=QS.max,i=this.geometry.attributes.position,r=i.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class OX extends qc{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new vn;s.setIndex(new An(i,1)),s.setAttribute("position",new Kt(r,3)),super(s,new za({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class kX extends Wc{constructor(e,t=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new vn;a.setAttribute("position",new Kt(s,3)),a.computeBoundingSphere(),super(a,new za({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new vn;c.setAttribute("position",new Kt(o,3)),c.computeBoundingSphere(),this.add(new Wt(c,new ar({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const yN=new ee;let VS,hT;class zX extends Gn{constructor(e=new ee(0,0,1),t=new ee(0,0,0),i=1,r=16776960,s=i*.2,a=s*.2){super(),this.type="ArrowHelper",VS===void 0&&(VS=new vn,VS.setAttribute("position",new Kt([0,0,0,0,1,0],3)),hT=new ov(.5,1,5,1),hT.translate(0,-.5,0)),this.position.copy(t),this.line=new Wc(VS,new za({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Wt(hT,new ar({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{yN.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(yN,t)}}setLength(e,t=e*.2,i=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class GX extends qc{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new vn;r.setAttribute("position",new Kt(t,3)),r.setAttribute("color",new Kt(i,3));const s=new za({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,i){const r=new Mt,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class HX{constructor(){this.type="ShapePath",this.color=new Mt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Uw,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,a){return this.currentPath.bezierCurveTo(e,t,i,r,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(E){const C=[];for(let T=0,R=E.length;T<R;T++){const B=E[T],U=new df;U.curves=B.curves,C.push(U)}return C}function i(E,C){const T=C.length;let R=!1;for(let B=T-1,U=0;U<T;B=U++){let O=C[B],F=C[U],L=F.x-O.x,P=F.y-O.y;if(Math.abs(P)>Number.EPSILON){if(P<0&&(O=C[U],L=-L,F=C[B],P=-P),E.y<O.y||E.y>F.y)continue;if(E.y===O.y){if(E.x===O.x)return!0}else{const W=P*(E.x-O.x)-L*(E.y-O.y);if(W===0)return!0;if(W<0)continue;R=!R}}else{if(E.y!==O.y)continue;if(F.x<=E.x&&E.x<=O.x||O.x<=E.x&&E.x<=F.x)return!0}}return R}const r=Hc.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,o,c;const h=[];if(s.length===1)return o=s[0],c=new df,c.curves=o.curves,h.push(c),h;let p=!r(s[0].getPoints());p=e?!p:p;const g=[],A=[];let v=[],x=0,S;A[x]=void 0,v[x]=[];for(let E=0,C=s.length;E<C;E++)o=s[E],S=o.getPoints(),a=r(S),a=e?!a:a,a?(!p&&A[x]&&x++,A[x]={s:new df,p:S},A[x].s.curves=o.curves,p&&x++,v[x]=[]):v[x].push({h:o,p:S[0]});if(!A[0])return t(s);if(A.length>1){let E=!1,C=0;for(let T=0,R=A.length;T<R;T++)g[T]=[];for(let T=0,R=A.length;T<R;T++){const B=v[T];for(let U=0;U<B.length;U++){const O=B[U];let F=!0;for(let L=0;L<A.length;L++)i(O.p,A[L].p)&&(T!==L&&C++,F?(F=!1,g[L].push(O)):E=!0);F&&g[T].push(O)}}C>0&&E===!1&&(v=g)}let _;for(let E=0,C=A.length;E<C;E++){c=A[E].s,h.push(c),_=v[E];for(let T=0,R=_.length;T<R;T++)c.holes.push(_[T].h)}return h}}class QX extends zo{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){Gt("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function VX(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2):(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0),n}function jX(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0):(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2),n}function WX(n){return n.repeat.x=1,n.repeat.y=1,n.offset.x=0,n.offset.y=0,n}function HR(n,e,t,i){const r=qX(i);switch(t){case e4:return n*e;case qu:return n*e/r.components*r.byteLength;case ex:return n*e/r.components*r.byteLength;case ac:return n*e*2/r.components*r.byteLength;case xM:return n*e*2/r.components*r.byteLength;case E0:return n*e*3/r.components*r.byteLength;case Fi:return n*e*4/r.components*r.byteLength;case _M:return n*e*4/r.components*r.byteLength;case wm:case Ud:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Mm:case f0:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case gw:case w0:return Math.max(n,16)*Math.max(e,8)/4;case db:case km:return Math.max(n,8)*Math.max(e,8)/2;case pb:case M0:case mb:case gb:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case C0:case Ab:case vb:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Fd:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Aw:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case vw:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case yw:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case Cm:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case bw:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case xw:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case _w:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case Sw:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case Ew:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case ww:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case Mw:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case Cw:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case Tw:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case zm:case Iw:case yb:return Math.ceil(n/4)*Math.ceil(e/4)*16;case bb:case xb:return Math.ceil(n/4)*Math.ceil(e/4)*8;case _b:case Sb:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function qX(n){switch(n){case xn:case AM:return{byteLength:1,components:1};case _0:case vM:case ci:return{byteLength:2,components:1};case yM:case bM:return{byteLength:2,components:4};case fl:case $b:case Si:return{byteLength:4,components:1};case Jb:case Zb:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}let XX=class{static contain(e,t){return VX(e,t)}static cover(e,t){return jX(e,t)}static fill(e){return WX(e)}static getByteLength(e,t,i,r){return HR(e,t,i,r)}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ag}}));typeof window<"u"&&(window.__THREE__?Gt("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ag);function u6(){let n=null,e=!1,t=null,i=null;function r(s,a){t(s,a),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function YX(n){const e=new WeakMap;function t(o,c){const h=o.array,p=o.usage,g=h.byteLength,A=n.createBuffer();n.bindBuffer(c,A),n.bufferData(c,h,p),o.onUploadCallback();let v;if(h instanceof Float32Array)v=n.FLOAT;else if(typeof Float16Array<"u"&&h instanceof Float16Array)v=n.HALF_FLOAT;else if(h instanceof Uint16Array)o.isFloat16BufferAttribute?v=n.HALF_FLOAT:v=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)v=n.SHORT;else if(h instanceof Uint32Array)v=n.UNSIGNED_INT;else if(h instanceof Int32Array)v=n.INT;else if(h instanceof Int8Array)v=n.BYTE;else if(h instanceof Uint8Array)v=n.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)v=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:A,type:v,bytesPerElement:h.BYTES_PER_ELEMENT,version:o.version,size:g}}function i(o,c,h){const p=c.array,g=c.updateRanges;if(n.bindBuffer(h,o),g.length===0)n.bufferSubData(h,0,p);else{g.sort((v,x)=>v.start-x.start);let A=0;for(let v=1;v<g.length;v++){const x=g[A],S=g[v];S.start<=x.start+x.count+1?x.count=Math.max(x.count,S.start+S.count-x.start):(++A,g[A]=S)}g.length=A+1;for(let v=0,x=g.length;v<x;v++){const S=g[v];n.bufferSubData(h,S.start*p.BYTES_PER_ELEMENT,p,S.start,S.count)}c.clearUpdateRanges()}c.onUploadCallback()}function r(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const c=e.get(o);c&&(n.deleteBuffer(c.buffer),e.delete(o))}function a(o,c){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const p=e.get(o);(!p||p.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const h=e.get(o);if(h===void 0)e.set(o,t(o,c));else if(h.version<o.version){if(h.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(h.buffer,o,c),h.version=o.version}}return{get:r,remove:s,update:a}}var KX=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,$X=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,JX=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,ZX=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,eY=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,tY=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,nY=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,iY=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,rY=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,sY=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,aY=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,oY=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,lY=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,cY=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,uY=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,hY=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,fY=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,dY=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,pY=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,mY=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,gY=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,AY=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,vY=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,yY=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,bY=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,xY=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,_Y=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,SY=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,EY=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,wY=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,MY="gl_FragColor = linearToOutputTexel( gl_FragColor );",CY=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,TY=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,IY=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,RY=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,BY=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,DY=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,LY=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,NY=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,UY=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,FY=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,PY=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,OY=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,kY=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,zY=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,GY=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,HY=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,QY=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,VY=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,jY=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,WY=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,qY=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,XY=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,YY=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,KY=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,$Y=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,JY=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,ZY=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,eK=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,tK=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,nK=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,iK=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,rK=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,sK=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,aK=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,oK=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,lK=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,cK=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,uK=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,hK=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,fK=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,dK=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,pK=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,mK=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,gK=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,AK=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,vK=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,yK=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,bK=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,xK=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,_K=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,SK=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,EK=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,wK=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,MK=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,CK=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,TK=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,IK=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,RK=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,BK=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,DK=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,LK=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,NK=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,UK=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,FK=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,PK=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,OK=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,kK=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,zK=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,GK=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,HK=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,QK=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,VK=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,jK=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,WK=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,qK=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,XK=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const YK=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,KK=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,$K=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,JK=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,ZK=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,e$=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,t$=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,n$=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,i$=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,r$=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,s$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,a$=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,o$=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,l$=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,c$=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,u$=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,h$=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,f$=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,d$=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,p$=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,m$=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,g$=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,A$=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,v$=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,y$=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,b$=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,x$=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_$=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,S$=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,E$=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,w$=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,M$=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,C$=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,T$=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,kn={alphahash_fragment:KX,alphahash_pars_fragment:$X,alphamap_fragment:JX,alphamap_pars_fragment:ZX,alphatest_fragment:eY,alphatest_pars_fragment:tY,aomap_fragment:nY,aomap_pars_fragment:iY,batching_pars_vertex:rY,batching_vertex:sY,begin_vertex:aY,beginnormal_vertex:oY,bsdfs:lY,iridescence_fragment:cY,bumpmap_pars_fragment:uY,clipping_planes_fragment:hY,clipping_planes_pars_fragment:fY,clipping_planes_pars_vertex:dY,clipping_planes_vertex:pY,color_fragment:mY,color_pars_fragment:gY,color_pars_vertex:AY,color_vertex:vY,common:yY,cube_uv_reflection_fragment:bY,defaultnormal_vertex:xY,displacementmap_pars_vertex:_Y,displacementmap_vertex:SY,emissivemap_fragment:EY,emissivemap_pars_fragment:wY,colorspace_fragment:MY,colorspace_pars_fragment:CY,envmap_fragment:TY,envmap_common_pars_fragment:IY,envmap_pars_fragment:RY,envmap_pars_vertex:BY,envmap_physical_pars_fragment:HY,envmap_vertex:DY,fog_vertex:LY,fog_pars_vertex:NY,fog_fragment:UY,fog_pars_fragment:FY,gradientmap_pars_fragment:PY,lightmap_pars_fragment:OY,lights_lambert_fragment:kY,lights_lambert_pars_fragment:zY,lights_pars_begin:GY,lights_toon_fragment:QY,lights_toon_pars_fragment:VY,lights_phong_fragment:jY,lights_phong_pars_fragment:WY,lights_physical_fragment:qY,lights_physical_pars_fragment:XY,lights_fragment_begin:YY,lights_fragment_maps:KY,lights_fragment_end:$Y,logdepthbuf_fragment:JY,logdepthbuf_pars_fragment:ZY,logdepthbuf_pars_vertex:eK,logdepthbuf_vertex:tK,map_fragment:nK,map_pars_fragment:iK,map_particle_fragment:rK,map_particle_pars_fragment:sK,metalnessmap_fragment:aK,metalnessmap_pars_fragment:oK,morphinstance_vertex:lK,morphcolor_vertex:cK,morphnormal_vertex:uK,morphtarget_pars_vertex:hK,morphtarget_vertex:fK,normal_fragment_begin:dK,normal_fragment_maps:pK,normal_pars_fragment:mK,normal_pars_vertex:gK,normal_vertex:AK,normalmap_pars_fragment:vK,clearcoat_normal_fragment_begin:yK,clearcoat_normal_fragment_maps:bK,clearcoat_pars_fragment:xK,iridescence_pars_fragment:_K,opaque_fragment:SK,packing:EK,premultiplied_alpha_fragment:wK,project_vertex:MK,dithering_fragment:CK,dithering_pars_fragment:TK,roughnessmap_fragment:IK,roughnessmap_pars_fragment:RK,shadowmap_pars_fragment:BK,shadowmap_pars_vertex:DK,shadowmap_vertex:LK,shadowmask_pars_fragment:NK,skinbase_vertex:UK,skinning_pars_vertex:FK,skinning_vertex:PK,skinnormal_vertex:OK,specularmap_fragment:kK,specularmap_pars_fragment:zK,tonemapping_fragment:GK,tonemapping_pars_fragment:HK,transmission_fragment:QK,transmission_pars_fragment:VK,uv_pars_fragment:jK,uv_pars_vertex:WK,uv_vertex:qK,worldpos_vertex:XK,background_vert:YK,background_frag:KK,backgroundCube_vert:$K,backgroundCube_frag:JK,cube_vert:ZK,cube_frag:e$,depth_vert:t$,depth_frag:n$,distance_vert:i$,distance_frag:r$,equirect_vert:s$,equirect_frag:a$,linedashed_vert:o$,linedashed_frag:l$,meshbasic_vert:c$,meshbasic_frag:u$,meshlambert_vert:h$,meshlambert_frag:f$,meshmatcap_vert:d$,meshmatcap_frag:p$,meshnormal_vert:m$,meshnormal_frag:g$,meshphong_vert:A$,meshphong_frag:v$,meshphysical_vert:y$,meshphysical_frag:b$,meshtoon_vert:x$,meshtoon_frag:_$,points_vert:S$,points_frag:E$,shadow_vert:w$,shadow_frag:M$,sprite_vert:C$,sprite_frag:T$},Ht={common:{diffuse:{value:new Mt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Rn},alphaMap:{value:null},alphaMapTransform:{value:new Rn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Rn}},envmap:{envMap:{value:null},envMapRotation:{value:new Rn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Rn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Rn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Rn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Rn},normalScale:{value:new Ze(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Rn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Rn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Rn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Rn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Mt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Mt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Rn},alphaTest:{value:0},uvTransform:{value:new Rn}},sprite:{diffuse:{value:new Mt(16777215)},opacity:{value:1},center:{value:new Ze(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Rn},alphaMap:{value:null},alphaMapTransform:{value:new Rn},alphaTest:{value:0}}},kc={basic:{uniforms:to([Ht.common,Ht.specularmap,Ht.envmap,Ht.aomap,Ht.lightmap,Ht.fog]),vertexShader:kn.meshbasic_vert,fragmentShader:kn.meshbasic_frag},lambert:{uniforms:to([Ht.common,Ht.specularmap,Ht.envmap,Ht.aomap,Ht.lightmap,Ht.emissivemap,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,Ht.fog,Ht.lights,{emissive:{value:new Mt(0)}}]),vertexShader:kn.meshlambert_vert,fragmentShader:kn.meshlambert_frag},phong:{uniforms:to([Ht.common,Ht.specularmap,Ht.envmap,Ht.aomap,Ht.lightmap,Ht.emissivemap,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,Ht.fog,Ht.lights,{emissive:{value:new Mt(0)},specular:{value:new Mt(1118481)},shininess:{value:30}}]),vertexShader:kn.meshphong_vert,fragmentShader:kn.meshphong_frag},standard:{uniforms:to([Ht.common,Ht.envmap,Ht.aomap,Ht.lightmap,Ht.emissivemap,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,Ht.roughnessmap,Ht.metalnessmap,Ht.fog,Ht.lights,{emissive:{value:new Mt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:kn.meshphysical_vert,fragmentShader:kn.meshphysical_frag},toon:{uniforms:to([Ht.common,Ht.aomap,Ht.lightmap,Ht.emissivemap,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,Ht.gradientmap,Ht.fog,Ht.lights,{emissive:{value:new Mt(0)}}]),vertexShader:kn.meshtoon_vert,fragmentShader:kn.meshtoon_frag},matcap:{uniforms:to([Ht.common,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,Ht.fog,{matcap:{value:null}}]),vertexShader:kn.meshmatcap_vert,fragmentShader:kn.meshmatcap_frag},points:{uniforms:to([Ht.points,Ht.fog]),vertexShader:kn.points_vert,fragmentShader:kn.points_frag},dashed:{uniforms:to([Ht.common,Ht.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:kn.linedashed_vert,fragmentShader:kn.linedashed_frag},depth:{uniforms:to([Ht.common,Ht.displacementmap]),vertexShader:kn.depth_vert,fragmentShader:kn.depth_frag},normal:{uniforms:to([Ht.common,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,{opacity:{value:1}}]),vertexShader:kn.meshnormal_vert,fragmentShader:kn.meshnormal_frag},sprite:{uniforms:to([Ht.sprite,Ht.fog]),vertexShader:kn.sprite_vert,fragmentShader:kn.sprite_frag},background:{uniforms:{uvTransform:{value:new Rn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:kn.background_vert,fragmentShader:kn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Rn}},vertexShader:kn.backgroundCube_vert,fragmentShader:kn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:kn.cube_vert,fragmentShader:kn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:kn.equirect_vert,fragmentShader:kn.equirect_frag},distance:{uniforms:to([Ht.common,Ht.displacementmap,{referencePosition:{value:new ee},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:kn.distance_vert,fragmentShader:kn.distance_frag},shadow:{uniforms:to([Ht.lights,Ht.fog,{color:{value:new Mt(0)},opacity:{value:1}}]),vertexShader:kn.shadow_vert,fragmentShader:kn.shadow_frag}};kc.physical={uniforms:to([kc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Rn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Rn},clearcoatNormalScale:{value:new Ze(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Rn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Rn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Rn},sheen:{value:0},sheenColor:{value:new Mt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Rn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Rn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Rn},transmissionSamplerSize:{value:new Ze},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Rn},attenuationDistance:{value:0},attenuationColor:{value:new Mt(0)},specularColor:{value:new Mt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Rn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Rn},anisotropyVector:{value:new Ze},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Rn}}]),vertexShader:kn.meshphysical_vert,fragmentShader:kn.meshphysical_frag};const jS={r:0,b:0,g:0},Kp=new Us,I$=new qt;function R$(n,e,t,i,r,s,a){const o=new Mt(0);let c=s===!0?0:1,h,p,g=null,A=0,v=null;function x(T){let R=T.isScene===!0?T.background:null;return R&&R.isTexture&&(R=(T.backgroundBlurriness>0?t:e).get(R)),R}function S(T){let R=!1;const B=x(T);B===null?E(o,c):B&&B.isColor&&(E(B,1),R=!0);const U=n.xr.getEnvironmentBlendMode();U==="additive"?i.buffers.color.setClear(0,0,0,1,a):U==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,a),(n.autoClear||R)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function _(T,R){const B=x(R);B&&(B.isCubeTexture||B.mapping===iv)?(p===void 0&&(p=new Wt(new ba(1,1,1),new Fs({name:"BackgroundCubeMaterial",uniforms:N0(kc.backgroundCube.uniforms),vertexShader:kc.backgroundCube.vertexShader,fragmentShader:kc.backgroundCube.fragmentShader,side:ia,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(U,O,F){this.matrixWorld.copyPosition(F.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(p)),Kp.copy(R.backgroundRotation),Kp.x*=-1,Kp.y*=-1,Kp.z*=-1,B.isCubeTexture&&B.isRenderTargetTexture===!1&&(Kp.y*=-1,Kp.z*=-1),p.material.uniforms.envMap.value=B,p.material.uniforms.flipEnvMap.value=B.isCubeTexture&&B.isRenderTargetTexture===!1?-1:1,p.material.uniforms.backgroundBlurriness.value=R.backgroundBlurriness,p.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,p.material.uniforms.backgroundRotation.value.setFromMatrix4(I$.makeRotationFromEuler(Kp)),p.material.toneMapped=Wn.getTransfer(B.colorSpace)!==Ui,(g!==B||A!==B.version||v!==n.toneMapping)&&(p.material.needsUpdate=!0,g=B,A=B.version,v=n.toneMapping),p.layers.enableAll(),T.unshift(p,p.geometry,p.material,0,0,null)):B&&B.isTexture&&(h===void 0&&(h=new Wt(new ra(2,2),new Fs({name:"BackgroundMaterial",uniforms:N0(kc.background.uniforms),vertexShader:kc.background.vertexShader,fragmentShader:kc.background.fragmentShader,side:cc,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(h)),h.material.uniforms.t2D.value=B,h.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,h.material.toneMapped=Wn.getTransfer(B.colorSpace)!==Ui,B.matrixAutoUpdate===!0&&B.updateMatrix(),h.material.uniforms.uvTransform.value.copy(B.matrix),(g!==B||A!==B.version||v!==n.toneMapping)&&(h.material.needsUpdate=!0,g=B,A=B.version,v=n.toneMapping),h.layers.enableAll(),T.unshift(h,h.geometry,h.material,0,0,null))}function E(T,R){T.getRGB(jS,x8(n)),i.buffers.color.setClear(jS.r,jS.g,jS.b,R,a)}function C(){p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0),h!==void 0&&(h.geometry.dispose(),h.material.dispose(),h=void 0)}return{getClearColor:function(){return o},setClearColor:function(T,R=1){o.set(T),c=R,E(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(T){c=T,E(o,c)},render:S,addToRenderList:_,dispose:C}}function B$(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=A(null);let s=r,a=!1;function o(P,W,j,V,q){let re=!1;const Q=g(V,j,W);s!==Q&&(s=Q,h(s.object)),re=v(P,V,j,q),re&&x(P,V,j,q),q!==null&&e.update(q,n.ELEMENT_ARRAY_BUFFER),(re||a)&&(a=!1,R(P,W,j,V),q!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(q).buffer))}function c(){return n.createVertexArray()}function h(P){return n.bindVertexArray(P)}function p(P){return n.deleteVertexArray(P)}function g(P,W,j){const V=j.wireframe===!0;let q=i[P.id];q===void 0&&(q={},i[P.id]=q);let re=q[W.id];re===void 0&&(re={},q[W.id]=re);let Q=re[V];return Q===void 0&&(Q=A(c()),re[V]=Q),Q}function A(P){const W=[],j=[],V=[];for(let q=0;q<t;q++)W[q]=0,j[q]=0,V[q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:W,enabledAttributes:j,attributeDivisors:V,object:P,attributes:{},index:null}}function v(P,W,j,V){const q=s.attributes,re=W.attributes;let Q=0;const K=j.getAttributes();for(const ce in K)if(K[ce].location>=0){const oe=q[ce];let z=re[ce];if(z===void 0&&(ce==="instanceMatrix"&&P.instanceMatrix&&(z=P.instanceMatrix),ce==="instanceColor"&&P.instanceColor&&(z=P.instanceColor)),oe===void 0||oe.attribute!==z||z&&oe.data!==z.data)return!0;Q++}return s.attributesNum!==Q||s.index!==V}function x(P,W,j,V){const q={},re=W.attributes;let Q=0;const K=j.getAttributes();for(const ce in K)if(K[ce].location>=0){let oe=re[ce];oe===void 0&&(ce==="instanceMatrix"&&P.instanceMatrix&&(oe=P.instanceMatrix),ce==="instanceColor"&&P.instanceColor&&(oe=P.instanceColor));const z={};z.attribute=oe,oe&&oe.data&&(z.data=oe.data),q[ce]=z,Q++}s.attributes=q,s.attributesNum=Q,s.index=V}function S(){const P=s.newAttributes;for(let W=0,j=P.length;W<j;W++)P[W]=0}function _(P){E(P,0)}function E(P,W){const j=s.newAttributes,V=s.enabledAttributes,q=s.attributeDivisors;j[P]=1,V[P]===0&&(n.enableVertexAttribArray(P),V[P]=1),q[P]!==W&&(n.vertexAttribDivisor(P,W),q[P]=W)}function C(){const P=s.newAttributes,W=s.enabledAttributes;for(let j=0,V=W.length;j<V;j++)W[j]!==P[j]&&(n.disableVertexAttribArray(j),W[j]=0)}function T(P,W,j,V,q,re,Q){Q===!0?n.vertexAttribIPointer(P,W,j,q,re):n.vertexAttribPointer(P,W,j,V,q,re)}function R(P,W,j,V){S();const q=V.attributes,re=j.getAttributes(),Q=W.defaultAttributeValues;for(const K in re){const ce=re[K];if(ce.location>=0){let ue=q[K];if(ue===void 0&&(K==="instanceMatrix"&&P.instanceMatrix&&(ue=P.instanceMatrix),K==="instanceColor"&&P.instanceColor&&(ue=P.instanceColor)),ue!==void 0){const oe=ue.normalized,z=ue.itemSize,$=e.get(ue);if($===void 0)continue;const ae=$.buffer,he=$.type,me=$.bytesPerElement,le=he===n.INT||he===n.UNSIGNED_INT||ue.gpuType===$b;if(ue.isInterleavedBufferAttribute){const fe=ue.data,_e=fe.stride,Pe=ue.offset;if(fe.isInstancedInterleavedBuffer){for(let et=0;et<ce.locationSize;et++)E(ce.location+et,fe.meshPerAttribute);P.isInstancedMesh!==!0&&V._maxInstanceCount===void 0&&(V._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let et=0;et<ce.locationSize;et++)_(ce.location+et);n.bindBuffer(n.ARRAY_BUFFER,ae);for(let et=0;et<ce.locationSize;et++)T(ce.location+et,z/ce.locationSize,he,oe,_e*me,(Pe+z/ce.locationSize*et)*me,le)}else{if(ue.isInstancedBufferAttribute){for(let fe=0;fe<ce.locationSize;fe++)E(ce.location+fe,ue.meshPerAttribute);P.isInstancedMesh!==!0&&V._maxInstanceCount===void 0&&(V._maxInstanceCount=ue.meshPerAttribute*ue.count)}else for(let fe=0;fe<ce.locationSize;fe++)_(ce.location+fe);n.bindBuffer(n.ARRAY_BUFFER,ae);for(let fe=0;fe<ce.locationSize;fe++)T(ce.location+fe,z/ce.locationSize,he,oe,z*me,z/ce.locationSize*fe*me,le)}}else if(Q!==void 0){const oe=Q[K];if(oe!==void 0)switch(oe.length){case 2:n.vertexAttrib2fv(ce.location,oe);break;case 3:n.vertexAttrib3fv(ce.location,oe);break;case 4:n.vertexAttrib4fv(ce.location,oe);break;default:n.vertexAttrib1fv(ce.location,oe)}}}}C()}function B(){F();for(const P in i){const W=i[P];for(const j in W){const V=W[j];for(const q in V)p(V[q].object),delete V[q];delete W[j]}delete i[P]}}function U(P){if(i[P.id]===void 0)return;const W=i[P.id];for(const j in W){const V=W[j];for(const q in V)p(V[q].object),delete V[q];delete W[j]}delete i[P.id]}function O(P){for(const W in i){const j=i[W];if(j[P.id]===void 0)continue;const V=j[P.id];for(const q in V)p(V[q].object),delete V[q];delete j[P.id]}}function F(){L(),a=!0,s!==r&&(s=r,h(s.object))}function L(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:o,reset:F,resetDefaultState:L,dispose:B,releaseStatesOfGeometry:U,releaseStatesOfProgram:O,initAttributes:S,enableAttribute:_,disableUnusedAttributes:C}}function D$(n,e,t){let i;function r(h){i=h}function s(h,p){n.drawArrays(i,h,p),t.update(p,i,1)}function a(h,p,g){g!==0&&(n.drawArraysInstanced(i,h,p,g),t.update(p,i,g))}function o(h,p,g){if(g===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,h,0,p,0,g);let v=0;for(let x=0;x<g;x++)v+=p[x];t.update(v,i,1)}function c(h,p,g,A){if(g===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let x=0;x<h.length;x++)a(h[x],p[x],A[x]);else{v.multiDrawArraysInstancedWEBGL(i,h,0,p,0,A,0,g);let x=0;for(let S=0;S<g;S++)x+=p[S]*A[S];t.update(x,i,1)}}this.setMode=r,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=c}function L$(n,e,t,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const O=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(O.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(O){return!(O!==Fi&&i.convert(O)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(O){const F=O===ci&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(O!==xn&&i.convert(O)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&O!==Si&&!F)}function c(O){if(O==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";O="mediump"}return O==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let h=t.precision!==void 0?t.precision:"highp";const p=c(h);p!==h&&(Gt("WebGLRenderer:",h,"not supported, using",p,"instead."),h=p);const g=t.logarithmicDepthBuffer===!0,A=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),v=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),x=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),S=n.getParameter(n.MAX_TEXTURE_SIZE),_=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),E=n.getParameter(n.MAX_VERTEX_ATTRIBS),C=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),T=n.getParameter(n.MAX_VARYING_VECTORS),R=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),B=n.getParameter(n.MAX_SAMPLES),U=n.getParameter(n.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:c,textureFormatReadable:a,textureTypeReadable:o,precision:h,logarithmicDepthBuffer:g,reversedDepthBuffer:A,maxTextures:v,maxVertexTextures:x,maxTextureSize:S,maxCubemapSize:_,maxAttributes:E,maxVertexUniforms:C,maxVaryings:T,maxFragmentUniforms:R,maxSamples:B,samples:U}}function N$(n){const e=this;let t=null,i=0,r=!1,s=!1;const a=new nc,o=new Rn,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(g,A){const v=g.length!==0||A||i!==0||r;return r=A,i=g.length,v},this.beginShadows=function(){s=!0,p(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(g,A){t=p(g,A,0)},this.setState=function(g,A,v){const x=g.clippingPlanes,S=g.clipIntersection,_=g.clipShadows,E=n.get(g);if(!r||x===null||x.length===0||s&&!_)s?p(null):h();else{const C=s?0:i,T=C*4;let R=E.clippingState||null;c.value=R,R=p(x,A,T,v);for(let B=0;B!==T;++B)R[B]=t[B];E.clippingState=R,this.numIntersection=S?this.numPlanes:0,this.numPlanes+=C}};function h(){c.value!==t&&(c.value=t,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function p(g,A,v,x){const S=g!==null?g.length:0;let _=null;if(S!==0){if(_=c.value,x!==!0||_===null){const E=v+S*4,C=A.matrixWorldInverse;o.getNormalMatrix(C),(_===null||_.length<E)&&(_=new Float32Array(E));for(let T=0,R=v;T!==S;++T,R+=4)a.copy(g[T]).applyMatrix4(C,o),a.normal.toArray(_,R),_[R+3]=a.constant}c.value=_,c.needsUpdate=!0}return e.numPlanes=S,e.numIntersection=0,_}}function U$(n){let e=new WeakMap;function t(a,o){return o===Om?a.mapping=jc:o===fb&&(a.mapping=Qd),a}function i(a){if(a&&a.isTexture){const o=a.mapping;if(o===Om||o===fb)if(e.has(a)){const c=e.get(a).texture;return t(c,a.mapping)}else{const c=a.image;if(c&&c.height>0){const h=new rv(c.height);return h.fromEquirectangularTexture(n,a),e.set(a,h),a.addEventListener("dispose",r),t(h.texture,a.mapping)}else return null}}return a}function r(a){const o=a.target;o.removeEventListener("dispose",r);const c=e.get(o);c!==void 0&&(e.delete(o),c.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}const Dd=4,bN=[.125,.215,.35,.446,.526,.582],pm=20,F$=256,o1=new Yc,xN=new Mt;let fT=null,dT=0,pT=0,mT=!1;const P$=new ee;class QR{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,i=.1,r=100,s={}){const{size:a=256,position:o=P$}=s;fT=this._renderer.getRenderTarget(),dT=this._renderer.getActiveCubeFace(),pT=this._renderer.getActiveMipmapLevel(),mT=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,i,r,c,o),t>0&&this._blur(c,0,0,t),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=EN(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=SN(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(fT,dT,pT),this._renderer.xr.enabled=mT,e.scissorTest=!1,DA(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===jc||e.mapping===Qd?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),fT=this._renderer.getRenderTarget(),dT=this._renderer.getActiveCubeFace(),pT=this._renderer.getActiveMipmapLevel(),mT=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:mn,minFilter:mn,generateMipmaps:!1,type:ci,format:Fi,colorSpace:Xi,depthBuffer:!1},r=_N(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_N(e,t,i);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=O$(s)),this._blurMaterial=z$(s,e,t),this._ggxMaterial=k$(s,e,t)}return r}_compileMaterial(e){const t=new Wt(new vn,e);this._renderer.compile(t,o1)}_sceneToCubeUV(e,t,i,r,s){const c=new Gr(90,1,t,i),h=[1,-1,1,1,1,1],p=[1,1,1,-1,-1,-1],g=this._renderer,A=g.autoClear,v=g.toneMapping;g.getClearColor(xN),g.toneMapping=ko,g.autoClear=!1,g.state.buffers.depth.getReversed()&&(g.setRenderTarget(r),g.clearDepth(),g.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new Wt(new ba,new ar({name:"PMREM.Background",side:ia,depthWrite:!1,depthTest:!1})));const S=this._backgroundBox,_=S.material;let E=!1;const C=e.background;C?C.isColor&&(_.color.copy(C),e.background=null,E=!0):(_.color.copy(xN),E=!0);for(let T=0;T<6;T++){const R=T%3;R===0?(c.up.set(0,h[T],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x+p[T],s.y,s.z)):R===1?(c.up.set(0,0,h[T]),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y+p[T],s.z)):(c.up.set(0,h[T],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y,s.z+p[T]));const B=this._cubeSize;DA(r,R*B,T>2?B:0,B,B),g.setRenderTarget(r),E&&g.render(S,c),g.render(e,c)}g.toneMapping=v,g.autoClear=A,e.background=C}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===jc||e.mapping===Qd;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=EN()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=SN());const s=r?this._cubemapMaterial:this._equirectMaterial,a=this._lodMeshes[0];a.material=s;const o=s.uniforms;o.envMap.value=e;const c=this._cubeSize;DA(t,0,0,3*c,2*c),i.setRenderTarget(t),i.render(a,o1)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=i}_applyGGXFilter(e,t,i){const r=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,o=this._lodMeshes[i];o.material=a;const c=a.uniforms,h=i/(this._lodMeshes.length-1),p=t/(this._lodMeshes.length-1),g=Math.sqrt(h*h-p*p),A=0+h*1.25,v=g*A,{_lodMax:x}=this,S=this._sizeLods[i],_=3*S*(i>x-Dd?i-x+Dd:0),E=4*(this._cubeSize-S);c.envMap.value=e.texture,c.roughness.value=v,c.mipInt.value=x-t,DA(s,_,E,3*S,2*S),r.setRenderTarget(s),r.render(o,o1),c.envMap.value=s.texture,c.roughness.value=0,c.mipInt.value=x-i,DA(e,_,E,3*S,2*S),r.setRenderTarget(e),r.render(o,o1)}_blur(e,t,i,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,i,r,"latitudinal",s),this._halfBlur(a,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,a,o){const c=this._renderer,h=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&on("blur direction must be either latitudinal or longitudinal!");const p=3,g=this._lodMeshes[r];g.material=h;const A=h.uniforms,v=this._sizeLods[i]-1,x=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*pm-1),S=s/x,_=isFinite(s)?1+Math.floor(p*S):pm;_>pm&&Gt(`sigmaRadians, ${s}, is too large and will clip, as it requested ${_} samples when the maximum is set to ${pm}`);const E=[];let C=0;for(let O=0;O<pm;++O){const F=O/S,L=Math.exp(-F*F/2);E.push(L),O===0?C+=L:O<_&&(C+=2*L)}for(let O=0;O<E.length;O++)E[O]=E[O]/C;A.envMap.value=e.texture,A.samples.value=_,A.weights.value=E,A.latitudinal.value=a==="latitudinal",o&&(A.poleAxis.value=o);const{_lodMax:T}=this;A.dTheta.value=x,A.mipInt.value=T-i;const R=this._sizeLods[r],B=3*R*(r>T-Dd?r-T+Dd:0),U=4*(this._cubeSize-R);DA(t,B,U,3*R,2*R),c.setRenderTarget(t),c.render(g,o1)}}function O$(n){const e=[],t=[],i=[];let r=n;const s=n-Dd+1+bN.length;for(let a=0;a<s;a++){const o=Math.pow(2,r);e.push(o);let c=1/o;a>n-Dd?c=bN[a-n+Dd-1]:a===0&&(c=0),t.push(c);const h=1/(o-2),p=-h,g=1+h,A=[p,p,g,p,g,g,p,p,g,g,p,g],v=6,x=6,S=3,_=2,E=1,C=new Float32Array(S*x*v),T=new Float32Array(_*x*v),R=new Float32Array(E*x*v);for(let U=0;U<v;U++){const O=U%3*2/3-1,F=U>2?0:-1,L=[O,F,0,O+2/3,F,0,O+2/3,F+1,0,O,F,0,O+2/3,F+1,0,O,F+1,0];C.set(L,S*x*U),T.set(A,_*x*U);const P=[U,U,U,U,U,U];R.set(P,E*x*U)}const B=new vn;B.setAttribute("position",new An(C,S)),B.setAttribute("uv",new An(T,_)),B.setAttribute("faceIndex",new An(R,E)),i.push(new Wt(B,null)),r>Dd&&r--}return{lodMeshes:i,sizeLods:e,sigmas:t}}function _N(n,e,t){const i=new Vr(n,e,t);return i.texture.mapping=iv,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function DA(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function k$(n,e,t){return new Fs({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:F$,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:$M(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:lc,depthTest:!1,depthWrite:!1})}function z$(n,e,t){const i=new Float32Array(pm),r=new ee(0,1,0);return new Fs({name:"SphericalGaussianBlur",defines:{n:pm,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:$M(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:lc,depthTest:!1,depthWrite:!1})}function SN(){return new Fs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:$M(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:lc,depthTest:!1,depthWrite:!1})}function EN(){return new Fs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:$M(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:lc,depthTest:!1,depthWrite:!1})}function $M(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function G$(n){let e=new WeakMap,t=null;function i(o){if(o&&o.isTexture){const c=o.mapping,h=c===Om||c===fb,p=c===jc||c===Qd;if(h||p){let g=e.get(o);const A=g!==void 0?g.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==A)return t===null&&(t=new QR(n)),g=h?t.fromEquirectangular(o,g):t.fromCubemap(o,g),g.texture.pmremVersion=o.pmremVersion,e.set(o,g),g.texture;if(g!==void 0)return g.texture;{const v=o.image;return h&&v&&v.height>0||p&&v&&r(v)?(t===null&&(t=new QR(n)),g=h?t.fromEquirectangular(o):t.fromCubemap(o),g.texture.pmremVersion=o.pmremVersion,e.set(o,g),o.addEventListener("dispose",s),g.texture):null}}}return o}function r(o){let c=0;const h=6;for(let p=0;p<h;p++)o[p]!==void 0&&c++;return c===h}function s(o){const c=o.target;c.removeEventListener("dispose",s);const h=e.get(c);h!==void 0&&(e.delete(c),h.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:a}}function H$(n){const e={};function t(i){if(e[i]!==void 0)return e[i];const r=n.getExtension(i);return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const r=t(i);return r===null&&R0("WebGLRenderer: "+i+" extension not supported."),r}}}function Q$(n,e,t,i){const r={},s=new WeakMap;function a(g){const A=g.target;A.index!==null&&e.remove(A.index);for(const x in A.attributes)e.remove(A.attributes[x]);A.removeEventListener("dispose",a),delete r[A.id];const v=s.get(A);v&&(e.remove(v),s.delete(A)),i.releaseStatesOfGeometry(A),A.isInstancedBufferGeometry===!0&&delete A._maxInstanceCount,t.memory.geometries--}function o(g,A){return r[A.id]===!0||(A.addEventListener("dispose",a),r[A.id]=!0,t.memory.geometries++),A}function c(g){const A=g.attributes;for(const v in A)e.update(A[v],n.ARRAY_BUFFER)}function h(g){const A=[],v=g.index,x=g.attributes.position;let S=0;if(v!==null){const C=v.array;S=v.version;for(let T=0,R=C.length;T<R;T+=3){const B=C[T+0],U=C[T+1],O=C[T+2];A.push(B,U,U,O,O,B)}}else if(x!==void 0){const C=x.array;S=x.version;for(let T=0,R=C.length/3-1;T<R;T+=3){const B=T+0,U=T+1,O=T+2;A.push(B,U,U,O,O,B)}}else return;const _=new(A8(A)?o4:a4)(A,1);_.version=S;const E=s.get(g);E&&e.remove(E),s.set(g,_)}function p(g){const A=s.get(g);if(A){const v=g.index;v!==null&&A.version<v.version&&h(g)}else h(g);return s.get(g)}return{get:o,update:c,getWireframeAttribute:p}}function V$(n,e,t){let i;function r(A){i=A}let s,a;function o(A){s=A.type,a=A.bytesPerElement}function c(A,v){n.drawElements(i,v,s,A*a),t.update(v,i,1)}function h(A,v,x){x!==0&&(n.drawElementsInstanced(i,v,s,A*a,x),t.update(v,i,x))}function p(A,v,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,v,0,s,A,0,x);let _=0;for(let E=0;E<x;E++)_+=v[E];t.update(_,i,1)}function g(A,v,x,S){if(x===0)return;const _=e.get("WEBGL_multi_draw");if(_===null)for(let E=0;E<A.length;E++)h(A[E]/a,v[E],S[E]);else{_.multiDrawElementsInstancedWEBGL(i,v,0,s,A,0,S,0,x);let E=0;for(let C=0;C<x;C++)E+=v[C]*S[C];t.update(E,i,1)}}this.setMode=r,this.setIndex=o,this.render=c,this.renderInstances=h,this.renderMultiDraw=p,this.renderMultiDrawInstances=g}function j$(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(t.calls++,a){case n.TRIANGLES:t.triangles+=o*(s/3);break;case n.LINES:t.lines+=o*(s/2);break;case n.LINE_STRIP:t.lines+=o*(s-1);break;case n.LINE_LOOP:t.lines+=o*s;break;case n.POINTS:t.points+=o*s;break;default:on("WebGLInfo: Unknown draw mode:",a);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function W$(n,e,t){const i=new WeakMap,r=new Ii;function s(a,o,c){const h=a.morphTargetInfluences,p=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,g=p!==void 0?p.length:0;let A=i.get(o);if(A===void 0||A.count!==g){let L=function(){O.dispose(),i.delete(o),o.removeEventListener("dispose",L)};A!==void 0&&A.texture.dispose();const v=o.morphAttributes.position!==void 0,x=o.morphAttributes.normal!==void 0,S=o.morphAttributes.color!==void 0,_=o.morphAttributes.position||[],E=o.morphAttributes.normal||[],C=o.morphAttributes.color||[];let T=0;v===!0&&(T=1),x===!0&&(T=2),S===!0&&(T=3);let R=o.attributes.position.count*T,B=1;R>e.maxTextureSize&&(B=Math.ceil(R/e.maxTextureSize),R=e.maxTextureSize);const U=new Float32Array(R*B*4*g),O=new MM(U,R,B,g);O.type=Si,O.needsUpdate=!0;const F=T*4;for(let P=0;P<g;P++){const W=_[P],j=E[P],V=C[P],q=R*B*4*P;for(let re=0;re<W.count;re++){const Q=re*F;v===!0&&(r.fromBufferAttribute(W,re),U[q+Q+0]=r.x,U[q+Q+1]=r.y,U[q+Q+2]=r.z,U[q+Q+3]=0),x===!0&&(r.fromBufferAttribute(j,re),U[q+Q+4]=r.x,U[q+Q+5]=r.y,U[q+Q+6]=r.z,U[q+Q+7]=0),S===!0&&(r.fromBufferAttribute(V,re),U[q+Q+8]=r.x,U[q+Q+9]=r.y,U[q+Q+10]=r.z,U[q+Q+11]=V.itemSize===4?r.w:1)}}A={count:g,texture:O,size:new Ze(R,B)},i.set(o,A),o.addEventListener("dispose",L)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)c.getUniforms().setValue(n,"morphTexture",a.morphTexture,t);else{let v=0;for(let S=0;S<h.length;S++)v+=h[S];const x=o.morphTargetsRelative?1:1-v;c.getUniforms().setValue(n,"morphTargetBaseInfluence",x),c.getUniforms().setValue(n,"morphTargetInfluences",h)}c.getUniforms().setValue(n,"morphTargetsTexture",A.texture,t),c.getUniforms().setValue(n,"morphTargetsTextureSize",A.size)}return{update:s}}function q$(n,e,t,i){let r=new WeakMap;function s(c){const h=i.render.frame,p=c.geometry,g=e.get(c,p);if(r.get(g)!==h&&(e.update(g),r.set(g,h)),c.isInstancedMesh&&(c.hasEventListener("dispose",o)===!1&&c.addEventListener("dispose",o),r.get(c)!==h&&(t.update(c.instanceMatrix,n.ARRAY_BUFFER),c.instanceColor!==null&&t.update(c.instanceColor,n.ARRAY_BUFFER),r.set(c,h))),c.isSkinnedMesh){const A=c.skeleton;r.get(A)!==h&&(A.update(),r.set(A,h))}return g}function a(){r=new WeakMap}function o(c){const h=c.target;h.removeEventListener("dispose",o),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:s,dispose:a}}const X$={[dM]:"LINEAR_TONE_MAPPING",[pM]:"REINHARD_TONE_MAPPING",[mM]:"CINEON_TONE_MAPPING",[Kb]:"ACES_FILMIC_TONE_MAPPING",[gM]:"AGX_TONE_MAPPING",[Pm]:"NEUTRAL_TONE_MAPPING",[Z2]:"CUSTOM_TONE_MAPPING"};function Y$(n,e,t,i,r){const s=new Vr(e,t,{type:n,depthBuffer:i,stencilBuffer:r}),a=new Vr(e,t,{type:ci,depthBuffer:!1,stencilBuffer:!1}),o=new vn;o.setAttribute("position",new Kt([-1,3,0,-1,-1,0,3,-1,0],3)),o.setAttribute("uv",new Kt([0,2,0,0,2,0],2));const c=new b4({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),h=new Wt(o,c),p=new Yc(-1,1,1,-1,0,1);let g=null,A=null,v=!1,x,S=null,_=[],E=!1;this.setSize=function(C,T){s.setSize(C,T),a.setSize(C,T);for(let R=0;R<_.length;R++){const B=_[R];B.setSize&&B.setSize(C,T)}},this.setEffects=function(C){_=C,E=_.length>0&&_[0].isRenderPass===!0;const T=s.width,R=s.height;for(let B=0;B<_.length;B++){const U=_[B];U.setSize&&U.setSize(T,R)}},this.begin=function(C,T){if(v||C.toneMapping===ko&&_.length===0)return!1;if(S=T,T!==null){const R=T.width,B=T.height;(s.width!==R||s.height!==B)&&this.setSize(R,B)}return E===!1&&C.setRenderTarget(s),x=C.toneMapping,C.toneMapping=ko,!0},this.hasRenderPass=function(){return E},this.end=function(C,T){C.toneMapping=x,v=!0;let R=s,B=a;for(let U=0;U<_.length;U++){const O=_[U];if(O.enabled!==!1&&(O.render(C,B,R,T),O.needsSwap!==!1)){const F=R;R=B,B=F}}if(g!==C.outputColorSpace||A!==C.toneMapping){g=C.outputColorSpace,A=C.toneMapping,c.defines={},Wn.getTransfer(g)===Ui&&(c.defines.SRGB_TRANSFER="");const U=X$[A];U&&(c.defines[U]=""),c.needsUpdate=!0}c.uniforms.tDiffuse.value=R.texture,C.setRenderTarget(S),C.render(h,p),S=null,v=!1},this.isCompositing=function(){return v},this.dispose=function(){s.dispose(),a.dispose(),o.dispose(),c.dispose()}}const h6=new Pi,VR=new Qm(1,1),f6=new MM,d6=new tx,p6=new nx,wN=[],MN=[],CN=new Float32Array(16),TN=new Float32Array(9),IN=new Float32Array(4);function fv(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=wN[r];if(s===void 0&&(s=new Float32Array(r),wN[r]=s),e!==0){i.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,n[a].toArray(s,o)}return s}function Ps(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Os(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function JM(n,e){let t=MN[e];t===void 0&&(t=new Int32Array(e),MN[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function K$(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function $$(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ps(t,e))return;n.uniform2fv(this.addr,e),Os(t,e)}}function J$(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ps(t,e))return;n.uniform3fv(this.addr,e),Os(t,e)}}function Z$(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ps(t,e))return;n.uniform4fv(this.addr,e),Os(t,e)}}function eJ(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ps(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Os(t,e)}else{if(Ps(t,i))return;IN.set(i),n.uniformMatrix2fv(this.addr,!1,IN),Os(t,i)}}function tJ(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ps(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Os(t,e)}else{if(Ps(t,i))return;TN.set(i),n.uniformMatrix3fv(this.addr,!1,TN),Os(t,i)}}function nJ(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ps(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Os(t,e)}else{if(Ps(t,i))return;CN.set(i),n.uniformMatrix4fv(this.addr,!1,CN),Os(t,i)}}function iJ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function rJ(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ps(t,e))return;n.uniform2iv(this.addr,e),Os(t,e)}}function sJ(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ps(t,e))return;n.uniform3iv(this.addr,e),Os(t,e)}}function aJ(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ps(t,e))return;n.uniform4iv(this.addr,e),Os(t,e)}}function oJ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function lJ(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ps(t,e))return;n.uniform2uiv(this.addr,e),Os(t,e)}}function cJ(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ps(t,e))return;n.uniform3uiv(this.addr,e),Os(t,e)}}function uJ(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ps(t,e))return;n.uniform4uiv(this.addr,e),Os(t,e)}}function hJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);let s;this.type===n.SAMPLER_2D_SHADOW?(VR.compareFunction=t.isReversedDepthBuffer()?wM:EM,s=VR):s=h6,t.setTexture2D(e||s,r)}function fJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||d6,r)}function dJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||p6,r)}function pJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||f6,r)}function mJ(n){switch(n){case 5126:return K$;case 35664:return $$;case 35665:return J$;case 35666:return Z$;case 35674:return eJ;case 35675:return tJ;case 35676:return nJ;case 5124:case 35670:return iJ;case 35667:case 35671:return rJ;case 35668:case 35672:return sJ;case 35669:case 35673:return aJ;case 5125:return oJ;case 36294:return lJ;case 36295:return cJ;case 36296:return uJ;case 35678:case 36198:case 36298:case 36306:case 35682:return hJ;case 35679:case 36299:case 36307:return fJ;case 35680:case 36300:case 36308:case 36293:return dJ;case 36289:case 36303:case 36311:case 36292:return pJ}}function gJ(n,e){n.uniform1fv(this.addr,e)}function AJ(n,e){const t=fv(e,this.size,2);n.uniform2fv(this.addr,t)}function vJ(n,e){const t=fv(e,this.size,3);n.uniform3fv(this.addr,t)}function yJ(n,e){const t=fv(e,this.size,4);n.uniform4fv(this.addr,t)}function bJ(n,e){const t=fv(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function xJ(n,e){const t=fv(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function _J(n,e){const t=fv(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function SJ(n,e){n.uniform1iv(this.addr,e)}function EJ(n,e){n.uniform2iv(this.addr,e)}function wJ(n,e){n.uniform3iv(this.addr,e)}function MJ(n,e){n.uniform4iv(this.addr,e)}function CJ(n,e){n.uniform1uiv(this.addr,e)}function TJ(n,e){n.uniform2uiv(this.addr,e)}function IJ(n,e){n.uniform3uiv(this.addr,e)}function RJ(n,e){n.uniform4uiv(this.addr,e)}function BJ(n,e,t){const i=this.cache,r=e.length,s=JM(t,r);Ps(i,s)||(n.uniform1iv(this.addr,s),Os(i,s));let a;this.type===n.SAMPLER_2D_SHADOW?a=VR:a=h6;for(let o=0;o!==r;++o)t.setTexture2D(e[o]||a,s[o])}function DJ(n,e,t){const i=this.cache,r=e.length,s=JM(t,r);Ps(i,s)||(n.uniform1iv(this.addr,s),Os(i,s));for(let a=0;a!==r;++a)t.setTexture3D(e[a]||d6,s[a])}function LJ(n,e,t){const i=this.cache,r=e.length,s=JM(t,r);Ps(i,s)||(n.uniform1iv(this.addr,s),Os(i,s));for(let a=0;a!==r;++a)t.setTextureCube(e[a]||p6,s[a])}function NJ(n,e,t){const i=this.cache,r=e.length,s=JM(t,r);Ps(i,s)||(n.uniform1iv(this.addr,s),Os(i,s));for(let a=0;a!==r;++a)t.setTexture2DArray(e[a]||f6,s[a])}function UJ(n){switch(n){case 5126:return gJ;case 35664:return AJ;case 35665:return vJ;case 35666:return yJ;case 35674:return bJ;case 35675:return xJ;case 35676:return _J;case 5124:case 35670:return SJ;case 35667:case 35671:return EJ;case 35668:case 35672:return wJ;case 35669:case 35673:return MJ;case 5125:return CJ;case 36294:return TJ;case 36295:return IJ;case 36296:return RJ;case 35678:case 36198:case 36298:case 36306:case 35682:return BJ;case 35679:case 36299:case 36307:return DJ;case 35680:case 36300:case 36308:case 36293:return LJ;case 36289:case 36303:case 36311:case 36292:return NJ}}class FJ{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=mJ(t.type)}}class PJ{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=UJ(t.type)}}class OJ{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const o=r[s];o.setValue(e,t[o.id],i)}}}const gT=/(\w+)(\])?(\[|\.)?/g;function RN(n,e){n.seq.push(e),n.map[e.id]=e}function kJ(n,e,t){const i=n.name,r=i.length;for(gT.lastIndex=0;;){const s=gT.exec(i),a=gT.lastIndex;let o=s[1];const c=s[2]==="]",h=s[3];if(c&&(o=o|0),h===void 0||h==="["&&a+2===r){RN(t,h===void 0?new FJ(o,n,e):new PJ(o,n,e));break}else{let g=t.map[o];g===void 0&&(g=new OJ(o),RN(t,g)),t=g}}}class jE{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<i;++a){const o=e.getActiveUniform(t,a),c=e.getUniformLocation(t,o.name);kJ(o,c,this)}const r=[],s=[];for(const a of this.seq)a.type===e.SAMPLER_2D_SHADOW||a.type===e.SAMPLER_CUBE_SHADOW||a.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(a):s.push(a);r.length>0&&(this.seq=r.concat(s))}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,a=t.length;s!==a;++s){const o=t[s],c=i[o.id];c.needsUpdate!==!1&&o.setValue(e,c.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in t&&i.push(a)}return i}}function BN(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const zJ=37297;let GJ=0;function HJ(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=r;a<s;a++){const o=a+1;i.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return i.join(`
`)}const DN=new Rn;function QJ(n){Wn._getMatrix(DN,Wn.workingColorSpace,n);const e=`mat3( ${DN.elements.map(t=>t.toFixed(4))} )`;switch(Wn.getTransfer(n)){case Mb:return[e,"LinearTransferOETF"];case Ui:return[e,"sRGBTransferOETF"];default:return Gt("WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function LN(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),s=(n.getShaderInfoLog(e)||"").trim();if(i&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const o=parseInt(a[1]);return t.toUpperCase()+`

`+s+`

`+HJ(n.getShaderSource(e),o)}else return s}function VJ(n,e){const t=QJ(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const jJ={[dM]:"Linear",[pM]:"Reinhard",[mM]:"Cineon",[Kb]:"ACESFilmic",[gM]:"AgX",[Pm]:"Neutral",[Z2]:"Custom"};function WJ(n,e){const t=jJ[e];return t===void 0?(Gt("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+n+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const WS=new ee;function qJ(){Wn.getLuminanceCoefficients(WS);const n=WS.x.toFixed(4),e=WS.y.toFixed(4),t=WS.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function XJ(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(z1).join(`
`)}function YJ(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function KJ(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),a=s.name;let o=1;s.type===n.FLOAT_MAT2&&(o=2),s.type===n.FLOAT_MAT3&&(o=3),s.type===n.FLOAT_MAT4&&(o=4),t[a]={type:s.type,location:n.getAttribLocation(e,a),locationSize:o}}return t}function z1(n){return n!==""}function NN(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function UN(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const $J=/^[ \t]*#include +<([\w\d./]+)>/gm;function jR(n){return n.replace($J,ZJ)}const JJ=new Map;function ZJ(n,e){let t=kn[e];if(t===void 0){const i=JJ.get(e);if(i!==void 0)t=kn[i],Gt('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return jR(t)}const eZ=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function FN(n){return n.replace(eZ,tZ)}function tZ(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function PN(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const nZ={[h0]:"SHADOWMAP_TYPE_PCF",[mm]:"SHADOWMAP_TYPE_VSM"};function iZ(n){return nZ[n.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const rZ={[jc]:"ENVMAP_TYPE_CUBE",[Qd]:"ENVMAP_TYPE_CUBE",[iv]:"ENVMAP_TYPE_CUBE_UV"};function sZ(n){return n.envMap===!1?"ENVMAP_TYPE_CUBE":rZ[n.envMapMode]||"ENVMAP_TYPE_CUBE"}const aZ={[Qd]:"ENVMAP_MODE_REFRACTION"};function oZ(n){return n.envMap===!1?"ENVMAP_MODE_REFLECTION":aZ[n.envMapMode]||"ENVMAP_MODE_REFLECTION"}const lZ={[Yb]:"ENVMAP_BLENDING_MULTIPLY",[r8]:"ENVMAP_BLENDING_MIX",[s8]:"ENVMAP_BLENDING_ADD"};function cZ(n){return n.envMap===!1?"ENVMAP_BLENDING_NONE":lZ[n.combine]||"ENVMAP_BLENDING_NONE"}function uZ(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}function hZ(n,e,t,i){const r=n.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const c=iZ(t),h=sZ(t),p=oZ(t),g=cZ(t),A=uZ(t),v=XJ(t),x=YJ(s),S=r.createProgram();let _,E,C=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(_=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(z1).join(`
`),_.length>0&&(_+=`
`),E=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(z1).join(`
`),E.length>0&&(E+=`
`)):(_=[PN(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(z1).join(`
`),E=[PN(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+p:"",t.envMap?"#define "+g:"",A?"#define CUBEUV_TEXEL_WIDTH "+A.texelWidth:"",A?"#define CUBEUV_TEXEL_HEIGHT "+A.texelHeight:"",A?"#define CUBEUV_MAX_MIP "+A.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ko?"#define TONE_MAPPING":"",t.toneMapping!==ko?kn.tonemapping_pars_fragment:"",t.toneMapping!==ko?WJ("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",kn.colorspace_pars_fragment,VJ("linearToOutputTexel",t.outputColorSpace),qJ(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(z1).join(`
`)),a=jR(a),a=NN(a,t),a=UN(a,t),o=jR(o),o=NN(o,t),o=UN(o,t),a=FN(a),o=FN(o),t.isRawShaderMaterial!==!0&&(C=`#version 300 es
`,_=[v,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+_,E=["#define varying in",t.glslVersion===FR?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===FR?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+E);const T=C+_+a,R=C+E+o,B=BN(r,r.VERTEX_SHADER,T),U=BN(r,r.FRAGMENT_SHADER,R);r.attachShader(S,B),r.attachShader(S,U),t.index0AttributeName!==void 0?r.bindAttribLocation(S,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(S,0,"position"),r.linkProgram(S);function O(W){if(n.debug.checkShaderErrors){const j=r.getProgramInfoLog(S)||"",V=r.getShaderInfoLog(B)||"",q=r.getShaderInfoLog(U)||"",re=j.trim(),Q=V.trim(),K=q.trim();let ce=!0,ue=!0;if(r.getProgramParameter(S,r.LINK_STATUS)===!1)if(ce=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,S,B,U);else{const oe=LN(r,B,"vertex"),z=LN(r,U,"fragment");on("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(S,r.VALIDATE_STATUS)+`

Material Name: `+W.name+`
Material Type: `+W.type+`

Program Info Log: `+re+`
`+oe+`
`+z)}else re!==""?Gt("WebGLProgram: Program Info Log:",re):(Q===""||K==="")&&(ue=!1);ue&&(W.diagnostics={runnable:ce,programLog:re,vertexShader:{log:Q,prefix:_},fragmentShader:{log:K,prefix:E}})}r.deleteShader(B),r.deleteShader(U),F=new jE(r,S),L=KJ(r,S)}let F;this.getUniforms=function(){return F===void 0&&O(this),F};let L;this.getAttributes=function(){return L===void 0&&O(this),L};let P=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return P===!1&&(P=r.getProgramParameter(S,zJ)),P},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(S),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=GJ++,this.cacheKey=e,this.usedTimes=1,this.program=S,this.vertexShader=B,this.fragmentShader=U,this}let fZ=0;class dZ{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new pZ(e),t.set(e,i)),i}}class pZ{constructor(e){this.id=fZ++,this.code=e,this.usedTimes=0}}function mZ(n,e,t,i,r,s,a){const o=new L0,c=new dZ,h=new Set,p=[],g=new Map,A=r.logarithmicDepthBuffer;let v=r.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function S(L){return h.add(L),L===0?"uv":`uv${L}`}function _(L,P,W,j,V){const q=j.fog,re=V.geometry,Q=L.isMeshStandardMaterial?j.environment:null,K=(L.isMeshStandardMaterial?t:e).get(L.envMap||Q),ce=K&&K.mapping===iv?K.image.height:null,ue=x[L.type];L.precision!==null&&(v=r.getMaxPrecision(L.precision),v!==L.precision&&Gt("WebGLProgram.getParameters:",L.precision,"not supported, using",v,"instead."));const oe=re.morphAttributes.position||re.morphAttributes.normal||re.morphAttributes.color,z=oe!==void 0?oe.length:0;let $=0;re.morphAttributes.position!==void 0&&($=1),re.morphAttributes.normal!==void 0&&($=2),re.morphAttributes.color!==void 0&&($=3);let ae,he,me,le;if(ue){const rn=kc[ue];ae=rn.vertexShader,he=rn.fragmentShader}else ae=L.vertexShader,he=L.fragmentShader,c.update(L),me=c.getVertexShaderID(L),le=c.getFragmentShaderID(L);const fe=n.getRenderTarget(),_e=n.state.buffers.depth.getReversed(),Pe=V.isInstancedMesh===!0,et=V.isBatchedMesh===!0,ot=!!L.map,Je=!!L.matcap,_t=!!K,Be=!!L.aoMap,Le=!!L.lightMap,Te=!!L.bumpMap,Ye=!!L.normalMap,ne=!!L.displacementMap,ft=!!L.emissiveMap,qe=!!L.metalnessMap,Ne=!!L.roughnessMap,tt=L.anisotropy>0,Z=L.clearcoat>0,H=L.dispersion>0,de=L.iridescence>0,De=L.sheen>0,Ie=L.transmission>0,we=tt&&!!L.anisotropyMap,st=Z&&!!L.clearcoatMap,it=Z&&!!L.clearcoatNormalMap,It=Z&&!!L.clearcoatRoughnessMap,Ot=de&&!!L.iridescenceMap,Qe=de&&!!L.iridescenceThicknessMap,Ve=De&&!!L.sheenColorMap,at=De&&!!L.sheenRoughnessMap,bt=!!L.specularMap,ht=!!L.specularColorMap,Vt=!!L.specularIntensityMap,ve=Ie&&!!L.transmissionMap,Me=Ie&&!!L.thicknessMap,rt=!!L.gradientMap,Ut=!!L.alphaMap,nt=L.alphaTest>0,ke=!!L.alphaHash,gt=!!L.extensions;let Qt=ko;L.toneMapped&&(fe===null||fe.isXRRenderTarget===!0)&&(Qt=n.toneMapping);const kt={shaderID:ue,shaderType:L.type,shaderName:L.name,vertexShader:ae,fragmentShader:he,defines:L.defines,customVertexShaderID:me,customFragmentShaderID:le,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:v,batching:et,batchingColor:et&&V._colorsTexture!==null,instancing:Pe,instancingColor:Pe&&V.instanceColor!==null,instancingMorph:Pe&&V.morphTexture!==null,outputColorSpace:fe===null?n.outputColorSpace:fe.isXRRenderTarget===!0?fe.texture.colorSpace:Xi,alphaToCoverage:!!L.alphaToCoverage,map:ot,matcap:Je,envMap:_t,envMapMode:_t&&K.mapping,envMapCubeUVHeight:ce,aoMap:Be,lightMap:Le,bumpMap:Te,normalMap:Ye,displacementMap:ne,emissiveMap:ft,normalMapObjectSpace:Ye&&L.normalMapType===u8,normalMapTangentSpace:Ye&&L.normalMapType===$d,metalnessMap:qe,roughnessMap:Ne,anisotropy:tt,anisotropyMap:we,clearcoat:Z,clearcoatMap:st,clearcoatNormalMap:it,clearcoatRoughnessMap:It,dispersion:H,iridescence:de,iridescenceMap:Ot,iridescenceThicknessMap:Qe,sheen:De,sheenColorMap:Ve,sheenRoughnessMap:at,specularMap:bt,specularColorMap:ht,specularIntensityMap:Vt,transmission:Ie,transmissionMap:ve,thicknessMap:Me,gradientMap:rt,opaque:L.transparent===!1&&L.blending===Em&&L.alphaToCoverage===!1,alphaMap:Ut,alphaTest:nt,alphaHash:ke,combine:L.combine,mapUv:ot&&S(L.map.channel),aoMapUv:Be&&S(L.aoMap.channel),lightMapUv:Le&&S(L.lightMap.channel),bumpMapUv:Te&&S(L.bumpMap.channel),normalMapUv:Ye&&S(L.normalMap.channel),displacementMapUv:ne&&S(L.displacementMap.channel),emissiveMapUv:ft&&S(L.emissiveMap.channel),metalnessMapUv:qe&&S(L.metalnessMap.channel),roughnessMapUv:Ne&&S(L.roughnessMap.channel),anisotropyMapUv:we&&S(L.anisotropyMap.channel),clearcoatMapUv:st&&S(L.clearcoatMap.channel),clearcoatNormalMapUv:it&&S(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:It&&S(L.clearcoatRoughnessMap.channel),iridescenceMapUv:Ot&&S(L.iridescenceMap.channel),iridescenceThicknessMapUv:Qe&&S(L.iridescenceThicknessMap.channel),sheenColorMapUv:Ve&&S(L.sheenColorMap.channel),sheenRoughnessMapUv:at&&S(L.sheenRoughnessMap.channel),specularMapUv:bt&&S(L.specularMap.channel),specularColorMapUv:ht&&S(L.specularColorMap.channel),specularIntensityMapUv:Vt&&S(L.specularIntensityMap.channel),transmissionMapUv:ve&&S(L.transmissionMap.channel),thicknessMapUv:Me&&S(L.thicknessMap.channel),alphaMapUv:Ut&&S(L.alphaMap.channel),vertexTangents:!!re.attributes.tangent&&(Ye||tt),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!re.attributes.color&&re.attributes.color.itemSize===4,pointsUvs:V.isPoints===!0&&!!re.attributes.uv&&(ot||Ut),fog:!!q,useFog:L.fog===!0,fogExp2:!!q&&q.isFogExp2,flatShading:L.flatShading===!0&&L.wireframe===!1,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:A,reversedDepthBuffer:_e,skinning:V.isSkinnedMesh===!0,morphTargets:re.morphAttributes.position!==void 0,morphNormals:re.morphAttributes.normal!==void 0,morphColors:re.morphAttributes.color!==void 0,morphTargetsCount:z,morphTextureStride:$,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numLightProbes:P.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:L.dithering,shadowMapEnabled:n.shadowMap.enabled&&W.length>0,shadowMapType:n.shadowMap.type,toneMapping:Qt,decodeVideoTexture:ot&&L.map.isVideoTexture===!0&&Wn.getTransfer(L.map.colorSpace)===Ui,decodeVideoTextureEmissive:ft&&L.emissiveMap.isVideoTexture===!0&&Wn.getTransfer(L.emissiveMap.colorSpace)===Ui,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===gi,flipSided:L.side===ia,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:gt&&L.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(gt&&L.extensions.multiDraw===!0||et)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return kt.vertexUv1s=h.has(1),kt.vertexUv2s=h.has(2),kt.vertexUv3s=h.has(3),h.clear(),kt}function E(L){const P=[];if(L.shaderID?P.push(L.shaderID):(P.push(L.customVertexShaderID),P.push(L.customFragmentShaderID)),L.defines!==void 0)for(const W in L.defines)P.push(W),P.push(L.defines[W]);return L.isRawShaderMaterial===!1&&(C(P,L),T(P,L),P.push(n.outputColorSpace)),P.push(L.customProgramCacheKey),P.join()}function C(L,P){L.push(P.precision),L.push(P.outputColorSpace),L.push(P.envMapMode),L.push(P.envMapCubeUVHeight),L.push(P.mapUv),L.push(P.alphaMapUv),L.push(P.lightMapUv),L.push(P.aoMapUv),L.push(P.bumpMapUv),L.push(P.normalMapUv),L.push(P.displacementMapUv),L.push(P.emissiveMapUv),L.push(P.metalnessMapUv),L.push(P.roughnessMapUv),L.push(P.anisotropyMapUv),L.push(P.clearcoatMapUv),L.push(P.clearcoatNormalMapUv),L.push(P.clearcoatRoughnessMapUv),L.push(P.iridescenceMapUv),L.push(P.iridescenceThicknessMapUv),L.push(P.sheenColorMapUv),L.push(P.sheenRoughnessMapUv),L.push(P.specularMapUv),L.push(P.specularColorMapUv),L.push(P.specularIntensityMapUv),L.push(P.transmissionMapUv),L.push(P.thicknessMapUv),L.push(P.combine),L.push(P.fogExp2),L.push(P.sizeAttenuation),L.push(P.morphTargetsCount),L.push(P.morphAttributeCount),L.push(P.numDirLights),L.push(P.numPointLights),L.push(P.numSpotLights),L.push(P.numSpotLightMaps),L.push(P.numHemiLights),L.push(P.numRectAreaLights),L.push(P.numDirLightShadows),L.push(P.numPointLightShadows),L.push(P.numSpotLightShadows),L.push(P.numSpotLightShadowsWithMaps),L.push(P.numLightProbes),L.push(P.shadowMapType),L.push(P.toneMapping),L.push(P.numClippingPlanes),L.push(P.numClipIntersection),L.push(P.depthPacking)}function T(L,P){o.disableAll(),P.instancing&&o.enable(0),P.instancingColor&&o.enable(1),P.instancingMorph&&o.enable(2),P.matcap&&o.enable(3),P.envMap&&o.enable(4),P.normalMapObjectSpace&&o.enable(5),P.normalMapTangentSpace&&o.enable(6),P.clearcoat&&o.enable(7),P.iridescence&&o.enable(8),P.alphaTest&&o.enable(9),P.vertexColors&&o.enable(10),P.vertexAlphas&&o.enable(11),P.vertexUv1s&&o.enable(12),P.vertexUv2s&&o.enable(13),P.vertexUv3s&&o.enable(14),P.vertexTangents&&o.enable(15),P.anisotropy&&o.enable(16),P.alphaHash&&o.enable(17),P.batching&&o.enable(18),P.dispersion&&o.enable(19),P.batchingColor&&o.enable(20),P.gradientMap&&o.enable(21),L.push(o.mask),o.disableAll(),P.fog&&o.enable(0),P.useFog&&o.enable(1),P.flatShading&&o.enable(2),P.logarithmicDepthBuffer&&o.enable(3),P.reversedDepthBuffer&&o.enable(4),P.skinning&&o.enable(5),P.morphTargets&&o.enable(6),P.morphNormals&&o.enable(7),P.morphColors&&o.enable(8),P.premultipliedAlpha&&o.enable(9),P.shadowMapEnabled&&o.enable(10),P.doubleSided&&o.enable(11),P.flipSided&&o.enable(12),P.useDepthPacking&&o.enable(13),P.dithering&&o.enable(14),P.transmission&&o.enable(15),P.sheen&&o.enable(16),P.opaque&&o.enable(17),P.pointsUvs&&o.enable(18),P.decodeVideoTexture&&o.enable(19),P.decodeVideoTextureEmissive&&o.enable(20),P.alphaToCoverage&&o.enable(21),L.push(o.mask)}function R(L){const P=x[L.type];let W;if(P){const j=kc[P];W=l4.clone(j.uniforms)}else W=L.uniforms;return W}function B(L,P){let W=g.get(P);return W!==void 0?++W.usedTimes:(W=new hZ(n,P,L,s),p.push(W),g.set(P,W)),W}function U(L){if(--L.usedTimes===0){const P=p.indexOf(L);p[P]=p[p.length-1],p.pop(),g.delete(L.cacheKey),L.destroy()}}function O(L){c.remove(L)}function F(){c.dispose()}return{getParameters:_,getProgramCacheKey:E,getUniforms:R,acquireProgram:B,releaseProgram:U,releaseShaderCache:O,programs:p,dispose:F}}function gZ(){let n=new WeakMap;function e(a){return n.has(a)}function t(a){let o=n.get(a);return o===void 0&&(o={},n.set(a,o)),o}function i(a){n.delete(a)}function r(a,o,c){n.get(a)[o]=c}function s(){n=new WeakMap}return{has:e,get:t,remove:i,update:r,dispose:s}}function AZ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function ON(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function kN(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function a(g,A,v,x,S,_){let E=n[e];return E===void 0?(E={id:g.id,object:g,geometry:A,material:v,groupOrder:x,renderOrder:g.renderOrder,z:S,group:_},n[e]=E):(E.id=g.id,E.object=g,E.geometry=A,E.material=v,E.groupOrder=x,E.renderOrder=g.renderOrder,E.z=S,E.group=_),e++,E}function o(g,A,v,x,S,_){const E=a(g,A,v,x,S,_);v.transmission>0?i.push(E):v.transparent===!0?r.push(E):t.push(E)}function c(g,A,v,x,S,_){const E=a(g,A,v,x,S,_);v.transmission>0?i.unshift(E):v.transparent===!0?r.unshift(E):t.unshift(E)}function h(g,A){t.length>1&&t.sort(g||AZ),i.length>1&&i.sort(A||ON),r.length>1&&r.sort(A||ON)}function p(){for(let g=e,A=n.length;g<A;g++){const v=n[g];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:o,unshift:c,finish:p,sort:h}}function vZ(){let n=new WeakMap;function e(i,r){const s=n.get(i);let a;return s===void 0?(a=new kN,n.set(i,[a])):r>=s.length?(a=new kN,s.push(a)):a=s[r],a}function t(){n=new WeakMap}return{get:e,dispose:t}}function yZ(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ee,color:new Mt};break;case"SpotLight":t={position:new ee,direction:new ee,color:new Mt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ee,color:new Mt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ee,skyColor:new Mt,groundColor:new Mt};break;case"RectAreaLight":t={color:new Mt,position:new ee,halfWidth:new ee,halfHeight:new ee};break}return n[e.id]=t,t}}}function bZ(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ze};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ze};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ze,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let xZ=0;function _Z(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function SZ(n){const e=new yZ,t=bZ(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)i.probe.push(new ee);const r=new ee,s=new qt,a=new qt;function o(h){let p=0,g=0,A=0;for(let L=0;L<9;L++)i.probe[L].set(0,0,0);let v=0,x=0,S=0,_=0,E=0,C=0,T=0,R=0,B=0,U=0,O=0;h.sort(_Z);for(let L=0,P=h.length;L<P;L++){const W=h[L],j=W.color,V=W.intensity,q=W.distance;let re=null;if(W.shadow&&W.shadow.map&&(W.shadow.map.texture.format===ac?re=W.shadow.map.texture:re=W.shadow.map.depthTexture||W.shadow.map.texture),W.isAmbientLight)p+=j.r*V,g+=j.g*V,A+=j.b*V;else if(W.isLightProbe){for(let Q=0;Q<9;Q++)i.probe[Q].addScaledVector(W.sh.coefficients[Q],V);O++}else if(W.isDirectionalLight){const Q=e.get(W);if(Q.color.copy(W.color).multiplyScalar(W.intensity),W.castShadow){const K=W.shadow,ce=t.get(W);ce.shadowIntensity=K.intensity,ce.shadowBias=K.bias,ce.shadowNormalBias=K.normalBias,ce.shadowRadius=K.radius,ce.shadowMapSize=K.mapSize,i.directionalShadow[v]=ce,i.directionalShadowMap[v]=re,i.directionalShadowMatrix[v]=W.shadow.matrix,C++}i.directional[v]=Q,v++}else if(W.isSpotLight){const Q=e.get(W);Q.position.setFromMatrixPosition(W.matrixWorld),Q.color.copy(j).multiplyScalar(V),Q.distance=q,Q.coneCos=Math.cos(W.angle),Q.penumbraCos=Math.cos(W.angle*(1-W.penumbra)),Q.decay=W.decay,i.spot[S]=Q;const K=W.shadow;if(W.map&&(i.spotLightMap[B]=W.map,B++,K.updateMatrices(W),W.castShadow&&U++),i.spotLightMatrix[S]=K.matrix,W.castShadow){const ce=t.get(W);ce.shadowIntensity=K.intensity,ce.shadowBias=K.bias,ce.shadowNormalBias=K.normalBias,ce.shadowRadius=K.radius,ce.shadowMapSize=K.mapSize,i.spotShadow[S]=ce,i.spotShadowMap[S]=re,R++}S++}else if(W.isRectAreaLight){const Q=e.get(W);Q.color.copy(j).multiplyScalar(V),Q.halfWidth.set(W.width*.5,0,0),Q.halfHeight.set(0,W.height*.5,0),i.rectArea[_]=Q,_++}else if(W.isPointLight){const Q=e.get(W);if(Q.color.copy(W.color).multiplyScalar(W.intensity),Q.distance=W.distance,Q.decay=W.decay,W.castShadow){const K=W.shadow,ce=t.get(W);ce.shadowIntensity=K.intensity,ce.shadowBias=K.bias,ce.shadowNormalBias=K.normalBias,ce.shadowRadius=K.radius,ce.shadowMapSize=K.mapSize,ce.shadowCameraNear=K.camera.near,ce.shadowCameraFar=K.camera.far,i.pointShadow[x]=ce,i.pointShadowMap[x]=re,i.pointShadowMatrix[x]=W.shadow.matrix,T++}i.point[x]=Q,x++}else if(W.isHemisphereLight){const Q=e.get(W);Q.skyColor.copy(W.color).multiplyScalar(V),Q.groundColor.copy(W.groundColor).multiplyScalar(V),i.hemi[E]=Q,E++}}_>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Ht.LTC_FLOAT_1,i.rectAreaLTC2=Ht.LTC_FLOAT_2):(i.rectAreaLTC1=Ht.LTC_HALF_1,i.rectAreaLTC2=Ht.LTC_HALF_2)),i.ambient[0]=p,i.ambient[1]=g,i.ambient[2]=A;const F=i.hash;(F.directionalLength!==v||F.pointLength!==x||F.spotLength!==S||F.rectAreaLength!==_||F.hemiLength!==E||F.numDirectionalShadows!==C||F.numPointShadows!==T||F.numSpotShadows!==R||F.numSpotMaps!==B||F.numLightProbes!==O)&&(i.directional.length=v,i.spot.length=S,i.rectArea.length=_,i.point.length=x,i.hemi.length=E,i.directionalShadow.length=C,i.directionalShadowMap.length=C,i.pointShadow.length=T,i.pointShadowMap.length=T,i.spotShadow.length=R,i.spotShadowMap.length=R,i.directionalShadowMatrix.length=C,i.pointShadowMatrix.length=T,i.spotLightMatrix.length=R+B-U,i.spotLightMap.length=B,i.numSpotLightShadowsWithMaps=U,i.numLightProbes=O,F.directionalLength=v,F.pointLength=x,F.spotLength=S,F.rectAreaLength=_,F.hemiLength=E,F.numDirectionalShadows=C,F.numPointShadows=T,F.numSpotShadows=R,F.numSpotMaps=B,F.numLightProbes=O,i.version=xZ++)}function c(h,p){let g=0,A=0,v=0,x=0,S=0;const _=p.matrixWorldInverse;for(let E=0,C=h.length;E<C;E++){const T=h[E];if(T.isDirectionalLight){const R=i.directional[g];R.direction.setFromMatrixPosition(T.matrixWorld),r.setFromMatrixPosition(T.target.matrixWorld),R.direction.sub(r),R.direction.transformDirection(_),g++}else if(T.isSpotLight){const R=i.spot[v];R.position.setFromMatrixPosition(T.matrixWorld),R.position.applyMatrix4(_),R.direction.setFromMatrixPosition(T.matrixWorld),r.setFromMatrixPosition(T.target.matrixWorld),R.direction.sub(r),R.direction.transformDirection(_),v++}else if(T.isRectAreaLight){const R=i.rectArea[x];R.position.setFromMatrixPosition(T.matrixWorld),R.position.applyMatrix4(_),a.identity(),s.copy(T.matrixWorld),s.premultiply(_),a.extractRotation(s),R.halfWidth.set(T.width*.5,0,0),R.halfHeight.set(0,T.height*.5,0),R.halfWidth.applyMatrix4(a),R.halfHeight.applyMatrix4(a),x++}else if(T.isPointLight){const R=i.point[A];R.position.setFromMatrixPosition(T.matrixWorld),R.position.applyMatrix4(_),A++}else if(T.isHemisphereLight){const R=i.hemi[S];R.direction.setFromMatrixPosition(T.matrixWorld),R.direction.transformDirection(_),S++}}}return{setup:o,setupView:c,state:i}}function zN(n){const e=new SZ(n),t=[],i=[];function r(p){h.camera=p,t.length=0,i.length=0}function s(p){t.push(p)}function a(p){i.push(p)}function o(){e.setup(t)}function c(p){e.setupView(t,p)}const h={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:h,setupLights:o,setupLightsView:c,pushLight:s,pushShadow:a}}function EZ(n){let e=new WeakMap;function t(r,s=0){const a=e.get(r);let o;return a===void 0?(o=new zN(n),e.set(r,[o])):s>=a.length?(o=new zN(n),a.push(o)):o=a[s],o}function i(){e=new WeakMap}return{get:t,dispose:i}}const wZ=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,MZ=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,CZ=[new ee(1,0,0),new ee(-1,0,0),new ee(0,1,0),new ee(0,-1,0),new ee(0,0,1),new ee(0,0,-1)],TZ=[new ee(0,-1,0),new ee(0,-1,0),new ee(0,0,1),new ee(0,0,-1),new ee(0,-1,0),new ee(0,-1,0)],GN=new qt,l1=new ee,AT=new ee;function IZ(n,e,t){let i=new av;const r=new Ze,s=new Ze,a=new Ii,o=new sx,c=new jM,h={},p=t.maxTextureSize,g={[cc]:ia,[ia]:cc,[gi]:gi},A=new Fs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ze},radius:{value:4}},vertexShader:wZ,fragmentShader:MZ}),v=A.clone();v.defines.HORIZONTAL_PASS=1;const x=new vn;x.setAttribute("position",new An(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const S=new Wt(x,A),_=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=h0;let E=this.type;this.render=function(U,O,F){if(_.enabled===!1||_.autoUpdate===!1&&_.needsUpdate===!1||U.length===0)return;U.type===J1&&(Gt("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),U.type=h0);const L=n.getRenderTarget(),P=n.getActiveCubeFace(),W=n.getActiveMipmapLevel(),j=n.state;j.setBlending(lc),j.buffers.depth.getReversed()===!0?j.buffers.color.setClear(0,0,0,0):j.buffers.color.setClear(1,1,1,1),j.buffers.depth.setTest(!0),j.setScissorTest(!1);const V=E!==this.type;V&&O.traverse(function(q){q.material&&(Array.isArray(q.material)?q.material.forEach(re=>re.needsUpdate=!0):q.material.needsUpdate=!0)});for(let q=0,re=U.length;q<re;q++){const Q=U[q],K=Q.shadow;if(K===void 0){Gt("WebGLShadowMap:",Q,"has no shadow.");continue}if(K.autoUpdate===!1&&K.needsUpdate===!1)continue;r.copy(K.mapSize);const ce=K.getFrameExtents();if(r.multiply(ce),s.copy(K.mapSize),(r.x>p||r.y>p)&&(r.x>p&&(s.x=Math.floor(p/ce.x),r.x=s.x*ce.x,K.mapSize.x=s.x),r.y>p&&(s.y=Math.floor(p/ce.y),r.y=s.y*ce.y,K.mapSize.y=s.y)),K.map===null||V===!0){if(K.map!==null&&(K.map.depthTexture!==null&&(K.map.depthTexture.dispose(),K.map.depthTexture=null),K.map.dispose()),this.type===mm){if(Q.isPointLight){Gt("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}K.map=new Vr(r.x,r.y,{format:ac,type:ci,minFilter:mn,magFilter:mn,generateMipmaps:!1}),K.map.texture.name=Q.name+".shadowMap",K.map.depthTexture=new Qm(r.x,r.y,Si),K.map.depthTexture.name=Q.name+".shadowMapDepth",K.map.depthTexture.format=Zu,K.map.depthTexture.compareFunction=null,K.map.depthTexture.minFilter=Ri,K.map.depthTexture.magFilter=Ri}else{Q.isPointLight?(K.map=new rv(r.x),K.map.depthTexture=new T8(r.x,fl)):(K.map=new Vr(r.x,r.y),K.map.depthTexture=new Qm(r.x,r.y,fl)),K.map.depthTexture.name=Q.name+".shadowMap",K.map.depthTexture.format=Zu;const oe=n.state.buffers.depth.getReversed();this.type===h0?(K.map.depthTexture.compareFunction=oe?wM:EM,K.map.depthTexture.minFilter=mn,K.map.depthTexture.magFilter=mn):(K.map.depthTexture.compareFunction=null,K.map.depthTexture.minFilter=Ri,K.map.depthTexture.magFilter=Ri)}K.camera.updateProjectionMatrix()}const ue=K.map.isWebGLCubeRenderTarget?6:1;for(let oe=0;oe<ue;oe++){if(K.map.isWebGLCubeRenderTarget)n.setRenderTarget(K.map,oe),n.clear();else{oe===0&&(n.setRenderTarget(K.map),n.clear());const z=K.getViewport(oe);a.set(s.x*z.x,s.y*z.y,s.x*z.z,s.y*z.w),j.viewport(a)}if(Q.isPointLight){const z=K.camera,$=K.matrix,ae=Q.distance||z.far;ae!==z.far&&(z.far=ae,z.updateProjectionMatrix()),l1.setFromMatrixPosition(Q.matrixWorld),z.position.copy(l1),AT.copy(z.position),AT.add(CZ[oe]),z.up.copy(TZ[oe]),z.lookAt(AT),z.updateMatrixWorld(),$.makeTranslation(-l1.x,-l1.y,-l1.z),GN.multiplyMatrices(z.projectionMatrix,z.matrixWorldInverse),K._frustum.setFromProjectionMatrix(GN,z.coordinateSystem,z.reversedDepth)}else K.updateMatrices(Q);i=K.getFrustum(),R(O,F,K.camera,Q,this.type)}K.isPointLightShadow!==!0&&this.type===mm&&C(K,F),K.needsUpdate=!1}E=this.type,_.needsUpdate=!1,n.setRenderTarget(L,P,W)};function C(U,O){const F=e.update(S);A.defines.VSM_SAMPLES!==U.blurSamples&&(A.defines.VSM_SAMPLES=U.blurSamples,v.defines.VSM_SAMPLES=U.blurSamples,A.needsUpdate=!0,v.needsUpdate=!0),U.mapPass===null&&(U.mapPass=new Vr(r.x,r.y,{format:ac,type:ci})),A.uniforms.shadow_pass.value=U.map.depthTexture,A.uniforms.resolution.value=U.mapSize,A.uniforms.radius.value=U.radius,n.setRenderTarget(U.mapPass),n.clear(),n.renderBufferDirect(O,null,F,A,S,null),v.uniforms.shadow_pass.value=U.mapPass.texture,v.uniforms.resolution.value=U.mapSize,v.uniforms.radius.value=U.radius,n.setRenderTarget(U.map),n.clear(),n.renderBufferDirect(O,null,F,v,S,null)}function T(U,O,F,L){let P=null;const W=F.isPointLight===!0?U.customDistanceMaterial:U.customDepthMaterial;if(W!==void 0)P=W;else if(P=F.isPointLight===!0?c:o,n.localClippingEnabled&&O.clipShadows===!0&&Array.isArray(O.clippingPlanes)&&O.clippingPlanes.length!==0||O.displacementMap&&O.displacementScale!==0||O.alphaMap&&O.alphaTest>0||O.map&&O.alphaTest>0||O.alphaToCoverage===!0){const j=P.uuid,V=O.uuid;let q=h[j];q===void 0&&(q={},h[j]=q);let re=q[V];re===void 0&&(re=P.clone(),q[V]=re,O.addEventListener("dispose",B)),P=re}if(P.visible=O.visible,P.wireframe=O.wireframe,L===mm?P.side=O.shadowSide!==null?O.shadowSide:O.side:P.side=O.shadowSide!==null?O.shadowSide:g[O.side],P.alphaMap=O.alphaMap,P.alphaTest=O.alphaToCoverage===!0?.5:O.alphaTest,P.map=O.map,P.clipShadows=O.clipShadows,P.clippingPlanes=O.clippingPlanes,P.clipIntersection=O.clipIntersection,P.displacementMap=O.displacementMap,P.displacementScale=O.displacementScale,P.displacementBias=O.displacementBias,P.wireframeLinewidth=O.wireframeLinewidth,P.linewidth=O.linewidth,F.isPointLight===!0&&P.isMeshDistanceMaterial===!0){const j=n.properties.get(P);j.light=F}return P}function R(U,O,F,L,P){if(U.visible===!1)return;if(U.layers.test(O.layers)&&(U.isMesh||U.isLine||U.isPoints)&&(U.castShadow||U.receiveShadow&&P===mm)&&(!U.frustumCulled||i.intersectsObject(U))){U.modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,U.matrixWorld);const V=e.update(U),q=U.material;if(Array.isArray(q)){const re=V.groups;for(let Q=0,K=re.length;Q<K;Q++){const ce=re[Q],ue=q[ce.materialIndex];if(ue&&ue.visible){const oe=T(U,ue,L,P);U.onBeforeShadow(n,U,O,F,V,oe,ce),n.renderBufferDirect(F,null,V,oe,U,ce),U.onAfterShadow(n,U,O,F,V,oe,ce)}}}else if(q.visible){const re=T(U,q,L,P);U.onBeforeShadow(n,U,O,F,V,re,null),n.renderBufferDirect(F,null,V,re,U,null),U.onAfterShadow(n,U,O,F,V,re,null)}}const j=U.children;for(let V=0,q=j.length;V<q;V++)R(j[V],O,F,L,P)}function B(U){U.target.removeEventListener("dispose",B);for(const F in h){const L=h[F],P=U.target.uuid;P in L&&(L[P].dispose(),delete L[P])}}}const RZ={[cw]:uw,[hw]:pw,[fw]:mw,[Fm]:dw,[uw]:cw,[pw]:hw,[mw]:fw,[dw]:Fm};function BZ(n,e){function t(){let ve=!1;const Me=new Ii;let rt=null;const Ut=new Ii(0,0,0,0);return{setMask:function(nt){rt!==nt&&!ve&&(n.colorMask(nt,nt,nt,nt),rt=nt)},setLocked:function(nt){ve=nt},setClear:function(nt,ke,gt,Qt,kt){kt===!0&&(nt*=Qt,ke*=Qt,gt*=Qt),Me.set(nt,ke,gt,Qt),Ut.equals(Me)===!1&&(n.clearColor(nt,ke,gt,Qt),Ut.copy(Me))},reset:function(){ve=!1,rt=null,Ut.set(-1,0,0,0)}}}function i(){let ve=!1,Me=!1,rt=null,Ut=null,nt=null;return{setReversed:function(ke){if(Me!==ke){const gt=e.get("EXT_clip_control");ke?gt.clipControlEXT(gt.LOWER_LEFT_EXT,gt.ZERO_TO_ONE_EXT):gt.clipControlEXT(gt.LOWER_LEFT_EXT,gt.NEGATIVE_ONE_TO_ONE_EXT),Me=ke;const Qt=nt;nt=null,this.setClear(Qt)}},getReversed:function(){return Me},setTest:function(ke){ke?fe(n.DEPTH_TEST):_e(n.DEPTH_TEST)},setMask:function(ke){rt!==ke&&!ve&&(n.depthMask(ke),rt=ke)},setFunc:function(ke){if(Me&&(ke=RZ[ke]),Ut!==ke){switch(ke){case cw:n.depthFunc(n.NEVER);break;case uw:n.depthFunc(n.ALWAYS);break;case hw:n.depthFunc(n.LESS);break;case Fm:n.depthFunc(n.LEQUAL);break;case fw:n.depthFunc(n.EQUAL);break;case dw:n.depthFunc(n.GEQUAL);break;case pw:n.depthFunc(n.GREATER);break;case mw:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Ut=ke}},setLocked:function(ke){ve=ke},setClear:function(ke){nt!==ke&&(Me&&(ke=1-ke),n.clearDepth(ke),nt=ke)},reset:function(){ve=!1,rt=null,Ut=null,nt=null,Me=!1}}}function r(){let ve=!1,Me=null,rt=null,Ut=null,nt=null,ke=null,gt=null,Qt=null,kt=null;return{setTest:function(rn){ve||(rn?fe(n.STENCIL_TEST):_e(n.STENCIL_TEST))},setMask:function(rn){Me!==rn&&!ve&&(n.stencilMask(rn),Me=rn)},setFunc:function(rn,ti,ui){(rt!==rn||Ut!==ti||nt!==ui)&&(n.stencilFunc(rn,ti,ui),rt=rn,Ut=ti,nt=ui)},setOp:function(rn,ti,ui){(ke!==rn||gt!==ti||Qt!==ui)&&(n.stencilOp(rn,ti,ui),ke=rn,gt=ti,Qt=ui)},setLocked:function(rn){ve=rn},setClear:function(rn){kt!==rn&&(n.clearStencil(rn),kt=rn)},reset:function(){ve=!1,Me=null,rt=null,Ut=null,nt=null,ke=null,gt=null,Qt=null,kt=null}}}const s=new t,a=new i,o=new r,c=new WeakMap,h=new WeakMap;let p={},g={},A=new WeakMap,v=[],x=null,S=!1,_=null,E=null,C=null,T=null,R=null,B=null,U=null,O=new Mt(0,0,0),F=0,L=!1,P=null,W=null,j=null,V=null,q=null;const re=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Q=!1,K=0;const ce=n.getParameter(n.VERSION);ce.indexOf("WebGL")!==-1?(K=parseFloat(/^WebGL (\d)/.exec(ce)[1]),Q=K>=1):ce.indexOf("OpenGL ES")!==-1&&(K=parseFloat(/^OpenGL ES (\d)/.exec(ce)[1]),Q=K>=2);let ue=null,oe={};const z=n.getParameter(n.SCISSOR_BOX),$=n.getParameter(n.VIEWPORT),ae=new Ii().fromArray(z),he=new Ii().fromArray($);function me(ve,Me,rt,Ut){const nt=new Uint8Array(4),ke=n.createTexture();n.bindTexture(ve,ke),n.texParameteri(ve,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ve,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let gt=0;gt<rt;gt++)ve===n.TEXTURE_3D||ve===n.TEXTURE_2D_ARRAY?n.texImage3D(Me,0,n.RGBA,1,1,Ut,0,n.RGBA,n.UNSIGNED_BYTE,nt):n.texImage2D(Me+gt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,nt);return ke}const le={};le[n.TEXTURE_2D]=me(n.TEXTURE_2D,n.TEXTURE_2D,1),le[n.TEXTURE_CUBE_MAP]=me(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),le[n.TEXTURE_2D_ARRAY]=me(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),le[n.TEXTURE_3D]=me(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),fe(n.DEPTH_TEST),a.setFunc(Fm),Te(!1),Ye(IR),fe(n.CULL_FACE),Be(lc);function fe(ve){p[ve]!==!0&&(n.enable(ve),p[ve]=!0)}function _e(ve){p[ve]!==!1&&(n.disable(ve),p[ve]=!1)}function Pe(ve,Me){return g[ve]!==Me?(n.bindFramebuffer(ve,Me),g[ve]=Me,ve===n.DRAW_FRAMEBUFFER&&(g[n.FRAMEBUFFER]=Me),ve===n.FRAMEBUFFER&&(g[n.DRAW_FRAMEBUFFER]=Me),!0):!1}function et(ve,Me){let rt=v,Ut=!1;if(ve){rt=A.get(Me),rt===void 0&&(rt=[],A.set(Me,rt));const nt=ve.textures;if(rt.length!==nt.length||rt[0]!==n.COLOR_ATTACHMENT0){for(let ke=0,gt=nt.length;ke<gt;ke++)rt[ke]=n.COLOR_ATTACHMENT0+ke;rt.length=nt.length,Ut=!0}}else rt[0]!==n.BACK&&(rt[0]=n.BACK,Ut=!0);Ut&&n.drawBuffers(rt)}function ot(ve){return x!==ve?(n.useProgram(ve),x=ve,!0):!1}const Je={[Md]:n.FUNC_ADD,[Gk]:n.FUNC_SUBTRACT,[Hk]:n.FUNC_REVERSE_SUBTRACT};Je[Qk]=n.MIN,Je[Vk]=n.MAX;const _t={[jk]:n.ZERO,[Wk]:n.ONE,[qk]:n.SRC_COLOR,[ow]:n.SRC_ALPHA,[Zk]:n.SRC_ALPHA_SATURATE,[$k]:n.DST_COLOR,[Yk]:n.DST_ALPHA,[Xk]:n.ONE_MINUS_SRC_COLOR,[lw]:n.ONE_MINUS_SRC_ALPHA,[Jk]:n.ONE_MINUS_DST_COLOR,[Kk]:n.ONE_MINUS_DST_ALPHA,[e8]:n.CONSTANT_COLOR,[t8]:n.ONE_MINUS_CONSTANT_COLOR,[n8]:n.CONSTANT_ALPHA,[i8]:n.ONE_MINUS_CONSTANT_ALPHA};function Be(ve,Me,rt,Ut,nt,ke,gt,Qt,kt,rn){if(ve===lc){S===!0&&(_e(n.BLEND),S=!1);return}if(S===!1&&(fe(n.BLEND),S=!0),ve!==zk){if(ve!==_||rn!==L){if((E!==Md||R!==Md)&&(n.blendEquation(n.FUNC_ADD),E=Md,R=Md),rn)switch(ve){case Em:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case RR:n.blendFunc(n.ONE,n.ONE);break;case BR:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case DR:n.blendFuncSeparate(n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ZERO,n.ONE);break;default:on("WebGLState: Invalid blending: ",ve);break}else switch(ve){case Em:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case RR:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE,n.ONE,n.ONE);break;case BR:on("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case DR:on("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:on("WebGLState: Invalid blending: ",ve);break}C=null,T=null,B=null,U=null,O.set(0,0,0),F=0,_=ve,L=rn}return}nt=nt||Me,ke=ke||rt,gt=gt||Ut,(Me!==E||nt!==R)&&(n.blendEquationSeparate(Je[Me],Je[nt]),E=Me,R=nt),(rt!==C||Ut!==T||ke!==B||gt!==U)&&(n.blendFuncSeparate(_t[rt],_t[Ut],_t[ke],_t[gt]),C=rt,T=Ut,B=ke,U=gt),(Qt.equals(O)===!1||kt!==F)&&(n.blendColor(Qt.r,Qt.g,Qt.b,kt),O.copy(Qt),F=kt),_=ve,L=!1}function Le(ve,Me){ve.side===gi?_e(n.CULL_FACE):fe(n.CULL_FACE);let rt=ve.side===ia;Me&&(rt=!rt),Te(rt),ve.blending===Em&&ve.transparent===!1?Be(lc):Be(ve.blending,ve.blendEquation,ve.blendSrc,ve.blendDst,ve.blendEquationAlpha,ve.blendSrcAlpha,ve.blendDstAlpha,ve.blendColor,ve.blendAlpha,ve.premultipliedAlpha),a.setFunc(ve.depthFunc),a.setTest(ve.depthTest),a.setMask(ve.depthWrite),s.setMask(ve.colorWrite);const Ut=ve.stencilWrite;o.setTest(Ut),Ut&&(o.setMask(ve.stencilWriteMask),o.setFunc(ve.stencilFunc,ve.stencilRef,ve.stencilFuncMask),o.setOp(ve.stencilFail,ve.stencilZFail,ve.stencilZPass)),ft(ve.polygonOffset,ve.polygonOffsetFactor,ve.polygonOffsetUnits),ve.alphaToCoverage===!0?fe(n.SAMPLE_ALPHA_TO_COVERAGE):_e(n.SAMPLE_ALPHA_TO_COVERAGE)}function Te(ve){P!==ve&&(ve?n.frontFace(n.CW):n.frontFace(n.CCW),P=ve)}function Ye(ve){ve!==Pk?(fe(n.CULL_FACE),ve!==W&&(ve===IR?n.cullFace(n.BACK):ve===Ok?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):_e(n.CULL_FACE),W=ve}function ne(ve){ve!==j&&(Q&&n.lineWidth(ve),j=ve)}function ft(ve,Me,rt){ve?(fe(n.POLYGON_OFFSET_FILL),(V!==Me||q!==rt)&&(n.polygonOffset(Me,rt),V=Me,q=rt)):_e(n.POLYGON_OFFSET_FILL)}function qe(ve){ve?fe(n.SCISSOR_TEST):_e(n.SCISSOR_TEST)}function Ne(ve){ve===void 0&&(ve=n.TEXTURE0+re-1),ue!==ve&&(n.activeTexture(ve),ue=ve)}function tt(ve,Me,rt){rt===void 0&&(ue===null?rt=n.TEXTURE0+re-1:rt=ue);let Ut=oe[rt];Ut===void 0&&(Ut={type:void 0,texture:void 0},oe[rt]=Ut),(Ut.type!==ve||Ut.texture!==Me)&&(ue!==rt&&(n.activeTexture(rt),ue=rt),n.bindTexture(ve,Me||le[ve]),Ut.type=ve,Ut.texture=Me)}function Z(){const ve=oe[ue];ve!==void 0&&ve.type!==void 0&&(n.bindTexture(ve.type,null),ve.type=void 0,ve.texture=void 0)}function H(){try{n.compressedTexImage2D(...arguments)}catch(ve){on("WebGLState:",ve)}}function de(){try{n.compressedTexImage3D(...arguments)}catch(ve){on("WebGLState:",ve)}}function De(){try{n.texSubImage2D(...arguments)}catch(ve){on("WebGLState:",ve)}}function Ie(){try{n.texSubImage3D(...arguments)}catch(ve){on("WebGLState:",ve)}}function we(){try{n.compressedTexSubImage2D(...arguments)}catch(ve){on("WebGLState:",ve)}}function st(){try{n.compressedTexSubImage3D(...arguments)}catch(ve){on("WebGLState:",ve)}}function it(){try{n.texStorage2D(...arguments)}catch(ve){on("WebGLState:",ve)}}function It(){try{n.texStorage3D(...arguments)}catch(ve){on("WebGLState:",ve)}}function Ot(){try{n.texImage2D(...arguments)}catch(ve){on("WebGLState:",ve)}}function Qe(){try{n.texImage3D(...arguments)}catch(ve){on("WebGLState:",ve)}}function Ve(ve){ae.equals(ve)===!1&&(n.scissor(ve.x,ve.y,ve.z,ve.w),ae.copy(ve))}function at(ve){he.equals(ve)===!1&&(n.viewport(ve.x,ve.y,ve.z,ve.w),he.copy(ve))}function bt(ve,Me){let rt=h.get(Me);rt===void 0&&(rt=new WeakMap,h.set(Me,rt));let Ut=rt.get(ve);Ut===void 0&&(Ut=n.getUniformBlockIndex(Me,ve.name),rt.set(ve,Ut))}function ht(ve,Me){const Ut=h.get(Me).get(ve);c.get(Me)!==Ut&&(n.uniformBlockBinding(Me,Ut,ve.__bindingPointIndex),c.set(Me,Ut))}function Vt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),a.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},ue=null,oe={},g={},A=new WeakMap,v=[],x=null,S=!1,_=null,E=null,C=null,T=null,R=null,B=null,U=null,O=new Mt(0,0,0),F=0,L=!1,P=null,W=null,j=null,V=null,q=null,ae.set(0,0,n.canvas.width,n.canvas.height),he.set(0,0,n.canvas.width,n.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:fe,disable:_e,bindFramebuffer:Pe,drawBuffers:et,useProgram:ot,setBlending:Be,setMaterial:Le,setFlipSided:Te,setCullFace:Ye,setLineWidth:ne,setPolygonOffset:ft,setScissorTest:qe,activeTexture:Ne,bindTexture:tt,unbindTexture:Z,compressedTexImage2D:H,compressedTexImage3D:de,texImage2D:Ot,texImage3D:Qe,updateUBOMapping:bt,uniformBlockBinding:ht,texStorage2D:it,texStorage3D:It,texSubImage2D:De,texSubImage3D:Ie,compressedTexSubImage2D:we,compressedTexSubImage3D:st,scissor:Ve,viewport:at,reset:Vt}}function DZ(n,e,t,i,r,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),h=new Ze,p=new WeakMap;let g;const A=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(Z,H){return v?new OffscreenCanvas(Z,H):Tb("canvas")}function S(Z,H,de){let De=1;const Ie=tt(Z);if((Ie.width>de||Ie.height>de)&&(De=de/Math.max(Ie.width,Ie.height)),De<1)if(typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Z instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Z instanceof ImageBitmap||typeof VideoFrame<"u"&&Z instanceof VideoFrame){const we=Math.floor(De*Ie.width),st=Math.floor(De*Ie.height);g===void 0&&(g=x(we,st));const it=H?x(we,st):g;return it.width=we,it.height=st,it.getContext("2d").drawImage(Z,0,0,we,st),Gt("WebGLRenderer: Texture has been resized from ("+Ie.width+"x"+Ie.height+") to ("+we+"x"+st+")."),it}else return"data"in Z&&Gt("WebGLRenderer: Image in DataTexture is too big ("+Ie.width+"x"+Ie.height+")."),Z;return Z}function _(Z){return Z.generateMipmaps}function E(Z){n.generateMipmap(Z)}function C(Z){return Z.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:Z.isWebGL3DRenderTarget?n.TEXTURE_3D:Z.isWebGLArrayRenderTarget||Z.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function T(Z,H,de,De,Ie=!1){if(Z!==null){if(n[Z]!==void 0)return n[Z];Gt("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Z+"'")}let we=H;if(H===n.RED&&(de===n.FLOAT&&(we=n.R32F),de===n.HALF_FLOAT&&(we=n.R16F),de===n.UNSIGNED_BYTE&&(we=n.R8)),H===n.RED_INTEGER&&(de===n.UNSIGNED_BYTE&&(we=n.R8UI),de===n.UNSIGNED_SHORT&&(we=n.R16UI),de===n.UNSIGNED_INT&&(we=n.R32UI),de===n.BYTE&&(we=n.R8I),de===n.SHORT&&(we=n.R16I),de===n.INT&&(we=n.R32I)),H===n.RG&&(de===n.FLOAT&&(we=n.RG32F),de===n.HALF_FLOAT&&(we=n.RG16F),de===n.UNSIGNED_BYTE&&(we=n.RG8)),H===n.RG_INTEGER&&(de===n.UNSIGNED_BYTE&&(we=n.RG8UI),de===n.UNSIGNED_SHORT&&(we=n.RG16UI),de===n.UNSIGNED_INT&&(we=n.RG32UI),de===n.BYTE&&(we=n.RG8I),de===n.SHORT&&(we=n.RG16I),de===n.INT&&(we=n.RG32I)),H===n.RGB_INTEGER&&(de===n.UNSIGNED_BYTE&&(we=n.RGB8UI),de===n.UNSIGNED_SHORT&&(we=n.RGB16UI),de===n.UNSIGNED_INT&&(we=n.RGB32UI),de===n.BYTE&&(we=n.RGB8I),de===n.SHORT&&(we=n.RGB16I),de===n.INT&&(we=n.RGB32I)),H===n.RGBA_INTEGER&&(de===n.UNSIGNED_BYTE&&(we=n.RGBA8UI),de===n.UNSIGNED_SHORT&&(we=n.RGBA16UI),de===n.UNSIGNED_INT&&(we=n.RGBA32UI),de===n.BYTE&&(we=n.RGBA8I),de===n.SHORT&&(we=n.RGBA16I),de===n.INT&&(we=n.RGBA32I)),H===n.RGB&&(de===n.UNSIGNED_INT_5_9_9_9_REV&&(we=n.RGB9_E5),de===n.UNSIGNED_INT_10F_11F_11F_REV&&(we=n.R11F_G11F_B10F)),H===n.RGBA){const st=Ie?Mb:Wn.getTransfer(De);de===n.FLOAT&&(we=n.RGBA32F),de===n.HALF_FLOAT&&(we=n.RGBA16F),de===n.UNSIGNED_BYTE&&(we=st===Ui?n.SRGB8_ALPHA8:n.RGBA8),de===n.UNSIGNED_SHORT_4_4_4_4&&(we=n.RGBA4),de===n.UNSIGNED_SHORT_5_5_5_1&&(we=n.RGB5_A1)}return(we===n.R16F||we===n.R32F||we===n.RG16F||we===n.RG32F||we===n.RGBA16F||we===n.RGBA32F)&&e.get("EXT_color_buffer_float"),we}function R(Z,H){let de;return Z?H===null||H===fl||H===S0?de=n.DEPTH24_STENCIL8:H===Si?de=n.DEPTH32F_STENCIL8:H===_0&&(de=n.DEPTH24_STENCIL8,Gt("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):H===null||H===fl||H===S0?de=n.DEPTH_COMPONENT24:H===Si?de=n.DEPTH_COMPONENT32F:H===_0&&(de=n.DEPTH_COMPONENT16),de}function B(Z,H){return _(Z)===!0||Z.isFramebufferTexture&&Z.minFilter!==Ri&&Z.minFilter!==mn?Math.log2(Math.max(H.width,H.height))+1:Z.mipmaps!==void 0&&Z.mipmaps.length>0?Z.mipmaps.length:Z.isCompressedTexture&&Array.isArray(Z.image)?H.mipmaps.length:1}function U(Z){const H=Z.target;H.removeEventListener("dispose",U),F(H),H.isVideoTexture&&p.delete(H)}function O(Z){const H=Z.target;H.removeEventListener("dispose",O),P(H)}function F(Z){const H=i.get(Z);if(H.__webglInit===void 0)return;const de=Z.source,De=A.get(de);if(De){const Ie=De[H.__cacheKey];Ie.usedTimes--,Ie.usedTimes===0&&L(Z),Object.keys(De).length===0&&A.delete(de)}i.remove(Z)}function L(Z){const H=i.get(Z);n.deleteTexture(H.__webglTexture);const de=Z.source,De=A.get(de);delete De[H.__cacheKey],a.memory.textures--}function P(Z){const H=i.get(Z);if(Z.depthTexture&&(Z.depthTexture.dispose(),i.remove(Z.depthTexture)),Z.isWebGLCubeRenderTarget)for(let De=0;De<6;De++){if(Array.isArray(H.__webglFramebuffer[De]))for(let Ie=0;Ie<H.__webglFramebuffer[De].length;Ie++)n.deleteFramebuffer(H.__webglFramebuffer[De][Ie]);else n.deleteFramebuffer(H.__webglFramebuffer[De]);H.__webglDepthbuffer&&n.deleteRenderbuffer(H.__webglDepthbuffer[De])}else{if(Array.isArray(H.__webglFramebuffer))for(let De=0;De<H.__webglFramebuffer.length;De++)n.deleteFramebuffer(H.__webglFramebuffer[De]);else n.deleteFramebuffer(H.__webglFramebuffer);if(H.__webglDepthbuffer&&n.deleteRenderbuffer(H.__webglDepthbuffer),H.__webglMultisampledFramebuffer&&n.deleteFramebuffer(H.__webglMultisampledFramebuffer),H.__webglColorRenderbuffer)for(let De=0;De<H.__webglColorRenderbuffer.length;De++)H.__webglColorRenderbuffer[De]&&n.deleteRenderbuffer(H.__webglColorRenderbuffer[De]);H.__webglDepthRenderbuffer&&n.deleteRenderbuffer(H.__webglDepthRenderbuffer)}const de=Z.textures;for(let De=0,Ie=de.length;De<Ie;De++){const we=i.get(de[De]);we.__webglTexture&&(n.deleteTexture(we.__webglTexture),a.memory.textures--),i.remove(de[De])}i.remove(Z)}let W=0;function j(){W=0}function V(){const Z=W;return Z>=r.maxTextures&&Gt("WebGLTextures: Trying to use "+Z+" texture units while this GPU supports only "+r.maxTextures),W+=1,Z}function q(Z){const H=[];return H.push(Z.wrapS),H.push(Z.wrapT),H.push(Z.wrapR||0),H.push(Z.magFilter),H.push(Z.minFilter),H.push(Z.anisotropy),H.push(Z.internalFormat),H.push(Z.format),H.push(Z.type),H.push(Z.generateMipmaps),H.push(Z.premultiplyAlpha),H.push(Z.flipY),H.push(Z.unpackAlignment),H.push(Z.colorSpace),H.join()}function re(Z,H){const de=i.get(Z);if(Z.isVideoTexture&&qe(Z),Z.isRenderTargetTexture===!1&&Z.isExternalTexture!==!0&&Z.version>0&&de.__version!==Z.version){const De=Z.image;if(De===null)Gt("WebGLRenderer: Texture marked for update but no image data found.");else if(De.complete===!1)Gt("WebGLRenderer: Texture marked for update but image is incomplete");else{le(de,Z,H);return}}else Z.isExternalTexture&&(de.__webglTexture=Z.sourceTexture?Z.sourceTexture:null);t.bindTexture(n.TEXTURE_2D,de.__webglTexture,n.TEXTURE0+H)}function Q(Z,H){const de=i.get(Z);if(Z.isRenderTargetTexture===!1&&Z.version>0&&de.__version!==Z.version){le(de,Z,H);return}else Z.isExternalTexture&&(de.__webglTexture=Z.sourceTexture?Z.sourceTexture:null);t.bindTexture(n.TEXTURE_2D_ARRAY,de.__webglTexture,n.TEXTURE0+H)}function K(Z,H){const de=i.get(Z);if(Z.isRenderTargetTexture===!1&&Z.version>0&&de.__version!==Z.version){le(de,Z,H);return}t.bindTexture(n.TEXTURE_3D,de.__webglTexture,n.TEXTURE0+H)}function ce(Z,H){const de=i.get(Z);if(Z.isCubeDepthTexture!==!0&&Z.version>0&&de.__version!==Z.version){fe(de,Z,H);return}t.bindTexture(n.TEXTURE_CUBE_MAP,de.__webglTexture,n.TEXTURE0+H)}const ue={[hl]:n.REPEAT,[or]:n.CLAMP_TO_EDGE,[mf]:n.MIRRORED_REPEAT},oe={[Ri]:n.NEAREST,[Kd]:n.NEAREST_MIPMAP_NEAREST,[Wu]:n.NEAREST_MIPMAP_LINEAR,[mn]:n.LINEAR,[uf]:n.LINEAR_MIPMAP_NEAREST,[ya]:n.LINEAR_MIPMAP_LINEAR},z={[h8]:n.NEVER,[g8]:n.ALWAYS,[f8]:n.LESS,[EM]:n.LEQUAL,[d8]:n.EQUAL,[wM]:n.GEQUAL,[p8]:n.GREATER,[m8]:n.NOTEQUAL};function $(Z,H){if(H.type===Si&&e.has("OES_texture_float_linear")===!1&&(H.magFilter===mn||H.magFilter===uf||H.magFilter===Wu||H.magFilter===ya||H.minFilter===mn||H.minFilter===uf||H.minFilter===Wu||H.minFilter===ya)&&Gt("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(Z,n.TEXTURE_WRAP_S,ue[H.wrapS]),n.texParameteri(Z,n.TEXTURE_WRAP_T,ue[H.wrapT]),(Z===n.TEXTURE_3D||Z===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Z,n.TEXTURE_WRAP_R,ue[H.wrapR]),n.texParameteri(Z,n.TEXTURE_MAG_FILTER,oe[H.magFilter]),n.texParameteri(Z,n.TEXTURE_MIN_FILTER,oe[H.minFilter]),H.compareFunction&&(n.texParameteri(Z,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(Z,n.TEXTURE_COMPARE_FUNC,z[H.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(H.magFilter===Ri||H.minFilter!==Wu&&H.minFilter!==ya||H.type===Si&&e.has("OES_texture_float_linear")===!1)return;if(H.anisotropy>1||i.get(H).__currentAnisotropy){const de=e.get("EXT_texture_filter_anisotropic");n.texParameterf(Z,de.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(H.anisotropy,r.getMaxAnisotropy())),i.get(H).__currentAnisotropy=H.anisotropy}}}function ae(Z,H){let de=!1;Z.__webglInit===void 0&&(Z.__webglInit=!0,H.addEventListener("dispose",U));const De=H.source;let Ie=A.get(De);Ie===void 0&&(Ie={},A.set(De,Ie));const we=q(H);if(we!==Z.__cacheKey){Ie[we]===void 0&&(Ie[we]={texture:n.createTexture(),usedTimes:0},a.memory.textures++,de=!0),Ie[we].usedTimes++;const st=Ie[Z.__cacheKey];st!==void 0&&(Ie[Z.__cacheKey].usedTimes--,st.usedTimes===0&&L(H)),Z.__cacheKey=we,Z.__webglTexture=Ie[we].texture}return de}function he(Z,H,de){return Math.floor(Math.floor(Z/de)/H)}function me(Z,H,de,De){const we=Z.updateRanges;if(we.length===0)t.texSubImage2D(n.TEXTURE_2D,0,0,0,H.width,H.height,de,De,H.data);else{we.sort((Qe,Ve)=>Qe.start-Ve.start);let st=0;for(let Qe=1;Qe<we.length;Qe++){const Ve=we[st],at=we[Qe],bt=Ve.start+Ve.count,ht=he(at.start,H.width,4),Vt=he(Ve.start,H.width,4);at.start<=bt+1&&ht===Vt&&he(at.start+at.count-1,H.width,4)===ht?Ve.count=Math.max(Ve.count,at.start+at.count-Ve.start):(++st,we[st]=at)}we.length=st+1;const it=n.getParameter(n.UNPACK_ROW_LENGTH),It=n.getParameter(n.UNPACK_SKIP_PIXELS),Ot=n.getParameter(n.UNPACK_SKIP_ROWS);n.pixelStorei(n.UNPACK_ROW_LENGTH,H.width);for(let Qe=0,Ve=we.length;Qe<Ve;Qe++){const at=we[Qe],bt=Math.floor(at.start/4),ht=Math.ceil(at.count/4),Vt=bt%H.width,ve=Math.floor(bt/H.width),Me=ht,rt=1;n.pixelStorei(n.UNPACK_SKIP_PIXELS,Vt),n.pixelStorei(n.UNPACK_SKIP_ROWS,ve),t.texSubImage2D(n.TEXTURE_2D,0,Vt,ve,Me,rt,de,De,H.data)}Z.clearUpdateRanges(),n.pixelStorei(n.UNPACK_ROW_LENGTH,it),n.pixelStorei(n.UNPACK_SKIP_PIXELS,It),n.pixelStorei(n.UNPACK_SKIP_ROWS,Ot)}}function le(Z,H,de){let De=n.TEXTURE_2D;(H.isDataArrayTexture||H.isCompressedArrayTexture)&&(De=n.TEXTURE_2D_ARRAY),H.isData3DTexture&&(De=n.TEXTURE_3D);const Ie=ae(Z,H),we=H.source;t.bindTexture(De,Z.__webglTexture,n.TEXTURE0+de);const st=i.get(we);if(we.version!==st.__version||Ie===!0){t.activeTexture(n.TEXTURE0+de);const it=Wn.getPrimaries(Wn.workingColorSpace),It=H.colorSpace===nl?null:Wn.getPrimaries(H.colorSpace),Ot=H.colorSpace===nl||it===It?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,H.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,H.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ot);let Qe=S(H.image,!1,r.maxTextureSize);Qe=Ne(H,Qe);const Ve=s.convert(H.format,H.colorSpace),at=s.convert(H.type);let bt=T(H.internalFormat,Ve,at,H.colorSpace,H.isVideoTexture);$(De,H);let ht;const Vt=H.mipmaps,ve=H.isVideoTexture!==!0,Me=st.__version===void 0||Ie===!0,rt=we.dataReady,Ut=B(H,Qe);if(H.isDepthTexture)bt=R(H.format===Bd,H.type),Me&&(ve?t.texStorage2D(n.TEXTURE_2D,1,bt,Qe.width,Qe.height):t.texImage2D(n.TEXTURE_2D,0,bt,Qe.width,Qe.height,0,Ve,at,null));else if(H.isDataTexture)if(Vt.length>0){ve&&Me&&t.texStorage2D(n.TEXTURE_2D,Ut,bt,Vt[0].width,Vt[0].height);for(let nt=0,ke=Vt.length;nt<ke;nt++)ht=Vt[nt],ve?rt&&t.texSubImage2D(n.TEXTURE_2D,nt,0,0,ht.width,ht.height,Ve,at,ht.data):t.texImage2D(n.TEXTURE_2D,nt,bt,ht.width,ht.height,0,Ve,at,ht.data);H.generateMipmaps=!1}else ve?(Me&&t.texStorage2D(n.TEXTURE_2D,Ut,bt,Qe.width,Qe.height),rt&&me(H,Qe,Ve,at)):t.texImage2D(n.TEXTURE_2D,0,bt,Qe.width,Qe.height,0,Ve,at,Qe.data);else if(H.isCompressedTexture)if(H.isCompressedArrayTexture){ve&&Me&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ut,bt,Vt[0].width,Vt[0].height,Qe.depth);for(let nt=0,ke=Vt.length;nt<ke;nt++)if(ht=Vt[nt],H.format!==Fi)if(Ve!==null)if(ve){if(rt)if(H.layerUpdates.size>0){const gt=HR(ht.width,ht.height,H.format,H.type);for(const Qt of H.layerUpdates){const kt=ht.data.subarray(Qt*gt/ht.data.BYTES_PER_ELEMENT,(Qt+1)*gt/ht.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,nt,0,0,Qt,ht.width,ht.height,1,Ve,kt)}H.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,nt,0,0,0,ht.width,ht.height,Qe.depth,Ve,ht.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,nt,bt,ht.width,ht.height,Qe.depth,0,ht.data,0,0);else Gt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ve?rt&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,nt,0,0,0,ht.width,ht.height,Qe.depth,Ve,at,ht.data):t.texImage3D(n.TEXTURE_2D_ARRAY,nt,bt,ht.width,ht.height,Qe.depth,0,Ve,at,ht.data)}else{ve&&Me&&t.texStorage2D(n.TEXTURE_2D,Ut,bt,Vt[0].width,Vt[0].height);for(let nt=0,ke=Vt.length;nt<ke;nt++)ht=Vt[nt],H.format!==Fi?Ve!==null?ve?rt&&t.compressedTexSubImage2D(n.TEXTURE_2D,nt,0,0,ht.width,ht.height,Ve,ht.data):t.compressedTexImage2D(n.TEXTURE_2D,nt,bt,ht.width,ht.height,0,ht.data):Gt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ve?rt&&t.texSubImage2D(n.TEXTURE_2D,nt,0,0,ht.width,ht.height,Ve,at,ht.data):t.texImage2D(n.TEXTURE_2D,nt,bt,ht.width,ht.height,0,Ve,at,ht.data)}else if(H.isDataArrayTexture)if(ve){if(Me&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ut,bt,Qe.width,Qe.height,Qe.depth),rt)if(H.layerUpdates.size>0){const nt=HR(Qe.width,Qe.height,H.format,H.type);for(const ke of H.layerUpdates){const gt=Qe.data.subarray(ke*nt/Qe.data.BYTES_PER_ELEMENT,(ke+1)*nt/Qe.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,ke,Qe.width,Qe.height,1,Ve,at,gt)}H.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Qe.width,Qe.height,Qe.depth,Ve,at,Qe.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,bt,Qe.width,Qe.height,Qe.depth,0,Ve,at,Qe.data);else if(H.isData3DTexture)ve?(Me&&t.texStorage3D(n.TEXTURE_3D,Ut,bt,Qe.width,Qe.height,Qe.depth),rt&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Qe.width,Qe.height,Qe.depth,Ve,at,Qe.data)):t.texImage3D(n.TEXTURE_3D,0,bt,Qe.width,Qe.height,Qe.depth,0,Ve,at,Qe.data);else if(H.isFramebufferTexture){if(Me)if(ve)t.texStorage2D(n.TEXTURE_2D,Ut,bt,Qe.width,Qe.height);else{let nt=Qe.width,ke=Qe.height;for(let gt=0;gt<Ut;gt++)t.texImage2D(n.TEXTURE_2D,gt,bt,nt,ke,0,Ve,at,null),nt>>=1,ke>>=1}}else if(Vt.length>0){if(ve&&Me){const nt=tt(Vt[0]);t.texStorage2D(n.TEXTURE_2D,Ut,bt,nt.width,nt.height)}for(let nt=0,ke=Vt.length;nt<ke;nt++)ht=Vt[nt],ve?rt&&t.texSubImage2D(n.TEXTURE_2D,nt,0,0,Ve,at,ht):t.texImage2D(n.TEXTURE_2D,nt,bt,Ve,at,ht);H.generateMipmaps=!1}else if(ve){if(Me){const nt=tt(Qe);t.texStorage2D(n.TEXTURE_2D,Ut,bt,nt.width,nt.height)}rt&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ve,at,Qe)}else t.texImage2D(n.TEXTURE_2D,0,bt,Ve,at,Qe);_(H)&&E(De),st.__version=we.version,H.onUpdate&&H.onUpdate(H)}Z.__version=H.version}function fe(Z,H,de){if(H.image.length!==6)return;const De=ae(Z,H),Ie=H.source;t.bindTexture(n.TEXTURE_CUBE_MAP,Z.__webglTexture,n.TEXTURE0+de);const we=i.get(Ie);if(Ie.version!==we.__version||De===!0){t.activeTexture(n.TEXTURE0+de);const st=Wn.getPrimaries(Wn.workingColorSpace),it=H.colorSpace===nl?null:Wn.getPrimaries(H.colorSpace),It=H.colorSpace===nl||st===it?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,H.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,H.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,It);const Ot=H.isCompressedTexture||H.image[0].isCompressedTexture,Qe=H.image[0]&&H.image[0].isDataTexture,Ve=[];for(let ke=0;ke<6;ke++)!Ot&&!Qe?Ve[ke]=S(H.image[ke],!0,r.maxCubemapSize):Ve[ke]=Qe?H.image[ke].image:H.image[ke],Ve[ke]=Ne(H,Ve[ke]);const at=Ve[0],bt=s.convert(H.format,H.colorSpace),ht=s.convert(H.type),Vt=T(H.internalFormat,bt,ht,H.colorSpace),ve=H.isVideoTexture!==!0,Me=we.__version===void 0||De===!0,rt=Ie.dataReady;let Ut=B(H,at);$(n.TEXTURE_CUBE_MAP,H);let nt;if(Ot){ve&&Me&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Ut,Vt,at.width,at.height);for(let ke=0;ke<6;ke++){nt=Ve[ke].mipmaps;for(let gt=0;gt<nt.length;gt++){const Qt=nt[gt];H.format!==Fi?bt!==null?ve?rt&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,gt,0,0,Qt.width,Qt.height,bt,Qt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,gt,Vt,Qt.width,Qt.height,0,Qt.data):Gt("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ve?rt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,gt,0,0,Qt.width,Qt.height,bt,ht,Qt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,gt,Vt,Qt.width,Qt.height,0,bt,ht,Qt.data)}}}else{if(nt=H.mipmaps,ve&&Me){nt.length>0&&Ut++;const ke=tt(Ve[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Ut,Vt,ke.width,ke.height)}for(let ke=0;ke<6;ke++)if(Qe){ve?rt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,0,0,Ve[ke].width,Ve[ke].height,bt,ht,Ve[ke].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,Vt,Ve[ke].width,Ve[ke].height,0,bt,ht,Ve[ke].data);for(let gt=0;gt<nt.length;gt++){const kt=nt[gt].image[ke].image;ve?rt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,gt+1,0,0,kt.width,kt.height,bt,ht,kt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,gt+1,Vt,kt.width,kt.height,0,bt,ht,kt.data)}}else{ve?rt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,0,0,bt,ht,Ve[ke]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,Vt,bt,ht,Ve[ke]);for(let gt=0;gt<nt.length;gt++){const Qt=nt[gt];ve?rt&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,gt+1,0,0,bt,ht,Qt.image[ke]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,gt+1,Vt,bt,ht,Qt.image[ke])}}}_(H)&&E(n.TEXTURE_CUBE_MAP),we.__version=Ie.version,H.onUpdate&&H.onUpdate(H)}Z.__version=H.version}function _e(Z,H,de,De,Ie,we){const st=s.convert(de.format,de.colorSpace),it=s.convert(de.type),It=T(de.internalFormat,st,it,de.colorSpace),Ot=i.get(H),Qe=i.get(de);if(Qe.__renderTarget=H,!Ot.__hasExternalTextures){const Ve=Math.max(1,H.width>>we),at=Math.max(1,H.height>>we);Ie===n.TEXTURE_3D||Ie===n.TEXTURE_2D_ARRAY?t.texImage3D(Ie,we,It,Ve,at,H.depth,0,st,it,null):t.texImage2D(Ie,we,It,Ve,at,0,st,it,null)}t.bindFramebuffer(n.FRAMEBUFFER,Z),ft(H)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,De,Ie,Qe.__webglTexture,0,ne(H)):(Ie===n.TEXTURE_2D||Ie>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Ie<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,De,Ie,Qe.__webglTexture,we),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Pe(Z,H,de){if(n.bindRenderbuffer(n.RENDERBUFFER,Z),H.depthBuffer){const De=H.depthTexture,Ie=De&&De.isDepthTexture?De.type:null,we=R(H.stencilBuffer,Ie),st=H.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;ft(H)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ne(H),we,H.width,H.height):de?n.renderbufferStorageMultisample(n.RENDERBUFFER,ne(H),we,H.width,H.height):n.renderbufferStorage(n.RENDERBUFFER,we,H.width,H.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,st,n.RENDERBUFFER,Z)}else{const De=H.textures;for(let Ie=0;Ie<De.length;Ie++){const we=De[Ie],st=s.convert(we.format,we.colorSpace),it=s.convert(we.type),It=T(we.internalFormat,st,it,we.colorSpace);ft(H)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ne(H),It,H.width,H.height):de?n.renderbufferStorageMultisample(n.RENDERBUFFER,ne(H),It,H.width,H.height):n.renderbufferStorage(n.RENDERBUFFER,It,H.width,H.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function et(Z,H,de){const De=H.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(n.FRAMEBUFFER,Z),!(H.depthTexture&&H.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Ie=i.get(H.depthTexture);if(Ie.__renderTarget=H,(!Ie.__webglTexture||H.depthTexture.image.width!==H.width||H.depthTexture.image.height!==H.height)&&(H.depthTexture.image.width=H.width,H.depthTexture.image.height=H.height,H.depthTexture.needsUpdate=!0),De){if(Ie.__webglInit===void 0&&(Ie.__webglInit=!0,H.depthTexture.addEventListener("dispose",U)),Ie.__webglTexture===void 0){Ie.__webglTexture=n.createTexture(),t.bindTexture(n.TEXTURE_CUBE_MAP,Ie.__webglTexture),$(n.TEXTURE_CUBE_MAP,H.depthTexture);const Ot=s.convert(H.depthTexture.format),Qe=s.convert(H.depthTexture.type);let Ve;H.depthTexture.format===Zu?Ve=n.DEPTH_COMPONENT24:H.depthTexture.format===Bd&&(Ve=n.DEPTH24_STENCIL8);for(let at=0;at<6;at++)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+at,0,Ve,H.width,H.height,0,Ot,Qe,null)}}else re(H.depthTexture,0);const we=Ie.__webglTexture,st=ne(H),it=De?n.TEXTURE_CUBE_MAP_POSITIVE_X+de:n.TEXTURE_2D,It=H.depthTexture.format===Bd?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(H.depthTexture.format===Zu)ft(H)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,It,it,we,0,st):n.framebufferTexture2D(n.FRAMEBUFFER,It,it,we,0);else if(H.depthTexture.format===Bd)ft(H)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,It,it,we,0,st):n.framebufferTexture2D(n.FRAMEBUFFER,It,it,we,0);else throw new Error("Unknown depthTexture format")}function ot(Z){const H=i.get(Z),de=Z.isWebGLCubeRenderTarget===!0;if(H.__boundDepthTexture!==Z.depthTexture){const De=Z.depthTexture;if(H.__depthDisposeCallback&&H.__depthDisposeCallback(),De){const Ie=()=>{delete H.__boundDepthTexture,delete H.__depthDisposeCallback,De.removeEventListener("dispose",Ie)};De.addEventListener("dispose",Ie),H.__depthDisposeCallback=Ie}H.__boundDepthTexture=De}if(Z.depthTexture&&!H.__autoAllocateDepthBuffer)if(de)for(let De=0;De<6;De++)et(H.__webglFramebuffer[De],Z,De);else{const De=Z.texture.mipmaps;De&&De.length>0?et(H.__webglFramebuffer[0],Z,0):et(H.__webglFramebuffer,Z,0)}else if(de){H.__webglDepthbuffer=[];for(let De=0;De<6;De++)if(t.bindFramebuffer(n.FRAMEBUFFER,H.__webglFramebuffer[De]),H.__webglDepthbuffer[De]===void 0)H.__webglDepthbuffer[De]=n.createRenderbuffer(),Pe(H.__webglDepthbuffer[De],Z,!1);else{const Ie=Z.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,we=H.__webglDepthbuffer[De];n.bindRenderbuffer(n.RENDERBUFFER,we),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ie,n.RENDERBUFFER,we)}}else{const De=Z.texture.mipmaps;if(De&&De.length>0?t.bindFramebuffer(n.FRAMEBUFFER,H.__webglFramebuffer[0]):t.bindFramebuffer(n.FRAMEBUFFER,H.__webglFramebuffer),H.__webglDepthbuffer===void 0)H.__webglDepthbuffer=n.createRenderbuffer(),Pe(H.__webglDepthbuffer,Z,!1);else{const Ie=Z.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,we=H.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,we),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ie,n.RENDERBUFFER,we)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}function Je(Z,H,de){const De=i.get(Z);H!==void 0&&_e(De.__webglFramebuffer,Z,Z.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),de!==void 0&&ot(Z)}function _t(Z){const H=Z.texture,de=i.get(Z),De=i.get(H);Z.addEventListener("dispose",O);const Ie=Z.textures,we=Z.isWebGLCubeRenderTarget===!0,st=Ie.length>1;if(st||(De.__webglTexture===void 0&&(De.__webglTexture=n.createTexture()),De.__version=H.version,a.memory.textures++),we){de.__webglFramebuffer=[];for(let it=0;it<6;it++)if(H.mipmaps&&H.mipmaps.length>0){de.__webglFramebuffer[it]=[];for(let It=0;It<H.mipmaps.length;It++)de.__webglFramebuffer[it][It]=n.createFramebuffer()}else de.__webglFramebuffer[it]=n.createFramebuffer()}else{if(H.mipmaps&&H.mipmaps.length>0){de.__webglFramebuffer=[];for(let it=0;it<H.mipmaps.length;it++)de.__webglFramebuffer[it]=n.createFramebuffer()}else de.__webglFramebuffer=n.createFramebuffer();if(st)for(let it=0,It=Ie.length;it<It;it++){const Ot=i.get(Ie[it]);Ot.__webglTexture===void 0&&(Ot.__webglTexture=n.createTexture(),a.memory.textures++)}if(Z.samples>0&&ft(Z)===!1){de.__webglMultisampledFramebuffer=n.createFramebuffer(),de.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,de.__webglMultisampledFramebuffer);for(let it=0;it<Ie.length;it++){const It=Ie[it];de.__webglColorRenderbuffer[it]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,de.__webglColorRenderbuffer[it]);const Ot=s.convert(It.format,It.colorSpace),Qe=s.convert(It.type),Ve=T(It.internalFormat,Ot,Qe,It.colorSpace,Z.isXRRenderTarget===!0),at=ne(Z);n.renderbufferStorageMultisample(n.RENDERBUFFER,at,Ve,Z.width,Z.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+it,n.RENDERBUFFER,de.__webglColorRenderbuffer[it])}n.bindRenderbuffer(n.RENDERBUFFER,null),Z.depthBuffer&&(de.__webglDepthRenderbuffer=n.createRenderbuffer(),Pe(de.__webglDepthRenderbuffer,Z,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(we){t.bindTexture(n.TEXTURE_CUBE_MAP,De.__webglTexture),$(n.TEXTURE_CUBE_MAP,H);for(let it=0;it<6;it++)if(H.mipmaps&&H.mipmaps.length>0)for(let It=0;It<H.mipmaps.length;It++)_e(de.__webglFramebuffer[it][It],Z,H,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+it,It);else _e(de.__webglFramebuffer[it],Z,H,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+it,0);_(H)&&E(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(st){for(let it=0,It=Ie.length;it<It;it++){const Ot=Ie[it],Qe=i.get(Ot);let Ve=n.TEXTURE_2D;(Z.isWebGL3DRenderTarget||Z.isWebGLArrayRenderTarget)&&(Ve=Z.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Ve,Qe.__webglTexture),$(Ve,Ot),_e(de.__webglFramebuffer,Z,Ot,n.COLOR_ATTACHMENT0+it,Ve,0),_(Ot)&&E(Ve)}t.unbindTexture()}else{let it=n.TEXTURE_2D;if((Z.isWebGL3DRenderTarget||Z.isWebGLArrayRenderTarget)&&(it=Z.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(it,De.__webglTexture),$(it,H),H.mipmaps&&H.mipmaps.length>0)for(let It=0;It<H.mipmaps.length;It++)_e(de.__webglFramebuffer[It],Z,H,n.COLOR_ATTACHMENT0,it,It);else _e(de.__webglFramebuffer,Z,H,n.COLOR_ATTACHMENT0,it,0);_(H)&&E(it),t.unbindTexture()}Z.depthBuffer&&ot(Z)}function Be(Z){const H=Z.textures;for(let de=0,De=H.length;de<De;de++){const Ie=H[de];if(_(Ie)){const we=C(Z),st=i.get(Ie).__webglTexture;t.bindTexture(we,st),E(we),t.unbindTexture()}}}const Le=[],Te=[];function Ye(Z){if(Z.samples>0){if(ft(Z)===!1){const H=Z.textures,de=Z.width,De=Z.height;let Ie=n.COLOR_BUFFER_BIT;const we=Z.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,st=i.get(Z),it=H.length>1;if(it)for(let Ot=0;Ot<H.length;Ot++)t.bindFramebuffer(n.FRAMEBUFFER,st.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ot,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,st.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ot,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,st.__webglMultisampledFramebuffer);const It=Z.texture.mipmaps;It&&It.length>0?t.bindFramebuffer(n.DRAW_FRAMEBUFFER,st.__webglFramebuffer[0]):t.bindFramebuffer(n.DRAW_FRAMEBUFFER,st.__webglFramebuffer);for(let Ot=0;Ot<H.length;Ot++){if(Z.resolveDepthBuffer&&(Z.depthBuffer&&(Ie|=n.DEPTH_BUFFER_BIT),Z.stencilBuffer&&Z.resolveStencilBuffer&&(Ie|=n.STENCIL_BUFFER_BIT)),it){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,st.__webglColorRenderbuffer[Ot]);const Qe=i.get(H[Ot]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Qe,0)}n.blitFramebuffer(0,0,de,De,0,0,de,De,Ie,n.NEAREST),c===!0&&(Le.length=0,Te.length=0,Le.push(n.COLOR_ATTACHMENT0+Ot),Z.depthBuffer&&Z.resolveDepthBuffer===!1&&(Le.push(we),Te.push(we),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,Te)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Le))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),it)for(let Ot=0;Ot<H.length;Ot++){t.bindFramebuffer(n.FRAMEBUFFER,st.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ot,n.RENDERBUFFER,st.__webglColorRenderbuffer[Ot]);const Qe=i.get(H[Ot]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,st.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ot,n.TEXTURE_2D,Qe,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,st.__webglMultisampledFramebuffer)}else if(Z.depthBuffer&&Z.resolveDepthBuffer===!1&&c){const H=Z.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[H])}}}function ne(Z){return Math.min(r.maxSamples,Z.samples)}function ft(Z){const H=i.get(Z);return Z.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&H.__useRenderToTexture!==!1}function qe(Z){const H=a.render.frame;p.get(Z)!==H&&(p.set(Z,H),Z.update())}function Ne(Z,H){const de=Z.colorSpace,De=Z.format,Ie=Z.type;return Z.isCompressedTexture===!0||Z.isVideoTexture===!0||de!==Xi&&de!==nl&&(Wn.getTransfer(de)===Ui?(De!==Fi||Ie!==xn)&&Gt("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):on("WebGLTextures: Unsupported texture color space:",de)),H}function tt(Z){return typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement?(h.width=Z.naturalWidth||Z.width,h.height=Z.naturalHeight||Z.height):typeof VideoFrame<"u"&&Z instanceof VideoFrame?(h.width=Z.displayWidth,h.height=Z.displayHeight):(h.width=Z.width,h.height=Z.height),h}this.allocateTextureUnit=V,this.resetTextureUnits=j,this.setTexture2D=re,this.setTexture2DArray=Q,this.setTexture3D=K,this.setTextureCube=ce,this.rebindTextures=Je,this.setupRenderTarget=_t,this.updateRenderTargetMipmap=Be,this.updateMultisampleRenderTarget=Ye,this.setupDepthRenderbuffer=ot,this.setupFrameBufferTexture=_e,this.useMultisampledRTT=ft,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function m6(n,e){function t(i,r=nl){let s;const a=Wn.getTransfer(r);if(i===xn)return n.UNSIGNED_BYTE;if(i===yM)return n.UNSIGNED_SHORT_4_4_4_4;if(i===bM)return n.UNSIGNED_SHORT_5_5_5_1;if(i===Jb)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===Zb)return n.UNSIGNED_INT_10F_11F_11F_REV;if(i===AM)return n.BYTE;if(i===vM)return n.SHORT;if(i===_0)return n.UNSIGNED_SHORT;if(i===$b)return n.INT;if(i===fl)return n.UNSIGNED_INT;if(i===Si)return n.FLOAT;if(i===ci)return n.HALF_FLOAT;if(i===e4)return n.ALPHA;if(i===E0)return n.RGB;if(i===Fi)return n.RGBA;if(i===Zu)return n.DEPTH_COMPONENT;if(i===Bd)return n.DEPTH_STENCIL;if(i===qu)return n.RED;if(i===ex)return n.RED_INTEGER;if(i===ac)return n.RG;if(i===xM)return n.RG_INTEGER;if(i===_M)return n.RGBA_INTEGER;if(i===wm||i===Ud||i===Mm||i===f0)if(a===Ui)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===wm)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===Ud)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Mm)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===f0)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===wm)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===Ud)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Mm)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===f0)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===db||i===gw||i===km||i===w0)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===db)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===gw)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===km)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===w0)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===pb||i===M0||i===C0||i===mb||i===gb||i===Ab||i===vb)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===pb||i===M0)return a===Ui?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===C0)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(i===mb)return s.COMPRESSED_R11_EAC;if(i===gb)return s.COMPRESSED_SIGNED_R11_EAC;if(i===Ab)return s.COMPRESSED_RG11_EAC;if(i===vb)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(i===Fd||i===Aw||i===vw||i===yw||i===Cm||i===bw||i===xw||i===_w||i===Sw||i===Ew||i===ww||i===Mw||i===Cw||i===Tw)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===Fd)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===Aw)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===vw)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===yw)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===Cm)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===bw)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===xw)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===_w)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===Sw)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===Ew)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===ww)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===Mw)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===Cw)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===Tw)return a===Ui?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===zm||i===Iw||i===yb)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===zm)return a===Ui?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===Iw)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===yb)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===bb||i===xb||i===_b||i===Sb)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===bb)return s.COMPRESSED_RED_RGTC1_EXT;if(i===xb)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===_b)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===Sb)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===S0?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:t}}const LZ=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,NZ=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class UZ{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const i=new p4(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,i=new Fs({vertexShader:LZ,fragmentShader:NZ,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Wt(new ra(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class FZ extends zo{constructor(e,t){super();const i=this;let r=null,s=1,a=null,o="local-floor",c=1,h=null,p=null,g=null,A=null,v=null,x=null;const S=typeof XRWebGLBinding<"u",_=new UZ,E={},C=t.getContextAttributes();let T=null,R=null;const B=[],U=[],O=new Ze;let F=null;const L=new Gr;L.viewport=new Ii;const P=new Gr;P.viewport=new Ii;const W=[L,P],j=new i6;let V=null,q=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(le){let fe=B[le];return fe===void 0&&(fe=new VE,B[le]=fe),fe.getTargetRaySpace()},this.getControllerGrip=function(le){let fe=B[le];return fe===void 0&&(fe=new VE,B[le]=fe),fe.getGripSpace()},this.getHand=function(le){let fe=B[le];return fe===void 0&&(fe=new VE,B[le]=fe),fe.getHandSpace()};function re(le){const fe=U.indexOf(le.inputSource);if(fe===-1)return;const _e=B[fe];_e!==void 0&&(_e.update(le.inputSource,le.frame,h||a),_e.dispatchEvent({type:le.type,data:le.inputSource}))}function Q(){r.removeEventListener("select",re),r.removeEventListener("selectstart",re),r.removeEventListener("selectend",re),r.removeEventListener("squeeze",re),r.removeEventListener("squeezestart",re),r.removeEventListener("squeezeend",re),r.removeEventListener("end",Q),r.removeEventListener("inputsourceschange",K);for(let le=0;le<B.length;le++){const fe=U[le];fe!==null&&(U[le]=null,B[le].disconnect(fe))}V=null,q=null,_.reset();for(const le in E)delete E[le];e.setRenderTarget(T),v=null,A=null,g=null,r=null,R=null,me.stop(),i.isPresenting=!1,e.setPixelRatio(F),e.setSize(O.width,O.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(le){s=le,i.isPresenting===!0&&Gt("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(le){o=le,i.isPresenting===!0&&Gt("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||a},this.setReferenceSpace=function(le){h=le},this.getBaseLayer=function(){return A!==null?A:v},this.getBinding=function(){return g===null&&S&&(g=new XRWebGLBinding(r,t)),g},this.getFrame=function(){return x},this.getSession=function(){return r},this.setSession=async function(le){if(r=le,r!==null){if(T=e.getRenderTarget(),r.addEventListener("select",re),r.addEventListener("selectstart",re),r.addEventListener("selectend",re),r.addEventListener("squeeze",re),r.addEventListener("squeezestart",re),r.addEventListener("squeezeend",re),r.addEventListener("end",Q),r.addEventListener("inputsourceschange",K),C.xrCompatible!==!0&&await t.makeXRCompatible(),F=e.getPixelRatio(),e.getSize(O),S&&"createProjectionLayer"in XRWebGLBinding.prototype){let _e=null,Pe=null,et=null;C.depth&&(et=C.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,_e=C.stencil?Bd:Zu,Pe=C.stencil?S0:fl);const ot={colorFormat:t.RGBA8,depthFormat:et,scaleFactor:s};g=this.getBinding(),A=g.createProjectionLayer(ot),r.updateRenderState({layers:[A]}),e.setPixelRatio(1),e.setSize(A.textureWidth,A.textureHeight,!1),R=new Vr(A.textureWidth,A.textureHeight,{format:Fi,type:xn,depthTexture:new Qm(A.textureWidth,A.textureHeight,Pe,void 0,void 0,void 0,void 0,void 0,void 0,_e),stencilBuffer:C.stencil,colorSpace:e.outputColorSpace,samples:C.antialias?4:0,resolveDepthBuffer:A.ignoreDepthValues===!1,resolveStencilBuffer:A.ignoreDepthValues===!1})}else{const _e={antialias:C.antialias,alpha:!0,depth:C.depth,stencil:C.stencil,framebufferScaleFactor:s};v=new XRWebGLLayer(r,t,_e),r.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),R=new Vr(v.framebufferWidth,v.framebufferHeight,{format:Fi,type:xn,colorSpace:e.outputColorSpace,stencilBuffer:C.stencil,resolveDepthBuffer:v.ignoreDepthValues===!1,resolveStencilBuffer:v.ignoreDepthValues===!1})}R.isXRRenderTarget=!0,this.setFoveation(c),h=null,a=await r.requestReferenceSpace(o),me.setContext(r),me.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return _.getDepthTexture()};function K(le){for(let fe=0;fe<le.removed.length;fe++){const _e=le.removed[fe],Pe=U.indexOf(_e);Pe>=0&&(U[Pe]=null,B[Pe].disconnect(_e))}for(let fe=0;fe<le.added.length;fe++){const _e=le.added[fe];let Pe=U.indexOf(_e);if(Pe===-1){for(let ot=0;ot<B.length;ot++)if(ot>=U.length){U.push(_e),Pe=ot;break}else if(U[ot]===null){U[ot]=_e,Pe=ot;break}if(Pe===-1)break}const et=B[Pe];et&&et.connect(_e)}}const ce=new ee,ue=new ee;function oe(le,fe,_e){ce.setFromMatrixPosition(fe.matrixWorld),ue.setFromMatrixPosition(_e.matrixWorld);const Pe=ce.distanceTo(ue),et=fe.projectionMatrix.elements,ot=_e.projectionMatrix.elements,Je=et[14]/(et[10]-1),_t=et[14]/(et[10]+1),Be=(et[9]+1)/et[5],Le=(et[9]-1)/et[5],Te=(et[8]-1)/et[0],Ye=(ot[8]+1)/ot[0],ne=Je*Te,ft=Je*Ye,qe=Pe/(-Te+Ye),Ne=qe*-Te;if(fe.matrixWorld.decompose(le.position,le.quaternion,le.scale),le.translateX(Ne),le.translateZ(qe),le.matrixWorld.compose(le.position,le.quaternion,le.scale),le.matrixWorldInverse.copy(le.matrixWorld).invert(),et[10]===-1)le.projectionMatrix.copy(fe.projectionMatrix),le.projectionMatrixInverse.copy(fe.projectionMatrixInverse);else{const tt=Je+qe,Z=_t+qe,H=ne-Ne,de=ft+(Pe-Ne),De=Be*_t/Z*tt,Ie=Le*_t/Z*tt;le.projectionMatrix.makePerspective(H,de,De,Ie,tt,Z),le.projectionMatrixInverse.copy(le.projectionMatrix).invert()}}function z(le,fe){fe===null?le.matrixWorld.copy(le.matrix):le.matrixWorld.multiplyMatrices(fe.matrixWorld,le.matrix),le.matrixWorldInverse.copy(le.matrixWorld).invert()}this.updateCamera=function(le){if(r===null)return;let fe=le.near,_e=le.far;_.texture!==null&&(_.depthNear>0&&(fe=_.depthNear),_.depthFar>0&&(_e=_.depthFar)),j.near=P.near=L.near=fe,j.far=P.far=L.far=_e,(V!==j.near||q!==j.far)&&(r.updateRenderState({depthNear:j.near,depthFar:j.far}),V=j.near,q=j.far),j.layers.mask=le.layers.mask|6,L.layers.mask=j.layers.mask&3,P.layers.mask=j.layers.mask&5;const Pe=le.parent,et=j.cameras;z(j,Pe);for(let ot=0;ot<et.length;ot++)z(et[ot],Pe);et.length===2?oe(j,L,P):j.projectionMatrix.copy(L.projectionMatrix),$(le,j,Pe)};function $(le,fe,_e){_e===null?le.matrix.copy(fe.matrixWorld):(le.matrix.copy(_e.matrixWorld),le.matrix.invert(),le.matrix.multiply(fe.matrixWorld)),le.matrix.decompose(le.position,le.quaternion,le.scale),le.updateMatrixWorld(!0),le.projectionMatrix.copy(fe.projectionMatrix),le.projectionMatrixInverse.copy(fe.projectionMatrixInverse),le.isPerspectiveCamera&&(le.fov=B0*2*Math.atan(1/le.projectionMatrix.elements[5]),le.zoom=1)}this.getCamera=function(){return j},this.getFoveation=function(){if(!(A===null&&v===null))return c},this.setFoveation=function(le){c=le,A!==null&&(A.fixedFoveation=le),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=le)},this.hasDepthSensing=function(){return _.texture!==null},this.getDepthSensingMesh=function(){return _.getMesh(j)},this.getCameraTexture=function(le){return E[le]};let ae=null;function he(le,fe){if(p=fe.getViewerPose(h||a),x=fe,p!==null){const _e=p.views;v!==null&&(e.setRenderTargetFramebuffer(R,v.framebuffer),e.setRenderTarget(R));let Pe=!1;_e.length!==j.cameras.length&&(j.cameras.length=0,Pe=!0);for(let _t=0;_t<_e.length;_t++){const Be=_e[_t];let Le=null;if(v!==null)Le=v.getViewport(Be);else{const Ye=g.getViewSubImage(A,Be);Le=Ye.viewport,_t===0&&(e.setRenderTargetTextures(R,Ye.colorTexture,Ye.depthStencilTexture),e.setRenderTarget(R))}let Te=W[_t];Te===void 0&&(Te=new Gr,Te.layers.enable(_t),Te.viewport=new Ii,W[_t]=Te),Te.matrix.fromArray(Be.transform.matrix),Te.matrix.decompose(Te.position,Te.quaternion,Te.scale),Te.projectionMatrix.fromArray(Be.projectionMatrix),Te.projectionMatrixInverse.copy(Te.projectionMatrix).invert(),Te.viewport.set(Le.x,Le.y,Le.width,Le.height),_t===0&&(j.matrix.copy(Te.matrix),j.matrix.decompose(j.position,j.quaternion,j.scale)),Pe===!0&&j.cameras.push(Te)}const et=r.enabledFeatures;if(et&&et.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&S){g=i.getBinding();const _t=g.getDepthInformation(_e[0]);_t&&_t.isValid&&_t.texture&&_.init(_t,r.renderState)}if(et&&et.includes("camera-access")&&S){e.state.unbindTexture(),g=i.getBinding();for(let _t=0;_t<_e.length;_t++){const Be=_e[_t].camera;if(Be){let Le=E[Be];Le||(Le=new p4,E[Be]=Le);const Te=g.getCameraImage(Be);Le.sourceTexture=Te}}}}for(let _e=0;_e<B.length;_e++){const Pe=U[_e],et=B[_e];Pe!==null&&et!==void 0&&et.update(Pe,fe,h||a)}ae&&ae(le,fe),fe.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:fe}),x=null}const me=new u6;me.setAnimationLoop(he),this.setAnimationLoop=function(le){ae=le},this.dispose=function(){}}}const $p=new Us,PZ=new qt;function OZ(n,e){function t(_,E){_.matrixAutoUpdate===!0&&_.updateMatrix(),E.value.copy(_.matrix)}function i(_,E){E.color.getRGB(_.fogColor.value,x8(n)),E.isFog?(_.fogNear.value=E.near,_.fogFar.value=E.far):E.isFogExp2&&(_.fogDensity.value=E.density)}function r(_,E,C,T,R){E.isMeshBasicMaterial||E.isMeshLambertMaterial?s(_,E):E.isMeshToonMaterial?(s(_,E),g(_,E)):E.isMeshPhongMaterial?(s(_,E),p(_,E)):E.isMeshStandardMaterial?(s(_,E),A(_,E),E.isMeshPhysicalMaterial&&v(_,E,R)):E.isMeshMatcapMaterial?(s(_,E),x(_,E)):E.isMeshDepthMaterial?s(_,E):E.isMeshDistanceMaterial?(s(_,E),S(_,E)):E.isMeshNormalMaterial?s(_,E):E.isLineBasicMaterial?(a(_,E),E.isLineDashedMaterial&&o(_,E)):E.isPointsMaterial?c(_,E,C,T):E.isSpriteMaterial?h(_,E):E.isShadowMaterial?(_.color.value.copy(E.color),_.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}function s(_,E){_.opacity.value=E.opacity,E.color&&_.diffuse.value.copy(E.color),E.emissive&&_.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(_.map.value=E.map,t(E.map,_.mapTransform)),E.alphaMap&&(_.alphaMap.value=E.alphaMap,t(E.alphaMap,_.alphaMapTransform)),E.bumpMap&&(_.bumpMap.value=E.bumpMap,t(E.bumpMap,_.bumpMapTransform),_.bumpScale.value=E.bumpScale,E.side===ia&&(_.bumpScale.value*=-1)),E.normalMap&&(_.normalMap.value=E.normalMap,t(E.normalMap,_.normalMapTransform),_.normalScale.value.copy(E.normalScale),E.side===ia&&_.normalScale.value.negate()),E.displacementMap&&(_.displacementMap.value=E.displacementMap,t(E.displacementMap,_.displacementMapTransform),_.displacementScale.value=E.displacementScale,_.displacementBias.value=E.displacementBias),E.emissiveMap&&(_.emissiveMap.value=E.emissiveMap,t(E.emissiveMap,_.emissiveMapTransform)),E.specularMap&&(_.specularMap.value=E.specularMap,t(E.specularMap,_.specularMapTransform)),E.alphaTest>0&&(_.alphaTest.value=E.alphaTest);const C=e.get(E),T=C.envMap,R=C.envMapRotation;T&&(_.envMap.value=T,$p.copy(R),$p.x*=-1,$p.y*=-1,$p.z*=-1,T.isCubeTexture&&T.isRenderTargetTexture===!1&&($p.y*=-1,$p.z*=-1),_.envMapRotation.value.setFromMatrix4(PZ.makeRotationFromEuler($p)),_.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=E.reflectivity,_.ior.value=E.ior,_.refractionRatio.value=E.refractionRatio),E.lightMap&&(_.lightMap.value=E.lightMap,_.lightMapIntensity.value=E.lightMapIntensity,t(E.lightMap,_.lightMapTransform)),E.aoMap&&(_.aoMap.value=E.aoMap,_.aoMapIntensity.value=E.aoMapIntensity,t(E.aoMap,_.aoMapTransform))}function a(_,E){_.diffuse.value.copy(E.color),_.opacity.value=E.opacity,E.map&&(_.map.value=E.map,t(E.map,_.mapTransform))}function o(_,E){_.dashSize.value=E.dashSize,_.totalSize.value=E.dashSize+E.gapSize,_.scale.value=E.scale}function c(_,E,C,T){_.diffuse.value.copy(E.color),_.opacity.value=E.opacity,_.size.value=E.size*C,_.scale.value=T*.5,E.map&&(_.map.value=E.map,t(E.map,_.uvTransform)),E.alphaMap&&(_.alphaMap.value=E.alphaMap,t(E.alphaMap,_.alphaMapTransform)),E.alphaTest>0&&(_.alphaTest.value=E.alphaTest)}function h(_,E){_.diffuse.value.copy(E.color),_.opacity.value=E.opacity,_.rotation.value=E.rotation,E.map&&(_.map.value=E.map,t(E.map,_.mapTransform)),E.alphaMap&&(_.alphaMap.value=E.alphaMap,t(E.alphaMap,_.alphaMapTransform)),E.alphaTest>0&&(_.alphaTest.value=E.alphaTest)}function p(_,E){_.specular.value.copy(E.specular),_.shininess.value=Math.max(E.shininess,1e-4)}function g(_,E){E.gradientMap&&(_.gradientMap.value=E.gradientMap)}function A(_,E){_.metalness.value=E.metalness,E.metalnessMap&&(_.metalnessMap.value=E.metalnessMap,t(E.metalnessMap,_.metalnessMapTransform)),_.roughness.value=E.roughness,E.roughnessMap&&(_.roughnessMap.value=E.roughnessMap,t(E.roughnessMap,_.roughnessMapTransform)),E.envMap&&(_.envMapIntensity.value=E.envMapIntensity)}function v(_,E,C){_.ior.value=E.ior,E.sheen>0&&(_.sheenColor.value.copy(E.sheenColor).multiplyScalar(E.sheen),_.sheenRoughness.value=E.sheenRoughness,E.sheenColorMap&&(_.sheenColorMap.value=E.sheenColorMap,t(E.sheenColorMap,_.sheenColorMapTransform)),E.sheenRoughnessMap&&(_.sheenRoughnessMap.value=E.sheenRoughnessMap,t(E.sheenRoughnessMap,_.sheenRoughnessMapTransform))),E.clearcoat>0&&(_.clearcoat.value=E.clearcoat,_.clearcoatRoughness.value=E.clearcoatRoughness,E.clearcoatMap&&(_.clearcoatMap.value=E.clearcoatMap,t(E.clearcoatMap,_.clearcoatMapTransform)),E.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=E.clearcoatRoughnessMap,t(E.clearcoatRoughnessMap,_.clearcoatRoughnessMapTransform)),E.clearcoatNormalMap&&(_.clearcoatNormalMap.value=E.clearcoatNormalMap,t(E.clearcoatNormalMap,_.clearcoatNormalMapTransform),_.clearcoatNormalScale.value.copy(E.clearcoatNormalScale),E.side===ia&&_.clearcoatNormalScale.value.negate())),E.dispersion>0&&(_.dispersion.value=E.dispersion),E.iridescence>0&&(_.iridescence.value=E.iridescence,_.iridescenceIOR.value=E.iridescenceIOR,_.iridescenceThicknessMinimum.value=E.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=E.iridescenceThicknessRange[1],E.iridescenceMap&&(_.iridescenceMap.value=E.iridescenceMap,t(E.iridescenceMap,_.iridescenceMapTransform)),E.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=E.iridescenceThicknessMap,t(E.iridescenceThicknessMap,_.iridescenceThicknessMapTransform))),E.transmission>0&&(_.transmission.value=E.transmission,_.transmissionSamplerMap.value=C.texture,_.transmissionSamplerSize.value.set(C.width,C.height),E.transmissionMap&&(_.transmissionMap.value=E.transmissionMap,t(E.transmissionMap,_.transmissionMapTransform)),_.thickness.value=E.thickness,E.thicknessMap&&(_.thicknessMap.value=E.thicknessMap,t(E.thicknessMap,_.thicknessMapTransform)),_.attenuationDistance.value=E.attenuationDistance,_.attenuationColor.value.copy(E.attenuationColor)),E.anisotropy>0&&(_.anisotropyVector.value.set(E.anisotropy*Math.cos(E.anisotropyRotation),E.anisotropy*Math.sin(E.anisotropyRotation)),E.anisotropyMap&&(_.anisotropyMap.value=E.anisotropyMap,t(E.anisotropyMap,_.anisotropyMapTransform))),_.specularIntensity.value=E.specularIntensity,_.specularColor.value.copy(E.specularColor),E.specularColorMap&&(_.specularColorMap.value=E.specularColorMap,t(E.specularColorMap,_.specularColorMapTransform)),E.specularIntensityMap&&(_.specularIntensityMap.value=E.specularIntensityMap,t(E.specularIntensityMap,_.specularIntensityMapTransform))}function x(_,E){E.matcap&&(_.matcap.value=E.matcap)}function S(_,E){const C=e.get(E).light;_.referencePosition.value.setFromMatrixPosition(C.matrixWorld),_.nearDistance.value=C.shadow.camera.near,_.farDistance.value=C.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function kZ(n,e,t,i){let r={},s={},a=[];const o=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function c(C,T){const R=T.program;i.uniformBlockBinding(C,R)}function h(C,T){let R=r[C.id];R===void 0&&(x(C),R=p(C),r[C.id]=R,C.addEventListener("dispose",_));const B=T.program;i.updateUBOMapping(C,B);const U=e.render.frame;s[C.id]!==U&&(A(C),s[C.id]=U)}function p(C){const T=g();C.__bindingPointIndex=T;const R=n.createBuffer(),B=C.__size,U=C.usage;return n.bindBuffer(n.UNIFORM_BUFFER,R),n.bufferData(n.UNIFORM_BUFFER,B,U),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,T,R),R}function g(){for(let C=0;C<o;C++)if(a.indexOf(C)===-1)return a.push(C),C;return on("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function A(C){const T=r[C.id],R=C.uniforms,B=C.__cache;n.bindBuffer(n.UNIFORM_BUFFER,T);for(let U=0,O=R.length;U<O;U++){const F=Array.isArray(R[U])?R[U]:[R[U]];for(let L=0,P=F.length;L<P;L++){const W=F[L];if(v(W,U,L,B)===!0){const j=W.__offset,V=Array.isArray(W.value)?W.value:[W.value];let q=0;for(let re=0;re<V.length;re++){const Q=V[re],K=S(Q);typeof Q=="number"||typeof Q=="boolean"?(W.__data[0]=Q,n.bufferSubData(n.UNIFORM_BUFFER,j+q,W.__data)):Q.isMatrix3?(W.__data[0]=Q.elements[0],W.__data[1]=Q.elements[1],W.__data[2]=Q.elements[2],W.__data[3]=0,W.__data[4]=Q.elements[3],W.__data[5]=Q.elements[4],W.__data[6]=Q.elements[5],W.__data[7]=0,W.__data[8]=Q.elements[6],W.__data[9]=Q.elements[7],W.__data[10]=Q.elements[8],W.__data[11]=0):(Q.toArray(W.__data,q),q+=K.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,j,W.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function v(C,T,R,B){const U=C.value,O=T+"_"+R;if(B[O]===void 0)return typeof U=="number"||typeof U=="boolean"?B[O]=U:B[O]=U.clone(),!0;{const F=B[O];if(typeof U=="number"||typeof U=="boolean"){if(F!==U)return B[O]=U,!0}else if(F.equals(U)===!1)return F.copy(U),!0}return!1}function x(C){const T=C.uniforms;let R=0;const B=16;for(let O=0,F=T.length;O<F;O++){const L=Array.isArray(T[O])?T[O]:[T[O]];for(let P=0,W=L.length;P<W;P++){const j=L[P],V=Array.isArray(j.value)?j.value:[j.value];for(let q=0,re=V.length;q<re;q++){const Q=V[q],K=S(Q),ce=R%B,ue=ce%K.boundary,oe=ce+ue;R+=ue,oe!==0&&B-oe<K.storage&&(R+=B-oe),j.__data=new Float32Array(K.storage/Float32Array.BYTES_PER_ELEMENT),j.__offset=R,R+=K.storage}}}const U=R%B;return U>0&&(R+=B-U),C.__size=R,C.__cache={},this}function S(C){const T={boundary:0,storage:0};return typeof C=="number"||typeof C=="boolean"?(T.boundary=4,T.storage=4):C.isVector2?(T.boundary=8,T.storage=8):C.isVector3||C.isColor?(T.boundary=16,T.storage=12):C.isVector4?(T.boundary=16,T.storage=16):C.isMatrix3?(T.boundary=48,T.storage=48):C.isMatrix4?(T.boundary=64,T.storage=64):C.isTexture?Gt("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Gt("WebGLRenderer: Unsupported uniform value type.",C),T}function _(C){const T=C.target;T.removeEventListener("dispose",_);const R=a.indexOf(T.__bindingPointIndex);a.splice(R,1),n.deleteBuffer(r[T.id]),delete r[T.id],delete s[T.id]}function E(){for(const C in r)n.deleteBuffer(r[C]);a=[],r={},s={}}return{bind:c,update:h,dispose:E}}const zZ=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let Fu=null;function GZ(){return Fu===null&&(Fu=new ll(zZ,16,16,ac,ci),Fu.name="DFG_LUT",Fu.minFilter=mn,Fu.magFilter=mn,Fu.wrapS=or,Fu.wrapT=or,Fu.generateMipmaps=!1,Fu.needsUpdate=!0),Fu}class ZM{constructor(e={}){const{canvas:t=y8(),context:i=null,depth:r=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:h=!1,powerPreference:p="default",failIfMajorPerformanceCaveat:g=!1,reversedDepthBuffer:A=!1,outputBufferType:v=xn}=e;this.isWebGLRenderer=!0;let x;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");x=i.getContextAttributes().alpha}else x=a;const S=v,_=new Set([_M,xM,ex]),E=new Set([xn,fl,_0,S0,yM,bM]),C=new Uint32Array(4),T=new Int32Array(4);let R=null,B=null;const U=[],O=[];let F=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=ko,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const L=this;let P=!1;this._outputColorSpace=xi;let W=0,j=0,V=null,q=-1,re=null;const Q=new Ii,K=new Ii;let ce=null;const ue=new Mt(0);let oe=0,z=t.width,$=t.height,ae=1,he=null,me=null;const le=new Ii(0,0,z,$),fe=new Ii(0,0,z,$);let _e=!1;const Pe=new av;let et=!1,ot=!1;const Je=new qt,_t=new ee,Be=new Ii,Le={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Te=!1;function Ye(){return V===null?ae:1}let ne=i;function ft(J,pe){return t.getContext(J,pe)}try{const J={alpha:!0,depth:r,stencil:s,antialias:o,premultipliedAlpha:c,preserveDrawingBuffer:h,powerPreference:p,failIfMajorPerformanceCaveat:g};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${ag}`),t.addEventListener("webglcontextlost",Qt,!1),t.addEventListener("webglcontextrestored",kt,!1),t.addEventListener("webglcontextcreationerror",rn,!1),ne===null){const pe="webgl2";if(ne=ft(pe,J),ne===null)throw ft(pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(J){throw on("WebGLRenderer: "+J.message),J}let qe,Ne,tt,Z,H,de,De,Ie,we,st,it,It,Ot,Qe,Ve,at,bt,ht,Vt,ve,Me,rt,Ut,nt;function ke(){qe=new H$(ne),qe.init(),rt=new m6(ne,qe),Ne=new L$(ne,qe,e,rt),tt=new BZ(ne,qe),Ne.reversedDepthBuffer&&A&&tt.buffers.depth.setReversed(!0),Z=new j$(ne),H=new gZ,de=new DZ(ne,qe,tt,H,Ne,rt,Z),De=new U$(L),Ie=new G$(L),we=new YX(ne),Ut=new B$(ne,we),st=new Q$(ne,we,Z,Ut),it=new q$(ne,st,we,Z),Vt=new W$(ne,Ne,de),at=new N$(H),It=new mZ(L,De,Ie,qe,Ne,Ut,at),Ot=new OZ(L,H),Qe=new vZ,Ve=new EZ(qe),ht=new R$(L,De,Ie,tt,it,x,c),bt=new IZ(L,it,Ne),nt=new kZ(ne,Z,Ne,tt),ve=new D$(ne,qe,Z),Me=new V$(ne,qe,Z),Z.programs=It.programs,L.capabilities=Ne,L.extensions=qe,L.properties=H,L.renderLists=Qe,L.shadowMap=bt,L.state=tt,L.info=Z}ke(),S!==xn&&(F=new Y$(S,t.width,t.height,r,s));const gt=new FZ(L,ne);this.xr=gt,this.getContext=function(){return ne},this.getContextAttributes=function(){return ne.getContextAttributes()},this.forceContextLoss=function(){const J=qe.get("WEBGL_lose_context");J&&J.loseContext()},this.forceContextRestore=function(){const J=qe.get("WEBGL_lose_context");J&&J.restoreContext()},this.getPixelRatio=function(){return ae},this.setPixelRatio=function(J){J!==void 0&&(ae=J,this.setSize(z,$,!1))},this.getSize=function(J){return J.set(z,$)},this.setSize=function(J,pe,xe=!0){if(gt.isPresenting){Gt("WebGLRenderer: Can't change size while VR device is presenting.");return}z=J,$=pe,t.width=Math.floor(J*ae),t.height=Math.floor(pe*ae),xe===!0&&(t.style.width=J+"px",t.style.height=pe+"px"),F!==null&&F.setSize(t.width,t.height),this.setViewport(0,0,J,pe)},this.getDrawingBufferSize=function(J){return J.set(z*ae,$*ae).floor()},this.setDrawingBufferSize=function(J,pe,xe){z=J,$=pe,ae=xe,t.width=Math.floor(J*xe),t.height=Math.floor(pe*xe),this.setViewport(0,0,J,pe)},this.setEffects=function(J){if(S===xn){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(J){for(let pe=0;pe<J.length;pe++)if(J[pe].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}F.setEffects(J||[])},this.getCurrentViewport=function(J){return J.copy(Q)},this.getViewport=function(J){return J.copy(le)},this.setViewport=function(J,pe,xe,Se){J.isVector4?le.set(J.x,J.y,J.z,J.w):le.set(J,pe,xe,Se),tt.viewport(Q.copy(le).multiplyScalar(ae).round())},this.getScissor=function(J){return J.copy(fe)},this.setScissor=function(J,pe,xe,Se){J.isVector4?fe.set(J.x,J.y,J.z,J.w):fe.set(J,pe,xe,Se),tt.scissor(K.copy(fe).multiplyScalar(ae).round())},this.getScissorTest=function(){return _e},this.setScissorTest=function(J){tt.setScissorTest(_e=J)},this.setOpaqueSort=function(J){he=J},this.setTransparentSort=function(J){me=J},this.getClearColor=function(J){return J.copy(ht.getClearColor())},this.setClearColor=function(){ht.setClearColor(...arguments)},this.getClearAlpha=function(){return ht.getClearAlpha()},this.setClearAlpha=function(){ht.setClearAlpha(...arguments)},this.clear=function(J=!0,pe=!0,xe=!0){let Se=0;if(J){let be=!1;if(V!==null){const ct=V.texture.format;be=_.has(ct)}if(be){const ct=V.texture.type,yt=E.has(ct),ut=ht.getClearColor(),Ft=ht.getClearAlpha(),wt=ut.r,Yt=ut.g,Bt=ut.b;yt?(C[0]=wt,C[1]=Yt,C[2]=Bt,C[3]=Ft,ne.clearBufferuiv(ne.COLOR,0,C)):(T[0]=wt,T[1]=Yt,T[2]=Bt,T[3]=Ft,ne.clearBufferiv(ne.COLOR,0,T))}else Se|=ne.COLOR_BUFFER_BIT}pe&&(Se|=ne.DEPTH_BUFFER_BIT),xe&&(Se|=ne.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ne.clear(Se)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Qt,!1),t.removeEventListener("webglcontextrestored",kt,!1),t.removeEventListener("webglcontextcreationerror",rn,!1),ht.dispose(),Qe.dispose(),Ve.dispose(),H.dispose(),De.dispose(),Ie.dispose(),it.dispose(),Ut.dispose(),nt.dispose(),It.dispose(),gt.dispose(),gt.removeEventListener("sessionstart",Ki),gt.removeEventListener("sessionend",Rr),en.stop()};function Qt(J){J.preventDefault(),Ib("WebGLRenderer: Context Lost."),P=!0}function kt(){Ib("WebGLRenderer: Context Restored."),P=!1;const J=Z.autoReset,pe=bt.enabled,xe=bt.autoUpdate,Se=bt.needsUpdate,be=bt.type;ke(),Z.autoReset=J,bt.enabled=pe,bt.autoUpdate=xe,bt.needsUpdate=Se,bt.type=be}function rn(J){on("WebGLRenderer: A WebGL context could not be created. Reason: ",J.statusMessage)}function ti(J){const pe=J.target;pe.removeEventListener("dispose",ti),ui(pe)}function ui(J){vi(J),H.remove(J)}function vi(J){const pe=H.get(J).programs;pe!==void 0&&(pe.forEach(function(xe){It.releaseProgram(xe)}),J.isShaderMaterial&&It.releaseShaderCache(J))}this.renderBufferDirect=function(J,pe,xe,Se,be,ct){pe===null&&(pe=Le);const yt=be.isMesh&&be.matrixWorld.determinant()<0,ut=xt(J,pe,xe,Se,be);tt.setMaterial(Se,yt);let Ft=xe.index,wt=1;if(Se.wireframe===!0){if(Ft=st.getWireframeAttribute(xe),Ft===void 0)return;wt=2}const Yt=xe.drawRange,Bt=xe.attributes.position;let jt=Yt.start*wt,yn=(Yt.start+Yt.count)*wt;ct!==null&&(jt=Math.max(jt,ct.start*wt),yn=Math.min(yn,(ct.start+ct.count)*wt)),Ft!==null?(jt=Math.max(jt,0),yn=Math.min(yn,Ft.count)):Bt!=null&&(jt=Math.max(jt,0),yn=Math.min(yn,Bt.count));const Kn=yn-jt;if(Kn<0||Kn===1/0)return;Ut.setup(be,Se,ut,xe,Ft);let Sn,zt=ve;if(Ft!==null&&(Sn=we.get(Ft),zt=Me,zt.setIndex(Sn)),be.isMesh)Se.wireframe===!0?(tt.setLineWidth(Se.wireframeLinewidth*Ye()),zt.setMode(ne.LINES)):zt.setMode(ne.TRIANGLES);else if(be.isLine){let St=Se.linewidth;St===void 0&&(St=1),tt.setLineWidth(St*Ye()),be.isLineSegments?zt.setMode(ne.LINES):be.isLineLoop?zt.setMode(ne.LINE_LOOP):zt.setMode(ne.LINE_STRIP)}else be.isPoints?zt.setMode(ne.POINTS):be.isSprite&&zt.setMode(ne.TRIANGLES);if(be.isBatchedMesh)if(be._multiDrawInstances!==null)R0("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),zt.renderMultiDrawInstances(be._multiDrawStarts,be._multiDrawCounts,be._multiDrawCount,be._multiDrawInstances);else if(qe.get("WEBGL_multi_draw"))zt.renderMultiDraw(be._multiDrawStarts,be._multiDrawCounts,be._multiDrawCount);else{const St=be._multiDrawStarts,$t=be._multiDrawCounts,Lt=be._multiDrawCount,ni=Ft?we.get(Ft).bytesPerElement:1,$i=H.get(Se).currentProgram.getUniforms();for(let In=0;In<Lt;In++)$i.setValue(ne,"_gl_DrawID",In),zt.render(St[In]/ni,$t[In])}else if(be.isInstancedMesh)zt.renderInstances(jt,Kn,be.count);else if(xe.isInstancedBufferGeometry){const St=xe._maxInstanceCount!==void 0?xe._maxInstanceCount:1/0,$t=Math.min(xe.instanceCount,St);zt.renderInstances(jt,Kn,$t)}else zt.render(jt,Kn)};function yr(J,pe,xe){J.transparent===!0&&J.side===gi&&J.forceSinglePass===!1?(J.side=ia,J.needsUpdate=!0,Ue(J,pe,xe),J.side=cc,J.needsUpdate=!0,Ue(J,pe,xe),J.side=gi):Ue(J,pe,xe)}this.compile=function(J,pe,xe=null){xe===null&&(xe=J),B=Ve.get(xe),B.init(pe),O.push(B),xe.traverseVisible(function(be){be.isLight&&be.layers.test(pe.layers)&&(B.pushLight(be),be.castShadow&&B.pushShadow(be))}),J!==xe&&J.traverseVisible(function(be){be.isLight&&be.layers.test(pe.layers)&&(B.pushLight(be),be.castShadow&&B.pushShadow(be))}),B.setupLights();const Se=new Set;return J.traverse(function(be){if(!(be.isMesh||be.isPoints||be.isLine||be.isSprite))return;const ct=be.material;if(ct)if(Array.isArray(ct))for(let yt=0;yt<ct.length;yt++){const ut=ct[yt];yr(ut,xe,be),Se.add(ut)}else yr(ct,xe,be),Se.add(ct)}),B=O.pop(),Se},this.compileAsync=function(J,pe,xe=null){const Se=this.compile(J,pe,xe);return new Promise(be=>{function ct(){if(Se.forEach(function(yt){H.get(yt).currentProgram.isReady()&&Se.delete(yt)}),Se.size===0){be(J);return}setTimeout(ct,10)}qe.get("KHR_parallel_shader_compile")!==null?ct():setTimeout(ct,10)})};let Ir=null;function qr(J){Ir&&Ir(J)}function Ki(){en.stop()}function Rr(){en.start()}const en=new u6;en.setAnimationLoop(qr),typeof self<"u"&&en.setContext(self),this.setAnimationLoop=function(J){Ir=J,gt.setAnimationLoop(J),J===null?en.stop():en.start()},gt.addEventListener("sessionstart",Ki),gt.addEventListener("sessionend",Rr),this.render=function(J,pe){if(pe!==void 0&&pe.isCamera!==!0){on("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(P===!0)return;const xe=gt.enabled===!0&&gt.isPresenting===!0,Se=F!==null&&(V===null||xe)&&F.begin(L,V);if(J.matrixWorldAutoUpdate===!0&&J.updateMatrixWorld(),pe.parent===null&&pe.matrixWorldAutoUpdate===!0&&pe.updateMatrixWorld(),gt.enabled===!0&&gt.isPresenting===!0&&(F===null||F.isCompositing()===!1)&&(gt.cameraAutoUpdate===!0&&gt.updateCamera(pe),pe=gt.getCamera()),J.isScene===!0&&J.onBeforeRender(L,J,pe,V),B=Ve.get(J,O.length),B.init(pe),O.push(B),Je.multiplyMatrices(pe.projectionMatrix,pe.matrixWorldInverse),Pe.setFromProjectionMatrix(Je,rl,pe.reversedDepth),ot=this.localClippingEnabled,et=at.init(this.clippingPlanes,ot),R=Qe.get(J,U.length),R.init(),U.push(R),gt.enabled===!0&&gt.isPresenting===!0){const yt=L.xr.getDepthSensingMesh();yt!==null&&di(yt,pe,-1/0,L.sortObjects)}di(J,pe,0,L.sortObjects),R.finish(),L.sortObjects===!0&&R.sort(he,me),Te=gt.enabled===!1||gt.isPresenting===!1||gt.hasDepthSensing()===!1,Te&&ht.addToRenderList(R,J),this.info.render.frame++,et===!0&&at.beginShadows();const be=B.state.shadowsArray;if(bt.render(be,J,pe),et===!0&&at.endShadows(),this.info.autoReset===!0&&this.info.reset(),(Se&&F.hasRenderPass())===!1){const yt=R.opaque,ut=R.transmissive;if(B.setupLights(),pe.isArrayCamera){const Ft=pe.cameras;if(ut.length>0)for(let wt=0,Yt=Ft.length;wt<Yt;wt++){const Bt=Ft[wt];Y(yt,ut,J,Bt)}Te&&ht.render(J);for(let wt=0,Yt=Ft.length;wt<Yt;wt++){const Bt=Ft[wt];hi(R,J,Bt,Bt.viewport)}}else ut.length>0&&Y(yt,ut,J,pe),Te&&ht.render(J),hi(R,J,pe)}V!==null&&j===0&&(de.updateMultisampleRenderTarget(V),de.updateRenderTargetMipmap(V)),Se&&F.end(L),J.isScene===!0&&J.onAfterRender(L,J,pe),Ut.resetDefaultState(),q=-1,re=null,O.pop(),O.length>0?(B=O[O.length-1],et===!0&&at.setGlobalState(L.clippingPlanes,B.state.camera)):B=null,U.pop(),U.length>0?R=U[U.length-1]:R=null};function di(J,pe,xe,Se){if(J.visible===!1)return;if(J.layers.test(pe.layers)){if(J.isGroup)xe=J.renderOrder;else if(J.isLOD)J.autoUpdate===!0&&J.update(pe);else if(J.isLight)B.pushLight(J),J.castShadow&&B.pushShadow(J);else if(J.isSprite){if(!J.frustumCulled||Pe.intersectsSprite(J)){Se&&Be.setFromMatrixPosition(J.matrixWorld).applyMatrix4(Je);const yt=it.update(J),ut=J.material;ut.visible&&R.push(J,yt,ut,xe,Be.z,null)}}else if((J.isMesh||J.isLine||J.isPoints)&&(!J.frustumCulled||Pe.intersectsObject(J))){const yt=it.update(J),ut=J.material;if(Se&&(J.boundingSphere!==void 0?(J.boundingSphere===null&&J.computeBoundingSphere(),Be.copy(J.boundingSphere.center)):(yt.boundingSphere===null&&yt.computeBoundingSphere(),Be.copy(yt.boundingSphere.center)),Be.applyMatrix4(J.matrixWorld).applyMatrix4(Je)),Array.isArray(ut)){const Ft=yt.groups;for(let wt=0,Yt=Ft.length;wt<Yt;wt++){const Bt=Ft[wt],jt=ut[Bt.materialIndex];jt&&jt.visible&&R.push(J,yt,jt,xe,Be.z,Bt)}}else ut.visible&&R.push(J,yt,ut,xe,Be.z,null)}}const ct=J.children;for(let yt=0,ut=ct.length;yt<ut;yt++)di(ct[yt],pe,xe,Se)}function hi(J,pe,xe,Se){const{opaque:be,transmissive:ct,transparent:yt}=J;B.setupLightsView(xe),et===!0&&at.setGlobalState(L.clippingPlanes,xe),Se&&tt.viewport(Q.copy(Se)),be.length>0&&se(be,pe,xe),ct.length>0&&se(ct,pe,xe),yt.length>0&&se(yt,pe,xe),tt.buffers.depth.setTest(!0),tt.buffers.depth.setMask(!0),tt.buffers.color.setMask(!0),tt.setPolygonOffset(!1)}function Y(J,pe,xe,Se){if((xe.isScene===!0?xe.overrideMaterial:null)!==null)return;if(B.state.transmissionRenderTarget[Se.id]===void 0){const jt=qe.has("EXT_color_buffer_half_float")||qe.has("EXT_color_buffer_float");B.state.transmissionRenderTarget[Se.id]=new Vr(1,1,{generateMipmaps:!0,type:jt?ci:xn,minFilter:ya,samples:Ne.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Wn.workingColorSpace})}const ct=B.state.transmissionRenderTarget[Se.id],yt=Se.viewport||Q;ct.setSize(yt.z*L.transmissionResolutionScale,yt.w*L.transmissionResolutionScale);const ut=L.getRenderTarget(),Ft=L.getActiveCubeFace(),wt=L.getActiveMipmapLevel();L.setRenderTarget(ct),L.getClearColor(ue),oe=L.getClearAlpha(),oe<1&&L.setClearColor(16777215,.5),L.clear(),Te&&ht.render(xe);const Yt=L.toneMapping;L.toneMapping=ko;const Bt=Se.viewport;if(Se.viewport!==void 0&&(Se.viewport=void 0),B.setupLightsView(Se),et===!0&&at.setGlobalState(L.clippingPlanes,Se),se(J,xe,Se),de.updateMultisampleRenderTarget(ct),de.updateRenderTargetMipmap(ct),qe.has("WEBGL_multisampled_render_to_texture")===!1){let jt=!1;for(let yn=0,Kn=pe.length;yn<Kn;yn++){const Sn=pe[yn],{object:zt,geometry:St,material:$t,group:Lt}=Sn;if($t.side===gi&&zt.layers.test(Se.layers)){const ni=$t.side;$t.side=ia,$t.needsUpdate=!0,ge(zt,xe,Se,St,$t,Lt),$t.side=ni,$t.needsUpdate=!0,jt=!0}}jt===!0&&(de.updateMultisampleRenderTarget(ct),de.updateRenderTargetMipmap(ct))}L.setRenderTarget(ut,Ft,wt),L.setClearColor(ue,oe),Bt!==void 0&&(Se.viewport=Bt),L.toneMapping=Yt}function se(J,pe,xe){const Se=pe.isScene===!0?pe.overrideMaterial:null;for(let be=0,ct=J.length;be<ct;be++){const yt=J[be],{object:ut,geometry:Ft,group:wt}=yt;let Yt=yt.material;Yt.allowOverride===!0&&Se!==null&&(Yt=Se),ut.layers.test(xe.layers)&&ge(ut,pe,xe,Ft,Yt,wt)}}function ge(J,pe,xe,Se,be,ct){J.onBeforeRender(L,pe,xe,Se,be,ct),J.modelViewMatrix.multiplyMatrices(xe.matrixWorldInverse,J.matrixWorld),J.normalMatrix.getNormalMatrix(J.modelViewMatrix),be.onBeforeRender(L,pe,xe,Se,J,ct),be.transparent===!0&&be.side===gi&&be.forceSinglePass===!1?(be.side=ia,be.needsUpdate=!0,L.renderBufferDirect(xe,pe,Se,be,J,ct),be.side=cc,be.needsUpdate=!0,L.renderBufferDirect(xe,pe,Se,be,J,ct),be.side=gi):L.renderBufferDirect(xe,pe,Se,be,J,ct),J.onAfterRender(L,pe,xe,Se,be,ct)}function Ue(J,pe,xe){pe.isScene!==!0&&(pe=Le);const Se=H.get(J),be=B.state.lights,ct=B.state.shadowsArray,yt=be.state.version,ut=It.getParameters(J,be.state,ct,pe,xe),Ft=It.getProgramCacheKey(ut);let wt=Se.programs;Se.environment=J.isMeshStandardMaterial?pe.environment:null,Se.fog=pe.fog,Se.envMap=(J.isMeshStandardMaterial?Ie:De).get(J.envMap||Se.environment),Se.envMapRotation=Se.environment!==null&&J.envMap===null?pe.environmentRotation:J.envMapRotation,wt===void 0&&(J.addEventListener("dispose",ti),wt=new Map,Se.programs=wt);let Yt=wt.get(Ft);if(Yt!==void 0){if(Se.currentProgram===Yt&&Se.lightsStateVersion===yt)return Xe(J,ut),Yt}else ut.uniforms=It.getUniforms(J),J.onBeforeCompile(ut,L),Yt=It.acquireProgram(ut,Ft),wt.set(Ft,Yt),Se.uniforms=ut.uniforms;const Bt=Se.uniforms;return(!J.isShaderMaterial&&!J.isRawShaderMaterial||J.clipping===!0)&&(Bt.clippingPlanes=at.uniform),Xe(J,ut),Se.needsLights=Ct(J),Se.lightsStateVersion=yt,Se.needsLights&&(Bt.ambientLightColor.value=be.state.ambient,Bt.lightProbe.value=be.state.probe,Bt.directionalLights.value=be.state.directional,Bt.directionalLightShadows.value=be.state.directionalShadow,Bt.spotLights.value=be.state.spot,Bt.spotLightShadows.value=be.state.spotShadow,Bt.rectAreaLights.value=be.state.rectArea,Bt.ltc_1.value=be.state.rectAreaLTC1,Bt.ltc_2.value=be.state.rectAreaLTC2,Bt.pointLights.value=be.state.point,Bt.pointLightShadows.value=be.state.pointShadow,Bt.hemisphereLights.value=be.state.hemi,Bt.directionalShadowMap.value=be.state.directionalShadowMap,Bt.directionalShadowMatrix.value=be.state.directionalShadowMatrix,Bt.spotShadowMap.value=be.state.spotShadowMap,Bt.spotLightMatrix.value=be.state.spotLightMatrix,Bt.spotLightMap.value=be.state.spotLightMap,Bt.pointShadowMap.value=be.state.pointShadowMap,Bt.pointShadowMatrix.value=be.state.pointShadowMatrix),Se.currentProgram=Yt,Se.uniformsList=null,Yt}function je(J){if(J.uniformsList===null){const pe=J.currentProgram.getUniforms();J.uniformsList=jE.seqWithValue(pe.seq,J.uniforms)}return J.uniformsList}function Xe(J,pe){const xe=H.get(J);xe.outputColorSpace=pe.outputColorSpace,xe.batching=pe.batching,xe.batchingColor=pe.batchingColor,xe.instancing=pe.instancing,xe.instancingColor=pe.instancingColor,xe.instancingMorph=pe.instancingMorph,xe.skinning=pe.skinning,xe.morphTargets=pe.morphTargets,xe.morphNormals=pe.morphNormals,xe.morphColors=pe.morphColors,xe.morphTargetsCount=pe.morphTargetsCount,xe.numClippingPlanes=pe.numClippingPlanes,xe.numIntersection=pe.numClipIntersection,xe.vertexAlphas=pe.vertexAlphas,xe.vertexTangents=pe.vertexTangents,xe.toneMapping=pe.toneMapping}function xt(J,pe,xe,Se,be){pe.isScene!==!0&&(pe=Le),de.resetTextureUnits();const ct=pe.fog,yt=Se.isMeshStandardMaterial?pe.environment:null,ut=V===null?L.outputColorSpace:V.isXRRenderTarget===!0?V.texture.colorSpace:Xi,Ft=(Se.isMeshStandardMaterial?Ie:De).get(Se.envMap||yt),wt=Se.vertexColors===!0&&!!xe.attributes.color&&xe.attributes.color.itemSize===4,Yt=!!xe.attributes.tangent&&(!!Se.normalMap||Se.anisotropy>0),Bt=!!xe.morphAttributes.position,jt=!!xe.morphAttributes.normal,yn=!!xe.morphAttributes.color;let Kn=ko;Se.toneMapped&&(V===null||V.isXRRenderTarget===!0)&&(Kn=L.toneMapping);const Sn=xe.morphAttributes.position||xe.morphAttributes.normal||xe.morphAttributes.color,zt=Sn!==void 0?Sn.length:0,St=H.get(Se),$t=B.state.lights;if(et===!0&&(ot===!0||J!==re)){const Br=J===re&&Se.id===q;at.setState(Se,J,Br)}let Lt=!1;Se.version===St.__version?(St.needsLights&&St.lightsStateVersion!==$t.state.version||St.outputColorSpace!==ut||be.isBatchedMesh&&St.batching===!1||!be.isBatchedMesh&&St.batching===!0||be.isBatchedMesh&&St.batchingColor===!0&&be.colorTexture===null||be.isBatchedMesh&&St.batchingColor===!1&&be.colorTexture!==null||be.isInstancedMesh&&St.instancing===!1||!be.isInstancedMesh&&St.instancing===!0||be.isSkinnedMesh&&St.skinning===!1||!be.isSkinnedMesh&&St.skinning===!0||be.isInstancedMesh&&St.instancingColor===!0&&be.instanceColor===null||be.isInstancedMesh&&St.instancingColor===!1&&be.instanceColor!==null||be.isInstancedMesh&&St.instancingMorph===!0&&be.morphTexture===null||be.isInstancedMesh&&St.instancingMorph===!1&&be.morphTexture!==null||St.envMap!==Ft||Se.fog===!0&&St.fog!==ct||St.numClippingPlanes!==void 0&&(St.numClippingPlanes!==at.numPlanes||St.numIntersection!==at.numIntersection)||St.vertexAlphas!==wt||St.vertexTangents!==Yt||St.morphTargets!==Bt||St.morphNormals!==jt||St.morphColors!==yn||St.toneMapping!==Kn||St.morphTargetsCount!==zt)&&(Lt=!0):(Lt=!0,St.__version=Se.version);let ni=St.currentProgram;Lt===!0&&(ni=Ue(Se,pe,be));let $i=!1,In=!1,Oi=!1;const $n=ni.getUniforms(),Ji=St.uniforms;if(tt.useProgram(ni.program)&&($i=!0,In=!0,Oi=!0),Se.id!==q&&(q=Se.id,In=!0),$i||re!==J){tt.buffers.depth.getReversed()&&J.reversedDepth!==!0&&(J._reversedDepth=!0,J.updateProjectionMatrix()),$n.setValue(ne,"projectionMatrix",J.projectionMatrix),$n.setValue(ne,"viewMatrix",J.matrixWorldInverse);const Dr=$n.map.cameraPosition;Dr!==void 0&&Dr.setValue(ne,_t.setFromMatrixPosition(J.matrixWorld)),Ne.logarithmicDepthBuffer&&$n.setValue(ne,"logDepthBufFC",2/(Math.log(J.far+1)/Math.LN2)),(Se.isMeshPhongMaterial||Se.isMeshToonMaterial||Se.isMeshLambertMaterial||Se.isMeshBasicMaterial||Se.isMeshStandardMaterial||Se.isShaderMaterial)&&$n.setValue(ne,"isOrthographic",J.isOrthographicCamera===!0),re!==J&&(re=J,In=!0,Oi=!0)}if(St.needsLights&&($t.state.directionalShadowMap.length>0&&$n.setValue(ne,"directionalShadowMap",$t.state.directionalShadowMap,de),$t.state.spotShadowMap.length>0&&$n.setValue(ne,"spotShadowMap",$t.state.spotShadowMap,de),$t.state.pointShadowMap.length>0&&$n.setValue(ne,"pointShadowMap",$t.state.pointShadowMap,de)),be.isSkinnedMesh){$n.setOptional(ne,be,"bindMatrix"),$n.setOptional(ne,be,"bindMatrixInverse");const Br=be.skeleton;Br&&(Br.boneTexture===null&&Br.computeBoneTexture(),$n.setValue(ne,"boneTexture",Br.boneTexture,de))}be.isBatchedMesh&&($n.setOptional(ne,be,"batchingTexture"),$n.setValue(ne,"batchingTexture",be._matricesTexture,de),$n.setOptional(ne,be,"batchingIdTexture"),$n.setValue(ne,"batchingIdTexture",be._indirectTexture,de),$n.setOptional(ne,be,"batchingColorTexture"),be._colorsTexture!==null&&$n.setValue(ne,"batchingColorTexture",be._colorsTexture,de));const Zi=xe.morphAttributes;if((Zi.position!==void 0||Zi.normal!==void 0||Zi.color!==void 0)&&Vt.update(be,xe,ni),(In||St.receiveShadow!==be.receiveShadow)&&(St.receiveShadow=be.receiveShadow,$n.setValue(ne,"receiveShadow",be.receiveShadow)),Se.isMeshGouraudMaterial&&Se.envMap!==null&&(Ji.envMap.value=Ft,Ji.flipEnvMap.value=Ft.isCubeTexture&&Ft.isRenderTargetTexture===!1?-1:1),Se.isMeshStandardMaterial&&Se.envMap===null&&pe.environment!==null&&(Ji.envMapIntensity.value=pe.environmentIntensity),Ji.dfgLUT!==void 0&&(Ji.dfgLUT.value=GZ()),In&&($n.setValue(ne,"toneMappingExposure",L.toneMappingExposure),St.needsLights&&At(Ji,Oi),ct&&Se.fog===!0&&Ot.refreshFogUniforms(Ji,ct),Ot.refreshMaterialUniforms(Ji,Se,ae,$,B.state.transmissionRenderTarget[J.id]),jE.upload(ne,je(St),Ji,de)),Se.isShaderMaterial&&Se.uniformsNeedUpdate===!0&&(jE.upload(ne,je(St),Ji,de),Se.uniformsNeedUpdate=!1),Se.isSpriteMaterial&&$n.setValue(ne,"center",be.center),$n.setValue(ne,"modelViewMatrix",be.modelViewMatrix),$n.setValue(ne,"normalMatrix",be.normalMatrix),$n.setValue(ne,"modelMatrix",be.matrixWorld),Se.isShaderMaterial||Se.isRawShaderMaterial){const Br=Se.uniformsGroups;for(let Dr=0,Ho=Br.length;Dr<Ho;Dr++){const ps=Br[Dr];nt.update(ps,ni),nt.bind(ps,ni)}}return ni}function At(J,pe){J.ambientLightColor.needsUpdate=pe,J.lightProbe.needsUpdate=pe,J.directionalLights.needsUpdate=pe,J.directionalLightShadows.needsUpdate=pe,J.pointLights.needsUpdate=pe,J.pointLightShadows.needsUpdate=pe,J.spotLights.needsUpdate=pe,J.spotLightShadows.needsUpdate=pe,J.rectAreaLights.needsUpdate=pe,J.hemisphereLights.needsUpdate=pe}function Ct(J){return J.isMeshLambertMaterial||J.isMeshToonMaterial||J.isMeshPhongMaterial||J.isMeshStandardMaterial||J.isShadowMaterial||J.isShaderMaterial&&J.lights===!0}this.getActiveCubeFace=function(){return W},this.getActiveMipmapLevel=function(){return j},this.getRenderTarget=function(){return V},this.setRenderTargetTextures=function(J,pe,xe){const Se=H.get(J);Se.__autoAllocateDepthBuffer=J.resolveDepthBuffer===!1,Se.__autoAllocateDepthBuffer===!1&&(Se.__useRenderToTexture=!1),H.get(J.texture).__webglTexture=pe,H.get(J.depthTexture).__webglTexture=Se.__autoAllocateDepthBuffer?void 0:xe,Se.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(J,pe){const xe=H.get(J);xe.__webglFramebuffer=pe,xe.__useDefaultFramebuffer=pe===void 0};const Tt=ne.createFramebuffer();this.setRenderTarget=function(J,pe=0,xe=0){V=J,W=pe,j=xe;let Se=null,be=!1,ct=!1;if(J){const ut=H.get(J);if(ut.__useDefaultFramebuffer!==void 0){tt.bindFramebuffer(ne.FRAMEBUFFER,ut.__webglFramebuffer),Q.copy(J.viewport),K.copy(J.scissor),ce=J.scissorTest,tt.viewport(Q),tt.scissor(K),tt.setScissorTest(ce),q=-1;return}else if(ut.__webglFramebuffer===void 0)de.setupRenderTarget(J);else if(ut.__hasExternalTextures)de.rebindTextures(J,H.get(J.texture).__webglTexture,H.get(J.depthTexture).__webglTexture);else if(J.depthBuffer){const Yt=J.depthTexture;if(ut.__boundDepthTexture!==Yt){if(Yt!==null&&H.has(Yt)&&(J.width!==Yt.image.width||J.height!==Yt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");de.setupDepthRenderbuffer(J)}}const Ft=J.texture;(Ft.isData3DTexture||Ft.isDataArrayTexture||Ft.isCompressedArrayTexture)&&(ct=!0);const wt=H.get(J).__webglFramebuffer;J.isWebGLCubeRenderTarget?(Array.isArray(wt[pe])?Se=wt[pe][xe]:Se=wt[pe],be=!0):J.samples>0&&de.useMultisampledRTT(J)===!1?Se=H.get(J).__webglMultisampledFramebuffer:Array.isArray(wt)?Se=wt[xe]:Se=wt,Q.copy(J.viewport),K.copy(J.scissor),ce=J.scissorTest}else Q.copy(le).multiplyScalar(ae).floor(),K.copy(fe).multiplyScalar(ae).floor(),ce=_e;if(xe!==0&&(Se=Tt),tt.bindFramebuffer(ne.FRAMEBUFFER,Se)&&tt.drawBuffers(J,Se),tt.viewport(Q),tt.scissor(K),tt.setScissorTest(ce),be){const ut=H.get(J.texture);ne.framebufferTexture2D(ne.FRAMEBUFFER,ne.COLOR_ATTACHMENT0,ne.TEXTURE_CUBE_MAP_POSITIVE_X+pe,ut.__webglTexture,xe)}else if(ct){const ut=pe;for(let Ft=0;Ft<J.textures.length;Ft++){const wt=H.get(J.textures[Ft]);ne.framebufferTextureLayer(ne.FRAMEBUFFER,ne.COLOR_ATTACHMENT0+Ft,wt.__webglTexture,xe,ut)}}else if(J!==null&&xe!==0){const ut=H.get(J.texture);ne.framebufferTexture2D(ne.FRAMEBUFFER,ne.COLOR_ATTACHMENT0,ne.TEXTURE_2D,ut.__webglTexture,xe)}q=-1},this.readRenderTargetPixels=function(J,pe,xe,Se,be,ct,yt,ut=0){if(!(J&&J.isWebGLRenderTarget)){on("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ft=H.get(J).__webglFramebuffer;if(J.isWebGLCubeRenderTarget&&yt!==void 0&&(Ft=Ft[yt]),Ft){tt.bindFramebuffer(ne.FRAMEBUFFER,Ft);try{const wt=J.textures[ut],Yt=wt.format,Bt=wt.type;if(!Ne.textureFormatReadable(Yt)){on("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ne.textureTypeReadable(Bt)){on("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}pe>=0&&pe<=J.width-Se&&xe>=0&&xe<=J.height-be&&(J.textures.length>1&&ne.readBuffer(ne.COLOR_ATTACHMENT0+ut),ne.readPixels(pe,xe,Se,be,rt.convert(Yt),rt.convert(Bt),ct))}finally{const wt=V!==null?H.get(V).__webglFramebuffer:null;tt.bindFramebuffer(ne.FRAMEBUFFER,wt)}}},this.readRenderTargetPixelsAsync=async function(J,pe,xe,Se,be,ct,yt,ut=0){if(!(J&&J.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ft=H.get(J).__webglFramebuffer;if(J.isWebGLCubeRenderTarget&&yt!==void 0&&(Ft=Ft[yt]),Ft)if(pe>=0&&pe<=J.width-Se&&xe>=0&&xe<=J.height-be){tt.bindFramebuffer(ne.FRAMEBUFFER,Ft);const wt=J.textures[ut],Yt=wt.format,Bt=wt.type;if(!Ne.textureFormatReadable(Yt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ne.textureTypeReadable(Bt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const jt=ne.createBuffer();ne.bindBuffer(ne.PIXEL_PACK_BUFFER,jt),ne.bufferData(ne.PIXEL_PACK_BUFFER,ct.byteLength,ne.STREAM_READ),J.textures.length>1&&ne.readBuffer(ne.COLOR_ATTACHMENT0+ut),ne.readPixels(pe,xe,Se,be,rt.convert(Yt),rt.convert(Bt),0);const yn=V!==null?H.get(V).__webglFramebuffer:null;tt.bindFramebuffer(ne.FRAMEBUFFER,yn);const Kn=ne.fenceSync(ne.SYNC_GPU_COMMANDS_COMPLETE,0);return ne.flush(),await lW(ne,Kn,4),ne.bindBuffer(ne.PIXEL_PACK_BUFFER,jt),ne.getBufferSubData(ne.PIXEL_PACK_BUFFER,0,ct),ne.deleteBuffer(jt),ne.deleteSync(Kn),ct}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(J,pe=null,xe=0){const Se=Math.pow(2,-xe),be=Math.floor(J.image.width*Se),ct=Math.floor(J.image.height*Se),yt=pe!==null?pe.x:0,ut=pe!==null?pe.y:0;de.setTexture2D(J,0),ne.copyTexSubImage2D(ne.TEXTURE_2D,xe,0,0,yt,ut,be,ct),tt.unbindTexture()};const Dt=ne.createFramebuffer(),He=ne.createFramebuffer();this.copyTextureToTexture=function(J,pe,xe=null,Se=null,be=0,ct=null){ct===null&&(be!==0?(R0("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),ct=be,be=0):ct=0);let yt,ut,Ft,wt,Yt,Bt,jt,yn,Kn;const Sn=J.isCompressedTexture?J.mipmaps[ct]:J.image;if(xe!==null)yt=xe.max.x-xe.min.x,ut=xe.max.y-xe.min.y,Ft=xe.isBox3?xe.max.z-xe.min.z:1,wt=xe.min.x,Yt=xe.min.y,Bt=xe.isBox3?xe.min.z:0;else{const Zi=Math.pow(2,-be);yt=Math.floor(Sn.width*Zi),ut=Math.floor(Sn.height*Zi),J.isDataArrayTexture?Ft=Sn.depth:J.isData3DTexture?Ft=Math.floor(Sn.depth*Zi):Ft=1,wt=0,Yt=0,Bt=0}Se!==null?(jt=Se.x,yn=Se.y,Kn=Se.z):(jt=0,yn=0,Kn=0);const zt=rt.convert(pe.format),St=rt.convert(pe.type);let $t;pe.isData3DTexture?(de.setTexture3D(pe,0),$t=ne.TEXTURE_3D):pe.isDataArrayTexture||pe.isCompressedArrayTexture?(de.setTexture2DArray(pe,0),$t=ne.TEXTURE_2D_ARRAY):(de.setTexture2D(pe,0),$t=ne.TEXTURE_2D),ne.pixelStorei(ne.UNPACK_FLIP_Y_WEBGL,pe.flipY),ne.pixelStorei(ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL,pe.premultiplyAlpha),ne.pixelStorei(ne.UNPACK_ALIGNMENT,pe.unpackAlignment);const Lt=ne.getParameter(ne.UNPACK_ROW_LENGTH),ni=ne.getParameter(ne.UNPACK_IMAGE_HEIGHT),$i=ne.getParameter(ne.UNPACK_SKIP_PIXELS),In=ne.getParameter(ne.UNPACK_SKIP_ROWS),Oi=ne.getParameter(ne.UNPACK_SKIP_IMAGES);ne.pixelStorei(ne.UNPACK_ROW_LENGTH,Sn.width),ne.pixelStorei(ne.UNPACK_IMAGE_HEIGHT,Sn.height),ne.pixelStorei(ne.UNPACK_SKIP_PIXELS,wt),ne.pixelStorei(ne.UNPACK_SKIP_ROWS,Yt),ne.pixelStorei(ne.UNPACK_SKIP_IMAGES,Bt);const $n=J.isDataArrayTexture||J.isData3DTexture,Ji=pe.isDataArrayTexture||pe.isData3DTexture;if(J.isDepthTexture){const Zi=H.get(J),Br=H.get(pe),Dr=H.get(Zi.__renderTarget),Ho=H.get(Br.__renderTarget);tt.bindFramebuffer(ne.READ_FRAMEBUFFER,Dr.__webglFramebuffer),tt.bindFramebuffer(ne.DRAW_FRAMEBUFFER,Ho.__webglFramebuffer);for(let ps=0;ps<Ft;ps++)$n&&(ne.framebufferTextureLayer(ne.READ_FRAMEBUFFER,ne.COLOR_ATTACHMENT0,H.get(J).__webglTexture,be,Bt+ps),ne.framebufferTextureLayer(ne.DRAW_FRAMEBUFFER,ne.COLOR_ATTACHMENT0,H.get(pe).__webglTexture,ct,Kn+ps)),ne.blitFramebuffer(wt,Yt,yt,ut,jt,yn,yt,ut,ne.DEPTH_BUFFER_BIT,ne.NEAREST);tt.bindFramebuffer(ne.READ_FRAMEBUFFER,null),tt.bindFramebuffer(ne.DRAW_FRAMEBUFFER,null)}else if(be!==0||J.isRenderTargetTexture||H.has(J)){const Zi=H.get(J),Br=H.get(pe);tt.bindFramebuffer(ne.READ_FRAMEBUFFER,Dt),tt.bindFramebuffer(ne.DRAW_FRAMEBUFFER,He);for(let Dr=0;Dr<Ft;Dr++)$n?ne.framebufferTextureLayer(ne.READ_FRAMEBUFFER,ne.COLOR_ATTACHMENT0,Zi.__webglTexture,be,Bt+Dr):ne.framebufferTexture2D(ne.READ_FRAMEBUFFER,ne.COLOR_ATTACHMENT0,ne.TEXTURE_2D,Zi.__webglTexture,be),Ji?ne.framebufferTextureLayer(ne.DRAW_FRAMEBUFFER,ne.COLOR_ATTACHMENT0,Br.__webglTexture,ct,Kn+Dr):ne.framebufferTexture2D(ne.DRAW_FRAMEBUFFER,ne.COLOR_ATTACHMENT0,ne.TEXTURE_2D,Br.__webglTexture,ct),be!==0?ne.blitFramebuffer(wt,Yt,yt,ut,jt,yn,yt,ut,ne.COLOR_BUFFER_BIT,ne.NEAREST):Ji?ne.copyTexSubImage3D($t,ct,jt,yn,Kn+Dr,wt,Yt,yt,ut):ne.copyTexSubImage2D($t,ct,jt,yn,wt,Yt,yt,ut);tt.bindFramebuffer(ne.READ_FRAMEBUFFER,null),tt.bindFramebuffer(ne.DRAW_FRAMEBUFFER,null)}else Ji?J.isDataTexture||J.isData3DTexture?ne.texSubImage3D($t,ct,jt,yn,Kn,yt,ut,Ft,zt,St,Sn.data):pe.isCompressedArrayTexture?ne.compressedTexSubImage3D($t,ct,jt,yn,Kn,yt,ut,Ft,zt,Sn.data):ne.texSubImage3D($t,ct,jt,yn,Kn,yt,ut,Ft,zt,St,Sn):J.isDataTexture?ne.texSubImage2D(ne.TEXTURE_2D,ct,jt,yn,yt,ut,zt,St,Sn.data):J.isCompressedTexture?ne.compressedTexSubImage2D(ne.TEXTURE_2D,ct,jt,yn,Sn.width,Sn.height,zt,Sn.data):ne.texSubImage2D(ne.TEXTURE_2D,ct,jt,yn,yt,ut,zt,St,Sn);ne.pixelStorei(ne.UNPACK_ROW_LENGTH,Lt),ne.pixelStorei(ne.UNPACK_IMAGE_HEIGHT,ni),ne.pixelStorei(ne.UNPACK_SKIP_PIXELS,$i),ne.pixelStorei(ne.UNPACK_SKIP_ROWS,In),ne.pixelStorei(ne.UNPACK_SKIP_IMAGES,Oi),ct===0&&pe.generateMipmaps&&ne.generateMipmap($t),tt.unbindTexture()},this.initRenderTarget=function(J){H.get(J).__webglFramebuffer===void 0&&de.setupRenderTarget(J)},this.initTexture=function(J){J.isCubeTexture?de.setTextureCube(J,0):J.isData3DTexture?de.setTexture3D(J,0):J.isDataArrayTexture||J.isCompressedArrayTexture?de.setTexture2DArray(J,0):de.setTexture2D(J,0),tt.unbindTexture()},this.resetState=function(){W=0,j=0,V=null,tt.reset(),Ut.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return rl}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Wn._getDrawingBufferColorSpace(e),t.unpackColorSpace=Wn._getUnpackColorSpace()}}const HZ=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:Kb,AddEquation:Md,AddOperation:s8,AdditiveAnimationBlendMode:t4,AdditiveBlending:RR,AgXToneMapping:gM,AlphaFormat:e4,AlwaysCompare:g8,AlwaysDepth:uw,AlwaysStencilFunc:UR,AmbientLight:YM,AnimationAction:a6,AnimationClip:F0,AnimationLoader:qq,AnimationMixer:o6,AnimationObjectGroup:gX,AnimationUtils:Qq,ArcCurve:R8,ArrayCamera:i6,ArrowHelper:zX,AttachedBindMode:LR,Audio:r6,AudioAnalyser:aX,AudioContext:R4,AudioListener:iX,AudioLoader:eX,AxesHelper:GX,BackSide:ia,BasicDepthPacking:l8,BasicShadowMap:kk,BatchedMesh:w8,Bone:RM,BooleanKeyframeTrack:og,Box2:l6,Box3:gr,Box3Helper:OX,BoxGeometry:ba,BoxHelper:PX,BufferAttribute:An,BufferGeometry:vn,BufferGeometryLoader:t6,ByteType:AM,Cache:Xu,Camera:CM,CameraHelper:FX,CanvasTexture:d4,CapsuleGeometry:UM,CatmullRomCurve3:B8,CineonToneMapping:mM,CircleGeometry:Vm,ClampToEdgeWrapping:or,Clock:B4,Color:Mt,ColorKeyframeTrack:S4,ColorManagement:Wn,CompressedArrayTexture:M8,CompressedCubeTexture:C8,CompressedTexture:ff,CompressedTextureLoader:Xq,ConeGeometry:ov,ConstantAlphaFactor:n8,ConstantColorFactor:e8,Controls:QX,CubeCamera:Bw,CubeDepthTexture:T8,CubeReflectionMapping:jc,CubeRefractionMapping:Qd,CubeTexture:nx,CubeTextureLoader:J8,CubeUVReflectionMapping:iv,CubicBezierCurve:g4,CubicBezierCurve3:D8,CubicInterpolant:X8,CullFaceBack:IR,CullFaceFront:Ok,CullFaceFrontBack:Sj,CullFaceNone:Pk,Curve:Xc,CurvePath:N8,CustomBlending:zk,CustomToneMapping:Z2,CylinderGeometry:Wd,Cylindrical:wX,Data3DTexture:tx,DataArrayTexture:MM,DataTexture:ll,DataTextureLoader:qM,DataUtils:Gc,DecrementStencilOp:Fj,DecrementWrapStencilOp:Oj,DefaultLoadingManager:$8,DepthFormat:Zu,DepthStencilFormat:Bd,DepthTexture:Qm,DetachedBindMode:a8,DirectionalLight:hv,DirectionalLightHelper:UX,DiscreteInterpolant:Y8,DodecahedronGeometry:FM,DoubleSide:gi,DstAlphaFactor:Yk,DstColorFactor:$k,DynamicCopyUsage:Zj,DynamicDrawUsage:qj,DynamicReadUsage:Kj,EdgesGeometry:I8,EllipseCurve:PM,EqualCompare:d8,EqualDepth:fw,EqualStencilFunc:Hj,EquirectangularReflectionMapping:Om,EquirectangularRefractionMapping:fb,Euler:Us,EventDispatcher:zo,ExternalTexture:p4,ExtrudeGeometry:kM,FileLoader:fs,Float16BufferAttribute:jW,Float32BufferAttribute:Kt,FloatType:Si,Fog:IM,FogExp2:TM,FramebufferTexture:fq,FrontSide:cc,Frustum:av,FrustumArray:DM,GLBufferAttribute:_X,GLSL1:tW,GLSL3:FR,GreaterCompare:p8,GreaterDepth:pw,GreaterEqualCompare:wM,GreaterEqualDepth:dw,GreaterEqualStencilFunc:Wj,GreaterStencilFunc:Vj,GridHelper:LX,Group:Ds,HalfFloatType:ci,HemisphereLight:Z8,HemisphereLightHelper:DX,IcosahedronGeometry:rx,ImageBitmapLoader:n6,ImageLoader:Lb,ImageUtils:r4,IncrementStencilOp:Uj,IncrementWrapStencilOp:Pj,InstancedBufferAttribute:jd,InstancedBufferGeometry:I4,InstancedInterleavedBuffer:xX,InstancedMesh:BM,Int16BufferAttribute:QW,Int32BufferAttribute:VW,Int8BufferAttribute:zW,IntType:$b,InterleavedBuffer:sv,InterleavedBufferAttribute:Af,Interpolant:uv,InterpolateDiscrete:Gm,InterpolateLinear:Hm,InterpolateSmooth:HE,InterpolationSamplingMode:rW,InterpolationSamplingType:iW,InvertStencilOp:kj,KeepStencilOp:om,KeyframeTrack:dc,LOD:E8,LatheGeometry:zM,Layers:L0,LessCompare:f8,LessDepth:hw,LessEqualCompare:EM,LessEqualDepth:Fm,LessEqualStencilFunc:Qj,LessStencilFunc:Gj,Light:Zd,LightProbe:T4,Line:Wc,Line3:Fw,LineBasicMaterial:za,LineCurve:A4,LineCurve3:L8,LineDashedMaterial:W8,LineLoop:h4,LineSegments:qc,LinearFilter:mn,LinearInterpolant:_4,LinearMipMapLinearFilter:NR,LinearMipMapNearestFilter:Mj,LinearMipmapLinearFilter:ya,LinearMipmapNearestFilter:uf,LinearSRGBColorSpace:Xi,LinearToneMapping:dM,LinearTransfer:Mb,Loader:zs,LoaderUtils:Pd,LoadingManager:WM,LoopOnce:T0,LoopPingPong:Eb,LoopRepeat:Tm,MOUSE:xj,Material:ts,MaterialLoader:KM,MathUtils:D0,Matrix2:U4,Matrix3:Rn,Matrix4:qt,MaxEquation:Vk,Mesh:Wt,MeshBasicMaterial:ar,MeshDepthMaterial:sx,MeshDistanceMaterial:jM,MeshLambertMaterial:V8,MeshMatcapMaterial:j8,MeshNormalMaterial:Q8,MeshPhongMaterial:G8,MeshPhysicalMaterial:vl,MeshStandardMaterial:Ks,MeshToonMaterial:H8,MinEquation:Qk,MirroredRepeatWrapping:mf,MixOperation:r8,MultiplyBlending:DR,MultiplyOperation:Yb,NearestFilter:Ri,NearestMipMapLinearFilter:wj,NearestMipMapNearestFilter:Ej,NearestMipmapLinearFilter:Wu,NearestMipmapNearestFilter:Kd,NeutralToneMapping:Pm,NeverCompare:h8,NeverDepth:cw,NeverStencilFunc:zj,NoBlending:lc,NoColorSpace:nl,NoNormalPacking:Rj,NoToneMapping:ko,NormalAnimationBlendMode:SM,NormalBlending:Em,NormalGAPacking:Dj,NormalRGPacking:Bj,NotEqualCompare:m8,NotEqualDepth:mw,NotEqualStencilFunc:jj,NumberKeyframeTrack:Wm,Object3D:Gn,ObjectLoader:Jq,ObjectSpaceNormalMap:u8,OctahedronGeometry:lv,OneFactor:Wk,OneMinusConstantAlphaFactor:i8,OneMinusConstantColorFactor:t8,OneMinusDstAlphaFactor:Kk,OneMinusDstColorFactor:Jk,OneMinusSrcAlphaFactor:lw,OneMinusSrcColorFactor:Xk,OrthographicCamera:Yc,PCFShadowMap:h0,PCFSoftShadowMap:J1,PMREMGenerator:QR,Path:Uw,PerspectiveCamera:Gr,Plane:nc,PlaneGeometry:ra,PlaneHelper:kX,PointLight:XM,PointLightHelper:RX,Points:f4,PointsMaterial:LM,PolarGridHelper:NX,PolyhedronGeometry:Jd,PositionalAudio:sX,PropertyBinding:ei,PropertyMixer:s6,QuadraticBezierCurve:v4,QuadraticBezierCurve3:OM,Quaternion:Bi,QuaternionKeyframeTrack:qm,QuaternionLinearInterpolant:K8,R11_EAC_Format:mb,RED_GREEN_RGTC2_Format:_b,RED_RGTC1_Format:bb,REVISION:ag,RG11_EAC_Format:Ab,RGBADepthPacking:c8,RGBAFormat:Fi,RGBAIntegerFormat:_M,RGBA_ASTC_10x10_Format:Mw,RGBA_ASTC_10x5_Format:Sw,RGBA_ASTC_10x6_Format:Ew,RGBA_ASTC_10x8_Format:ww,RGBA_ASTC_12x10_Format:Cw,RGBA_ASTC_12x12_Format:Tw,RGBA_ASTC_4x4_Format:Fd,RGBA_ASTC_5x4_Format:Aw,RGBA_ASTC_5x5_Format:vw,RGBA_ASTC_6x5_Format:yw,RGBA_ASTC_6x6_Format:Cm,RGBA_ASTC_8x5_Format:bw,RGBA_ASTC_8x6_Format:xw,RGBA_ASTC_8x8_Format:_w,RGBA_BPTC_Format:zm,RGBA_ETC2_EAC_Format:C0,RGBA_PVRTC_2BPPV1_Format:w0,RGBA_PVRTC_4BPPV1_Format:km,RGBA_S3TC_DXT1_Format:Ud,RGBA_S3TC_DXT3_Format:Mm,RGBA_S3TC_DXT5_Format:f0,RGBDepthPacking:Tj,RGBFormat:E0,RGBIntegerFormat:Cj,RGB_BPTC_SIGNED_Format:Iw,RGB_BPTC_UNSIGNED_Format:yb,RGB_ETC1_Format:pb,RGB_ETC2_Format:M0,RGB_PVRTC_2BPPV1_Format:gw,RGB_PVRTC_4BPPV1_Format:db,RGB_S3TC_DXT1_Format:wm,RGDepthPacking:Ij,RGFormat:ac,RGIntegerFormat:xM,RawShaderMaterial:b4,Ray:gf,Raycaster:ep,RectAreaLight:e6,RedFormat:qu,RedIntegerFormat:ex,ReinhardToneMapping:pM,RenderTarget:s4,RenderTarget3D:vX,RepeatWrapping:hl,ReplaceStencilOp:Nj,ReverseSubtractEquation:Hk,RingGeometry:GM,SIGNED_R11_EAC_Format:gb,SIGNED_RED_GREEN_RGTC2_Format:Sb,SIGNED_RED_RGTC1_Format:xb,SIGNED_RG11_EAC_Format:vb,SRGBColorSpace:xi,SRGBTransfer:Ui,Scene:uc,ShaderChunk:kn,ShaderLib:kc,ShaderMaterial:Fs,ShadowMaterial:z8,Shape:df,ShapeGeometry:cv,ShapePath:HX,ShapeUtils:Hc,ShortType:vM,Skeleton:ix,SkeletonHelper:IX,SkinnedMesh:u4,Source:of,Sphere:jr,SphereGeometry:hc,Spherical:nb,SphericalHarmonics3:C4,SplineCurve:y4,SpotLight:M4,SpotLightHelper:TX,Sprite:S8,SpriteMaterial:c4,SrcAlphaFactor:ow,SrcAlphaSaturateFactor:Zk,SrcColorFactor:qk,StaticCopyUsage:Jj,StaticDrawUsage:Cb,StaticReadUsage:Yj,StereoCamera:tX,StreamCopyUsage:eW,StreamDrawUsage:Xj,StreamReadUsage:$j,StringKeyframeTrack:lg,SubtractEquation:Gk,SubtractiveBlending:BR,TOUCH:_j,TangentSpaceNormalMap:$d,TetrahedronGeometry:HM,Texture:Pi,TextureLoader:E4,TextureUtils:XX,Timer:SX,TimestampQuery:nW,TorusGeometry:Qu,TorusKnotGeometry:QM,Triangle:ea,TriangleFanDrawMode:Rw,TriangleStripDrawMode:n4,TrianglesDrawMode:o8,TubeGeometry:VM,UVMapping:Hd,Uint16BufferAttribute:a4,Uint32BufferAttribute:o4,Uint8BufferAttribute:GW,Uint8ClampedBufferAttribute:HW,Uniform:N4,UniformsGroup:bX,UniformsLib:Ht,UniformsUtils:l4,UnsignedByteType:xn,UnsignedInt101111Type:Zb,UnsignedInt248Type:S0,UnsignedInt5999Type:Jb,UnsignedIntType:fl,UnsignedShort4444Type:yM,UnsignedShort5551Type:bM,UnsignedShortType:_0,VSMShadowMap:mm,Vector2:Ze,Vector3:ee,Vector4:Ii,VectorKeyframeTrack:Xm,VideoFrameTexture:hq,VideoTexture:NM,WebGL3DRenderTarget:IW,WebGLArrayRenderTarget:TW,WebGLCoordinateSystem:rl,WebGLCubeRenderTarget:rv,WebGLRenderTarget:Vr,WebGLRenderer:ZM,WebGLUtils:m6,WebGPUCoordinateSystem:I0,WebXRController:VE,WireframeGeometry:k8,WrapAroundEnding:wb,ZeroCurvatureEnding:gm,ZeroFactor:jk,ZeroSlopeEnding:Am,ZeroStencilOp:Lj,createCanvasElement:y8,error:on,getConsoleFunction:oW,log:Ib,setConsoleFunction:aW,warn:Gt,warnOnce:R0},Symbol.toStringTag,{value:"Module"}));const F4=globalThis,HN=n=>n,Pw=F4.trustedTypes,QN=Pw?Pw.createPolicy("lit-html",{createHTML:n=>n}):void 0,g6="$lit$",Cd=`lit$${Math.random().toFixed(9).slice(2)}$`,A6="?"+Cd,QZ=`<${A6}>`,Ym=document,Nb=()=>Ym.createComment(""),Ub=n=>n===null||typeof n!="object"&&typeof n!="function",P4=Array.isArray,VZ=n=>P4(n)||typeof n?.[Symbol.iterator]=="function",vT=`[ 	
\f\r]`,c1=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,VN=/-->/g,jN=/>/g,Jp=RegExp(`>|${vT}(?:([^\\s"'>=/]+)(${vT}*=${vT}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),WN=/'/g,qN=/"/g,v6=/^(?:script|style|textarea|title)$/i,jZ=n=>(e,...t)=>({_$litType$:n,strings:e,values:t}),eC=jZ(1),P0=Symbol.for("lit-noChange"),Js=Symbol.for("lit-nothing"),XN=new WeakMap,ym=Ym.createTreeWalker(Ym,129);function y6(n,e){if(!P4(n)||!n.hasOwnProperty("raw"))throw Error("invalid template strings array");return QN!==void 0?QN.createHTML(e):e}const WZ=(n,e)=>{const t=n.length-1,i=[];let r,s=e===2?"<svg>":e===3?"<math>":"",a=c1;for(let o=0;o<t;o++){const c=n[o];let h,p,g=-1,A=0;for(;A<c.length&&(a.lastIndex=A,p=a.exec(c),p!==null);)A=a.lastIndex,a===c1?p[1]==="!--"?a=VN:p[1]!==void 0?a=jN:p[2]!==void 0?(v6.test(p[2])&&(r=RegExp("</"+p[2],"g")),a=Jp):p[3]!==void 0&&(a=Jp):a===Jp?p[0]===">"?(a=r??c1,g=-1):p[1]===void 0?g=-2:(g=a.lastIndex-p[2].length,h=p[1],a=p[3]===void 0?Jp:p[3]==='"'?qN:WN):a===qN||a===WN?a=Jp:a===VN||a===jN?a=c1:(a=Jp,r=void 0);const v=a===Jp&&n[o+1].startsWith("/>")?" ":"";s+=a===c1?c+QZ:g>=0?(i.push(h),c.slice(0,g)+g6+c.slice(g)+Cd+v):c+Cd+(g===-2?o:v)}return[y6(n,s+(n[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),i]};let WR=class b6{constructor({strings:e,_$litType$:t},i){let r;this.parts=[];let s=0,a=0;const o=e.length-1,c=this.parts,[h,p]=WZ(e,t);if(this.el=b6.createElement(h,i),ym.currentNode=this.el.content,t===2||t===3){const g=this.el.content.firstChild;g.replaceWith(...g.childNodes)}for(;(r=ym.nextNode())!==null&&c.length<o;){if(r.nodeType===1){if(r.hasAttributes())for(const g of r.getAttributeNames())if(g.endsWith(g6)){const A=p[a++],v=r.getAttribute(g).split(Cd),x=/([.?@])?(.*)/.exec(A);c.push({type:1,index:s,name:x[2],strings:v,ctor:x[1]==="."?XZ:x[1]==="?"?YZ:x[1]==="@"?KZ:tC}),r.removeAttribute(g)}else g.startsWith(Cd)&&(c.push({type:6,index:s}),r.removeAttribute(g));if(v6.test(r.tagName)){const g=r.textContent.split(Cd),A=g.length-1;if(A>0){r.textContent=Pw?Pw.emptyScript:"";for(let v=0;v<A;v++)r.append(g[v],Nb()),ym.nextNode(),c.push({type:2,index:++s});r.append(g[A],Nb())}}}else if(r.nodeType===8)if(r.data===A6)c.push({type:2,index:s});else{let g=-1;for(;(g=r.data.indexOf(Cd,g+1))!==-1;)c.push({type:7,index:s}),g+=Cd.length-1}s++}}static createElement(e,t){const i=Ym.createElement("template");return i.innerHTML=e,i}};function O0(n,e,t=n,i){if(e===P0)return e;let r=i!==void 0?t._$Co?.[i]:t._$Cl;const s=Ub(e)?void 0:e._$litDirective$;return r?.constructor!==s&&(r?._$AO?.(!1),s===void 0?r=void 0:(r=new s(n),r._$AT(n,t,i)),i!==void 0?(t._$Co??=[])[i]=r:t._$Cl=r),r!==void 0&&(e=O0(n,r._$AS(n,e.values),r,i)),e}let qZ=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:i}=this._$AD,r=(e?.creationScope??Ym).importNode(t,!0);ym.currentNode=r;let s=ym.nextNode(),a=0,o=0,c=i[0];for(;c!==void 0;){if(a===c.index){let h;c.type===2?h=new O4(s,s.nextSibling,this,e):c.type===1?h=new c.ctor(s,c.name,c.strings,this,e):c.type===6&&(h=new $Z(s,this,e)),this._$AV.push(h),c=i[++o]}a!==c?.index&&(s=ym.nextNode(),a++)}return ym.currentNode=Ym,r}p(e){let t=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}},O4=class x6{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,i,r){this.type=2,this._$AH=Js,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=r,this._$Cv=r?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&e?.nodeType===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=O0(this,e,t),Ub(e)?e===Js||e==null||e===""?(this._$AH!==Js&&this._$AR(),this._$AH=Js):e!==this._$AH&&e!==P0&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):VZ(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Js&&Ub(this._$AH)?this._$AA.nextSibling.data=e:this.T(Ym.createTextNode(e)),this._$AH=e}$(e){const{values:t,_$litType$:i}=e,r=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=WR.createElement(y6(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===r)this._$AH.p(t);else{const s=new qZ(r,this),a=s.u(this.options);s.p(t),this.T(a),this._$AH=s}}_$AC(e){let t=XN.get(e.strings);return t===void 0&&XN.set(e.strings,t=new WR(e)),t}k(e){P4(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,r=0;for(const s of e)r===t.length?t.push(i=new x6(this.O(Nb()),this.O(Nb()),this,this.options)):i=t[r],i._$AI(s),r++;r<t.length&&(this._$AR(i&&i._$AB.nextSibling,r),t.length=r)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e!==this._$AB;){const i=HN(e).nextSibling;HN(e).remove(),e=i}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},tC=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,i,r,s){this.type=1,this._$AH=Js,this._$AN=void 0,this.element=e,this.name=t,this._$AM=r,this.options=s,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Js}_$AI(e,t=this,i,r){const s=this.strings;let a=!1;if(s===void 0)e=O0(this,e,t,0),a=!Ub(e)||e!==this._$AH&&e!==P0,a&&(this._$AH=e);else{const o=e;let c,h;for(e=s[0],c=0;c<s.length-1;c++)h=O0(this,o[i+c],t,c),h===P0&&(h=this._$AH[c]),a||=!Ub(h)||h!==this._$AH[c],h===Js?e=Js:e!==Js&&(e+=(h??"")+s[c+1]),this._$AH[c]=h}a&&!r&&this.j(e)}j(e){e===Js?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},XZ=class extends tC{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Js?void 0:e}},YZ=class extends tC{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Js)}},KZ=class extends tC{constructor(e,t,i,r,s){super(e,t,i,r,s),this.type=5}_$AI(e,t=this){if((e=O0(this,e,t,0)??Js)===P0)return;const i=this._$AH,r=e===Js&&i!==Js||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,s=e!==Js&&(i===Js||r);r&&this.element.removeEventListener(this.name,this,i),s&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},$Z=class{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){O0(this,e)}};const JZ=F4.litHtmlPolyfillSupport;JZ?.(WR,O4),(F4.litHtmlVersions??=[]).push("3.3.2");const _6=(n,e,t)=>{const i=t?.renderBefore??e;let r=i._$litPart$;if(r===void 0){const s=t?.renderBefore??null;i._$litPart$=r=new O4(e.insertBefore(Nb(),s),s,void 0,t??{})}return r._$AI(n),r};const k4=globalThis;let WE=class extends dm{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=_6(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return P0}};WE._$litElement$=!0,WE.finalized=!0,k4.litElementHydrateSupport?.({LitElement:WE});const ZZ=k4.litElementPolyfillSupport;ZZ?.({LitElement:WE});(k4.litElementVersions??=[]).push("4.2.2");const S6=navigator.xr!=null&&self.XRSession!=null&&navigator.xr.isSessionSupported!=null,E6=S6&&self.XRSession.prototype.requestHitTestSource!=null,yT=self.ResizeObserver!=null,bT=self.IntersectionObserver!=null,w6=E6;(()=>{const n=navigator.userAgent||navigator.vendor||self.opera;let e=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4)))&&(e=!0),e})();const eee=/android/i.test(navigator.userAgent),tee=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!self.MSStream||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,nee=/firefox/i.test(navigator.userAgent),iee=/OculusBrowser/.test(navigator.userAgent),ree=eee&&!nee&&!iee,see=!!(window.webkit&&window.webkit.messageHandlers),YN=(()=>{if(tee){if(see)return!!/CriOS\/|EdgiOS\/|FxiOS\/|GSA\/|DuckDuckGo\//.test(navigator.userAgent);{const n=document.createElement("a");return!!(n.relList&&n.relList.supports&&n.relList.supports("ar"))}}else return!1})();const M6=n=>n&&n!=="null"?aee(n):null,KN=()=>{if(w6)return;const n=[];throw S6||n.push("WebXR Device API"),E6||n.push("WebXR Hit Test API"),new Error(`The following APIs are required for AR, but are missing in this browser: ${n.join(", ")}`)},aee=n=>new URL(n,window.location.toString()).toString(),oee=(n,e)=>{let t=null;const i=(...r)=>{t==null&&(n(...r),t=self.setTimeout(()=>t=null,e))};return i.flush=()=>{t!=null&&(self.clearTimeout(t),t=null)},i},$N=(n,e)=>{let t=null;return(...i)=>{t!=null&&self.clearTimeout(t),t=self.setTimeout(()=>{t=null,n(...i)},e)}},Vu=(n,e,t)=>Math.max(e,Math.min(t,n)),JN=(()=>{const n="model-viewer-debug-mode",e=new RegExp(`[?&]${n}(&|$)`);return()=>self.ModelViewerElement&&self.ModelViewerElement.debugMode||self.location&&self.location.search&&self.location.search.match(e)})(),lee=(n=0)=>new Promise(e=>setTimeout(e,n)),cee=(n,e,t=null)=>new Promise(i=>{function r(s){(!t||t(s))&&(i(s),n.removeEventListener(e,r))}n.addEventListener(e,r)});var Zp=function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(s=(r<3?a(s):r>3?a(e,t,s):a(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};const uee=.5,hee=0,fee=1,dee=1,G1=Symbol("currentEnvironmentMap"),H1=Symbol("currentBackground"),Ow=Symbol("updateEnvironment"),qS=Symbol("cancelEnvironmentUpdate"),pee=n=>{var e,t,i;class r extends n{constructor(){super(...arguments),this.environmentImage=null,this.skyboxImage=null,this.shadowIntensity=hee,this.shadowSoftness=fee,this.exposure=dee,this.toneMapping="auto",this.skyboxHeight="0",this[e]=null,this[t]=null,this[i]=null}updated(a){super.updated(a),a.has("shadowIntensity")&&(this[Rt].setShadowIntensity(this.shadowIntensity*uee),this[ta]()),a.has("shadowSoftness")&&(this[Rt].setShadowSoftness(this.shadowSoftness),this[ta]()),a.has("exposure")&&(this[Rt].exposure=this.exposure,this[ta]()),a.has("toneMapping")&&(this[Rt].toneMapping=this.toneMapping==="aces"?Kb:this.toneMapping==="agx"?gM:this.toneMapping==="reinhard"?pM:this.toneMapping==="cineon"?mM:this.toneMapping==="linear"?dM:this.toneMapping==="none"?ko:Pm,this[ta]()),(a.has("environmentImage")||a.has("skyboxImage"))&&this[k0]()&&this[Ow](),a.has("skyboxHeight")&&(this[Rt].setGroundedSkybox(),this[ta]())}hasBakedShadow(){return this[Rt].bakedShadows.size>0}async[(e=G1,t=H1,i=qS,Ow)](){const{skyboxImage:a,environmentImage:o}=this;this[qS]!=null&&(this[qS](),this[qS]=null);const{textureUtils:c}=this[zi];if(c==null)return;const h=this[Km].beginActivity("environment-update");try{const{environmentMap:p,skybox:g}=await c.generateEnvironmentMapAndSkybox(M6(a),o,A=>h(Vu(A,0,1)),this.withCredentials);this[G1]!==p&&(this[G1]=p,this.dispatchEvent(new CustomEvent("environment-change"))),g!=null?this[H1]=g.name===p.name?p:g:this[H1]=null,this[Rt].setEnvironmentAndSkybox(this[G1],this[H1])}catch(p){if(p instanceof Error)throw this[Rt].setEnvironmentAndSkybox(null,null),p}finally{h(1)}}}return Zp([wn({type:String,attribute:"environment-image"})],r.prototype,"environmentImage",void 0),Zp([wn({type:String,attribute:"skybox-image"})],r.prototype,"skyboxImage",void 0),Zp([wn({type:Number,attribute:"shadow-intensity"})],r.prototype,"shadowIntensity",void 0),Zp([wn({type:Number,attribute:"shadow-softness"})],r.prototype,"shadowSoftness",void 0),Zp([wn({type:Number})],r.prototype,"exposure",void 0),Zp([wn({type:String,attribute:"tone-mapping"})],r.prototype,"toneMapping",void 0),Zp([wn({type:String,attribute:"skybox-height"})],r.prototype,"skyboxHeight",void 0),r};const mee=eC`
<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="#000000">
    <!-- NOTE(cdata): This SVG filter is a stop-gap until we can implement
         support for dynamic re-coloring of UI components -->
    <defs>
      <filter id="drop-shadow" x="-100%" y="-100%" width="300%" height="300%">
        <feGaussianBlur in="SourceAlpha" stdDeviation="1"/>
        <feOffset dx="0" dy="0" result="offsetblur"/>
        <feFlood flood-color="#000000"/>
        <feComposite in2="offsetblur" operator="in"/>
        <feMerge>
          <feMergeNode/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
    </defs>
    <path filter="url(#drop-shadow)" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>`;const gee=eC`
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="36">
    <defs>
        <path id="A" d="M.001.232h24.997V36H.001z" />
    </defs>
    <g transform="translate(-11 -4)" fill="none" fill-rule="evenodd">
        <path fill-opacity="0" fill="#fff" d="M0 0h44v44H0z" />
        <g transform="translate(11 3)">
            <path d="M8.733 11.165c.04-1.108.766-2.027 1.743-2.307a2.54 2.54 0 0 1 .628-.089c.16 0 .314.017.463.044 1.088.2 1.9 1.092 1.9 2.16v8.88h1.26c2.943-1.39 5-4.45 5-8.025a9.01 9.01 0 0 0-1.9-5.56l-.43-.5c-.765-.838-1.683-1.522-2.712-2-1.057-.49-2.226-.77-3.46-.77s-2.4.278-3.46.77c-1.03.478-1.947 1.162-2.71 2l-.43.5a9.01 9.01 0 0 0-1.9 5.56 9.04 9.04 0 0 0 .094 1.305c.03.21.088.41.13.617l.136.624c.083.286.196.56.305.832l.124.333a8.78 8.78 0 0 0 .509.953l.065.122a8.69 8.69 0 0 0 3.521 3.191l1.11.537v-9.178z" fill-opacity=".5" fill="#e4e4e4" />
            <path d="M22.94 26.218l-2.76 7.74c-.172.485-.676.8-1.253.8H12.24c-1.606 0-3.092-.68-3.98-1.82-1.592-2.048-3.647-3.822-6.11-5.27-.095-.055-.15-.137-.152-.23-.004-.1.046-.196.193-.297.56-.393 1.234-.6 1.926-.6a3.43 3.43 0 0 1 .691.069l4.922.994V10.972c0-.663.615-1.203 1.37-1.203s1.373.54 1.373 1.203v9.882h2.953c.273 0 .533.073.757.21l6.257 3.874c.027.017.045.042.07.06.41.296.586.77.426 1.22M4.1 16.614c-.024-.04-.042-.083-.065-.122a8.69 8.69 0 0 1-.509-.953c-.048-.107-.08-.223-.124-.333l-.305-.832c-.058-.202-.09-.416-.136-.624l-.13-.617a9.03 9.03 0 0 1-.094-1.305c0-2.107.714-4.04 1.9-5.56l.43-.5c.764-.84 1.682-1.523 2.71-2 1.058-.49 2.226-.77 3.46-.77s2.402.28 3.46.77c1.03.477 1.947 1.16 2.712 2l.428.5a9 9 0 0 1 1.901 5.559c0 3.577-2.056 6.636-5 8.026h-1.26v-8.882c0-1.067-.822-1.96-1.9-2.16-.15-.028-.304-.044-.463-.044-.22 0-.427.037-.628.09-.977.28-1.703 1.198-1.743 2.306v9.178l-1.11-.537C6.18 19.098 4.96 18 4.1 16.614M22.97 24.09l-6.256-3.874c-.102-.063-.218-.098-.33-.144 2.683-1.8 4.354-4.855 4.354-8.243 0-.486-.037-.964-.104-1.43a9.97 9.97 0 0 0-1.57-4.128l-.295-.408-.066-.092a10.05 10.05 0 0 0-.949-1.078c-.342-.334-.708-.643-1.094-.922-1.155-.834-2.492-1.412-3.94-1.65l-.732-.088-.748-.03a9.29 9.29 0 0 0-1.482.119c-1.447.238-2.786.816-3.94 1.65a9.33 9.33 0 0 0-.813.686 9.59 9.59 0 0 0-.845.877l-.385.437-.36.5-.288.468-.418.778-.04.09c-.593 1.28-.93 2.71-.93 4.222 0 3.832 2.182 7.342 5.56 8.938l1.437.68v4.946L5 25.64a4.44 4.44 0 0 0-.888-.086c-.017 0-.034.003-.05.003-.252.004-.503.033-.75.08a5.08 5.08 0 0 0-.237.056c-.193.046-.382.107-.568.18-.075.03-.15.057-.225.1-.25.114-.494.244-.723.405a1.31 1.31 0 0 0-.566 1.122 1.28 1.28 0 0 0 .645 1.051C4 29.925 5.96 31.614 7.473 33.563a5.06 5.06 0 0 0 .434.491c1.086 1.082 2.656 1.713 4.326 1.715h6.697c.748-.001 1.43-.333 1.858-.872.142-.18.256-.38.336-.602l2.757-7.74c.094-.26.13-.53.112-.794s-.088-.52-.203-.76a2.19 2.19 0 0 0-.821-.91" fill-opacity=".6" fill="#000" />
            <path d="M22.444 24.94l-6.257-3.874a1.45 1.45 0 0 0-.757-.211h-2.953v-9.88c0-.663-.616-1.203-1.373-1.203s-1.37.54-1.37 1.203v16.643l-4.922-.994a3.44 3.44 0 0 0-.692-.069 3.35 3.35 0 0 0-1.925.598c-.147.102-.198.198-.194.298.004.094.058.176.153.23 2.462 1.448 4.517 3.22 6.11 5.27.887 1.14 2.373 1.82 3.98 1.82h6.686c.577 0 1.08-.326 1.253-.8l2.76-7.74c.16-.448-.017-.923-.426-1.22-.025-.02-.043-.043-.07-.06z" fill="#fff" />
            <g transform="translate(0 .769)">
                <mask id="B" fill="#fff">
                    <use xlink:href="#A" />
                </mask>
                <path d="M23.993 24.992a1.96 1.96 0 0 1-.111.794l-2.758 7.74c-.08.22-.194.423-.336.602-.427.54-1.11.87-1.857.872h-6.698c-1.67-.002-3.24-.633-4.326-1.715-.154-.154-.3-.318-.434-.49C5.96 30.846 4 29.157 1.646 27.773c-.385-.225-.626-.618-.645-1.05a1.31 1.31 0 0 1 .566-1.122 4.56 4.56 0 0 1 .723-.405l.225-.1a4.3 4.3 0 0 1 .568-.18l.237-.056c.248-.046.5-.075.75-.08.018 0 .034-.003.05-.003.303-.001.597.027.89.086l3.722.752V20.68l-1.436-.68c-3.377-1.596-5.56-5.106-5.56-8.938 0-1.51.336-2.94.93-4.222.015-.03.025-.06.04-.09.127-.267.268-.525.418-.778.093-.16.186-.316.288-.468.063-.095.133-.186.2-.277L3.773 5c.118-.155.26-.29.385-.437.266-.3.544-.604.845-.877a9.33 9.33 0 0 1 .813-.686C6.97 2.167 8.31 1.59 9.757 1.35a9.27 9.27 0 0 1 1.481-.119 8.82 8.82 0 0 1 .748.031c.247.02.49.05.733.088 1.448.238 2.786.816 3.94 1.65.387.28.752.588 1.094.922a9.94 9.94 0 0 1 .949 1.078l.066.092c.102.133.203.268.295.408a9.97 9.97 0 0 1 1.571 4.128c.066.467.103.945.103 1.43 0 3.388-1.67 6.453-4.353 8.243.11.046.227.08.33.144l6.256 3.874c.37.23.645.55.82.9.115.24.185.498.203.76m.697-1.195c-.265-.55-.677-1.007-1.194-1.326l-5.323-3.297c2.255-2.037 3.564-4.97 3.564-8.114 0-2.19-.637-4.304-1.84-6.114-.126-.188-.26-.37-.4-.552-.645-.848-1.402-1.6-2.252-2.204C15.472.91 13.393.232 11.238.232A10.21 10.21 0 0 0 5.23 2.19c-.848.614-1.606 1.356-2.253 2.205-.136.18-.272.363-.398.55C1.374 6.756.737 8.87.737 11.06c0 4.218 2.407 8.08 6.133 9.842l.863.41v3.092l-2.525-.51c-.356-.07-.717-.106-1.076-.106a5.45 5.45 0 0 0-3.14.996c-.653.46-1.022 1.202-.99 1.983a2.28 2.28 0 0 0 1.138 1.872c2.24 1.318 4.106 2.923 5.543 4.772 1.26 1.62 3.333 2.59 5.55 2.592h6.698c1.42-.001 2.68-.86 3.134-2.138l2.76-7.74c.272-.757.224-1.584-.134-2.325" fill-opacity=".05" fill="#000" mask="url(#B)" />
            </g>
        </g>
    </g>
</svg>`;const Aee=eC`
<svg version="1.1" id="view_x5F_in_x5F_AR_x5F_icon"
	 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px"
	 viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
<rect id="Bounding_Box" x="0" y="0" fill="none" width="24" height="24"/>
<g id="Art_layer">
	<path d="M3,4c0-0.55,0.45-1,1-1h2V1H4C2.35,1,1,2.35,1,4v2h2V4z"/>
	<path d="M20,3c0.55,0,1,0.45,1,1v2h2V4c0-1.65-1.35-3-3-3h-2v2H20z"/>
	<path d="M4,21c-0.55,0-1-0.45-1-1v-2H1v2c0,1.65,1.35,3,3,3h2v-2H4z"/>
	<path d="M20,21c0.55,0,1-0.45,1-1v-2h2v2c0,1.65-1.35,3-3,3h-2v-2H20z"/>
	<g>
		<path d="M18.25,7.6l-5.5-3.18c-0.46-0.27-1.04-0.27-1.5,0L5.75,7.6C5.29,7.87,5,8.36,5,8.9v6.35c0,0.54,0.29,1.03,0.75,1.3
			l5.5,3.18c0.46,0.27,1.04,0.27,1.5,0l5.5-3.18c0.46-0.27,0.75-0.76,0.75-1.3V8.9C19,8.36,18.71,7.87,18.25,7.6z M7,14.96v-4.62
			l4,2.32v4.61L7,14.96z M12,10.93L8,8.61l4-2.31l4,2.31L12,10.93z M13,17.27v-4.61l4-2.32v4.62L13,17.27z"/>
	</g>
</g>
</svg>`;const vee=eC`
<style>
:host {
  display: block;
  position: relative;
  contain: strict;
  width: 300px;
  height: 150px;
}

.container {
  position: relative;
  overflow: hidden;
}

.userInput {
  width: 100%;
  height: 100%;
  display: none;
  position: relative;
  outline-offset: -1px;
  outline-width: 1px;
}

canvas {
  position: absolute;
  display: none;
  pointer-events: none;
  /* NOTE(cdata): Chrome 76 and below apparently have a bug
   * that causes our canvas not to display pixels unless it is
   * on its own render layer
   * @see https://github.com/google/model-viewer/pull/755#issuecomment-536597893
   */
  transform: translateZ(0);
}

.show {
  display: block;
}

/* Adapted from HTML5 Boilerplate
 *
 * @see https://github.com/h5bp/html5-boilerplate/blob/ceb4620c78fc82e13534fc44202a3f168754873f/dist/css/main.css#L122-L133 */
.screen-reader-only {
  border: 0;
  left: 0;
  top: 0;
  clip: rect(0, 0, 0, 0);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  white-space: nowrap;
  width: 1px;
  pointer-events: none;
}

.slot {
  position: absolute;
  pointer-events: none;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.slot > * {
  pointer-events: initial;
}

.annotation-wrapper ::slotted(*) {
  opacity: var(--max-hotspot-opacity, 1);
  transition: opacity 0.3s;
}

.pointer-tumbling .annotation-wrapper ::slotted(*) {
  pointer-events: none;
}

.annotation-wrapper ::slotted(*) {
  pointer-events: initial;
}

.annotation-wrapper.hide ::slotted(*) {
  opacity: var(--min-hotspot-opacity, 0.25);
}

.slot.poster {
  display: none;
  background-color: inherit;
}

.slot.poster.show {
  display: inherit;
}

.slot.poster > * {
  pointer-events: initial;
}

.slot.poster:not(.show) > * {
  pointer-events: none;
}

#default-poster {
  width: 100%;
  height: 100%;
  /* The default poster is a <button> so we need to set display
   * to prevent it from being affected by text-align: */
  display: block;
  position: absolute;
  border: none;
  padding: 0;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  background-color: #fff0;
}

#default-progress-bar {
  display: block;
  position: relative;
  width: 100%;
  height: 100%;
  pointer-events: none;
  overflow: hidden;
}

#default-progress-bar > .bar {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--progress-bar-height, 5px);
  background-color: var(--progress-bar-color, rgba(0, 0, 0, 0.4));
  transition: transform 0.09s;
  transform-origin: top left;
  transform: scaleX(0);
  overflow: hidden;
}

#default-progress-bar > .bar.hide {
  transition: opacity 0.3s 1s;
  opacity: 0;
}

.centered {
  align-items: center;
  justify-content: center;
}

.cover {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.slot.interaction-prompt {
  display: var(--interaction-prompt-display, flex);
  overflow: hidden;
  opacity: 0;
  will-change: opacity;
  transition: opacity 0.3s;
}

.slot.interaction-prompt.visible {
  opacity: 1;
}

.animated-container {
  will-change: transform, opacity;
  opacity: 0;
  transition: opacity 0.3s;
}

.slot.interaction-prompt > * {
  pointer-events: none;
}

.slot.ar-button {
  -moz-user-select: none;
  -webkit-tap-highlight-color: transparent;
  user-select: none;

  display: var(--ar-button-display, block);
}

.slot.ar-button:not(.enabled) {
  display: none;
}

.fab {
  display: flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  width: 40px;
  height: 40px;
  cursor: pointer;
  background-color: #fff;
  box-shadow: 0px 0px 4px rgba(0, 0, 0, 0.15);
  border-radius: 100px;
}

.fab > * {
  opacity: 0.87;
}

#default-ar-button {
  position: absolute;
  bottom: 16px;
  right: 16px;
  transform: scale(var(--ar-button-scale, 1));
  transform-origin: bottom right;
}

.slot.pan-target {
  display: block;
  position: absolute;
  width: 0;
  height: 0;
  left: 50%;
  top: 50%;
  transform: translate3d(-50%, -50%, 0);
  background-color: transparent;
  opacity: 0;
  transition: opacity 0.3s;
}

#default-pan-target {
  width: 6px;
  height: 6px;
  border-radius: 6px;
  border: 1px solid white;
  box-shadow: 0px 0px 2px 1px rgba(0, 0, 0, 0.8);
}

.slot.default {
  pointer-events: none;
}

.slot.progress-bar {
  pointer-events: none;
}

.slot.exit-webxr-ar-button {
  pointer-events: none;
}

.slot.exit-webxr-ar-button:not(.enabled) {
  display: none;
}

#default-exit-webxr-ar-button {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: env(safe-area-inset-top, 16px);
  right: 16px;
  width: 40px;
  height: 40px;
  box-sizing: border-box;
}

#default-exit-webxr-ar-button > svg {
  fill: #fff;
}
</style>
<div class="container">
  <div class="userInput" tabindex="0" role="img"
      aria-label="3D model">
      <div class="slot canvas">
        <slot name="canvas">
          <canvas></canvas>
        </slot>
      </div>

  </div>

  <!-- NOTE(cdata): We need to wrap slots because browsers without ShadowDOM
        will have their <slot> elements removed by ShadyCSS -->
  <div class="slot poster">
    <slot name="poster">
      <button type="button" id="default-poster" aria-hidden="true" aria-label="Loading 3D model"></button>
    </slot>
  </div>

  <div class="slot ar-button">
    <slot name="ar-button">
      <a id="default-ar-button" part="default-ar-button" class="fab"
          tabindex="2"
          role="button"
          href="javascript:void(0);"
          aria-label="View in your space">
        ${Aee}
      </a>
    </slot>
  </div>

  <div class="slot pan-target">
    <slot name="pan-target">
      <div id="default-pan-target">
      </div>
    </slot>
  </div>

  <div class="slot interaction-prompt cover centered">
    <div id="prompt" class="animated-container">
      <slot name="interaction-prompt" aria-hidden="true">
        ${gee}
      </slot>
    </div>
  </div>

  <div id="finger0" class="animated-container cover">
    <slot name="finger0" aria-hidden="true">
    </slot>
  </div>
  <div id="finger1" class="animated-container cover">
    <slot name="finger1" aria-hidden="true">
    </slot>
  </div>

  <div class="slot default">
    <slot></slot>

    <div class="slot progress-bar">
      <slot name="progress-bar">
        <div id="default-progress-bar" aria-hidden="true">
          <div class="bar" part="default-progress-bar"></div>
        </div>
      </slot>
    </div>

    <div class="slot exit-webxr-ar-button">
      <slot name="exit-webxr-ar-button">
        <a id="default-exit-webxr-ar-button" part="default-exit-webxr-ar-button"
            tabindex="3"
            aria-label="Exit AR"
            aria-hidden="true">
          ${mee}
        </a>
      </slot>
    </div>
  </div>
</div>
<div class="screen-reader-only" role="region" aria-label="Live announcements">
  <span id="status" role="status"></span>
</div>`,yee=n=>{_6(vee,n)};var ZN=(function(){var n="b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q:Odkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq;w8Wqdbk;esezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9Uc;WFbGgocjdaocjd6EhDaicefhocbhqdnindndndnaeaq9nmbaDaeaq9RaqaDfae6Egkcsfglcl4cifcd4hxalc9WGgmTmecbhPawcjdfhsaohzinaraz9Rax6mvarazaxfgo9RcK6mvczhlcbhHinalgic9WfgOawcj;cbffhldndndndndnazaOco4fRbbaHcoG4ciGPlbedibkal9cb83ibalcwf9cb83ibxikalaoRblaoRbbgOco4gAaAciSgAE86bbawcj;cbfaifglcGfaoclfaAfgARbbaOcl4ciGgCaCciSgCE86bbalcVfaAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc7faAaCfgARbbaOciGgOaOciSgOE86bbalctfaAaOfgARbbaoRbegOco4gCaCciSgCE86bbalc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc93faAaCfgARbbaOciGgOaOciSgOE86bbalc94faAaOfgARbbaoRbdgOco4gCaCciSgCE86bbalc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc97faAaCfgARbbaOciGgOaOciSgOE86bbalc98faAaOfgORbbaoRbigoco4gAaAciSgAE86bbalc99faOaAfgORbbaocl4ciGgAaAciSgAE86bbalc9:faOaAfgORbbaocd4ciGgAaAciSgAE86bbalcufaOaAfglRbbaociGgoaociSgoE86bbalaofhoxdkalaoRbwaoRbbgOcl4gAaAcsSgAE86bbawcj;cbfaifglcGfaocwfaAfgARbbaOcsGgOaOcsSgOE86bbalcVfaAaOfgORbbaoRbegAcl4gCaCcsSgCE86bbalc7faOaCfgORbbaAcsGgAaAcsSgAE86bbalctfaOaAfgORbbaoRbdgAcl4gCaCcsSgCE86bbalc91faOaCfgORbbaAcsGgAaAcsSgAE86bbalc4faOaAfgORbbaoRbigAcl4gCaCcsSgCE86bbalc93faOaCfgORbbaAcsGgAaAcsSgAE86bbalc94faOaAfgORbbaoRblgAcl4gCaCcsSgCE86bbalc95faOaCfgORbbaAcsGgAaAcsSgAE86bbalc96faOaAfgORbbaoRbvgAcl4gCaCcsSgCE86bbalc97faOaCfgORbbaAcsGgAaAcsSgAE86bbalc98faOaAfgORbbaoRbogAcl4gCaCcsSgCE86bbalc99faOaCfgORbbaAcsGgAaAcsSgAE86bbalc9:faOaAfgORbbaoRbrgocl4gAaAcsSgAE86bbalcufaOaAfglRbbaocsGgoaocsSgoE86bbalaofhoxekalao8Pbb83bbalcwfaocwf8Pbb83bbaoczfhokdnaiam9pmbaHcdfhHaiczfhlarao9RcL0mekkaiam6mvaoTmvdnakTmbawaPfRbbhHawcj;cbfhlashiakhOinaialRbbgzce4cbazceG9R7aHfgH86bbaiadfhialcefhlaOcufgOmbkkascefhsaohzaPcefgPad9hmbxikkcbc99arao9Radcaadca0ESEhoxlkaoaxad2fhCdnakmbadhlinaoTmlarao9Rax6mlaoaxfhoalcufglmbkaChoxekcbhmawcjdfhAinarao9Rax6miawamfRbbhHawcj;cbfhlaAhiakhOinaialRbbgzce4cbazceG9R7aHfgH86bbaiadfhialcefhlaOcufgOmbkaAcefhAaoaxfhoamcefgmad9hmbkaChokabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqaombkc9:hoxekc9:hokavcj;ebf8Kjjjjbaok;cseHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;oiliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabaiavcefciGfcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavciGfgkcd7cetfaD87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavcufciGfcetfaD87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohvxekcjjjj94hvkabakcetfav87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2gdTmbinababydbgecwtcw91:Yaece91cjjj98Gcjjj;8if::NUdbabclfhbadcufgdmbkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklzNbb",e="b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q:6dkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq:p9sqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk:N8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhlaicefhodnaeTmbadTmbalc;WFbGglcjdalcjd6EhwcbhDinawaeaD9RaDawfae6Egqcsfglc9WGgkci2hxakcethmalcl4cifcd4hPabaDad2fhsakc;ab6hzcbhHincbhOaohAdndninaraA9RaP6meavcj;cbfaOak2fhCaAaPfhocbhidnazmbarao9Rc;Gb6mbcbhlinaCalfhidndndndndnaAalco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklbaoczfhokdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklzaoczfhokdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklaaoczfhokdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WaoclfaYpQbfaXc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WaocwfaYpQbfaXc:q:yjjbfRbbfhoxekaiaopbbbpkl8Waoczfhokalc;abfhialcjefak0meaihlarao9Rc;Fb0mbkkdnaiak9pmbaici4hlinarao9RcK6miaCaifhXdndndndndnaAaico4fRbbalcoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpkbbxikaXaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkbbaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaXaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkbbaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaXaopbbbpkbbaoczfhokalcdfhlaiczfgiak6mbkkaoTmeaohAaOcefgOclSmdxbkkc9:hoxlkdnakTmbavcjdfaHfhiavaHfpbdbhYcbhXinaiavcj;cbfaXfglpblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLalakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEalamfpblbg3cep9Ta3aQp9op9Hp9rg3alaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfhiaXczfgXak6mbkkaHclfgHad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfgDae6mbkkcbc99arao9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk::seHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:wPliuo97eue978Jjjjjbca9Rhiaec98Ghldndnadcl9hmbdnalTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalaeSmeaipxbbbbbbbbbbbbbbbbgqpklbaiabalcdtfgdaeciGglcdtgv;8qbbdnalTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDaqp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkadaiav;8qbbskdnalTmbcbhvabhdinadczfgxaxpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oaoarpmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgval6mbkkalaeSmbaiaeciGgvcitgdfcbcaad9R;8kbaiabalcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oaoarpmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalaeSmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbheabhdinadadpbbbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepkbbadczfhdaeclfgeav6mbkkdnavalSmbaialciGgecdtgdVcbc;abad9R;8kbaiabavcdtfgvad;8qbbdnaeTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepklbkavaiad;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz:Dbb",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),i=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var r=WebAssembly.validate(t)?o(e):o(n),s,a=WebAssembly.instantiate(r,{}).then(function(E){s=E.instance,s.exports.__wasm_call_ctors()});function o(E){for(var C=new Uint8Array(E.length),T=0;T<E.length;++T){var R=E.charCodeAt(T);C[T]=R>96?R-97:R>64?R-39:R+4}for(var B=0,T=0;T<E.length;++T)C[B++]=C[T]<60?i[C[T]]:(C[T]-60)*64+C[++T];return C.buffer.slice(0,B)}function c(E,C,T,R,B,U,O){var F=E.exports.sbrk,L=R+3&-4,P=F(L*B),W=F(U.length),j=new Uint8Array(E.exports.memory.buffer);j.set(U,W);var V=C(P,R,B,W,U.length);if(V==0&&O&&O(P,L,B),T.set(j.subarray(P,P+R*B)),F(P-F(0)),V!=0)throw new Error("Malformed buffer data: "+V)}var h={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},p={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},g=[],A=0;function v(E){var C={object:new Worker(E),pending:0,requests:{}};return C.object.onmessage=function(T){var R=T.data;C.pending-=R.count,C.requests[R.id][R.action](R.value),delete C.requests[R.id]},C}function x(E){for(var C="self.ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(r)+"]), {}).then(function(result) { result.instance.exports.__wasm_call_ctors(); return result.instance; });self.onmessage = "+_.name+";"+c.toString()+_.toString(),T=new Blob([C],{type:"text/javascript"}),R=URL.createObjectURL(T),B=g.length;B<E;++B)g[B]=v(R);for(var B=E;B<g.length;++B)g[B].object.postMessage({});g.length=E,URL.revokeObjectURL(R)}function S(E,C,T,R,B){for(var U=g[0],O=1;O<g.length;++O)g[O].pending<U.pending&&(U=g[O]);return new Promise(function(F,L){var P=new Uint8Array(T),W=++A;U.pending+=E,U.requests[W]={resolve:F,reject:L},U.object.postMessage({id:W,count:E,size:C,source:P,mode:R,filter:B},[P.buffer])})}function _(E){var C=E.data;if(!C.id)return self.close();self.ready.then(function(T){try{var R=new Uint8Array(C.count*C.size);c(T,T.exports[C.mode],R,C.count,C.size,C.source,T.exports[C.filter]),self.postMessage({id:C.id,count:C.count,action:"resolve",value:R},[R.buffer])}catch(B){self.postMessage({id:C.id,count:C.count,action:"reject",value:B})}})}return{ready:a,supported:!0,useWorkers:function(E){x(E)},decodeVertexBuffer:function(E,C,T,R,B){c(s,s.exports.meshopt_decodeVertexBuffer,E,C,T,R,s.exports[h[B]])},decodeIndexBuffer:function(E,C,T,R){c(s,s.exports.meshopt_decodeIndexBuffer,E,C,T,R)},decodeIndexSequence:function(E,C,T,R){c(s,s.exports.meshopt_decodeIndexSequence,E,C,T,R)},decodeGltfBuffer:function(E,C,T,R,B,U){c(s,s.exports[p[B]],E,C,T,R,s.exports[h[U]])},decodeGltfBufferAsync:function(E,C,T,R,B){return g.length>0?S(E,C,T,p[R],h[B]):a.then(function(){var U=new Uint8Array(E*C);return c(s,s.exports[p[R]],U,E,C,T,s.exports[h[B]]),U})}}})();const xT=new WeakMap;class bee extends zs{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){const s=new fs(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,a=>{this.parse(a,t,r)},i,r)}parse(e,t,i=()=>{}){this.decodeDracoFile(e,t,null,null,xi,i).catch(i)}decodeDracoFile(e,t,i,r,s=Xi,a=()=>{}){const o={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:s};return this.decodeGeometry(e,o).then(t).catch(a)}decodeGeometry(e,t){const i=JSON.stringify(t);if(xT.has(e)){const c=xT.get(e);if(c.key===i)return c.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,a=e.byteLength,o=this._getWorker(s,a).then(c=>(r=c,new Promise((h,p)=>{r._callbacks[s]={resolve:h,reject:p},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return o.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),xT.set(e,{key:i,promise:o}),o}_createGeometry(e){const t=new vn;e.index&&t.setIndex(new An(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const{name:r,array:s,itemSize:a,stride:o,vertexColorSpace:c}=e.attributes[i];let h;if(a===o)h=new An(s,a);else{const p=new sv(s,o);h=new Af(p,a,0)}r==="color"&&(this._assignVertexColorSpace(h,c),h.normalized=!(s instanceof Float32Array)),t.setAttribute(r,h)}return t}_assignVertexColorSpace(e,t){if(t!==xi)return;const i=new Mt;for(let r=0,s=e.count;r<s;r++)i.fromBufferAttribute(e,r),Wn.colorSpaceToWorking(i,xi),e.setXYZ(r,i.r,i.g,i.b)}_loadLibrary(e,t){const i=new fs(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=xee.toString(),a=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const a=s.data;switch(a.type){case"decode":r._callbacks[a.id].resolve(a);break;case"error":r._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function xee(){let n,e;onmessage=function(a){const o=a.data;switch(o.type){case"init":n=o.decoderConfig,e=new Promise(function(p){n.onModuleLoaded=function(g){p({draco:g})},DracoDecoderModule(n)});break;case"decode":const c=o.buffer,h=o.taskConfig;e.then(p=>{const g=p.draco,A=new g.Decoder;try{const v=t(g,A,new Int8Array(c),h),x=v.attributes.map(S=>S.array.buffer);v.index&&x.push(v.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:v},x)}catch(v){console.error(v),self.postMessage({type:"error",id:o.id,error:v.message})}finally{g.destroy(A)}});break}};function t(a,o,c,h){const p=h.attributeIDs,g=h.attributeTypes;let A,v;const x=o.GetEncodedGeometryType(c);if(x===a.TRIANGULAR_MESH)A=new a.Mesh,v=o.DecodeArrayToMesh(c,c.byteLength,A);else if(x===a.POINT_CLOUD)A=new a.PointCloud,v=o.DecodeArrayToPointCloud(c,c.byteLength,A);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!v.ok()||A.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+v.error_msg());const S={index:null,attributes:[]};for(const _ in p){const E=self[g[_]];let C,T;if(h.useUniqueIDs)T=p[_],C=o.GetAttributeByUniqueId(A,T);else{if(T=o.GetAttributeId(A,a[p[_]]),T===-1)continue;C=o.GetAttribute(A,T)}const R=r(a,o,A,_,E,C);_==="color"&&(R.vertexColorSpace=h.vertexColorSpace),S.attributes.push(R)}return x===a.TRIANGULAR_MESH&&(S.index=i(a,o,A)),a.destroy(A),S}function i(a,o,c){const p=c.num_faces()*3,g=p*4,A=a._malloc(g);o.GetTrianglesUInt32Array(c,g,A);const v=new Uint32Array(a.HEAPF32.buffer,A,p).slice();return a._free(A),{array:v,itemSize:1}}function r(a,o,c,h,p,g){const A=c.num_points(),v=g.num_components(),x=s(a,p),S=v*p.BYTES_PER_ELEMENT,_=Math.ceil(S/4)*4,E=_/p.BYTES_PER_ELEMENT,C=A*S,T=A*_,R=a._malloc(C);o.GetAttributeDataArrayForAllPoints(c,g,x,C,R);const B=new p(a.HEAPF32.buffer,R,C/p.BYTES_PER_ELEMENT);let U;if(S===_)U=B.slice();else{U=new p(T/p.BYTES_PER_ELEMENT);let O=0;for(let F=0,L=B.length;F<L;F++){for(let P=0;P<v;P++)U[O+P]=B[F*v+P];O+=E}}return a._free(R),{name:h,count:A,itemSize:v,array:U,stride:E}}function s(a,o){switch(o){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}function eU(n,e){if(e===o8)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===Rw||e===n4){let t=n.getIndex();if(t===null){const a=[],o=n.getAttribute("position");if(o!==void 0){for(let c=0;c<o.count;c++)a.push(c);n.setIndex(a),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,r=[];if(e===Rw)for(let a=1;a<=i;a++)r.push(t.getX(0)),r.push(t.getX(a)),r.push(t.getX(a+1));else for(let a=0;a<i;a++)a%2===0?(r.push(t.getX(a)),r.push(t.getX(a+1)),r.push(t.getX(a+2))):(r.push(t.getX(a+2)),r.push(t.getX(a+1)),r.push(t.getX(a)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class ax extends zs{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Mee(t)}),this.register(function(t){return new Cee(t)}),this.register(function(t){return new Fee(t)}),this.register(function(t){return new Pee(t)}),this.register(function(t){return new Oee(t)}),this.register(function(t){return new Iee(t)}),this.register(function(t){return new Ree(t)}),this.register(function(t){return new Bee(t)}),this.register(function(t){return new Dee(t)}),this.register(function(t){return new wee(t)}),this.register(function(t){return new Lee(t)}),this.register(function(t){return new Tee(t)}),this.register(function(t){return new Uee(t)}),this.register(function(t){return new Nee(t)}),this.register(function(t){return new See(t)}),this.register(function(t){return new kee(t)}),this.register(function(t){return new zee(t)})}load(e,t,i,r){const s=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const h=Pd.extractUrlBase(e);a=Pd.resolveURL(h,this.path)}else a=Pd.extractUrlBase(e);this.manager.itemStart(e);const o=function(h){r?r(h):console.error(h),s.manager.itemError(e),s.manager.itemEnd(e)},c=new fs(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(h){try{s.parse(h,a,function(p){t(p),s.manager.itemEnd(e)},o)}catch(p){o(p)}},i,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const a={},o={},c=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(c.decode(new Uint8Array(e,0,4))===C6){try{a[ai.KHR_BINARY_GLTF]=new Gee(e)}catch(g){r&&r(g);return}s=JSON.parse(a[ai.KHR_BINARY_GLTF].content)}else s=JSON.parse(c.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const h=new ete(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(let p=0;p<this.pluginCallbacks.length;p++){const g=this.pluginCallbacks[p](h);g.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[g.name]=g,a[g.name]=!0}if(s.extensionsUsed)for(let p=0;p<s.extensionsUsed.length;++p){const g=s.extensionsUsed[p],A=s.extensionsRequired||[];switch(g){case ai.KHR_MATERIALS_UNLIT:a[g]=new Eee;break;case ai.KHR_DRACO_MESH_COMPRESSION:a[g]=new Hee(s,this.dracoLoader);break;case ai.KHR_TEXTURE_TRANSFORM:a[g]=new Qee;break;case ai.KHR_MESH_QUANTIZATION:a[g]=new Vee;break;default:A.indexOf(g)>=0&&o[g]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+g+'".')}}h.setExtensions(a),h.setPlugins(o),h.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function _ee(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const ai={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class See{constructor(e){this.parser=e,this.name=ai.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,c=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let h;const p=new Mt(16777215);c.color!==void 0&&p.setRGB(c.color[0],c.color[1],c.color[2],Xi);const g=c.range!==void 0?c.range:0;switch(c.type){case"directional":h=new hv(p),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new XM(p),h.distance=g;break;case"spot":h=new M4(p),h.distance=g,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,h.angle=c.spot.outerConeAngle,h.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return h.position.set(0,0,0),zu(h,c),c.intensity!==void 0&&(h.intensity=c.intensity),h.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(h),t.cache.add(i,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],o=(s.extensions&&s.extensions[this.name]||{}).light;return o===void 0?null:this._loadLight(o).then(function(c){return i._getNodeRef(t.cache,o,c)})}}let Eee=class{constructor(){this.name=ai.KHR_MATERIALS_UNLIT}getMaterialType(){return ar}extendParams(e,t,i){const r=[];e.color=new Mt(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const a=s.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],Xi),e.opacity=a[3]}s.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",s.baseColorTexture,xi))}return Promise.all(r)}},wee=class{constructor(e){this.parser=e,this.name=ai.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}},Mee=class{constructor(e){this.parser=e,this.name=ai.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vl}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];if(a.clearcoatFactor!==void 0&&(t.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const o=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ze(o,o)}return Promise.all(s)}},Cee=class{constructor(e){this.parser=e,this.name=ai.KHR_MATERIALS_DISPERSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vl}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}},Tee=class{constructor(e){this.parser=e,this.name=ai.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vl}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.iridescenceFactor!==void 0&&(t.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(t.iridescenceIOR=a.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}},Iee=class{constructor(e){this.parser=e,this.name=ai.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vl}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Mt(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=r.extensions[this.name];if(a.sheenColorFactor!==void 0){const o=a.sheenColorFactor;t.sheenColor.setRGB(o[0],o[1],o[2],Xi)}return a.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",a.sheenColorTexture,xi)),a.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}},Ree=class{constructor(e){this.parser=e,this.name=ai.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vl}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(s)}},Bee=class{constructor(e){this.parser=e,this.name=ai.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vl}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];t.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const o=a.attenuationColor||[1,1,1];return t.attenuationColor=new Mt().setRGB(o[0],o[1],o[2],Xi),Promise.all(s)}},Dee=class{constructor(e){this.parser=e,this.name=ai.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vl}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}},Lee=class{constructor(e){this.parser=e,this.name=ai.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vl}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];t.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",a.specularTexture));const o=a.specularColorFactor||[1,1,1];return t.specularColor=new Mt().setRGB(o[0],o[1],o[2],Xi),a.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",a.specularColorTexture,xi)),Promise.all(s)}},Nee=class{constructor(e){this.parser=e,this.name=ai.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vl}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return t.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&s.push(i.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(s)}},Uee=class{constructor(e){this.parser=e,this.name=ai.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vl}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.anisotropyStrength!==void 0&&(t.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(t.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&s.push(i.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(s)}};class Fee{constructor(e){this.parser=e,this.name=ai.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,a)}}class Pee{constructor(e){this.parser=e,this.name=ai.EXT_TEXTURE_WEBP}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],o=r.images[a.source];let c=i.textureLoader;if(o.uri){const h=i.options.manager.getHandler(o.uri);h!==null&&(c=h)}return i.loadTextureImage(e,a.source,c)}}class Oee{constructor(e){this.parser=e,this.name=ai.EXT_TEXTURE_AVIF}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],o=r.images[a.source];let c=i.textureLoader;if(o.uri){const h=i.options.manager.getHandler(o.uri);h!==null&&(c=h)}return i.loadTextureImage(e,a.source,c)}}class kee{constructor(e){this.name=ai.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(o){const c=r.byteOffset||0,h=r.byteLength||0,p=r.count,g=r.byteStride,A=new Uint8Array(o,c,h);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(p,g,A,r.mode,r.filter).then(function(v){return v.buffer}):a.ready.then(function(){const v=new ArrayBuffer(p*g);return a.decodeGltfBuffer(new Uint8Array(v),p,g,A,r.mode,r.filter),v})})}else return null}}let zee=class{constructor(e){this.name=ai.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const r=t.meshes[i.mesh];for(const h of r.primitives)if(h.mode!==tc.TRIANGLES&&h.mode!==tc.TRIANGLE_STRIP&&h.mode!==tc.TRIANGLE_FAN&&h.mode!==void 0)return null;const a=i.extensions[this.name].attributes,o=[],c={};for(const h in a)o.push(this.parser.getDependency("accessor",a[h]).then(p=>(c[h]=p,c[h])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(h=>{const p=h.pop(),g=p.isGroup?p.children:[p],A=h[0].count,v=[];for(const x of g){const S=new qt,_=new ee,E=new Bi,C=new ee(1,1,1),T=new BM(x.geometry,x.material,A);for(let R=0;R<A;R++)c.TRANSLATION&&_.fromBufferAttribute(c.TRANSLATION,R),c.ROTATION&&E.fromBufferAttribute(c.ROTATION,R),c.SCALE&&C.fromBufferAttribute(c.SCALE,R),T.setMatrixAt(R,S.compose(_,E,C));for(const R in c)if(R==="_COLOR_0"){const B=c[R];T.instanceColor=new jd(B.array,B.itemSize,B.normalized)}else R!=="TRANSLATION"&&R!=="ROTATION"&&R!=="SCALE"&&x.geometry.setAttribute(R,c[R]);Gn.prototype.copy.call(T,x),this.parser.assignFinalMaterial(T),v.push(T)}return p.isGroup?(p.clear(),p.add(...v),p):v[0]}))}};const C6="glTF",u1=12,tU={JSON:1313821514,BIN:5130562};class Gee{constructor(e){this.name=ai.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,u1),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==C6)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-u1,s=new DataView(e,u1);let a=0;for(;a<r;){const o=s.getUint32(a,!0);a+=4;const c=s.getUint32(a,!0);if(a+=4,c===tU.JSON){const h=new Uint8Array(e,u1+a,o);this.content=i.decode(h)}else if(c===tU.BIN){const h=u1+a;this.body=e.slice(h,h+o)}a+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Hee{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ai.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},c={},h={};for(const p in a){const g=qR[p]||p.toLowerCase();o[g]=a[p]}for(const p in e.attributes){const g=qR[p]||p.toLowerCase();if(a[p]!==void 0){const A=i.accessors[e.attributes[p]],v=p0[A.componentType];h[g]=v.name,c[g]=A.normalized===!0}}return t.getDependency("bufferView",s).then(function(p){return new Promise(function(g,A){r.decodeDracoFile(p,function(v){for(const x in v.attributes){const S=v.attributes[x],_=c[x];_!==void 0&&(S.normalized=_)}g(v)},o,h,Xi,A)})})}}class Qee{constructor(){this.name=ai.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Vee{constructor(){this.name=ai.KHR_MESH_QUANTIZATION}}class T6 extends uv{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let a=0;a!==r;a++)t[a]=i[s+a];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=o*2,h=o*3,p=r-t,g=(i-t)/p,A=g*g,v=A*g,x=e*h,S=x-h,_=-2*v+3*A,E=v-A,C=1-_,T=E-A+g;for(let R=0;R!==o;R++){const B=a[S+R+o],U=a[S+R+c]*p,O=a[x+R+o],F=a[x+R]*p;s[R]=C*B+T*U+_*O+E*F}return s}}const jee=new Bi;class Wee extends T6{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return jee.fromArray(s).normalize().toArray(s),s}}const tc={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},p0={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},nU={9728:Ri,9729:mn,9984:Kd,9985:uf,9986:Wu,9987:ya},iU={33071:or,33648:mf,10497:hl},_T={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},qR={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},gd={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},qee={CUBICSPLINE:void 0,LINEAR:Hm,STEP:Gm},ST={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Xee(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new Ks({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:cc})),n.DefaultMaterial}function em(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function zu(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Yee(n,e,t){let i=!1,r=!1,s=!1;for(let h=0,p=e.length;h<p;h++){const g=e[h];if(g.POSITION!==void 0&&(i=!0),g.NORMAL!==void 0&&(r=!0),g.COLOR_0!==void 0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const a=[],o=[],c=[];for(let h=0,p=e.length;h<p;h++){const g=e[h];if(i){const A=g.POSITION!==void 0?t.getDependency("accessor",g.POSITION):n.attributes.position;a.push(A)}if(r){const A=g.NORMAL!==void 0?t.getDependency("accessor",g.NORMAL):n.attributes.normal;o.push(A)}if(s){const A=g.COLOR_0!==void 0?t.getDependency("accessor",g.COLOR_0):n.attributes.color;c.push(A)}}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(c)]).then(function(h){const p=h[0],g=h[1],A=h[2];return i&&(n.morphAttributes.position=p),r&&(n.morphAttributes.normal=g),s&&(n.morphAttributes.color=A),n.morphTargetsRelative=!0,n})}function Kee(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function $ee(n){let e;const t=n.extensions&&n.extensions[ai.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+ET(t.attributes):e=n.indices+":"+ET(n.attributes)+":"+n.mode,n.targets!==void 0)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+ET(n.targets[i]);return e}function ET(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function XR(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Jee(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":n.search(/\.ktx2($|\?)/i)>0||n.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const Zee=new qt;class ete{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new _ee,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=-1,s=!1,a=-1;if(typeof navigator<"u"){const o=navigator.userAgent;i=/^((?!chrome|android).)*safari/i.test(o)===!0;const c=o.match(/Version\/(\d+)/);r=i&&c?parseInt(c[1],10):-1,s=o.indexOf("Firefox")>-1,a=s?o.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||i&&r<17||s&&a<98?this.textureLoader=new E4(this.options.manager):this.textureLoader=new n6(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new fs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(a){const o={scene:a[0][r.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:r.asset,parser:i,userData:{}};return em(s,o,r),zu(o,r),Promise.all(i._invokeAll(function(c){return c.afterRoot&&c.afterRoot(o)})).then(function(){for(const c of o.scenes)c.updateMatrixWorld();e(o)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const a=t[r].joints;for(let o=0,c=a.length;o<c;o++)e[a[o]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const a=e[r];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(i[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(a,o)=>{const c=this.associations.get(a);c!=null&&this.associations.set(o,c);for(const[h,p]of a.children.entries())s(p,o.children[h])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,a){return i.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[ai.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,a){i.load(Pd.resolveURL(t.uri,r.path),s,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const r=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+r)})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const a=_T[r.type],o=p0[r.componentType],c=r.normalized===!0,h=new o(r.count*a);return Promise.resolve(new An(h,a,c))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(a){const o=a[0],c=_T[r.type],h=p0[r.componentType],p=h.BYTES_PER_ELEMENT,g=p*c,A=r.byteOffset||0,v=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,x=r.normalized===!0;let S,_;if(v&&v!==g){const E=Math.floor(A/v),C="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+E+":"+r.count;let T=t.cache.get(C);T||(S=new h(o,E*v,r.count*v/p),T=new sv(S,v/p),t.cache.add(C,T)),_=new Af(T,c,A%v/p,x)}else o===null?S=new h(r.count*c):S=new h(o,A,r.count*c),_=new An(S,c,x);if(r.sparse!==void 0){const E=_T.SCALAR,C=p0[r.sparse.indices.componentType],T=r.sparse.indices.byteOffset||0,R=r.sparse.values.byteOffset||0,B=new C(a[1],T,r.sparse.count*E),U=new h(a[2],R,r.sparse.count*c);o!==null&&(_=new An(_.array.slice(),_.itemSize,_.normalized)),_.normalized=!1;for(let O=0,F=B.length;O<F;O++){const L=B[O];if(_.setX(L,U[O*c]),c>=2&&_.setY(L,U[O*c+1]),c>=3&&_.setZ(L,U[O*c+2]),c>=4&&_.setW(L,U[O*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}_.normalized=x}return _})}loadTexture(e){const t=this.json,i=this.options,s=t.textures[e].source,a=t.images[s];let o=this.textureLoader;if(a.uri){const c=i.manager.getHandler(a.uri);c!==null&&(o=c)}return this.loadTextureImage(e,s,o)}loadTextureImage(e,t,i){const r=this,s=this.json,a=s.textures[e],o=s.images[t],c=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[c])return this.textureCache[c];const h=this.loadImageSource(t,i).then(function(p){p.flipY=!1,p.name=a.name||o.name||"",p.name===""&&typeof o.uri=="string"&&o.uri.startsWith("data:image/")===!1&&(p.name=o.uri);const A=(s.samplers||{})[a.sampler]||{};return p.magFilter=nU[A.magFilter]||mn,p.minFilter=nU[A.minFilter]||ya,p.wrapS=iU[A.wrapS]||hl,p.wrapT=iU[A.wrapT]||hl,p.generateMipmaps=!p.isCompressedTexture&&p.minFilter!==Ri&&p.minFilter!==mn,r.associations.set(p,{textures:e}),p}).catch(function(){return null});return this.textureCache[c]=h,h}loadImageSource(e,t){const i=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(g=>g.clone());const a=r.images[e],o=self.URL||self.webkitURL;let c=a.uri||"",h=!1;if(a.bufferView!==void 0)c=i.getDependency("bufferView",a.bufferView).then(function(g){h=!0;const A=new Blob([g],{type:a.mimeType});return c=o.createObjectURL(A),c});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const p=Promise.resolve(c).then(function(g){return new Promise(function(A,v){let x=A;t.isImageBitmapLoader===!0&&(x=function(S){const _=new Pi(S);_.needsUpdate=!0,A(_)}),t.load(Pd.resolveURL(g,s.path),x,void 0,v)})}).then(function(g){return h===!0&&o.revokeObjectURL(c),zu(g,a),g.userData.mimeType=a.mimeType||Jee(a.uri),g}).catch(function(g){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),g});return this.sourceCache[e]=p,p}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(a){if(!a)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(a=a.clone(),a.channel=i.texCoord),s.extensions[ai.KHR_TEXTURE_TRANSFORM]){const o=i.extensions!==void 0?i.extensions[ai.KHR_TEXTURE_TRANSFORM]:void 0;if(o){const c=s.associations.get(a);a=s.extensions[ai.KHR_TEXTURE_TRANSFORM].extendTexture(a,o),s.associations.set(a,c)}}return r!==void 0&&(a.colorSpace=r),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,a=t.attributes.normal===void 0;if(e.isPoints){const o="PointsMaterial:"+i.uuid;let c=this.cache.get(o);c||(c=new LM,ts.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,c.sizeAttenuation=!1,this.cache.add(o,c)),i=c}else if(e.isLine){const o="LineBasicMaterial:"+i.uuid;let c=this.cache.get(o);c||(c=new za,ts.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,this.cache.add(o,c)),i=c}if(r||s||a){let o="ClonedMaterial:"+i.uuid+":";r&&(o+="derivative-tangents:"),s&&(o+="vertex-colors:"),a&&(o+="flat-shading:");let c=this.cache.get(o);c||(c=i.clone(),s&&(c.vertexColors=!0),a&&(c.flatShading=!0),r&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(o,c),this.associations.set(c,this.associations.get(i))),i=c}e.material=i}getMaterialType(){return Ks}loadMaterial(e){const t=this,i=this.json,r=this.extensions,s=i.materials[e];let a;const o={},c=s.extensions||{},h=[];if(c[ai.KHR_MATERIALS_UNLIT]){const g=r[ai.KHR_MATERIALS_UNLIT];a=g.getMaterialType(),h.push(g.extendParams(o,s,t))}else{const g=s.pbrMetallicRoughness||{};if(o.color=new Mt(1,1,1),o.opacity=1,Array.isArray(g.baseColorFactor)){const A=g.baseColorFactor;o.color.setRGB(A[0],A[1],A[2],Xi),o.opacity=A[3]}g.baseColorTexture!==void 0&&h.push(t.assignTexture(o,"map",g.baseColorTexture,xi)),o.metalness=g.metallicFactor!==void 0?g.metallicFactor:1,o.roughness=g.roughnessFactor!==void 0?g.roughnessFactor:1,g.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(o,"metalnessMap",g.metallicRoughnessTexture)),h.push(t.assignTexture(o,"roughnessMap",g.metallicRoughnessTexture))),a=this._invokeOne(function(A){return A.getMaterialType&&A.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(A){return A.extendMaterialParams&&A.extendMaterialParams(e,o)})))}s.doubleSided===!0&&(o.side=gi);const p=s.alphaMode||ST.OPAQUE;if(p===ST.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,p===ST.MASK&&(o.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&a!==ar&&(h.push(t.assignTexture(o,"normalMap",s.normalTexture)),o.normalScale=new Ze(1,1),s.normalTexture.scale!==void 0)){const g=s.normalTexture.scale;o.normalScale.set(g,g)}if(s.occlusionTexture!==void 0&&a!==ar&&(h.push(t.assignTexture(o,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(o.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&a!==ar){const g=s.emissiveFactor;o.emissive=new Mt().setRGB(g[0],g[1],g[2],Xi)}return s.emissiveTexture!==void 0&&a!==ar&&h.push(t.assignTexture(o,"emissiveMap",s.emissiveTexture,xi)),Promise.all(h).then(function(){const g=new a(o);return s.name&&(g.name=s.name),zu(g,s),t.associations.set(g,{materials:e}),s.extensions&&em(r,g,s),g})}createUniqueName(e){const t=ei.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(o){return i[ai.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(o,t).then(function(c){return rU(c,o,t)})}const a=[];for(let o=0,c=e.length;o<c;o++){const h=e[o],p=$ee(h),g=r[p];if(g)a.push(g.promise);else{let A;h.extensions&&h.extensions[ai.KHR_DRACO_MESH_COMPRESSION]?A=s(h):A=rU(new vn,h,t),r[p]={primitive:h,promise:A},a.push(A)}}return Promise.all(a)}loadMesh(e){const t=this,i=this.json,r=this.extensions,s=i.meshes[e],a=s.primitives,o=[];for(let c=0,h=a.length;c<h;c++){const p=a[c].material===void 0?Xee(this.cache):this.getDependency("material",a[c].material);o.push(p)}return o.push(t.loadGeometries(a)),Promise.all(o).then(function(c){const h=c.slice(0,c.length-1),p=c[c.length-1],g=[];for(let v=0,x=p.length;v<x;v++){const S=p[v],_=a[v];let E;const C=h[v];if(_.mode===tc.TRIANGLES||_.mode===tc.TRIANGLE_STRIP||_.mode===tc.TRIANGLE_FAN||_.mode===void 0)E=s.isSkinnedMesh===!0?new u4(S,C):new Wt(S,C),E.isSkinnedMesh===!0&&E.normalizeSkinWeights(),_.mode===tc.TRIANGLE_STRIP?E.geometry=eU(E.geometry,n4):_.mode===tc.TRIANGLE_FAN&&(E.geometry=eU(E.geometry,Rw));else if(_.mode===tc.LINES)E=new qc(S,C);else if(_.mode===tc.LINE_STRIP)E=new Wc(S,C);else if(_.mode===tc.LINE_LOOP)E=new h4(S,C);else if(_.mode===tc.POINTS)E=new f4(S,C);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_.mode);Object.keys(E.geometry.morphAttributes).length>0&&Kee(E,s),E.name=t.createUniqueName(s.name||"mesh_"+e),zu(E,s),_.extensions&&em(r,E,_),t.assignFinalMaterial(E),g.push(E)}for(let v=0,x=g.length;v<x;v++)t.associations.set(g[v],{meshes:e,primitives:v});if(g.length===1)return s.extensions&&em(r,g[0],s),g[0];const A=new Ds;s.extensions&&em(r,A,s),t.associations.set(A,{meshes:e});for(let v=0,x=g.length;v<x;v++)A.add(g[v]);return A})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new Gr(D0.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(t=new Yc(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),zu(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(r){const s=r.pop(),a=r,o=[],c=[];for(let h=0,p=a.length;h<p;h++){const g=a[h];if(g){o.push(g);const A=new qt;s!==null&&A.fromArray(s.array,h*16),c.push(A)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new ix(o,c)})}loadAnimation(e){const t=this.json,i=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,a=[],o=[],c=[],h=[],p=[];for(let g=0,A=r.channels.length;g<A;g++){const v=r.channels[g],x=r.samplers[v.sampler],S=v.target,_=S.node,E=r.parameters!==void 0?r.parameters[x.input]:x.input,C=r.parameters!==void 0?r.parameters[x.output]:x.output;S.node!==void 0&&(a.push(this.getDependency("node",_)),o.push(this.getDependency("accessor",E)),c.push(this.getDependency("accessor",C)),h.push(x),p.push(S))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(c),Promise.all(h),Promise.all(p)]).then(function(g){const A=g[0],v=g[1],x=g[2],S=g[3],_=g[4],E=[];for(let T=0,R=A.length;T<R;T++){const B=A[T],U=v[T],O=x[T],F=S[T],L=_[T];if(B===void 0)continue;B.updateMatrix&&B.updateMatrix();const P=i._createAnimationTracks(B,U,O,F,L);if(P)for(let W=0;W<P.length;W++)E.push(P[W])}const C=new F0(s,void 0,E);return zu(C,r),C})}createNodeMesh(e){const t=this.json,i=this,r=t.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(s){const a=i._getNodeRef(i.meshCache,r.mesh,s);return r.weights!==void 0&&a.traverse(function(o){if(o.isMesh)for(let c=0,h=r.weights.length;c<h;c++)o.morphTargetInfluences[c]=r.weights[c]}),a})}loadNode(e){const t=this.json,i=this,r=t.nodes[e],s=i._loadNodeShallow(e),a=[],o=r.children||[];for(let h=0,p=o.length;h<p;h++)a.push(i.getDependency("node",o[h]));const c=r.skin===void 0?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(a),c]).then(function(h){const p=h[0],g=h[1],A=h[2];A!==null&&p.traverse(function(v){v.isSkinnedMesh&&v.bind(A,Zee)});for(let v=0,x=g.length;v<x;v++)p.add(g[v]);return p})}_loadNodeShallow(e){const t=this.json,i=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],a=s.name?r.createUniqueName(s.name):"",o=[],c=r._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return c&&o.push(c),s.camera!==void 0&&o.push(r.getDependency("camera",s.camera).then(function(h){return r._getNodeRef(r.cameraCache,s.camera,h)})),r._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){o.push(h)}),this.nodeCache[e]=Promise.all(o).then(function(h){let p;if(s.isBone===!0?p=new RM:h.length>1?p=new Ds:h.length===1?p=h[0]:p=new Gn,p!==h[0])for(let g=0,A=h.length;g<A;g++)p.add(h[g]);if(s.name&&(p.userData.name=s.name,p.name=a),zu(p,s),s.extensions&&em(i,p,s),s.matrix!==void 0){const g=new qt;g.fromArray(s.matrix),p.applyMatrix4(g)}else s.translation!==void 0&&p.position.fromArray(s.translation),s.rotation!==void 0&&p.quaternion.fromArray(s.rotation),s.scale!==void 0&&p.scale.fromArray(s.scale);if(!r.associations.has(p))r.associations.set(p,{});else if(s.mesh!==void 0&&r.meshCache.refs[s.mesh]>1){const g=r.associations.get(p);r.associations.set(p,{...g})}return r.associations.get(p).nodes=e,p}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new Ds;i.name&&(s.name=r.createUniqueName(i.name)),zu(s,i),i.extensions&&em(t,s,i);const a=i.nodes||[],o=[];for(let c=0,h=a.length;c<h;c++)o.push(r.getDependency("node",a[c]));return Promise.all(o).then(function(c){for(let p=0,g=c.length;p<g;p++)s.add(c[p]);const h=p=>{const g=new Map;for(const[A,v]of r.associations)(A instanceof ts||A instanceof Pi)&&g.set(A,v);return p.traverse(A=>{const v=r.associations.get(A);v!=null&&g.set(A,v)}),g};return r.associations=h(s),s})}_createAnimationTracks(e,t,i,r,s){const a=[],o=e.name?e.name:e.uuid,c=[];gd[s.path]===gd.weights?e.traverse(function(A){A.morphTargetInfluences&&c.push(A.name?A.name:A.uuid)}):c.push(o);let h;switch(gd[s.path]){case gd.weights:h=Wm;break;case gd.rotation:h=qm;break;case gd.translation:case gd.scale:h=Xm;break;default:i.itemSize===1?h=Wm:h=Xm;break}const p=r.interpolation!==void 0?qee[r.interpolation]:Hm,g=this._getArrayFromAccessor(i);for(let A=0,v=c.length;A<v;A++){const x=new h(c[A]+"."+gd[s.path],t.array,g,p);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(x),a.push(x)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=XR(t.constructor),r=new Float32Array(t.length);for(let s=0,a=t.length;s<a;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const r=this instanceof qm?Wee:T6;return new r(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function tte(n,e,t){const i=e.attributes,r=new gr;if(i.POSITION!==void 0){const o=t.json.accessors[i.POSITION],c=o.min,h=o.max;if(c!==void 0&&h!==void 0){if(r.set(new ee(c[0],c[1],c[2]),new ee(h[0],h[1],h[2])),o.normalized){const p=XR(p0[o.componentType]);r.min.multiplyScalar(p),r.max.multiplyScalar(p)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const o=new ee,c=new ee;for(let h=0,p=s.length;h<p;h++){const g=s[h];if(g.POSITION!==void 0){const A=t.json.accessors[g.POSITION],v=A.min,x=A.max;if(v!==void 0&&x!==void 0){if(c.setX(Math.max(Math.abs(v[0]),Math.abs(x[0]))),c.setY(Math.max(Math.abs(v[1]),Math.abs(x[1]))),c.setZ(Math.max(Math.abs(v[2]),Math.abs(x[2]))),A.normalized){const S=XR(p0[A.componentType]);c.multiplyScalar(S)}o.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(o)}n.boundingBox=r;const a=new jr;r.getCenter(a.center),a.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=a}function rU(n,e,t){const i=e.attributes,r=[];function s(a,o){return t.getDependency("accessor",a).then(function(c){n.setAttribute(o,c)})}for(const a in i){const o=qR[a]||a.toLowerCase();o in n.attributes||r.push(s(i[a],o))}if(e.indices!==void 0&&!n.index){const a=t.getDependency("accessor",e.indices).then(function(o){n.setIndex(o)});r.push(a)}return Wn.workingColorSpace!==Xi&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Wn.workingColorSpace}" not supported.`),zu(n,e),tte(n,e,t),Promise.all(r).then(function(){return e.targets!==void 0?Yee(n,e.targets,t):n})}class nte{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0,this.workerCreator=null}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const i=this.workersResolve[e];if(i&&i(t),this.queue.length){const{resolve:r,msg:s,transfer:a}=this.queue.shift();this.workersResolve[e]=r,this.workers[e].postMessage(s,a)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(i=>{const r=this._getIdleWorker();r!==-1?(this._initWorker(r),this.workerStatus|=1<<r,this.workersResolve[r]=i,this.workers[r].postMessage(e,t)):this.queue.push({resolve:i,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const ite=0,sU=2,rte=1,aU=2,ste=0,ate=1,ote=10,lte=0,I6=9,R6=15,B6=16,D6=22,L6=37,N6=43,U6=76,F6=83,P6=97,O6=100,k6=103,z6=109,G6=122,H6=123,Q6=131,V6=132,j6=133,W6=134,q6=137,X6=138,Y6=139,K6=140,$6=141,J6=142,Z6=145,e9=146,t9=148,n9=152,YR=153,cte=154,KR=155,ute=156,i9=157,r9=158,s9=165,a9=166,o9=1000054e3,l9=1000054001,c9=1000054004,u9=1000054005,z4=1000066e3,h9=1000066004;let h1=class{constructor(e,t,i,r){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(e.buffer,e.byteOffset+t,i),this._littleEndian=r,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint8Array(e){const t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,e);return this._offset+=e,t}_skip(e){return this._offset+=e,this}_scan(e,t=0){const i=this._offset;let r=0;for(;this._dataView.getUint8(this._offset)!==t&&r<e;)r++,this._offset++;return r<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+i,r)}};const eo=[171,75,84,88,32,50,48,187,13,10,26,10];function oU(n){return new TextDecoder().decode(n)}function hte(n){const e=new Uint8Array(n.buffer,n.byteOffset,eo.length);if(e[0]!==eo[0]||e[1]!==eo[1]||e[2]!==eo[2]||e[3]!==eo[3]||e[4]!==eo[4]||e[5]!==eo[5]||e[6]!==eo[6]||e[7]!==eo[7]||e[8]!==eo[8]||e[9]!==eo[9]||e[10]!==eo[10]||e[11]!==eo[11])throw new Error("Missing KTX 2.0 identifier.");const t={vkFormat:0,typeSize:1,pixelWidth:0,pixelHeight:0,pixelDepth:0,layerCount:0,faceCount:1,levelCount:0,supercompressionScheme:0,levels:[],dataFormatDescriptor:[{vendorId:0,descriptorType:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],keyValue:{},globalData:null},i=17*Uint32Array.BYTES_PER_ELEMENT,r=new h1(n,eo.length,i,!0);t.vkFormat=r._nextUint32(),t.typeSize=r._nextUint32(),t.pixelWidth=r._nextUint32(),t.pixelHeight=r._nextUint32(),t.pixelDepth=r._nextUint32(),t.layerCount=r._nextUint32(),t.faceCount=r._nextUint32(),t.levelCount=r._nextUint32(),t.supercompressionScheme=r._nextUint32();const s=r._nextUint32(),a=r._nextUint32(),o=r._nextUint32(),c=r._nextUint32(),h=r._nextUint64(),p=r._nextUint64(),g=3*Math.max(t.levelCount,1)*8,A=new h1(n,eo.length+i,g,!0);for(let z=0,$=Math.max(t.levelCount,1);z<$;z++)t.levels.push({levelData:new Uint8Array(n.buffer,n.byteOffset+A._nextUint64(),A._nextUint64()),uncompressedByteLength:A._nextUint64()});const v=new h1(n,s,a,!0);v._skip(4);const x=v._nextUint16(),S=v._nextUint16(),_=v._nextUint16(),E=v._nextUint16(),C={vendorId:x,descriptorType:S,versionNumber:_,colorModel:v._nextUint8(),colorPrimaries:v._nextUint8(),transferFunction:v._nextUint8(),flags:v._nextUint8(),texelBlockDimension:[v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8()],bytesPlane:[v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8()],samples:[]},T=(E/4-6)/4;for(let z=0;z<T;z++){const $={bitOffset:v._nextUint16(),bitLength:v._nextUint8(),channelType:v._nextUint8(),samplePosition:[v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8()],sampleLower:Number.NEGATIVE_INFINITY,sampleUpper:Number.POSITIVE_INFINITY};64&$.channelType?($.sampleLower=v._nextInt32(),$.sampleUpper=v._nextInt32()):($.sampleLower=v._nextUint32(),$.sampleUpper=v._nextUint32()),C.samples[z]=$}t.dataFormatDescriptor.length=0,t.dataFormatDescriptor.push(C);const R=new h1(n,o,c,!0);for(;R._offset<c;){const z=R._nextUint32(),$=R._scan(z),ae=oU($);if(t.keyValue[ae]=R._nextUint8Array(z-$.byteLength-1),ae.match(/^ktx/i)){const he=oU(t.keyValue[ae]);t.keyValue[ae]=he.substring(0,he.lastIndexOf("\0"))}R._skip(z%4?4-z%4:0)}if(p<=0)return t;const B=new h1(n,h,p,!0),U=B._nextUint16(),O=B._nextUint16(),F=B._nextUint32(),L=B._nextUint32(),P=B._nextUint32(),W=B._nextUint32(),j=[];for(let z=0,$=Math.max(t.levelCount,1);z<$;z++)j.push({imageFlags:B._nextUint32(),rgbSliceByteOffset:B._nextUint32(),rgbSliceByteLength:B._nextUint32(),alphaSliceByteOffset:B._nextUint32(),alphaSliceByteLength:B._nextUint32()});const V=h+B._offset,q=V+F,re=q+L,Q=re+P,K=new Uint8Array(n.buffer,n.byteOffset+V,F),ce=new Uint8Array(n.buffer,n.byteOffset+q,L),ue=new Uint8Array(n.buffer,n.byteOffset+re,P),oe=new Uint8Array(n.buffer,n.byteOffset+Q,W);return t.globalData={endpointCount:U,selectorCount:O,imageDescs:j,endpointsData:K,selectorsData:ce,tablesData:ue,extendedData:oe},t}let wT,rf,$R;const MT={env:{emscripten_notify_memory_growth:function(n){$R=new Uint8Array(rf.exports.memory.buffer)}}};let fte=class{init(){return wT||(wT=typeof fetch<"u"?fetch("data:application/wasm;base64,"+lU).then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,MT)).then(this._init):WebAssembly.instantiate(Buffer.from(lU,"base64"),MT).then(this._init),wT)}_init(e){rf=e.instance,MT.env.emscripten_notify_memory_growth(0)}decode(e,t=0){if(!rf)throw new Error("ZSTDDecoder: Await .init() before decoding.");const i=e.byteLength,r=rf.exports.malloc(i);$R.set(e,r),t=t||Number(rf.exports.ZSTD_findDecompressedSize(r,i));const s=rf.exports.malloc(t),a=rf.exports.ZSTD_decompress(s,t,r,i),o=$R.slice(s,s+a);return rf.exports.free(r),rf.exports.free(s),o}};const lU="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ",dte="display-p3",pte="display-p3-linear";({...Wn.spaces[xi]});const CT=new WeakMap;let TT=0,IT;class rc extends zs{constructor(e){super(e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new nte,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(e){return this.transcoderPath=e,this}setWorkerLimit(e){return this.workerPool.setWorkerLimit(e),this}async detectSupportAsync(e){return console.warn('KTX2Loader: "detectSupportAsync()" has been deprecated. Use "detectSupport()" and "await renderer.init();" when creating the renderer.'),await e.init(),this.detectSupport(e)}detectSupport(e){return e.isWebGPURenderer===!0?this.workerConfig={astcSupported:e.hasFeature("texture-compression-astc"),astcHDRSupported:!1,etc1Supported:e.hasFeature("texture-compression-etc1"),etc2Supported:e.hasFeature("texture-compression-etc2"),dxtSupported:e.hasFeature("texture-compression-s3tc"),bptcSupported:e.hasFeature("texture-compression-bc"),pvrtcSupported:e.hasFeature("texture-compression-pvrtc")}:(this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),astcHDRSupported:e.extensions.has("WEBGL_compressed_texture_astc")&&e.extensions.get("WEBGL_compressed_texture_astc").getSupportedProfiles().includes("hdr"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},typeof navigator<"u"&&navigator.platform.indexOf("Linux")>=0&&navigator.userAgent.indexOf("Firefox")>=0&&this.workerConfig.astcSupported&&this.workerConfig.etc2Supported&&this.workerConfig.bptcSupported&&this.workerConfig.dxtSupported&&(this.workerConfig.astcSupported=!1,this.workerConfig.etc2Supported=!1)),this}init(){if(!this.transcoderPending){const e=new fs(this.manager);e.setPath(this.transcoderPath),e.setWithCredentials(this.withCredentials);const t=e.loadAsync("basis_transcoder.js"),i=new fs(this.manager);i.setPath(this.transcoderPath),i.setResponseType("arraybuffer"),i.setWithCredentials(this.withCredentials);const r=i.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([t,r]).then(([s,a])=>{const o=rc.BasisWorker.toString(),c=["/* constants */","let _EngineFormat = "+JSON.stringify(rc.EngineFormat),"let _EngineType = "+JSON.stringify(rc.EngineType),"let _TranscoderFormat = "+JSON.stringify(rc.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(rc.BasisFormat),"/* basis_transcoder.js */",s,"/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([c])),this.transcoderBinary=a,this.workerPool.setWorkerCreator(()=>{const h=new Worker(this.workerSourceURL),p=this.transcoderBinary.slice(0);return h.postMessage({type:"init",config:this.workerConfig,transcoderBinary:p},[p]),h})}),TT>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),TT++}return this.transcoderPending}load(e,t,i,r){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const s=new fs(this.manager);s.setPath(this.path),s.setCrossOrigin(this.crossOrigin),s.setWithCredentials(this.withCredentials),s.setRequestHeader(this.requestHeader),s.setResponseType("arraybuffer"),s.load(e,a=>{this.parse(a,t,r)},i,r)}parse(e,t,i){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");if(CT.has(e))return CT.get(e).promise.then(t).catch(i);this._createTexture(e).then(r=>t?t(r):null).catch(i)}_createTextureFrom(e,t){const{type:i,error:r,data:{faces:s,width:a,height:o,format:c,type:h,dfdFlags:p}}=e;if(i==="error")return Promise.reject(r);let g;if(t.faceCount===6)g=new C8(s,c,h);else{const A=s[0].mipmaps;g=t.layerCount>1?new M8(A,a,o,t.layerCount,c,h):new ff(A,a,o,c,h)}return g.minFilter=s[0].mipmaps.length===1?mn:ya,g.magFilter=mn,g.generateMipmaps=!1,g.needsUpdate=!0,g.colorSpace=f9(t),g.premultiplyAlpha=!!(p&rte),g}async _createTexture(e,t={}){const i=hte(new Uint8Array(e)),r=i.vkFormat===z4&&i.dataFormatDescriptor[0].colorModel===167;if(!(i.vkFormat===lte||r&&!this.workerConfig.astcHDRSupported))return gte(i);const a=t,o=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:e,taskConfig:a},[e])).then(c=>this._createTextureFrom(c.data,i));return CT.set(e,{promise:o}),o}dispose(){this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),TT--}}rc.BasisFormat={ETC1S:0,UASTC:1,UASTC_HDR:2};rc.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16,BC6H:22,RGB_HALF:24,RGBA_HALF:25};rc.EngineFormat={RGBAFormat:Fi,RGBA_ASTC_4x4_Format:Fd,RGB_BPTC_UNSIGNED_Format:yb,RGBA_BPTC_Format:zm,RGBA_ETC2_EAC_Format:C0,RGBA_PVRTC_4BPPV1_Format:km,RGBA_S3TC_DXT5_Format:f0,RGB_ETC1_Format:pb,RGB_ETC2_Format:M0,RGB_PVRTC_4BPPV1_Format:db,RGBA_S3TC_DXT1_Format:Ud};rc.EngineType={UnsignedByteType:xn,HalfFloatType:ci,FloatType:Si};rc.BasisWorker=function(){let n,e,t;const i=_EngineFormat,r=_EngineType,s=_TranscoderFormat,a=_BasisFormat;self.addEventListener("message",function(x){const S=x.data;switch(S.type){case"init":n=S.config,o(S.transcoderBinary);break;case"transcode":e.then(()=>{try{const{faces:_,buffers:E,width:C,height:T,hasAlpha:R,format:B,type:U,dfdFlags:O}=c(S.buffer);self.postMessage({type:"transcode",id:S.id,data:{faces:_,width:C,height:T,hasAlpha:R,format:B,type:U,dfdFlags:O}},E)}catch(_){console.error(_),self.postMessage({type:"error",id:S.id,error:_.message})}});break}});function o(x){e=new Promise(S=>{t={wasmBinary:x,onRuntimeInitialized:S},BASIS(t)}).then(()=>{t.initializeBasis(),t.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function c(x){const S=new t.KTX2File(new Uint8Array(x));function _(){S.close(),S.delete()}if(!S.isValid())throw _(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");let E;if(S.isUASTC())E=a.UASTC;else if(S.isETC1S())E=a.ETC1S;else if(S.isHDR())E=a.UASTC_HDR;else throw new Error("THREE.KTX2Loader: Unknown Basis encoding");const C=S.getWidth(),T=S.getHeight(),R=S.getLayers()||1,B=S.getLevels(),U=S.getFaces(),O=S.getHasAlpha(),F=S.getDFDFlags(),{transcoderFormat:L,engineFormat:P,engineType:W}=g(E,C,T,O);if(!C||!T||!B)throw _(),new Error("THREE.KTX2Loader:	Invalid texture");if(!S.startTranscoding())throw _(),new Error("THREE.KTX2Loader: .startTranscoding failed");const j=[],V=[];for(let q=0;q<U;q++){const re=[];for(let Q=0;Q<B;Q++){const K=[];let ce,ue;for(let z=0;z<R;z++){const $=S.getImageLevelInfo(Q,z,q);q===0&&Q===0&&z===0&&($.origWidth%4!==0||$.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),B>1?(ce=$.origWidth,ue=$.origHeight):(ce=$.width,ue=$.height);let ae=new Uint8Array(S.getImageTranscodedSizeInBytes(Q,z,0,L));const he=S.transcodeImage(ae,Q,z,q,L,0,-1,-1);if(W===r.HalfFloatType&&(ae=new Uint16Array(ae.buffer,ae.byteOffset,ae.byteLength/Uint16Array.BYTES_PER_ELEMENT)),!he)throw _(),new Error("THREE.KTX2Loader: .transcodeImage failed.");K.push(ae)}const oe=v(K);re.push({data:oe,width:ce,height:ue}),V.push(oe.buffer)}j.push({mipmaps:re,width:C,height:T,format:P,type:W})}return _(),{faces:j,buffers:V,width:C,height:T,hasAlpha:O,dfdFlags:F,format:P,type:W}}const h=[{if:"astcSupported",basisFormat:[a.UASTC],transcoderFormat:[s.ASTC_4x4,s.ASTC_4x4],engineFormat:[i.RGBA_ASTC_4x4_Format,i.RGBA_ASTC_4x4_Format],engineType:[r.UnsignedByteType],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[s.BC7_M5,s.BC7_M5],engineFormat:[i.RGBA_BPTC_Format,i.RGBA_BPTC_Format],engineType:[r.UnsignedByteType],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[s.BC1,s.BC3],engineFormat:[i.RGBA_S3TC_DXT1_Format,i.RGBA_S3TC_DXT5_Format],engineType:[r.UnsignedByteType],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[s.ETC1,s.ETC2],engineFormat:[i.RGB_ETC2_Format,i.RGBA_ETC2_EAC_Format],engineType:[r.UnsignedByteType],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[s.ETC1],engineFormat:[i.RGB_ETC1_Format],engineType:[r.UnsignedByteType],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[s.PVRTC1_4_RGB,s.PVRTC1_4_RGBA],engineFormat:[i.RGB_PVRTC_4BPPV1_Format,i.RGBA_PVRTC_4BPPV1_Format],engineType:[r.UnsignedByteType],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0},{if:"bptcSupported",basisFormat:[a.UASTC_HDR],transcoderFormat:[s.BC6H],engineFormat:[i.RGB_BPTC_UNSIGNED_Format],engineType:[r.HalfFloatType],priorityHDR:1,needsPowerOfTwo:!1},{basisFormat:[a.ETC1S,a.UASTC],transcoderFormat:[s.RGBA32,s.RGBA32],engineFormat:[i.RGBAFormat,i.RGBAFormat],engineType:[r.UnsignedByteType,r.UnsignedByteType],priorityETC1S:100,priorityUASTC:100,needsPowerOfTwo:!1},{basisFormat:[a.UASTC_HDR],transcoderFormat:[s.RGBA_HALF],engineFormat:[i.RGBAFormat],engineType:[r.HalfFloatType],priorityHDR:100,needsPowerOfTwo:!1}],p={[a.ETC1S]:h.filter(x=>x.basisFormat.includes(a.ETC1S)).sort((x,S)=>x.priorityETC1S-S.priorityETC1S),[a.UASTC]:h.filter(x=>x.basisFormat.includes(a.UASTC)).sort((x,S)=>x.priorityUASTC-S.priorityUASTC),[a.UASTC_HDR]:h.filter(x=>x.basisFormat.includes(a.UASTC_HDR)).sort((x,S)=>x.priorityHDR-S.priorityHDR)};function g(x,S,_,E){const C=p[x];for(let T=0;T<C.length;T++){const R=C[T];if(R.if&&!n[R.if]||!R.basisFormat.includes(x)||E&&R.transcoderFormat.length<2||R.needsPowerOfTwo&&!(A(S)&&A(_)))continue;const B=R.transcoderFormat[E?1:0],U=R.engineFormat[E?1:0],O=R.engineType[0];return{transcoderFormat:B,engineFormat:U,engineType:O}}throw new Error("THREE.KTX2Loader: Failed to identify transcoding target.")}function A(x){return x<=2?!0:(x&x-1)===0&&x!==0}function v(x){if(x.length===1)return x[0];let S=0;for(let C=0;C<x.length;C++){const T=x[C];S+=T.byteLength}const _=new Uint8Array(S);let E=0;for(let C=0;C<x.length;C++){const T=x[C];_.set(T,E),E+=T.byteLength}return _}};const mte=new Set([Fi,E0,ac,qu]),RT={[z6]:Fi,[k6]:ac,[O6]:qu,[P6]:Fi,[F6]:ac,[U6]:qu,[N6]:Fi,[L6]:Fi,[D6]:ac,[B6]:ac,[R6]:qu,[I6]:qu,[H6]:E0,[G6]:E0,[n9]:C0,[t9]:M0,[YR]:mb,[cte]:gb,[KR]:Ab,[ute]:vb,[z4]:Fd,[r9]:Fd,[i9]:Fd,[h9]:Cm,[a9]:Cm,[s9]:Cm,[W6]:Ud,[j6]:Ud,[V6]:wm,[Q6]:wm,[X6]:Mm,[q6]:Mm,[K6]:xb,[Y6]:bb,[J6]:Sb,[$6]:_b,[e9]:zm,[Z6]:zm,[u9]:km,[l9]:km,[c9]:w0,[o9]:w0},LA={[z6]:Si,[k6]:Si,[O6]:Si,[P6]:ci,[F6]:ci,[U6]:ci,[N6]:xn,[L6]:xn,[D6]:xn,[B6]:xn,[R6]:xn,[I6]:xn,[H6]:Jb,[G6]:Zb,[n9]:xn,[t9]:xn,[YR]:xn,[YR]:xn,[KR]:xn,[KR]:xn,[z4]:ci,[r9]:xn,[i9]:xn,[h9]:ci,[a9]:xn,[s9]:xn,[W6]:xn,[j6]:xn,[V6]:xn,[Q6]:xn,[X6]:xn,[q6]:xn,[K6]:xn,[Y6]:xn,[J6]:xn,[$6]:xn,[e9]:xn,[Z6]:xn,[u9]:xn,[l9]:xn,[c9]:xn,[o9]:xn};async function gte(n){const{vkFormat:e}=n;if(RT[e]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat: "+e);LA[e]===void 0&&console.warn('THREE.KTX2Loader: Missing ".type" for vkFormat: '+e);let t;n.supercompressionScheme===sU&&(IT||(IT=new Promise(async a=>{const o=new fte;await o.init(),a(o)})),t=await IT);const i=[];for(let a=0;a<n.levels.length;a++){const o=Math.max(1,n.pixelWidth>>a),c=Math.max(1,n.pixelHeight>>a),h=n.pixelDepth?Math.max(1,n.pixelDepth>>a):0,p=n.levels[a];let g;if(n.supercompressionScheme===ite)g=p.levelData;else if(n.supercompressionScheme===sU)g=t.decode(p.levelData,p.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let A;LA[e]===Si?A=new Float32Array(g.buffer,g.byteOffset,g.byteLength/Float32Array.BYTES_PER_ELEMENT):LA[e]===ci?A=new Uint16Array(g.buffer,g.byteOffset,g.byteLength/Uint16Array.BYTES_PER_ELEMENT):LA[e]===Jb||LA[e]===Zb?A=new Uint32Array(g.buffer,g.byteOffset,g.byteLength/Uint32Array.BYTES_PER_ELEMENT):A=g,i.push({data:A,width:o,height:c,depth:h})}const r=n.levelCount===0||i.length>1;let s;if(mte.has(RT[e]))s=n.pixelDepth===0?new ll(i[0].data,n.pixelWidth,n.pixelHeight):new tx(i[0].data,n.pixelWidth,n.pixelHeight,n.pixelDepth),s.minFilter=r?Kd:Ri,s.magFilter=Ri,s.generateMipmaps=n.levelCount===0;else{if(n.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");s=new ff(i,n.pixelWidth,n.pixelHeight),s.minFilter=r?ya:mn,s.magFilter=mn}return s.mipmaps=i,s.type=LA[e],s.format=RT[e],s.colorSpace=f9(n),s.needsUpdate=!0,Promise.resolve(s)}function f9(n){const e=n.dataFormatDescriptor[0];return e.colorPrimaries===ate?e.transferFunction===aU?xi:Xi:e.colorPrimaries===ote?e.transferFunction===aU?dte:pte:(e.colorPrimaries===ste||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${e.colorPrimaries}"`),nl)}var cU,uU;const Pc=Symbol("retainerCount"),Xh=Symbol("recentlyUsed"),XS=Symbol("evict"),f1=Symbol("evictionThreshold"),BT=Symbol("cache");class Ate{constructor(e,t=5){this[cU]=new Map,this[uU]=[],this[BT]=e,this[f1]=t}set evictionThreshold(e){this[f1]=e,this[XS]()}get evictionThreshold(){return this[f1]}get cache(){return this[BT]}retainerCount(e){return this[Pc].get(e)||0}reset(){this[Pc].clear(),this[Xh]=[]}retain(e){this[Pc].has(e)||this[Pc].set(e,0),this[Pc].set(e,this[Pc].get(e)+1);const t=this[Xh].indexOf(e);t!==-1&&this[Xh].splice(t,1),this[Xh].unshift(e),this[XS]()}release(e){this[Pc].has(e)&&this[Pc].set(e,Math.max(this[Pc].get(e)-1,0)),this[XS]()}[(cU=Pc,uU=Xh,XS)](){if(!(this[Xh].length<this[f1]))for(let e=this[Xh].length-1;e>=this[f1];--e){const t=this[Xh][e];this[Pc].get(t)===0&&(this[BT].delete(t),this[Xh].splice(e,1))}}}const vte=n=>{const e=[],t=new Set;for(const i of n){let r=i,s=0;for(;t.has(r);)r=i+"."+ ++s;t.add(r),e.push(r)}return e},yte=n=>{const e=new Map;for(const t of n.mappings)for(const i of t.variants)e.set(i,{material:null,gltfMaterialIndex:t.material});return e};class bte{constructor(e){this.parser=e,this.name="KHR_materials_variants"}afterRoot(e){const t=this.parser,i=t.json;if(i.extensions===void 0||i.extensions[this.name]===void 0)return null;const s=i.extensions[this.name].variants||[],a=vte(s.map(o=>o.name));for(const o of e.scenes)o.traverse(c=>{const h=c;if(!h.material)return;const p=t.associations.get(h);if(p==null||p.meshes==null||p.primitives==null)return;const x=i.meshes[p.meshes].primitives[p.primitives].extensions;!x||!x[this.name]||(h.userData.variantMaterials=yte(x[this.name]))});return e.userData.variants=a,Promise.resolve()}}var d9,hU;Pi.DEFAULT_ANISOTROPY=4;const xte=(n,e,t=()=>{})=>{const i=r=>{const s=r.loaded/r.total;t(Math.max(0,Math.min(1,isFinite(s)?s:1)))};return new Promise((r,s)=>{e.load(n,r,i,s)})},_te=n=>new Promise((e,t)=>{const i=document.createElement("script");document.body.appendChild(i),i.onload=e,i.onerror=t,i.async=!0,i.src=n}),Yh=new Map,DT=new Map;let fU;const dU=new bee;let pU;const LT=new rc;let NT,UT;const lm=Symbol("loader"),Sd=Symbol("evictionPolicy"),mU=Symbol("GLTFInstance");class ro extends zo{static setDRACODecoderLocation(e){fU=e,dU.setDecoderPath(e)}static getDRACODecoderLocation(){return fU}static setKTX2TranscoderLocation(e){pU=e,LT.setTranscoderPath(e)}static getKTX2TranscoderLocation(){return pU}static setMeshoptDecoderLocation(e){NT!==e&&(NT=e,UT=_te(e).then(()=>ZN.ready).then(()=>ZN))}static getMeshoptDecoderLocation(){return NT}static initializeKTX2Loader(e){LT.detectSupport(e)}static get cache(){return Yh}static clearCache(){Yh.forEach((e,t)=>{this.delete(t)}),this[Sd].reset()}static has(e){return Yh.has(e)}static async delete(e){if(!this.has(e))return;const t=Yh.get(e);DT.delete(e),Yh.delete(e),(await t).dispose()}static hasFinishedLoading(e){return!!DT.get(e)}constructor(e){super(),this[hU]=new ax().register(t=>new bte(t)),this[mU]=e,this[lm].setDRACOLoader(dU),this[lm].setKTX2Loader(LT)}get[(d9=Sd,hU=lm,Sd)](){return this.constructor[Sd]}async preload(e,t,i=()=>{}){if(this[lm].setWithCredentials(t.withCredentials),this.dispatchEvent({type:"preload",element:t,src:e}),!Yh.has(e)){UT!=null&&this[lm].setMeshoptDecoder(await UT);const r=xte(e,this[lm],o=>{i(o*.8)}),s=this[mU],a=r.then(o=>s.prepare(o)).then(o=>(i(.9),new s(o))).catch((o=>(console.error(o),new s)));Yh.set(e,a)}await Yh.get(e),DT.set(e,!0),i&&i(1)}async load(e,t,i=()=>{}){await this.preload(e,t,i);const s=await(await Yh.get(e)).clone();return this[Sd].retain(e),s.dispose=()=>{this[Sd].release(e)},s}}ro[d9]=new Ate(ro);class Ste extends Gn{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Ze(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element&&t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const NA=new ee,gU=new qt,AU=new qt,vU=new ee,yU=new ee;class Ete{constructor(e={}){const t=this;let i,r,s,a;const o={objects:new WeakMap},c=e.element!==void 0?e.element:document.createElement("div");c.style.overflow="hidden",this.domElement=c,this.sortObjects=!0,this.getSize=function(){return{width:i,height:r}},this.render=function(x,S){x.matrixWorldAutoUpdate===!0&&x.updateMatrixWorld(),S.parent===null&&S.matrixWorldAutoUpdate===!0&&S.updateMatrixWorld(),gU.copy(S.matrixWorldInverse),AU.multiplyMatrices(S.projectionMatrix,gU),p(x,x,S),this.sortObjects&&v(x)},this.setSize=function(x,S){i=x,r=S,s=i/2,a=r/2,c.style.width=x+"px",c.style.height=S+"px"};function h(x){x.isCSS2DObject&&(x.element.style.display="none");for(let S=0,_=x.children.length;S<_;S++)h(x.children[S])}function p(x,S,_){if(x.visible===!1){h(x);return}if(x.isCSS2DObject){NA.setFromMatrixPosition(x.matrixWorld),NA.applyMatrix4(AU);const E=NA.z>=-1&&NA.z<=1&&x.layers.test(_.layers)===!0,C=x.element;C.style.display=E===!0?"":"none",E===!0&&(x.onBeforeRender(t,S,_),C.style.transform="translate("+-100*x.center.x+"%,"+-100*x.center.y+"%)translate("+(NA.x*s+s)+"px,"+(-NA.y*a+a)+"px)",C.parentNode!==c&&c.appendChild(C),x.onAfterRender(t,S,_));const T={distanceToCameraSquared:g(_,x)};o.objects.set(x,T)}for(let E=0,C=x.children.length;E<C;E++)p(x.children[E],S,_)}function g(x,S){return vU.setFromMatrixPosition(x.matrixWorld),yU.setFromMatrixPosition(S.matrixWorld),vU.distanceToSquared(yU)}function A(x){const S=[];return x.traverseVisible(function(_){_.isCSS2DObject&&S.push(_)}),S}function v(x){const S=A(x).sort(function(E,C){if(E.renderOrder!==C.renderOrder)return C.renderOrder-E.renderOrder;const T=o.objects.get(E).distanceToCameraSquared,R=o.objects.get(C).distanceToCameraSquared;return T-R}),_=S.length;for(let E=0,C=S.length;E<C;E++)S[E].element.style.zIndex=_-E}}}function YS(n,e,t){let i=t;const r=new ee;return n.updateWorldMatrix(!0,!0),n.traverseVisible(s=>{const{geometry:a}=s;if(a!==void 0){const{position:o}=a.attributes;if(o!==void 0)for(let c=0,h=o.count;c<h;c++)s.isMesh?s.getVertexPosition(c,r):r.fromBufferAttribute(o,c),s.isSkinnedMesh||r.applyMatrix4(s.matrixWorld),i=e(i,r)}}),i}const bU={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class kw{constructor(){this.textureUtils=null,this.pluginCallbacks=[],this.register(function(e){return new Ute(e)}),this.register(function(e){return new Fte(e)}),this.register(function(e){return new zte(e)}),this.register(function(e){return new Gte(e)}),this.register(function(e){return new Hte(e)}),this.register(function(e){return new Qte(e)}),this.register(function(e){return new Pte(e)}),this.register(function(e){return new Ote(e)}),this.register(function(e){return new kte(e)}),this.register(function(e){return new Vte(e)}),this.register(function(e){return new jte(e)}),this.register(function(e){return new Wte(e)}),this.register(function(e){return new qte(e)}),this.register(function(e){return new Xte(e)})}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}setTextureUtils(e){return this.textureUtils=e,this}parse(e,t,i,r){const s=new Nte,a=[];for(let o=0,c=this.pluginCallbacks.length;o<c;o++)a.push(this.pluginCallbacks[o](s));s.setPlugins(a),s.setTextureUtils(this.textureUtils),s.writeAsync(e,t,r).catch(i)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,r,s,t)})}}const si={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},FT="KHR_mesh_quantization",sl={};sl[Ri]=si.NEAREST;sl[Kd]=si.NEAREST_MIPMAP_NEAREST;sl[Wu]=si.NEAREST_MIPMAP_LINEAR;sl[mn]=si.LINEAR;sl[uf]=si.LINEAR_MIPMAP_NEAREST;sl[ya]=si.LINEAR_MIPMAP_LINEAR;sl[or]=si.CLAMP_TO_EDGE;sl[hl]=si.REPEAT;sl[mf]=si.MIRRORED_REPEAT;const xU={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},wte=new Mt,_U=12,Mte=1179937895,Cte=2,SU=8,Tte=1313821514,Ite=5130562;function Q1(n,e){return n.length===e.length&&n.every(function(t,i){return t===e[i]})}function Rte(n){return new TextEncoder().encode(n).buffer}function Bte(n){return Q1(n.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function Dte(n,e,t){const i={min:new Array(n.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(n.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let r=e;r<e+t;r++)for(let s=0;s<n.itemSize;s++){let a;n.itemSize>4?a=n.array[r*n.itemSize+s]:(s===0?a=n.getX(r):s===1?a=n.getY(r):s===2?a=n.getZ(r):s===3&&(a=n.getW(r)),n.normalized===!0&&(a=D0.normalize(a,n.array))),i.min[s]=Math.min(i.min[s],a),i.max[s]=Math.max(i.max[s],a)}return i}function p9(n){return Math.ceil(n/4)*4}function PT(n,e=0){const t=p9(n.byteLength);if(t!==n.byteLength){const i=new Uint8Array(t);if(i.set(new Uint8Array(n)),e!==0)for(let r=n.byteLength;r<t;r++)i[r]=e;return i.buffer}return n}function EU(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function Lte(n,e){if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){let t;return e==="image/jpeg"?t=.92:e==="image/webp"&&(t=.8),n.convertToBlob({type:e,quality:t})}else return new Promise(t=>n.toBlob(t,e))}class Nte{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter r"+ag}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},this.textureUtils=null}setPlugins(e){this.plugins=e}setTextureUtils(e){this.textureUtils=e}async writeAsync(e,t,i={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},i),this.options.animations.length>0&&(this.options.trs=!0),await this.processInputAsync(e),await Promise.all(this.pending);const r=this,s=r.buffers,a=r.json;i=r.options;const o=r.extensionsUsed,c=r.extensionsRequired,h=new Blob(s,{type:"application/octet-stream"}),p=Object.keys(o),g=Object.keys(c);if(p.length>0&&(a.extensionsUsed=p),g.length>0&&(a.extensionsRequired=g),a.buffers&&a.buffers.length>0&&(a.buffers[0].byteLength=h.size),i.binary===!0){const A=new FileReader;A.readAsArrayBuffer(h),A.onloadend=function(){const v=PT(A.result),x=new DataView(new ArrayBuffer(SU));x.setUint32(0,v.byteLength,!0),x.setUint32(4,Ite,!0);const S=PT(Rte(JSON.stringify(a)),32),_=new DataView(new ArrayBuffer(SU));_.setUint32(0,S.byteLength,!0),_.setUint32(4,Tte,!0);const E=new ArrayBuffer(_U),C=new DataView(E);C.setUint32(0,Mte,!0),C.setUint32(4,Cte,!0);const T=_U+_.byteLength+S.byteLength+x.byteLength+v.byteLength;C.setUint32(8,T,!0);const R=new Blob([E,_,S,x,v],{type:"application/octet-stream"}),B=new FileReader;B.readAsArrayBuffer(R),B.onloadend=function(){t(B.result)}}}else if(a.buffers&&a.buffers.length>0){const A=new FileReader;A.readAsDataURL(h),A.onloadend=function(){const v=A.result;a.buffers[0].uri=v,t(a)}}else t(a)}serializeUserData(e,t){if(Object.keys(e.userData).length===0)return;const i=this.options,r=this.extensionsUsed;try{const s=JSON.parse(JSON.stringify(e.userData));if(i.includeCustomExtensions&&s.gltfExtensions){t.extensions===void 0&&(t.extensions={});for(const a in s.gltfExtensions)t.extensions[a]=s.gltfExtensions[a],r[a]=!0;delete s.gltfExtensions}Object.keys(s).length>0&&(t.extras=s)}catch(s){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+s.message)}}getUID(e,t=!1){if(this.uids.has(e)===!1){const r=new Map;r.set(!0,this.uid++),r.set(!1,this.uid++),this.uids.set(e,r)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const i=new ee;for(let r=0,s=e.count;r<s;r++)if(Math.abs(i.fromBufferAttribute(e,r).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const i=e.clone(),r=new ee;for(let s=0,a=i.count;s<a;s++)r.fromBufferAttribute(i,s),r.x===0&&r.y===0&&r.z===0?r.setX(1):r.normalize(),i.setXYZ(s,r.x,r.y,r.z);return t.attributesNormalized.set(e,i),i}applyTextureTransform(e,t){let i=!1;const r={};(t.offset.x!==0||t.offset.y!==0)&&(r.offset=t.offset.toArray(),i=!0),t.rotation!==0&&(r.rotation=t.rotation,i=!0),(t.repeat.x!==1||t.repeat.y!==1)&&(r.scale=t.repeat.toArray(),i=!0),i&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,this.extensionsUsed.KHR_texture_transform=!0)}async buildMetalRoughTextureAsync(e,t){if(e===t)return e;function i(v){return v.colorSpace===xi?function(S){return S<.04045?S*.0773993808:Math.pow(S*.9478672986+.0521327014,2.4)}:function(S){return S}}e instanceof ff&&(e=await this.decompressTextureAsync(e)),t instanceof ff&&(t=await this.decompressTextureAsync(t));const r=e?e.image:null,s=t?t.image:null,a=Math.max(r?r.width:0,s?s.width:0),o=Math.max(r?r.height:0,s?s.height:0),c=EU();c.width=a,c.height=o;const h=c.getContext("2d",{willReadFrequently:!0});h.fillStyle="#00ffff",h.fillRect(0,0,a,o);const p=h.getImageData(0,0,a,o);if(r){h.drawImage(r,0,0,a,o);const v=i(e),x=h.getImageData(0,0,a,o).data;for(let S=2;S<x.length;S+=4)p.data[S]=v(x[S]/256)*256}if(s){h.drawImage(s,0,0,a,o);const v=i(t),x=h.getImageData(0,0,a,o).data;for(let S=1;S<x.length;S+=4)p.data[S]=v(x[S]/256)*256}h.putImageData(p,0,0);const A=(e||t).clone();return A.source=new of(c),A.colorSpace=nl,A.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),A}async decompressTextureAsync(e,t=1/0){if(this.textureUtils===null)throw new Error("THREE.GLTFExporter: setTextureUtils() must be called to process compressed textures.");return await this.textureUtils.decompress(e,t)}processBuffer(e){const t=this.json,i=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),i.push(e),0}processBufferView(e,t,i,r,s){const a=this.json;a.bufferViews||(a.bufferViews=[]);let o;switch(t){case si.BYTE:case si.UNSIGNED_BYTE:o=1;break;case si.SHORT:case si.UNSIGNED_SHORT:o=2;break;default:o=4}let c=e.itemSize*o;s===si.ARRAY_BUFFER&&(c=Math.ceil(c/4)*4);const h=p9(r*c),p=new DataView(new ArrayBuffer(h));let g=0;for(let x=i;x<i+r;x++){for(let S=0;S<e.itemSize;S++){let _;e.itemSize>4?_=e.array[x*e.itemSize+S]:(S===0?_=e.getX(x):S===1?_=e.getY(x):S===2?_=e.getZ(x):S===3&&(_=e.getW(x)),e.normalized===!0&&(_=D0.normalize(_,e.array))),t===si.FLOAT?p.setFloat32(g,_,!0):t===si.INT?p.setInt32(g,_,!0):t===si.UNSIGNED_INT?p.setUint32(g,_,!0):t===si.SHORT?p.setInt16(g,_,!0):t===si.UNSIGNED_SHORT?p.setUint16(g,_,!0):t===si.BYTE?p.setInt8(g,_):t===si.UNSIGNED_BYTE&&p.setUint8(g,_),g+=o}g%c!==0&&(g+=c-g%c)}const A={buffer:this.processBuffer(p.buffer),byteOffset:this.byteOffset,byteLength:h};return s!==void 0&&(A.target=s),s===si.ARRAY_BUFFER&&(A.byteStride=c),this.byteOffset+=h,a.bufferViews.push(A),{id:a.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,i=t.json;return i.bufferViews||(i.bufferViews=[]),new Promise(function(r){const s=new FileReader;s.readAsArrayBuffer(e),s.onloadend=function(){const a=PT(s.result),o={buffer:t.processBuffer(a),byteOffset:t.byteOffset,byteLength:a.byteLength};t.byteOffset+=a.byteLength,r(i.bufferViews.push(o)-1)}})}processAccessor(e,t,i,r){const s=this.json,a={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let o;if(e.array.constructor===Float32Array)o=si.FLOAT;else if(e.array.constructor===Int32Array)o=si.INT;else if(e.array.constructor===Uint32Array)o=si.UNSIGNED_INT;else if(e.array.constructor===Int16Array)o=si.SHORT;else if(e.array.constructor===Uint16Array)o=si.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)o=si.BYTE;else if(e.array.constructor===Uint8Array)o=si.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);if(i===void 0&&(i=0),(r===void 0||r===1/0)&&(r=e.count),r===0)return null;const c=Dte(e,i,r);let h;t!==void 0&&(h=e===t.index?si.ELEMENT_ARRAY_BUFFER:si.ARRAY_BUFFER);const p=this.processBufferView(e,o,i,r,h),g={bufferView:p.id,byteOffset:p.byteOffset,componentType:o,count:r,max:c.max,min:c.min,type:a[e.itemSize]};return e.normalized===!0&&(g.normalized=!0),s.accessors||(s.accessors=[]),s.accessors.push(g)-1}processImage(e,t,i,r="image/png"){if(e!==null){const s=this,a=s.cache,o=s.json,c=s.options,h=s.pending;a.images.has(e)||a.images.set(e,{});const p=a.images.get(e),g=r+":flipY/"+i.toString();if(p[g]!==void 0)return p[g];o.images||(o.images=[]);const A={mimeType:r},v=EU();v.width=Math.min(e.width,c.maxTextureSize),v.height=Math.min(e.height,c.maxTextureSize);const x=v.getContext("2d",{willReadFrequently:!0});if(i===!0&&(x.translate(0,v.height),x.scale(1,-1)),e.data!==void 0){t!==Fi&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>c.maxTextureSize||e.height>c.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const _=new Uint8ClampedArray(e.height*e.width*4);for(let E=0;E<_.length;E+=4)_[E+0]=e.data[E+0],_[E+1]=e.data[E+1],_[E+2]=e.data[E+2],_[E+3]=e.data[E+3];x.putImageData(new ImageData(_,e.width,e.height),0,0)}else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)x.drawImage(e,0,0,v.width,v.height);else throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement, ImageBitmap or OffscreenCanvas.");c.binary===!0?h.push(Lte(v,r).then(_=>s.processBufferViewImage(_)).then(_=>{A.bufferView=_})):A.uri=r4.getDataURL(v,r);const S=o.images.push(A)-1;return p[g]=S,S}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const i={magFilter:sl[e.magFilter],minFilter:sl[e.minFilter],wrapS:sl[e.wrapS],wrapT:sl[e.wrapT]};return t.samplers.push(i)-1}async processTextureAsync(e){const i=this.options,r=this.cache,s=this.json;if(r.textures.has(e))return r.textures.get(e);s.textures||(s.textures=[]),e instanceof ff&&(e=await this.decompressTextureAsync(e,i.maxTextureSize));let a=e.userData.mimeType;a==="image/webp"&&(a="image/png");const o={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,a)};e.name&&(o.name=e.name),await this._invokeAllAsync(async function(h){h.writeTexture&&await h.writeTexture(e,o)});const c=s.textures.push(o)-1;return r.textures.set(e,c),c}async processMaterialAsync(e){const t=this.cache,i=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);const r={pbrMetallicRoughness:{}};e.isMeshStandardMaterial!==!0&&e.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const s=e.color.toArray().concat([e.opacity]);if(Q1(s,[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=s),e.isMeshStandardMaterial?(r.pbrMetallicRoughness.metallicFactor=e.metalness,r.pbrMetallicRoughness.roughnessFactor=e.roughness):(r.pbrMetallicRoughness.metallicFactor=0,r.pbrMetallicRoughness.roughnessFactor=1),e.metalnessMap||e.roughnessMap){const o=await this.buildMetalRoughTextureAsync(e.metalnessMap,e.roughnessMap),c={index:await this.processTextureAsync(o),texCoord:o.channel};this.applyTextureTransform(c,o),r.pbrMetallicRoughness.metallicRoughnessTexture=c}if(e.map){const o={index:await this.processTextureAsync(e.map),texCoord:e.map.channel};this.applyTextureTransform(o,e.map),r.pbrMetallicRoughness.baseColorTexture=o}if(e.emissive){const o=e.emissive;if(Math.max(o.r,o.g,o.b)>0&&(r.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const h={index:await this.processTextureAsync(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(h,e.emissiveMap),r.emissiveTexture=h}}if(e.normalMap){const o={index:await this.processTextureAsync(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&e.normalScale.x!==1&&(o.scale=e.normalScale.x),this.applyTextureTransform(o,e.normalMap),r.normalTexture=o}if(e.aoMap){const o={index:await this.processTextureAsync(e.aoMap),texCoord:e.aoMap.channel};e.aoMapIntensity!==1&&(o.strength=e.aoMapIntensity),this.applyTextureTransform(o,e.aoMap),r.occlusionTexture=o}e.transparent?r.alphaMode="BLEND":e.alphaTest>0&&(r.alphaMode="MASK",r.alphaCutoff=e.alphaTest),e.side===gi&&(r.doubleSided=!0),e.name!==""&&(r.name=e.name),this.serializeUserData(e,r),await this._invokeAllAsync(async function(o){o.writeMaterialAsync&&await o.writeMaterialAsync(e,r)});const a=i.materials.push(r)-1;return t.materials.set(e,a),a}async processMeshAsync(e){const t=this.cache,i=this.json,r=[e.geometry.uuid];if(Array.isArray(e.material))for(let R=0,B=e.material.length;R<B;R++)r.push(e.material[R].uuid);else r.push(e.material.uuid);const s=r.join(":");if(t.meshes.has(s))return t.meshes.get(s);const a=e.geometry;let o;e.isLineSegments?o=si.LINES:e.isLineLoop?o=si.LINE_LOOP:e.isLine?o=si.LINE_STRIP:e.isPoints?o=si.POINTS:o=e.material.wireframe?si.LINES:si.TRIANGLES;const c={},h={},p=[],g=[],A={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},v=a.getAttribute("normal");v!==void 0&&!this.isNormalizedNormalAttribute(v)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),a.setAttribute("normal",this.createNormalizedNormalAttribute(v)));let x=null;for(let R in a.attributes){if(R.slice(0,5)==="morph")continue;const B=a.attributes[R];if(R=A[R]||R.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(R)||(R="_"+R),t.attributes.has(this.getUID(B))){h[R]=t.attributes.get(this.getUID(B));continue}x=null;const O=B.array;R==="JOINTS_0"&&!(O instanceof Uint16Array)&&!(O instanceof Uint8Array)?(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),x=new An(new Uint16Array(O),B.itemSize,B.normalized)):(O instanceof Uint32Array||O instanceof Int32Array)&&!R.startsWith("_")&&(console.warn(`GLTFExporter: Attribute "${R}" converted to type FLOAT.`),x=kw.Utils.toFloat32BufferAttribute(B));const F=this.processAccessor(x||B,a);F!==null&&(R.startsWith("_")||this.detectMeshQuantization(R,B),h[R]=F,t.attributes.set(this.getUID(B),F))}if(v!==void 0&&a.setAttribute("normal",v),Object.keys(h).length===0)return null;if(e.morphTargetInfluences!==void 0&&e.morphTargetInfluences.length>0){const R=[],B=[],U={};if(e.morphTargetDictionary!==void 0)for(const O in e.morphTargetDictionary)U[e.morphTargetDictionary[O]]=O;for(let O=0;O<e.morphTargetInfluences.length;++O){const F={};let L=!1;for(const P in a.morphAttributes){if(P!=="position"&&P!=="normal"){L||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),L=!0);continue}const W=a.morphAttributes[P][O],j=P.toUpperCase(),V=a.attributes[P];if(t.attributes.has(this.getUID(W,!0))){F[j]=t.attributes.get(this.getUID(W,!0));continue}const q=W.clone();if(!a.morphTargetsRelative)for(let re=0,Q=W.count;re<Q;re++)for(let K=0;K<W.itemSize;K++)K===0&&q.setX(re,W.getX(re)-V.getX(re)),K===1&&q.setY(re,W.getY(re)-V.getY(re)),K===2&&q.setZ(re,W.getZ(re)-V.getZ(re)),K===3&&q.setW(re,W.getW(re)-V.getW(re));F[j]=this.processAccessor(q,a),t.attributes.set(this.getUID(V,!0),F[j])}g.push(F),R.push(e.morphTargetInfluences[O]),e.morphTargetDictionary!==void 0&&B.push(U[O])}c.weights=R,B.length>0&&(c.extras={},c.extras.targetNames=B)}const S=Array.isArray(e.material);if(S&&a.groups.length===0)return null;let _=!1;if(S&&a.index===null){const R=[];for(let B=0,U=a.attributes.position.count;B<U;B++)R[B]=B;a.setIndex(R),_=!0}const E=S?e.material:[e.material],C=S?a.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let R=0,B=C.length;R<B;R++){const U={mode:o,attributes:h};if(this.serializeUserData(a,U),g.length>0&&(U.targets=g),a.index!==null){let F=this.getUID(a.index);(C[R].start!==void 0||C[R].count!==void 0)&&(F+=":"+C[R].start+":"+C[R].count),t.attributes.has(F)?U.indices=t.attributes.get(F):(U.indices=this.processAccessor(a.index,a,C[R].start,C[R].count),t.attributes.set(F,U.indices)),U.indices===null&&delete U.indices}const O=await this.processMaterialAsync(E[C[R].materialIndex]);O!==null&&(U.material=O),p.push(U)}_===!0&&a.setIndex(null),c.primitives=p,i.meshes||(i.meshes=[]),await this._invokeAllAsync(function(R){R.writeMesh&&R.writeMesh(e,c)});const T=i.meshes.push(c)-1;return t.meshes.set(s,T),T}detectMeshQuantization(e,t){if(this.extensionsUsed[FT])return;let i;switch(t.array.constructor){case Int8Array:i="byte";break;case Uint8Array:i="unsigned byte";break;case Int16Array:i="short";break;case Uint16Array:i="unsigned short";break;default:return}t.normalized&&(i+=" normalized");const r=e.split("_",1)[0];bU[r]&&bU[r].includes(i)&&(this.extensionsUsed[FT]=!0,this.extensionsRequired[FT]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const i=e.isOrthographicCamera,r={type:i?"orthographic":"perspective"};return i?r.orthographic={xmag:e.right*2,ymag:e.top*2,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:D0.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},e.name!==""&&(r.name=e.type),t.cameras.push(r)-1}processAnimation(e,t){const i=this.json,r=this.nodeMap;i.animations||(i.animations=[]),e=kw.Utils.mergeMorphTargetTracks(e.clone(),t);const s=e.tracks,a=[],o=[];for(let h=0;h<s.length;++h){const p=s[h],g=ei.parseTrackName(p.name);let A=ei.findNode(t,g.nodeName);const v=xU[g.propertyName];if(g.objectName==="bones"&&(A.isSkinnedMesh===!0?A=A.skeleton.getBoneByName(g.objectIndex):A=void 0),!A||!v){console.warn('THREE.GLTFExporter: Could not export animation track "%s".',p.name);continue}const x=1;let S=p.values.length/p.times.length;v===xU.morphTargetInfluences&&(S/=A.morphTargetInfluences.length);let _;p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(_="CUBICSPLINE",S/=3):p.getInterpolation()===Gm?_="STEP":_="LINEAR",o.push({input:this.processAccessor(new An(p.times,x)),output:this.processAccessor(new An(p.values,S)),interpolation:_}),a.push({sampler:o.length-1,target:{node:r.get(A),path:v}})}const c={name:e.name||"clip_"+i.animations.length,samplers:o,channels:a};return this.serializeUserData(e,c),i.animations.push(c),i.animations.length-1}processSkin(e){const t=this.json,i=this.nodeMap,r=t.nodes[i.get(e)],s=e.skeleton;if(s===void 0)return null;const a=e.skeleton.bones[0];if(a===void 0)return null;const o=[],c=new Float32Array(s.bones.length*16),h=new qt;for(let g=0;g<s.bones.length;++g)o.push(i.get(s.bones[g])),h.copy(s.boneInverses[g]),h.multiply(e.bindMatrix).toArray(c,g*16);return t.skins===void 0&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new An(c,16)),joints:o,skeleton:i.get(a)}),r.skin=t.skins.length-1}async processNodeAsync(e){const t=this.json,i=this.options,r=this.nodeMap;t.nodes||(t.nodes=[]);const s={};if(i.trs){const o=e.quaternion.toArray(),c=e.position.toArray(),h=e.scale.toArray();Q1(o,[0,0,0,1])||(s.rotation=o),Q1(c,[0,0,0])||(s.translation=c),Q1(h,[1,1,1])||(s.scale=h)}else e.matrixAutoUpdate&&e.updateMatrix(),Bte(e.matrix)===!1&&(s.matrix=e.matrix.elements);if(e.name!==""&&(s.name=String(e.name)),this.serializeUserData(e,s),e.isMesh||e.isLine||e.isPoints){const o=await this.processMeshAsync(e);o!==null&&(s.mesh=o)}else e.isCamera&&(s.camera=this.processCamera(e));e.isSkinnedMesh&&this.skins.push(e);const a=t.nodes.push(s)-1;if(r.set(e,a),e.children.length>0){const o=[];for(let c=0,h=e.children.length;c<h;c++){const p=e.children[c];if(p.visible||i.onlyVisible===!1){const g=await this.processNodeAsync(p);g!==null&&o.push(g)}}o.length>0&&(s.children=o)}return await this._invokeAllAsync(function(o){o.writeNode&&o.writeNode(e,s)}),a}async processSceneAsync(e){const t=this.json,i=this.options;t.scenes||(t.scenes=[],t.scene=0);const r={};e.name!==""&&(r.name=e.name),t.scenes.push(r);const s=[];for(let a=0,o=e.children.length;a<o;a++){const c=e.children[a];if(c.visible||i.onlyVisible===!1){const h=await this.processNodeAsync(c);h!==null&&s.push(h)}}s.length>0&&(r.nodes=s),this.serializeUserData(e,r)}async processObjectsAsync(e){const t=new uc;t.name="AuxScene";for(let i=0;i<e.length;i++)t.children.push(e[i]);await this.processSceneAsync(t)}async processInputAsync(e){const t=this.options;e=e instanceof Array?e:[e],await this._invokeAllAsync(function(r){r.beforeParse&&r.beforeParse(e)});const i=[];for(let r=0;r<e.length;r++)e[r]instanceof uc?await this.processSceneAsync(e[r]):i.push(e[r]);i.length>0&&await this.processObjectsAsync(i);for(let r=0;r<this.skins.length;++r)this.processSkin(this.skins[r]);for(let r=0;r<t.animations.length;++r)this.processAnimation(t.animations[r],e[0]);await this._invokeAllAsync(function(r){r.afterParse&&r.afterParse(e)})}async _invokeAllAsync(e){for(let t=0,i=this.plugins.length;t<i;t++)await e(this.plugins[t])}}class Ute{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);return}const i=this.writer,r=i.json,s=i.extensionsUsed,a={};e.name&&(a.name=e.name),a.color=e.color.toArray(),a.intensity=e.intensity,e.isDirectionalLight?a.type="directional":e.isPointLight?(a.type="point",e.distance>0&&(a.range=e.distance)):e.isSpotLight&&(a.type="spot",e.distance>0&&(a.range=e.distance),a.spot={},a.spot.innerConeAngle=(1-e.penumbra)*e.angle,a.spot.outerConeAngle=e.angle),e.decay!==void 0&&e.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||e.target.position.x!==0||e.target.position.y!==0||e.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),s[this.name]||(r.extensions=r.extensions||{},r.extensions[this.name]={lights:[]},s[this.name]=!0);const o=r.extensions[this.name].lights;o.push(a),t.extensions=t.extensions||{},t.extensions[this.name]={light:o.length-1}}}class Fte{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}async writeMaterialAsync(e,t){if(!e.isMeshBasicMaterial)return;const r=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},r[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class Pte{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.clearcoat===0)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.clearcoatFactor=e.clearcoat,e.clearcoatMap){const a={index:await i.processTextureAsync(e.clearcoatMap),texCoord:e.clearcoatMap.channel};i.applyTextureTransform(a,e.clearcoatMap),s.clearcoatTexture=a}if(s.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const a={index:await i.processTextureAsync(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};i.applyTextureTransform(a,e.clearcoatRoughnessMap),s.clearcoatRoughnessTexture=a}if(e.clearcoatNormalMap){const a={index:await i.processTextureAsync(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};e.clearcoatNormalScale.x!==1&&(a.scale=e.clearcoatNormalScale.x),i.applyTextureTransform(a,e.clearcoatNormalMap),s.clearcoatNormalTexture=a}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Ote{constructor(e){this.writer=e,this.name="KHR_materials_dispersion"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.dispersion===0)return;const r=this.writer.extensionsUsed,s={};s.dispersion=e.dispersion,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class kte{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.iridescence===0)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.iridescenceFactor=e.iridescence,e.iridescenceMap){const a={index:await i.processTextureAsync(e.iridescenceMap),texCoord:e.iridescenceMap.channel};i.applyTextureTransform(a,e.iridescenceMap),s.iridescenceTexture=a}if(s.iridescenceIor=e.iridescenceIOR,s.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],s.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const a={index:await i.processTextureAsync(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};i.applyTextureTransform(a,e.iridescenceThicknessMap),s.iridescenceThicknessTexture=a}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class zte{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.transmission===0)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.transmissionFactor=e.transmission,e.transmissionMap){const a={index:await i.processTextureAsync(e.transmissionMap),texCoord:e.transmissionMap.channel};i.applyTextureTransform(a,e.transmissionMap),s.transmissionTexture=a}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Gte{constructor(e){this.writer=e,this.name="KHR_materials_volume"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.transmission===0)return;const i=this.writer,r=i.extensionsUsed,s={};if(s.thicknessFactor=e.thickness,e.thicknessMap){const a={index:await i.processTextureAsync(e.thicknessMap),texCoord:e.thicknessMap.channel};i.applyTextureTransform(a,e.thicknessMap),s.thicknessTexture=a}e.attenuationDistance!==1/0&&(s.attenuationDistance=e.attenuationDistance),s.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Hte{constructor(e){this.writer=e,this.name="KHR_materials_ior"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.ior===1.5)return;const r=this.writer.extensionsUsed,s={};s.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Qte{constructor(e){this.writer=e,this.name="KHR_materials_specular"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.specularIntensity===1&&e.specularColor.equals(wte)&&!e.specularIntensityMap&&!e.specularColorMap)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.specularIntensityMap){const a={index:await i.processTextureAsync(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};i.applyTextureTransform(a,e.specularIntensityMap),s.specularTexture=a}if(e.specularColorMap){const a={index:await i.processTextureAsync(e.specularColorMap),texCoord:e.specularColorMap.channel};i.applyTextureTransform(a,e.specularColorMap),s.specularColorTexture=a}s.specularFactor=e.specularIntensity,s.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Vte{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.sheen==0)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.sheenRoughnessMap){const a={index:await i.processTextureAsync(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};i.applyTextureTransform(a,e.sheenRoughnessMap),s.sheenRoughnessTexture=a}if(e.sheenColorMap){const a={index:await i.processTextureAsync(e.sheenColorMap),texCoord:e.sheenColorMap.channel};i.applyTextureTransform(a,e.sheenColorMap),s.sheenColorTexture=a}s.sheenRoughnessFactor=e.sheenRoughness,s.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class jte{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||e.anisotropy==0)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.anisotropyMap){const a={index:await i.processTextureAsync(e.anisotropyMap)};i.applyTextureTransform(a,e.anisotropyMap),s.anisotropyTexture=a}s.anisotropyStrength=e.anisotropy,s.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Wte{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}async writeMaterialAsync(e,t){if(!e.isMeshStandardMaterial||e.emissiveIntensity===1)return;const r=this.writer.extensionsUsed,s={};s.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class qte{constructor(e){this.writer=e,this.name="EXT_materials_bump"}async writeMaterialAsync(e,t){if(!e.isMeshStandardMaterial||e.bumpScale===1&&!e.bumpMap)return;const i=this.writer,r=i.extensionsUsed,s={};if(e.bumpMap){const a={index:await i.processTextureAsync(e.bumpMap),texCoord:e.bumpMap.channel};i.applyTextureTransform(a,e.bumpMap),s.bumpTexture=a}s.bumpFactor=e.bumpScale,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}}class Xte{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,t){if(!e.isInstancedMesh)return;const i=this.writer,r=e,s=new Float32Array(r.count*3),a=new Float32Array(r.count*4),o=new Float32Array(r.count*3),c=new qt,h=new ee,p=new Bi,g=new ee;for(let v=0;v<r.count;v++)r.getMatrixAt(v,c),c.decompose(h,p,g),h.toArray(s,v*3),p.toArray(a,v*4),g.toArray(o,v*3);const A={TRANSLATION:i.processAccessor(new An(s,3)),ROTATION:i.processAccessor(new An(a,4)),SCALE:i.processAccessor(new An(o,3))};r.instanceColor&&(A._COLOR_0=i.processAccessor(r.instanceColor)),t.extensions=t.extensions||{},t.extensions[this.name]={attributes:A},i.extensionsUsed[this.name]=!0,i.extensionsRequired[this.name]=!0}}kw.Utils={insertKeyframe:function(n,e){const i=n.getValueSize(),r=new n.TimeBufferType(n.times.length+1),s=new n.ValueBufferType(n.values.length+i),a=n.createInterpolant(new n.ValueBufferType(i));let o;if(n.times.length===0){r[0]=e;for(let c=0;c<i;c++)s[c]=0;o=0}else if(e<n.times[0]){if(Math.abs(n.times[0]-e)<.001)return 0;r[0]=e,r.set(n.times,1),s.set(a.evaluate(e),0),s.set(n.values,i),o=0}else if(e>n.times[n.times.length-1]){if(Math.abs(n.times[n.times.length-1]-e)<.001)return n.times.length-1;r[r.length-1]=e,r.set(n.times,0),s.set(n.values,0),s.set(a.evaluate(e),n.values.length),o=r.length-1}else for(let c=0;c<n.times.length;c++){if(Math.abs(n.times[c]-e)<.001)return c;if(n.times[c]<e&&n.times[c+1]>e){r.set(n.times.slice(0,c+1),0),r[c+1]=e,r.set(n.times.slice(c+1),c+2),s.set(n.values.slice(0,(c+1)*i),0),s.set(a.evaluate(e),(c+1)*i),s.set(n.values.slice((c+1)*i),(c+2)*i),o=c+1;break}}return n.times=r,n.values=s,o},mergeMorphTargetTracks:function(n,e){const t=[],i={},r=n.tracks;for(let s=0;s<r.length;++s){let a=r[s];const o=ei.parseTrackName(a.name),c=ei.findNode(e,o.nodeName);if(o.propertyName!=="morphTargetInfluences"||o.propertyIndex===void 0){t.push(a);continue}if(a.createInterpolant!==a.InterpolantFactoryMethodDiscrete&&a.createInterpolant!==a.InterpolantFactoryMethodLinear){if(a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),a=a.clone(),a.setInterpolation(Hm)}const h=c.morphTargetInfluences.length,p=c.morphTargetDictionary[o.propertyIndex];if(p===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+o.propertyIndex);let g;if(i[c.uuid]===void 0){g=a.clone();const v=new g.ValueBufferType(h*g.times.length);for(let x=0;x<g.times.length;x++)v[x*h+p]=g.values[x];g.name=(o.nodeName||"")+".morphTargetInfluences",g.values=v,i[c.uuid]=g,t.push(g);continue}const A=a.createInterpolant(new a.ValueBufferType(1));g=i[c.uuid];for(let v=0;v<g.times.length;v++)g.values[v*h+p]=A.evaluate(g.times[v]);for(let v=0;v<a.times.length;v++){const x=this.insertKeyframe(g,a.times[v]);g.values[x*h+p]=a.values[v]}}return n.tracks=t,n},toFloat32BufferAttribute:function(n){const e=new An(new Float32Array(n.count*n.itemSize),n.itemSize,!1);if(!n.normalized&&!n.isInterleavedBufferAttribute)return e.array.set(n.array),e;for(let t=0,i=n.count;t<i;t++)for(let r=0;r<n.itemSize;r++)e.setComponent(t,r,n.getComponent(t,r));return e}};const wU=n=>n.material!==void 0&&n.userData&&n.userData.variantMaterials&&!!Array.from(n.userData.variantMaterials.values()).filter(e=>qE(e.material)),qE=n=>n&&n.isMaterial&&!Array.isArray(n);class Yte{constructor(e){this.writer=e,this.name="KHR_materials_variants",this.variantNames=[]}beforeParse(e){const t=new Set,i=r=>{if(!wU(r))return;const s=r.userData.variantMaterials,a=r.userData.variantData;for(const[o,c]of a){const h=s.get(c.index);h&&qE(h.material)&&t.add(o)}};if(Array.isArray(e))for(const r of e)r.traverse(i);else e.traverse(i);t.forEach(r=>this.variantNames.push(r))}async writeMesh(e,t){if(!wU(e))return;const i=e.userData,r=i.variantMaterials,s=i.variantData,a=new Map,o=new Map,c=Array.from(s.values()).sort((g,A)=>g.index-A.index);for(const[g,A]of c.entries())o.set(A.index,g);for(const g of s.values()){const A=r.get(g.index);if(!A||!qE(A.material))continue;const v=await this.writer.processMaterialAsync(A.material);a.has(v)||a.set(v,{material:v,variants:[]}),a.get(v).variants.push(o.get(g.index))}const h=Array.from(a.values()).map((g=>g.variants.sort((A,v)=>A-v)&&g)).sort((g,A)=>g.material-A.material);if(h.length===0)return;const p=qE(i.originalMaterial)?await this.writer.processMaterialAsync(i.originalMaterial):-1;for(const g of t.primitives)p>=0&&(g.material=p),g.extensions=g.extensions||{},g.extensions[this.name]={mappings:h}}afterParse(){if(this.variantNames.length===0)return;const e=this.writer.json;e.extensions=e.extensions||{};const t=this.variantNames.map(i=>({name:i}));e.extensions[this.name]={variants:t},this.writer.extensionsUsed[this.name]=!0}}class Kte{constructor(e,t,i,r,s){this.xrLight=e,this.renderer=t,this.lightProbe=i,this.xrWebGLBinding=null,this.estimationStartCallback=s,this.frameCallback=this.onXRFrame.bind(this);const a=t.xr.getSession();if(r&&"XRWebGLBinding"in window){const o=new rv(16);e.environment=o.texture;const c=t.getContext();switch(a.preferredReflectionFormat){case"srgba8":c.getExtension("EXT_sRGB");break;case"rgba16f":c.getExtension("OES_texture_half_float");break}this.xrWebGLBinding=new XRWebGLBinding(a,c),this.lightProbe.addEventListener("reflectionchange",()=>{this.updateReflection()})}a.requestAnimationFrame(this.frameCallback)}updateReflection(){const e=this.renderer.properties.get(this.xrLight.environment);if(e){const t=this.xrWebGLBinding.getReflectionCubeMap(this.lightProbe);t&&(e.__webglTexture=t,this.xrLight.environment.needsPMREMUpdate=!0)}}onXRFrame(e,t){if(!this.xrLight)return;t.session.requestAnimationFrame(this.frameCallback);const r=t.getLightEstimate(this.lightProbe);if(r){this.xrLight.lightProbe.sh.fromArray(r.sphericalHarmonicsCoefficients),this.xrLight.lightProbe.intensity=1;const s=Math.max(1,Math.max(r.primaryLightIntensity.x,Math.max(r.primaryLightIntensity.y,r.primaryLightIntensity.z)));this.xrLight.directionalLight.color.setRGB(r.primaryLightIntensity.x/s,r.primaryLightIntensity.y/s,r.primaryLightIntensity.z/s),this.xrLight.directionalLight.intensity=s,this.xrLight.directionalLight.position.copy(r.primaryLightDirection),this.estimationStartCallback&&(this.estimationStartCallback(),this.estimationStartCallback=null)}}dispose(){this.xrLight=null,this.renderer=null,this.lightProbe=null,this.xrWebGLBinding=null}}class $te extends Ds{constructor(e,t=!0){super(),this.lightProbe=new T4,this.lightProbe.intensity=0,this.add(this.lightProbe),this.directionalLight=new hv,this.directionalLight.intensity=0,this.add(this.directionalLight),this.environment=null;let i=null,r=!1;e.xr.addEventListener("sessionstart",()=>{const s=e.xr.getSession();"requestLightProbe"in s&&s.requestLightProbe({reflectionFormat:s.preferredReflectionFormat}).then(a=>{i=new Kte(this,e,a,t,()=>{r=!0,this.dispatchEvent({type:"estimationstart"})})})}),e.xr.addEventListener("sessionend",()=>{i&&(i.dispose(),i=null),r&&this.dispatchEvent({type:"estimationend"})}),this.dispose=()=>{i&&(i.dispose(),i=null),this.remove(this.lightProbe),this.lightProbe=null,this.remove(this.directionalLight),this.directionalLight=null,this.environment=null}}}const m9=1e4,Jte=.001,g9=50;class ao{constructor(e=g9){this.velocity=0,this.naturalFrequency=0,this.setDecayTime(e)}setDecayTime(e){this.naturalFrequency=1/Math.max(Jte,e)}update(e,t,i,r){const s=2e-4*this.naturalFrequency;if(e==null||r===0||e===t&&this.velocity===0)return t;if(i<0)return e;const a=e-t,o=this.velocity+this.naturalFrequency*a,c=a+i*o,h=Math.exp(-this.naturalFrequency*i),p=(o-this.naturalFrequency*c)*h,g=-this.naturalFrequency*(p+o*h);return Math.abs(p)<s*Math.abs(r)&&g*a>=0?(this.velocity=0,t):(this.velocity=p,t+c*h)}}const Hu=.2,MU=.03,Zte=.75,A9=12,ene=Math.PI/(2*A9),CU=new Ze,KS=(n,e,t)=>{let i=e>0?t>0?0:-Math.PI/2:t>0?Math.PI/2:Math.PI;for(let r=0;r<=A9;++r)n.push(e+(Hu-MU)*Math.cos(i),t+(Hu-MU)*Math.sin(i),0,e+Hu*Math.cos(i),t+Hu*Math.sin(i),0),i+=ene};class TU extends Wt{constructor(e,t){const i=new vn,r=[],s=[],{size:a,boundingBox:o}=e,c=a.x/2,h=(t==="back"?a.y:a.z)/2;KS(s,c,h),KS(s,-c,h),KS(s,-c,-h),KS(s,c,-h);const p=s.length/3;for(let v=0;v<p-2;v+=2)r.push(v,v+1,v+3,v,v+3,v+2);const g=p-2;r.push(g,g+1,1,g,1,0),i.setAttribute("position",new Kt(s,3)),i.setIndex(r),super(i),this.side=t;const A=this.material;switch(A.side=gi,A.transparent=!0,A.opacity=0,this.goalOpacity=0,this.opacityDamper=new ao,this.hitPlane=new Wt(new ra(2*(c+Hu),2*(h+Hu))),this.hitPlane.visible=!1,this.hitPlane.material.side=gi,this.add(this.hitPlane),this.hitBox=new Wt(new ba(a.x+2*Hu,a.y+Hu,a.z+2*Hu)),this.hitBox.visible=!1,this.hitBox.material.side=gi,this.add(this.hitBox),o.getCenter(this.position),t){case"bottom":this.rotateX(-Math.PI/2),this.shadowHeight=o.min.y,this.position.y=this.shadowHeight;break;case"back":this.shadowHeight=o.min.z,this.position.z=this.shadowHeight}e.target.add(this),this.hitBox.position.y=(a.y+Hu)/2+o.min.y,e.target.add(this.hitBox),this.offsetHeight=0}getHit(e,t,i){CU.set(t,-i),this.hitPlane.visible=!0;const r=e.positionAndNormalFromPoint(CU,this.hitPlane);return this.hitPlane.visible=!1,r==null?null:r.position}getExpandedHit(e,t,i){this.hitPlane.scale.set(1e3,1e3,1e3),this.hitPlane.updateMatrixWorld();const r=this.getHit(e,t,i);return this.hitPlane.scale.set(1,1,1),r}controllerIntersection(e,t){this.hitBox.visible=!0;const i=e.hitFromController(t,this.hitBox);return this.hitBox.visible=!1,i}set offsetHeight(e){e-=.001,this.side==="back"?this.position.z=this.shadowHeight+e:this.position.y=this.shadowHeight+e}get offsetHeight(){return this.side==="back"?this.position.z-this.shadowHeight:this.position.y-this.shadowHeight}set show(e){this.goalOpacity=e?Zte:0}updateOpacity(e){const t=this.material;t.opacity=this.opacityDamper.update(t.opacity,this.goalOpacity,e,1),this.visible=t.opacity>0}dispose(){const{geometry:e,material:t}=this.hitPlane;e.dispose(),t.dispose(),this.hitBox.geometry.dispose(),this.hitBox.material.dispose(),this.geometry.dispose(),this.material.dispose(),this.hitBox.removeFromParent(),this.removeFromParent()}}const Oa=(n,e)=>({type:"number",number:n,unit:e}),lf=(()=>{const n={};return t=>{const i=t;if(i in n)return n[i];const r=[];let s=0;for(;t;){if(++s>1e3){t="";break}const a=v9(t),o=a.nodes[0];if(o==null||o.terms.length===0)break;r.push(o),t=a.remainingInput}return n[i]=r}})(),v9=(()=>{const n=/^(\-\-|[a-z\u0240-\uffff])/i,e=/^([\*\+\/]|[\-]\s)/i,t=/^[\),]/;return s=>{const a=[];for(;s.length&&(s=s.trim(),!t.test(s));)if(s[0]==="("){const{nodes:o,remainingInput:c}=IU(s);s=c,a.push({type:"function",name:{type:"ident",value:"calc"},arguments:o})}else if(n.test(s)){const o=tne(s),c=o.nodes[0];if(s=o.remainingInput,s[0]==="("){const{nodes:h,remainingInput:p}=IU(s);a.push({type:"function",name:c,arguments:h}),s=p}else a.push(c)}else if(e.test(s))a.push({type:"operator",value:s[0]}),s=s.slice(1);else{const{nodes:o,remainingInput:c}=s[0]==="#"?ine(s):nne(s);if(o.length===0)break;a.push(o[0]),s=c}return{nodes:[{type:"expression",terms:a}],remainingInput:s}}})(),tne=(()=>{const n=/[^a-z0-9_\-\u0240-\uffff]/i;return e=>{const t=e.match(n),i=t==null?e:e.substr(0,t.index),r=t==null?"":e.substr(t.index);return{nodes:[{type:"ident",value:i}],remainingInput:r}}})(),nne=(()=>{const n=/[\+\-]?(\d+[\.]\d+|\d+|[\.]\d+)([eE][\+\-]?\d+)?/,e=/^[a-z%]+/i,t=/^(m|mm|cm|rad|deg|[%])$/;return i=>{const r=i.match(n),s=r==null?"0":r[0];i=s==null?i:i.slice(s.length);const a=i.match(e);let o=a!=null&&a[0]!==""?a[0]:null;const c=a==null?i:i.slice(o.length);return o!=null&&!t.test(o)&&(o=null),{nodes:[{type:"number",number:parseFloat(s)||0,unit:o}],remainingInput:c}}})(),ine=(()=>{const n=/^[a-f0-9]*/i;return e=>{e=e.slice(1).trim();const t=e.match(n);return{nodes:t==null?[]:[{type:"hex",value:t[0]}],remainingInput:t==null?e:e.slice(t[0].length)}}})(),IU=n=>{const e=[];for(n=n.slice(1).trim();n.length;){const t=v9(n);if(e.push(t.nodes[0]),n=t.remainingInput.trim(),n[0]===",")n=n.slice(1).trim();else if(n[0]===")"){n=n.slice(1);break}}return{nodes:e,remainingInput:n}},RU=Symbol("visitedTypes");class rne{constructor(e){this[RU]=e}walk(e,t){const i=e.slice();for(;i.length;){const r=i.shift();switch(this[RU].indexOf(r.type)>-1&&t(r),r.type){case"expression":i.unshift(...r.terms);break;case"function":i.unshift(r.name,...r.arguments);break}}}}const qd=Object.freeze({type:"number",number:0,unit:null});const nC=(n,e=0)=>{let{number:t,unit:i}=n;if(!isFinite(t))t=e,i="rad";else if(n.unit==="rad"||n.unit==null)return n;return{type:"number",number:(i==="deg"&&t!=null?t:0)*Math.PI/180,unit:"rad"}},BU=(n,e=0)=>{let{number:t,unit:i}=n;if(!isFinite(t))t=e,i="m";else if(n.unit==="m")return n;let r;switch(i){default:r=1;break;case"cm":r=1/100;break;case"mm":r=1/1e3;break}return{type:"number",number:r*t,unit:"m"}},Yu=(()=>{const n=t=>t,e={rad:n,deg:nC,m:n,mm:BU,cm:BU};return(t,i=qd)=>{isFinite(t.number)||(t.number=i.number,t.unit=i.unit);const{unit:r}=t;if(r==null)return t;const s=e[r];return s==null?i:s(t)}})();var y9,DU,LU;const dv=Symbol("evaluate"),XE=Symbol("lastValue");class Mr{constructor(){this[y9]=null}static evaluatableFor(e,t=qd){if(e instanceof Mr)return e;if(e.type==="number")return e.unit==="%"?new sne(e,t):e;switch(e.name.value){case"calc":return new lne(e,t);case"env":return new ane(e)}return qd}static evaluate(e){return e instanceof Mr?e.evaluate():e}static isConstant(e){return e instanceof Mr?e.isConstant:!0}static applyIntrinsics(e,t){const{basis:i,keywords:r}=t,{auto:s}=r;return i.map((a,o)=>{const c=s[o]==null?a:s[o];let h=e[o]?e[o]:c;if(h.type==="ident"){const p=h.value;p in r&&(h=r[p][o])}return(h==null||h.type==="ident")&&(h=c),h.unit==="%"?Oa(h.number/100*a.number,a.unit):(h=Yu(h,a),h.unit!==a.unit?a:h)})}get isConstant(){return!1}evaluate(){return(!this.isConstant||this[XE]==null)&&(this[XE]=this[dv]()),this[XE]}}y9=XE;const NU=Symbol("percentage"),OT=Symbol("basis");class sne extends Mr{constructor(e,t){super(),this[NU]=e,this[OT]=t}get isConstant(){return!0}[dv](){return Oa(this[NU].number/100*this[OT].number,this[OT].unit)}}const $S=Symbol("identNode");class ane extends Mr{constructor(e){super(),this[DU]=null;const t=e.arguments.length?e.arguments[0].terms[0]:null;t!=null&&t.type==="ident"&&(this[$S]=t)}get isConstant(){return!1}[(DU=$S,dv)](){if(this[$S]!=null&&this[$S].value==="window-scroll-y"){const e=window.pageYOffset,t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);return{type:"number",number:e/(t-window.innerHeight)||0,unit:null}}return qd}}const one=/[\*\/]/,UA=Symbol("evaluator");class lne extends Mr{constructor(e,t=qd){if(super(),this[LU]=null,e.arguments.length!==1)return;const i=e.arguments[0].terms.slice(),r=[];for(;i.length;){const s=i.shift();if(r.length>0){const a=r[r.length-1];if(a.type==="operator"&&one.test(a.value)){const o=r.pop(),c=r.pop();if(c==null)return;r.push(new FU(o,Mr.evaluatableFor(c,t),Mr.evaluatableFor(s,t)));continue}}r.push(s.type==="operator"?s:Mr.evaluatableFor(s,t))}for(;r.length>2;){const[s,a,o]=r.splice(0,3);if(a.type!=="operator")return;r.unshift(new FU(a,Mr.evaluatableFor(s,t),Mr.evaluatableFor(o,t)))}r.length===1&&(this[UA]=r[0])}get isConstant(){return this[UA]==null||Mr.isConstant(this[UA])}[(LU=UA,dv)](){return this[UA]!=null?Mr.evaluate(this[UA]):qd}}const UU=Symbol("operator"),kT=Symbol("left"),zT=Symbol("right");class FU extends Mr{constructor(e,t,i){super(),this[UU]=e,this[kT]=t,this[zT]=i}get isConstant(){return Mr.isConstant(this[kT])&&Mr.isConstant(this[zT])}[dv](){const e=Yu(Mr.evaluate(this[kT])),t=Yu(Mr.evaluate(this[zT])),{number:i,unit:r}=e,{number:s,unit:a}=t;if(a!=null&&r!=null&&a!=r)return qd;const o=r||a;let c;switch(this[UU].value){case"+":c=i+s;break;case"-":c=i-s;break;case"/":c=i/s;break;case"*":c=i*s;break;default:return qd}return{type:"number",number:c,unit:o}}}const GT=Symbol("evaluatables"),PU=Symbol("intrinsics");class b9 extends Mr{constructor(e,t){super(),this[PU]=t;const i=e[0],r=i!=null?i.terms:[];this[GT]=t.basis.map((s,a)=>{const o=r[a];return o==null?{type:"ident",value:"auto"}:o.type==="ident"?o:Mr.evaluatableFor(o,s)})}get isConstant(){for(const e of this[GT])if(!Mr.isConstant(e))return!1;return!0}[dv](){const e=this[GT].map(t=>Mr.evaluate(t));return Mr.applyIntrinsics(e,this[PU]).map(t=>t.number)}}var x9,_9,S9,E9;const FA=Symbol("instances"),OU=Symbol("activateListener"),kU=Symbol("deactivateListener"),HT=Symbol("notifyInstances"),zU=Symbol("notify"),GU=Symbol("callback");class Gu{static[HT](){for(const e of Gu[FA])e[zU]()}static[(x9=FA,OU)](){window.addEventListener("scroll",this[HT],{passive:!0})}static[kU](){window.removeEventListener("scroll",this[HT])}constructor(e){this[GU]=e}observe(){Gu[FA].size===0&&Gu[OU](),Gu[FA].add(this)}disconnect(){Gu[FA].delete(this),Gu[FA].size===0&&Gu[kU]()}[zU](){this[GU]()}}Gu[x9]=new Set;const HU=Symbol("computeStyleCallback"),w9=Symbol("astWalker"),V1=Symbol("dependencies"),M9=Symbol("onScroll");class cne{constructor(e){this[_9]={},this[S9]=new rne(["function"]),this[E9]=()=>{this[HU]({relatedState:"window-scroll"})},this[HU]=e}observeEffectsFor(e){const t={},i=this[V1];this[w9].walk(e,r=>{const{name:s}=r,o=r.arguments[0].terms[0];if(!(s.value!=="env"||o==null||o.type!=="ident"))switch(o.value){case"window-scroll-y":if(t["window-scroll"]==null){const c="window-scroll"in i?i["window-scroll"]:new Gu(this[M9]);c.observe(),delete i["window-scroll"],t["window-scroll"]=c}break}});for(const r in i)i[r].disconnect();this[V1]=t}dispose(){for(const e in this[V1])this[V1][e].disconnect()}}_9=V1,S9=w9,E9=M9;const _d=n=>{const e=n.observeEffects||!1,t=n.intrinsics instanceof Function?n.intrinsics:(()=>n.intrinsics);return(i,r)=>{const s=i.updated,a=i.connectedCallback,o=i.disconnectedCallback,c=Symbol(`${r}StyleEffector`),h=Symbol(`${r}StyleEvaluator`),p=Symbol(`${r}UpdateEvaluator`),g=Symbol(`${r}EvaluateAndSync`);Object.defineProperties(i,{[c]:{value:null,writable:!0},[h]:{value:null,writable:!0},[p]:{value:function(){const A=lf(this[r]);this[h]=new b9(A,t(this)),this[c]==null&&e&&(this[c]=new cne(()=>this[g]())),this[c]!=null&&this[c].observeEffectsFor(A)}},[g]:{value:function(){if(this[h]==null)return;const A=this[h].evaluate();this[n.updateHandler](A)}},updated:{value:function(A){A.has(r)&&(this[p](),this[g]()),s.call(this,A)}},connectedCallback:{value:function(){a.call(this),this.requestUpdate(r,this[r])}},disconnectedCallback:{value:function(){o.call(this),this[c]!=null&&(this[c].dispose(),this[c]=null)}}})}};const C9=n=>n<.5?2*n*n:-1+(4-2*n)*n,une=(n,e,t=C9)=>i=>n+(e-n)*t(i),hne=(n,e)=>{const t=(r=>s=>r+=s),i=e.map(t(0));return r=>{r=Vu(r,0,1),r*=i[i.length-1];const s=i.findIndex(c=>c>=r),a=s<1?0:i[s-1],o=i[s];return n[s]((r-a)/(o-a))}},o0=n=>{const e=[],t=[];let i=n.initialValue;for(let r=0;r<n.keyframes.length;++r){const s=n.keyframes[r],{value:a,frames:o}=s,c=s.ease||C9,h=une(i,a,c);e.push(h),t.push(o),i=a}return hne(e,t)};var _s=function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(s=(r<3?a(s):r>3?a(e,t,s):a(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};const fne=5e3,dne=o0({initialValue:0,keyframes:[{frames:5,value:-1},{frames:1,value:-1},{frames:8,value:1},{frames:1,value:1},{frames:5,value:0},{frames:18,value:0}]}),pne=o0({initialValue:0,keyframes:[{frames:1,value:1},{frames:5,value:1},{frames:1,value:0},{frames:6,value:0}]}),mne=30,gne=12,T9="0deg 75deg 105%",Ane="auto auto auto",vne="auto",yne=2.2,bne=["front","right","back","left"],xne=["upper-","","lower-"],_ne=3e3,Sne=". Use mouse, touch or arrow keys to move.",JS={AUTO:"auto"},QT={BASIC:"basic",WIGGLE:"wiggle"},Ene={NONE:"none"},QU=()=>({basis:[nC(Oa(mne,"deg"))],keywords:{auto:[null]}}),wne=()=>({basis:[nC(Oa(gne,"deg"))],keywords:{auto:[null]}}),I9=(()=>{const n=lf(T9)[0].terms,e=Yu(n[0]),t=Yu(n[1]);return i=>{const r=i[Rt].idealCameraDistance();return{basis:[e,t,Oa(r,"m")],keywords:{auto:[null,null,Oa(105,"%")]}}}})(),Mne=n=>{const e=yne*n[Rt].boundingSphere.radius;return{basis:[Oa(-1/0,"rad"),Oa(0,"rad"),Oa(e,"m")],keywords:{auto:[null,null,null]}}},Cne=n=>{const e=I9(n),i=new b9([],e).evaluate()[2];return{basis:[Oa(1/0,"rad"),Oa(Math.PI,"rad"),Oa(i,"m")],keywords:{auto:[null,null,null]}}},Tne=n=>{const e=n[Rt].boundingBox.getCenter(new ee);return{basis:[Oa(e.x,"m"),Oa(e.y,"m"),Oa(e.z,"m")],keywords:{auto:[null,null,null]}}},R9=Math.PI/2,Ine=Math.PI/3,Rne=R9/2,Bne=2*Math.PI,ki=Symbol("controls"),YE=Symbol("panElement"),VT=Symbol("promptElement"),ZS=Symbol("promptAnimatedContainer"),jT=Symbol("fingerAnimatedContainers"),eE=Symbol("deferInteractionPrompt"),VU=Symbol("updateAria"),Kh=Symbol("a11y"),jU=Symbol("updateA11y"),WU=Symbol("updateCameraForRadius"),PA=Symbol("cancelPrompts"),WT=Symbol("onChange"),d1=Symbol("onPointerChange"),tm=Symbol("waitingToPromptUser"),tE=Symbol("userHasInteracted"),OA=Symbol("promptElementVisibleTime"),p1=Symbol("lastPromptOffset"),nE=Symbol("cancellationSource"),qT=Symbol("lastSpherical"),m1=Symbol("jumpCamera"),XT=Symbol("initialized"),g1=Symbol("maintainThetaPhi"),qU=Symbol("syncCameraOrbit"),XU=Symbol("syncFieldOfView"),YU=Symbol("syncCameraTarget"),KU=Symbol("syncMinCameraOrbit"),$U=Symbol("syncMaxCameraOrbit"),JU=Symbol("syncMinFieldOfView"),ZU=Symbol("syncMaxFieldOfView"),Dne=n=>{var e,t,i,r,s,a,o,c,h,p,g,A,v,x,S,_,E,C;class T extends n{constructor(){super(...arguments),this.cameraControls=!1,this.cameraOrbit=T9,this.cameraTarget=Ane,this.fieldOfView=vne,this.minCameraOrbit="auto",this.maxCameraOrbit="auto",this.minFieldOfView="auto",this.maxFieldOfView="auto",this.interactionPromptThreshold=_ne,this.interactionPrompt=JS.AUTO,this.interactionPromptStyle=QT.WIGGLE,this.orbitSensitivity=1,this.zoomSensitivity=1,this.panSensitivity=1,this.touchAction=Ene.NONE,this.disableZoom=!1,this.disablePan=!1,this.disableTap=!1,this.interpolationDecay=g9,this.a11y=null,this[e]=this.shadowRoot.querySelector(".interaction-prompt"),this[t]=this.shadowRoot.querySelector("#prompt"),this[i]=[this.shadowRoot.querySelector("#finger0"),this.shadowRoot.querySelector("#finger1")],this[r]=this.shadowRoot.querySelector(".pan-target"),this[s]=0,this[a]=1/0,this[o]=!1,this[c]=!1,this[h]=kr.AUTOMATIC,this[p]=new Fne(this[Rt].camera,this[zc],this[Rt]),this[g]=new nb,this[A]=!1,this[v]=!1,this[x]=!1,this[S]={},this[_]=()=>{const B=this[ki].changeSource;this[nE]=B,B===kr.USER_INTERACTION&&(this[tE]=!0,this[eE]())},this[E]=()=>{this[VU](),this[ta]();const B=this[ki].changeSource;this.dispatchEvent(new CustomEvent("camera-change",{detail:{source:B}}))},this[C]=B=>{this[ZE].classList.toggle("pointer-tumbling",B.type==="pointer-change-start")}}get inputSensitivity(){return this[ki].inputSensitivity}set inputSensitivity(B){this[ki].inputSensitivity=B}getCameraOrbit(){const{theta:B,phi:U,radius:O}=this[qT];return{theta:B,phi:U,radius:O,toString(){return`${this.theta}rad ${this.phi}rad ${this.radius}m`}}}getCameraTarget(){return Id(this[zi].isPresenting?this[zi].arRenderer.target:this[Rt].getDynamicTarget())}getFieldOfView(){return this[ki].getFieldOfView()}getMinimumFieldOfView(){return this[ki].options.minimumFieldOfView}getMaximumFieldOfView(){return this[ki].options.maximumFieldOfView}getIdealAspect(){return this[Rt].idealAspect}jumpCameraToGoal(){this[m1]=!0,this.requestUpdate(m1,!1)}resetInteractionPrompt(){this[p1]=0,this[OA]=1/0,this[tE]=!1,this[tm]=this.interactionPrompt===JS.AUTO&&this.cameraControls}zoom(B){const U=new WheelEvent("wheel",{deltaY:-30*B});this[zc].dispatchEvent(U)}connectedCallback(){super.connectedCallback(),this[ki].addEventListener("user-interaction",this[PA]),this[ki].addEventListener("pointer-change-start",this[d1]),this[ki].addEventListener("pointer-change-end",this[d1])}disconnectedCallback(){super.disconnectedCallback(),this[ki].removeEventListener("user-interaction",this[PA]),this[ki].removeEventListener("pointer-change-start",this[d1]),this[ki].removeEventListener("pointer-change-end",this[d1])}updated(B){super.updated(B);const U=this[ki],O=this[Rt];if(B.has("cameraControls")&&(this.cameraControls?(U.enableInteraction(),this.interactionPrompt===JS.AUTO&&(this[tm]=!0)):(U.disableInteraction(),this[eE]()),this[zc].setAttribute("aria-label",this[c0])),B.has("disableZoom")&&(U.disableZoom=this.disableZoom),B.has("disablePan")&&(U.enablePan=!this.disablePan),B.has("disableTap")&&(U.enableTap=!this.disableTap),(B.has("interactionPrompt")||B.has("cameraControls")||B.has("src"))&&(this.interactionPrompt===JS.AUTO&&this.cameraControls&&!this[tE]?this[tm]=!0:this[eE]()),B.has("interactionPromptStyle")&&(this[ZS].style.opacity=this.interactionPromptStyle==QT.BASIC?"1":"0"),B.has("touchAction")){const F=this.touchAction;U.applyOptions({touchAction:F}),U.updateTouchActionStyle()}B.has("orbitSensitivity")&&(U.orbitSensitivity=this.orbitSensitivity),B.has("zoomSensitivity")&&(U.zoomSensitivity=this.zoomSensitivity),B.has("panSensitivity")&&(U.panSensitivity=this.panSensitivity),B.has("interpolationDecay")&&(U.setDamperDecayTime(this.interpolationDecay),O.setTargetDamperDecayTime(this.interpolationDecay)),B.has("a11y")&&this[jU](),this[m1]===!0&&Promise.resolve().then(()=>{U.jumpToGoal(),O.jumpToGoal(),this[WT](),this[m1]=!1})}async updateFraming(){const B=this[Rt],U=B.adjustedFoV(B.framedFoVDeg);await B.updateFraming();const O=B.adjustedFoV(B.framedFoVDeg),F=this[ki].getFieldOfView()/U;this[ki].setFieldOfView(O*F),this[g1]=!0,this.requestUpdate("maxFieldOfView"),this.requestUpdate("fieldOfView"),this.requestUpdate("minCameraOrbit"),this.requestUpdate("maxCameraOrbit"),this.requestUpdate("cameraOrbit"),await this.updateComplete}interact(B,U,O){const F=this[zc],L=this[jT];if(L[0].style.opacity==="1"){console.warn("interact() failed because an existing interaction is running.");return}const P=new Array;P.push({x:o0(U.x),y:o0(U.y)});const W=[{x:P[0].x(0),y:P[0].y(0)}];O!=null&&(P.push({x:o0(O.x),y:o0(O.y)}),W.push({x:P[1].x(0),y:P[1].y(0)}));let j=performance.now();const{width:V,height:q}=this[Rt],re=this.getBoundingClientRect(),Q=ue=>{for(const[oe,z]of W.entries()){const{style:$}=L[oe];$.transform=`translateX(${V*z.x}px) translateY(${q*z.y}px)`,ue==="pointerdown"?$.opacity="1":ue==="pointerup"&&($.opacity="0");const ae={pointerId:oe-5678,pointerType:"touch",target:F,clientX:V*z.x+re.x,clientY:q*z.y+re.y,altKey:!0};F.dispatchEvent(new PointerEvent(ue,ae))}},K=()=>{const ue=this[nE];if(ue!==kr.AUTOMATIC||!F.isConnected){for(const z of this[jT])z.style.opacity="0";Q("pointercancel"),this.dispatchEvent(new CustomEvent("interact-stopped",{detail:{source:ue}})),document.removeEventListener("visibilitychange",ce);return}const oe=Math.min(1,(performance.now()-j)/B);for(const[z,$]of W.entries())$.x=P[z].x(oe),$.y=P[z].y(oe);Q("pointermove"),oe<1?requestAnimationFrame(K):(Q("pointerup"),this.dispatchEvent(new CustomEvent("interact-stopped",{detail:{source:kr.AUTOMATIC}})),document.removeEventListener("visibilitychange",ce))},ce=()=>{let ue=0;document.visibilityState==="hidden"?ue=performance.now()-j:j=performance.now()-ue};document.addEventListener("visibilitychange",ce),Q("pointerdown"),this[nE]=kr.AUTOMATIC,requestAnimationFrame(K)}[(e=VT,t=ZS,i=jT,r=YE,s=p1,a=OA,o=tE,c=tm,h=nE,p=ki,g=qT,A=m1,v=XT,x=g1,S=Kh,XU)](B){const U=this[ki],O=this[Rt];O.framedFoVDeg=B[0]*180/Math.PI,U.changeSource=kr.NONE,U.setFieldOfView(O.adjustedFoV(O.framedFoVDeg)),this[PA]()}[qU](B){const U=this[ki];if(this[g1]){const{theta:O,phi:F}=this.getCameraOrbit();B[0]=O,B[1]=F,this[g1]=!1}U.changeSource=kr.NONE,U.setOrbit(B[0],B[1],B[2]),this[PA]()}[KU](B){this[ki].applyOptions({minimumAzimuthalAngle:B[0],minimumPolarAngle:B[1],minimumRadius:B[2]}),this.jumpCameraToGoal()}[$U](B){this[ki].applyOptions({maximumAzimuthalAngle:B[0],maximumPolarAngle:B[1],maximumRadius:B[2]}),this[WU](B[2]),this.jumpCameraToGoal()}[JU](B){this[ki].applyOptions({minimumFieldOfView:B[0]*180/Math.PI}),this.jumpCameraToGoal()}[ZU](B){const U=this[Rt].adjustedFoV(B[0]*180/Math.PI);this[ki].applyOptions({maximumFieldOfView:U}),this.jumpCameraToGoal()}[YU](B){const[U,O,F]=B;this[zi].arRenderer.isPresenting||this[Rt].setTarget(U,O,F),this[ki].changeSource=kr.NONE,this[zi].arRenderer.updateTarget(),this[PA]()}[eh](B,U){if(super[eh](B,U),this[zi].isPresenting||!this[$m]())return;const O=this[ki],F=this[Rt],L=performance.now();if(this[tm]&&this.loaded&&L>this[q1]+this.interactionPromptThreshold&&(this[tm]=!1,this[OA]=L,this[VT].classList.add("visible")),isFinite(this[OA])&&this.interactionPromptStyle===QT.WIGGLE){const j=(L-this[OA])/fne%1,V=dne(j),q=pne(j);if(this[ZS].style.opacity=`${q}`,V!==this[p1]){const re=V*F.width*.05,Q=(V-this[p1])*Math.PI/16;this[ZS].style.transform=`translateX(${re}px)`,O.changeSource=kr.AUTOMATIC,O.adjustOrbit(Q,0,0),this[p1]=V}}const P=O.update(B,U),W=F.updateTarget(U);(P||W)&&this[WT]()}[eE](){this[tm]=!1,this[VT].classList.remove("visible"),this[OA]=1/0}[WU](B){const U=Math.max(this[Rt].farRadius(),B),O=0,F=Math.abs(2*U);this[ki].updateNearFar(O,F)}[VU](){const{theta:B,phi:U}=this[ki].getCameraSpherical(this[qT]),O=(4+Math.floor((B%Bne+Rne)/R9))%4,F=Math.floor(U/Ine),L=bne[O],W=`${xne[F]}${L}`,j=W;j in this[Kh]?this[Qw](this[Kh][j]):this[Qw](`View from stage ${W}`)}get[c0](){let B=Sne;return"interaction-prompt"in this[Kh]&&(B=`. ${this[Kh]["interaction-prompt"]}`),super[c0].replace(/\.$/,"")+(this.cameraControls?B:"")}async[Vw](B){const U=this[ki],O=this[Rt],F=O.adjustedFoV(O.framedFoVDeg);super[Vw](B);const L=O.adjustedFoV(O.framedFoVDeg)/F,P=U.getFieldOfView()*(isFinite(L)?L:1);U.updateAspect(this[Rt].aspect),this.requestUpdate("maxFieldOfView",this.maxFieldOfView),await this.updateComplete,this[ki].setFieldOfView(P),this.jumpCameraToGoal()}[th](){super[th](),this[XT]?this[g1]=!0:this[XT]=!0,this.requestUpdate("maxFieldOfView",this.maxFieldOfView),this.requestUpdate("fieldOfView",this.fieldOfView),this.requestUpdate("minCameraOrbit",this.minCameraOrbit),this.requestUpdate("maxCameraOrbit",this.maxCameraOrbit),this.requestUpdate("cameraOrbit",this.cameraOrbit),this.requestUpdate("cameraTarget",this.cameraTarget),this.jumpCameraToGoal()}[(_=PA,E=WT,C=d1,jU)](){if(typeof this.a11y=="string")if(this.a11y.startsWith("{"))try{this[Kh]=JSON.parse(this.a11y)}catch(B){console.warn("Error parsing a11y JSON:",B)}else this.a11y.length>0?console.warn("Error not supported format, should be a JSON string:",this.a11y):this[Kh]={};else typeof this.a11y=="object"&&this.a11y!=null?this[Kh]=Object.assign({},this.a11y):this[Kh]={};this[zc].setAttribute("aria-label",this[c0])}}return _s([wn({type:Boolean,attribute:"camera-controls"})],T.prototype,"cameraControls",void 0),_s([_d({intrinsics:I9,observeEffects:!0,updateHandler:qU}),wn({type:String,attribute:"camera-orbit",hasChanged:()=>!0})],T.prototype,"cameraOrbit",void 0),_s([_d({intrinsics:Tne,observeEffects:!0,updateHandler:YU}),wn({type:String,attribute:"camera-target",hasChanged:()=>!0})],T.prototype,"cameraTarget",void 0),_s([_d({intrinsics:QU,observeEffects:!0,updateHandler:XU}),wn({type:String,attribute:"field-of-view",hasChanged:()=>!0})],T.prototype,"fieldOfView",void 0),_s([_d({intrinsics:Mne,updateHandler:KU}),wn({type:String,attribute:"min-camera-orbit",hasChanged:()=>!0})],T.prototype,"minCameraOrbit",void 0),_s([_d({intrinsics:Cne,updateHandler:$U}),wn({type:String,attribute:"max-camera-orbit",hasChanged:()=>!0})],T.prototype,"maxCameraOrbit",void 0),_s([_d({intrinsics:wne,updateHandler:JU}),wn({type:String,attribute:"min-field-of-view",hasChanged:()=>!0})],T.prototype,"minFieldOfView",void 0),_s([_d({intrinsics:QU,updateHandler:ZU}),wn({type:String,attribute:"max-field-of-view",hasChanged:()=>!0})],T.prototype,"maxFieldOfView",void 0),_s([wn({type:Number,attribute:"interaction-prompt-threshold"})],T.prototype,"interactionPromptThreshold",void 0),_s([wn({type:String,attribute:"interaction-prompt"})],T.prototype,"interactionPrompt",void 0),_s([wn({type:String,attribute:"interaction-prompt-style"})],T.prototype,"interactionPromptStyle",void 0),_s([wn({type:Number,attribute:"orbit-sensitivity"})],T.prototype,"orbitSensitivity",void 0),_s([wn({type:Number,attribute:"zoom-sensitivity"})],T.prototype,"zoomSensitivity",void 0),_s([wn({type:Number,attribute:"pan-sensitivity"})],T.prototype,"panSensitivity",void 0),_s([wn({type:String,attribute:"touch-action"})],T.prototype,"touchAction",void 0),_s([wn({type:Boolean,attribute:"disable-zoom"})],T.prototype,"disableZoom",void 0),_s([wn({type:Boolean,attribute:"disable-pan"})],T.prototype,"disablePan",void 0),_s([wn({type:Boolean,attribute:"disable-tap"})],T.prototype,"disableTap",void 0),_s([wn({type:Number,attribute:"interpolation-decay"})],T.prototype,"interpolationDecay",void 0),_s([wn()],T.prototype,"a11y",void 0),T};const Lne=.018,eF=2,Nne=300,Une=new Ze,tF=new ee,nF=Object.freeze({minimumRadius:0,maximumRadius:1/0,minimumPolarAngle:0,maximumPolarAngle:Math.PI,minimumAzimuthalAngle:-1/0,maximumAzimuthalAngle:1/0,minimumFieldOfView:10,maximumFieldOfView:45,touchAction:"none"}),iE=Math.PI/8,rE=.04,sE=10,kr={USER_INTERACTION:"user-interaction",NONE:"none",AUTOMATIC:"automatic"};class Fne extends zo{constructor(e,t,i){super(),this.camera=e,this.element=t,this.scene=i,this.orbitSensitivity=1,this.zoomSensitivity=1,this.panSensitivity=1,this.inputSensitivity=1,this.changeSource=kr.NONE,this._interactionEnabled=!1,this._disableZoom=!1,this.isUserPointing=!1,this.enablePan=!0,this.enableTap=!0,this.panProjection=new Rn,this.panPerPixel=0,this.spherical=new nb,this.goalSpherical=new nb,this.thetaDamper=new ao,this.phiDamper=new ao,this.radiusDamper=new ao,this.logFov=Math.log(nF.maximumFieldOfView),this.goalLogFov=this.logFov,this.fovDamper=new ao,this.touchMode=null,this.pointers=[],this.startTime=0,this.startPointerPosition={clientX:0,clientY:0},this.lastSeparation=0,this.touchDecided=!1,this.onContext=r=>{if(this.enablePan)r.preventDefault();else for(const s of this.pointers)this.onPointerUp(new PointerEvent("pointercancel",Object.assign(Object.assign({},this.startPointerPosition),{pointerId:s.id})))},this.touchModeZoom=(r,s)=>{if(!this._disableZoom){const a=this.twoTouchDistance(this.pointers[0],this.pointers[1]),o=rE*this.zoomSensitivity*(this.lastSeparation-a)*50/this.scene.height;this.lastSeparation=a,this.userAdjustOrbit(0,0,o)}this.panPerPixel>0&&this.movePan(r,s)},this.disableScroll=r=>{r.preventDefault()},this.touchModeRotate=(r,s)=>{const{touchAction:a}=this._options;if(!this.touchDecided&&a!=="none"){this.touchDecided=!0;const o=Math.abs(r),c=Math.abs(s);if(this.changeSource===kr.USER_INTERACTION&&(a==="pan-y"&&c>o||a==="pan-x"&&o>c)){this.touchMode=null;return}else this.element.addEventListener("touchmove",this.disableScroll,{passive:!1})}this.handleSinglePointerMove(r,s)},this.onPointerDown=r=>{if(this.pointers.length>2)return;const{element:s}=this;this.pointers.length===0&&(s.addEventListener("pointermove",this.onPointerMove),s.addEventListener("pointerup",this.onPointerUp),this.touchMode=null,this.touchDecided=!1,this.startPointerPosition.clientX=r.clientX,this.startPointerPosition.clientY=r.clientY,this.startTime=performance.now());try{s.setPointerCapture(r.pointerId)}catch{}this.pointers.push({clientX:r.clientX,clientY:r.clientY,id:r.pointerId}),this.isUserPointing=!1,r.pointerType==="touch"?(this.changeSource=r.altKey?kr.AUTOMATIC:kr.USER_INTERACTION,this.onTouchChange(r)):(this.changeSource=kr.USER_INTERACTION,this.onMouseDown(r)),this.changeSource===kr.USER_INTERACTION&&this.dispatchEvent({type:"user-interaction"})},this.onPointerMove=r=>{const s=this.pointers.find(h=>h.id===r.pointerId);if(s==null)return;if(r.pointerType==="mouse"&&r.buttons===0){this.onPointerUp(r);return}const a=this.pointers.length,o=(r.clientX-s.clientX)/a,c=(r.clientY-s.clientY)/a;o===0&&c===0||(s.clientX=r.clientX,s.clientY=r.clientY,r.pointerType==="touch"?(this.changeSource=r.altKey?kr.AUTOMATIC:kr.USER_INTERACTION,this.touchMode!==null&&this.touchMode(o,c)):(this.changeSource=kr.USER_INTERACTION,this.panPerPixel>0?this.movePan(o,c):this.handleSinglePointerMove(o,c)))},this.onPointerUp=r=>{const{element:s}=this,a=this.pointers.findIndex(o=>o.id===r.pointerId);a!==-1&&this.pointers.splice(a,1),this.panPerPixel>0&&!r.altKey&&this.resetRadius(),this.pointers.length===0?(s.removeEventListener("pointermove",this.onPointerMove),s.removeEventListener("pointerup",this.onPointerUp),s.removeEventListener("touchmove",this.disableScroll),this.enablePan&&this.enableTap&&this.recenter(r)):this.touchMode!==null&&this.onTouchChange(r),this.scene.element[YE].style.opacity=0,s.style.cursor="grab",this.panPerPixel=0,this.isUserPointing&&this.dispatchEvent({type:"pointer-change-end"})},this.onWheel=r=>{this.changeSource=kr.USER_INTERACTION;const s=r.deltaY*(r.deltaMode==1?18:1)*rE*this.zoomSensitivity/30;this.userAdjustOrbit(0,0,s),r.preventDefault(),this.dispatchEvent({type:"user-interaction"})},this.onKeyDown=r=>{const{changeSource:s}=this;this.changeSource=kr.USER_INTERACTION,(r.shiftKey&&this.enablePan?this.panKeyCodeHandler(r):this.orbitZoomKeyCodeHandler(r))?(r.preventDefault(),this.dispatchEvent({type:"user-interaction"})):this.changeSource=s},this._options=Object.assign({},nF),this.setOrbit(0,Math.PI/2,1),this.setFieldOfView(100),this.jumpToGoal()}get interactionEnabled(){return this._interactionEnabled}enableInteraction(){if(this._interactionEnabled===!1){const{element:e}=this;e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("pointercancel",this.onPointerUp),this._disableZoom||e.addEventListener("wheel",this.onWheel),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("touchmove",()=>{},{passive:!1}),e.addEventListener("contextmenu",this.onContext),this.element.style.cursor="grab",this._interactionEnabled=!0,this.updateTouchActionStyle()}}disableInteraction(){if(this._interactionEnabled===!0){const{element:e}=this;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),e.removeEventListener("pointercancel",this.onPointerUp),e.removeEventListener("wheel",this.onWheel),e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("contextmenu",this.onContext),e.style.cursor="",this.touchMode=null,this._interactionEnabled=!1,this.updateTouchActionStyle()}}get options(){return this._options}set disableZoom(e){this._disableZoom!=e&&(this._disableZoom=e,e===!0?this.element.removeEventListener("wheel",this.onWheel):this.element.addEventListener("wheel",this.onWheel),this.updateTouchActionStyle())}getCameraSpherical(e=new nb){return e.copy(this.spherical)}getFieldOfView(){return this.camera.fov}applyOptions(e){Object.assign(this._options,e),this.setOrbit(),this.setFieldOfView(Math.exp(this.goalLogFov))}updateNearFar(e,t){this.camera.far=t===0?2:t,this.camera.near=Math.max(e,this.camera.far/1e3),this.camera.updateProjectionMatrix()}updateAspect(e){this.camera.aspect=e,this.camera.updateProjectionMatrix()}setOrbit(e=this.goalSpherical.theta,t=this.goalSpherical.phi,i=this.goalSpherical.radius){const{minimumAzimuthalAngle:r,maximumAzimuthalAngle:s,minimumPolarAngle:a,maximumPolarAngle:o,minimumRadius:c,maximumRadius:h}=this._options,{theta:p,phi:g,radius:A}=this.goalSpherical,v=Vu(e,r,s);!isFinite(r)&&!isFinite(s)&&(this.spherical.theta=this.wrapAngle(this.spherical.theta-v)+v);const x=Vu(t,a,o),S=Vu(i,c,h);return v===p&&x===g&&S===A||!isFinite(v)||!isFinite(x)||!isFinite(S)?!1:(this.goalSpherical.theta=v,this.goalSpherical.phi=x,this.goalSpherical.radius=S,this.goalSpherical.makeSafe(),!0)}setRadius(e){this.goalSpherical.radius=e,this.setOrbit()}setFieldOfView(e){const{minimumFieldOfView:t,maximumFieldOfView:i}=this._options;e=Vu(e,t,i),this.goalLogFov=Math.log(e)}setDamperDecayTime(e){this.thetaDamper.setDecayTime(e),this.phiDamper.setDecayTime(e),this.radiusDamper.setDecayTime(e),this.fovDamper.setDecayTime(e)}adjustOrbit(e,t,i){const{theta:r,phi:s,radius:a}=this.goalSpherical,{minimumRadius:o,maximumRadius:c,minimumFieldOfView:h,maximumFieldOfView:p}=this._options,g=this.spherical.theta-r,A=Math.PI-.001,v=r-Vu(e,-A-g,A-g),x=s-t,S=i===0?0:((i>0?c:o)-a)/(Math.log(i>0?p:h)-this.goalLogFov),_=a+i*(isFinite(S)?S:(c-o)*2);if(this.setOrbit(v,x,_),i!==0){const E=this.goalLogFov+i;this.setFieldOfView(Math.exp(E))}}jumpToGoal(){this.update(0,m9)}update(e,t){if(this.isStationary())return!1;const{maximumPolarAngle:i,maximumRadius:r}=this._options,s=this.spherical.theta-this.goalSpherical.theta;return Math.abs(s)>Math.PI&&!isFinite(this._options.minimumAzimuthalAngle)&&!isFinite(this._options.maximumAzimuthalAngle)&&(this.spherical.theta-=Math.sign(s)*2*Math.PI),this.spherical.theta=this.thetaDamper.update(this.spherical.theta,this.goalSpherical.theta,t,Math.PI),this.spherical.phi=this.phiDamper.update(this.spherical.phi,this.goalSpherical.phi,t,i),this.spherical.radius=this.radiusDamper.update(this.spherical.radius,this.goalSpherical.radius,t,r),this.logFov=this.fovDamper.update(this.logFov,this.goalLogFov,t,1),this.moveCamera(),!0}updateTouchActionStyle(){const{style:e}=this.element;if(this._interactionEnabled){const{touchAction:t}=this._options;this._disableZoom&&t!=="none"?e.touchAction="manipulation":e.touchAction=t}else e.touchAction=""}isStationary(){return this.goalSpherical.theta===this.spherical.theta&&this.goalSpherical.phi===this.spherical.phi&&this.goalSpherical.radius===this.spherical.radius&&this.goalLogFov===this.logFov}moveCamera(){this.spherical.makeSafe(),this.camera.position.setFromSpherical(this.spherical),this.camera.setRotationFromEuler(new Us(this.spherical.phi-Math.PI/2,this.spherical.theta,0,"YXZ")),this.camera.fov!==Math.exp(this.logFov)&&(this.camera.fov=Math.exp(this.logFov),this.camera.updateProjectionMatrix())}userAdjustOrbit(e,t,i){this.adjustOrbit(e*this.orbitSensitivity*this.inputSensitivity,t*this.orbitSensitivity*this.inputSensitivity,i*this.inputSensitivity)}wrapAngle(e){const t=(e+Math.PI)/(2*Math.PI);return(t-Math.floor(t))*2*Math.PI-Math.PI}pixelLengthToSphericalAngle(e){return 2*Math.PI*e/this.scene.height}twoTouchDistance(e,t){const{clientX:i,clientY:r}=e,{clientX:s,clientY:a}=t,o=s-i,c=a-r;return Math.sqrt(o*o+c*c)}handleSinglePointerMove(e,t){const i=this.pixelLengthToSphericalAngle(e),r=this.pixelLengthToSphericalAngle(t);this.isUserPointing===!1&&(this.isUserPointing=!0,this.dispatchEvent({type:"pointer-change-start"})),this.userAdjustOrbit(i,r,0)}initializePan(){const{theta:e,phi:t}=this.spherical,i=e-this.scene.yaw;this.panPerPixel=Lne*this.panSensitivity/this.scene.height,this.panProjection.set(-Math.cos(i),-Math.cos(t)*Math.sin(i),0,0,Math.sin(t),0,Math.sin(i),-Math.cos(t)*Math.cos(i),0)}movePan(e,t){const{scene:i}=this,r=tF.set(e,t,0).multiplyScalar(this.inputSensitivity),s=this.spherical.radius*Math.exp(this.logFov)*this.panPerPixel;r.multiplyScalar(s);const a=i.getTarget();a.add(r.applyMatrix3(this.panProjection)),i.boundingSphere.clampPoint(a,a),i.setTarget(a.x,a.y,a.z)}recenter(e){if(performance.now()>this.startTime+Nne||Math.abs(e.clientX-this.startPointerPosition.clientX)>eF||Math.abs(e.clientY-this.startPointerPosition.clientY)>eF)return;const{scene:t}=this,i=t.positionAndNormalFromPoint(t.getNDC(e.clientX,e.clientY));if(i==null){const{cameraTarget:r}=t.element;t.element.cameraTarget="",t.element.cameraTarget=r,this.userAdjustOrbit(0,0,1)}else t.target.worldToLocal(i.position),t.setTarget(i.position.x,i.position.y,i.position.z)}resetRadius(){const{scene:e}=this,t=e.positionAndNormalFromPoint(Une.set(0,0));if(t==null)return;e.target.worldToLocal(t.position);const i=e.getTarget(),{theta:r,phi:s}=this.spherical,a=r-e.yaw,o=tF.set(Math.sin(s)*Math.sin(a),Math.cos(s),Math.sin(s)*Math.cos(a)),c=o.dot(t.position.sub(i));i.add(o.multiplyScalar(c)),e.setTarget(i.x,i.y,i.z),this.setOrbit(void 0,void 0,this.goalSpherical.radius-c)}onTouchChange(e){if(this.pointers.length===1)this.touchMode=this.touchModeRotate;else{if(this._disableZoom){this.touchMode=null,this.element.removeEventListener("touchmove",this.disableScroll);return}this.touchMode=this.touchDecided&&this.touchMode===null?null:this.touchModeZoom,this.touchDecided=!0,this.element.addEventListener("touchmove",this.disableScroll,{passive:!1}),this.lastSeparation=this.twoTouchDistance(this.pointers[0],this.pointers[1]),this.enablePan&&this.touchMode!=null&&(this.initializePan(),e.altKey||(this.scene.element[YE].style.opacity=1))}}onMouseDown(e){this.panPerPixel=0,this.enablePan&&(e.button===2||e.ctrlKey||e.metaKey||e.shiftKey)&&(this.initializePan(),this.scene.element[YE].style.opacity=1),this.element.style.cursor="grabbing"}orbitZoomKeyCodeHandler(e){let t=!0;switch(e.key){case"PageUp":this.userAdjustOrbit(0,0,rE*this.zoomSensitivity);break;case"PageDown":this.userAdjustOrbit(0,0,-1*rE*this.zoomSensitivity);break;case"ArrowUp":this.userAdjustOrbit(0,-iE,0);break;case"ArrowDown":this.userAdjustOrbit(0,iE,0);break;case"ArrowLeft":this.userAdjustOrbit(-iE,0,0);break;case"ArrowRight":this.userAdjustOrbit(iE,0,0);break;default:t=!1;break}return t}panKeyCodeHandler(e){this.initializePan();let t=!0;switch(e.key){case"ArrowUp":this.movePan(0,-1*sE);break;case"ArrowDown":this.movePan(0,sE);break;case"ArrowLeft":this.movePan(-1*sE,0);break;case"ArrowRight":this.movePan(sE,0);break;default:t=!1;break}return t}}const Pne=30,iF=.8,rF=1.5,One=20,kne=.2,zne=.25,Gne=10,kA=150,sF=5,Hne=.1,Td={NOT_PRESENTING:"not-presenting",SESSION_STARTED:"session-started",OBJECT_PLACED:"object-placed",FAILED:"failed"},JR={TRACKING:"tracking",NOT_TRACKING:"not-tracking"},A1=new ee,zA=new Bi,Qne=new qt,Vne=new ee,jne=new Gr(45,1,.1,100),aF=new vn().setFromPoints([new ee(0,0,0),new ee(0,0,-1)]),Wne=new ba;class qne extends zo{constructor(e){super(),this.renderer=e,this.currentSession=null,this.placeOnWall=!1,this.placementBox=null,this.lastTick=null,this.turntableRotation=null,this.oldShadowIntensity=null,this.frame=null,this.initialHitSource=null,this.transientHitTestSource=null,this.inputSource=null,this._presentedScene=null,this.resolveCleanup=null,this.exitWebXRButtonContainer=null,this.overlay=null,this.xrLight=null,this.xrMode=null,this.controller1=null,this.controller2=null,this.selectedController=null,this.tracking=!0,this.frames=0,this.initialized=!1,this.oldTarget=new ee,this.placementComplete=!1,this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.lastDragPosition=new ee,this.relativeOrientation=new Bi,this.scaleLine=new Wc(aF),this.firstRatio=0,this.lastAngle=0,this.goalPosition=new ee,this.goalYaw=0,this.goalScale=1,this.xDamper=new ao,this.yDamper=new ao,this.zDamper=new ao,this.yawDamper=new ao,this.pitchDamper=new ao,this.rollDamper=new ao,this.scaleDamper=new ao,this.onExitWebXRButtonContainerClick=()=>this.stopPresenting(),this.onControllerSelectStart=t=>{const i=this.presentedScene,r=t.target;if(this.placementBox.controllerIntersection(i,r)!=null)this.selectedController!=null&&(this.selectedController.userData.line.visible=!1,i.canScale&&(this.isTwoFingering=!0,this.firstRatio=this.controllerSeparation()/i.pivot.scale.x,this.scaleLine.visible=!0)),r.attach(i.pivot),this.selectedController=r,i.setShadowIntensity(.01);else{const s=r===this.controller1?this.controller2:this.controller1;this.relativeOrientation.copy(r.quaternion).invert().multiply(i.pivot.getWorldQuaternion(zA)),s.userData.turning=!1,r.userData.turning=!0,r.userData.line.visible=!1}},this.onControllerSelectEnd=t=>{const i=t.target;if(i.userData.turning=!1,i.userData.line.visible=!0,this.isTwoFingering=!1,this.scaleLine.visible=!1,this.selectedController!=null&&this.selectedController!=i)return;const r=this.presentedScene;r.attach(r.pivot),this.selectedController=null,this.goalYaw=Math.atan2(r.pivot.matrix.elements[8],r.pivot.matrix.elements[10]),this.goalPosition.x=r.pivot.position.x,this.goalPosition.z=r.pivot.position.z},this.onUpdateScene=()=>{this.placementBox!=null&&this.isPresenting&&(this.placementBox.dispose(),this.placementBox=new TU(this.presentedScene,this.placeOnWall?"back":"bottom"))},this.onSelectStart=t=>{const i=this.transientHitTestSource;if(i==null)return;const r=this.frame.getHitTestResultsForTransientInput(i),s=this.presentedScene,a=this.placementBox;if(r.length===1){this.inputSource=t.inputSource;const{axes:o}=this.inputSource.gamepad,c=a.getHit(this.presentedScene,o[0],o[1]);a.show=!0,c!=null?(this.isTranslating=!0,this.lastDragPosition.copy(c)):this.placeOnWall===!1&&(this.isRotating=!0,this.lastAngle=o[0]*rF)}else if(r.length===2){a.show=!0,this.isTwoFingering=!0;const{separation:o}=this.fingerPolar(r);this.firstRatio=o/s.pivot.scale.x}},this.onSelectEnd=()=>{this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.inputSource=null,this.goalPosition.y+=this.placementBox.offsetHeight*this.presentedScene.scale.x,this.placementBox.show=!1},this.threeRenderer=e.threeRenderer,this.threeRenderer.xr.enabled=!0}async resolveARSession(){KN();const e=await navigator.xr.requestSession("immersive-ar",{requiredFeatures:[],optionalFeatures:["hit-test","dom-overlay","light-estimation"],domOverlay:this.overlay?{root:this.overlay}:void 0});return this.threeRenderer.xr.setReferenceSpaceType("local"),await this.threeRenderer.xr.setSession(e),this.threeRenderer.xr.cameraAutoUpdate=!1,e}get presentedScene(){return this._presentedScene}async supportsPresentation(){try{return KN(),await navigator.xr.isSessionSupported("immersive-ar")}catch(e){return console.warn("Request to present in WebXR denied:"),console.warn(e),console.warn("Falling back to next ar-mode"),!1}}async present(e,t=!1){this.isPresenting&&console.warn("Cannot present while a model is already presenting");let i=new Promise((h,p)=>{requestAnimationFrame(()=>h())});e.setHotspotsVisibility(!1),e.queueRender(),await i,this._presentedScene=e,this.overlay=e.element.shadowRoot.querySelector("div.default"),t===!0&&(this.xrLight=new $te(this.threeRenderer),this.xrLight.addEventListener("estimationstart",()=>{if(!this.isPresenting||this.xrLight==null)return;const h=this.presentedScene;h.add(this.xrLight),h.environment=this.xrLight.environment}));const r=await this.resolveARSession();r.addEventListener("end",()=>{this.postSessionCleanup()},{once:!0});const s=e.element.shadowRoot.querySelector(".slot.exit-webxr-ar-button");s.classList.add("enabled"),s.addEventListener("click",this.onExitWebXRButtonContainerClick),this.exitWebXRButtonContainer=s;const a=await r.requestReferenceSpace("viewer");this.xrMode=r.interactionMode,this.tracking=!0,this.frames=0,this.initialized=!1,this.turntableRotation=e.yaw,this.goalYaw=e.yaw,this.goalScale=1,e.setBackground(null),this.oldShadowIntensity=e.shadowIntensity,e.setShadowIntensity(.01),this.oldTarget.copy(e.getTarget()),e.element.addEventListener("load",this.onUpdateScene);const o=One*Math.PI/180,c=this.placeOnWall===!0?void 0:new XRRay(new DOMPoint(0,0,0),{x:0,y:-Math.sin(o),z:-Math.cos(o)});r.requestHitTestSource({space:a,offsetRay:c}).then(h=>{this.initialHitSource=h}),this.xrMode!=="screen-space"&&(this.setupControllers(),this.xDamper.setDecayTime(kA),this.yDamper.setDecayTime(kA),this.zDamper.setDecayTime(kA),this.yawDamper.setDecayTime(kA),this.pitchDamper.setDecayTime(kA),this.rollDamper.setDecayTime(kA)),this.currentSession=r,this.placementBox=new TU(e,this.placeOnWall?"back":"bottom"),this.placementComplete=!1,this.lastTick=performance.now(),this.dispatchEvent({type:"status",status:Td.SESSION_STARTED})}setupControllers(){this.controller1=this.threeRenderer.xr.getController(0),this.controller1.addEventListener("selectstart",this.onControllerSelectStart),this.controller1.addEventListener("selectend",this.onControllerSelectEnd),this.controller2=this.threeRenderer.xr.getController(1),this.controller2.addEventListener("selectstart",this.onControllerSelectStart),this.controller2.addEventListener("selectend",this.onControllerSelectEnd);const e=this.presentedScene;if(e.add(this.controller1),e.add(this.controller2),!this.controller1.userData.line){const t=new Wc(aF);t.name="line",t.scale.z=sF,this.controller1.userData.turning=!1,this.controller1.userData.line=t,this.controller1.add(t),this.controller2.userData.turning=!1;const i=t.clone();this.controller2.userData.line=i,this.controller2.add(i),this.scaleLine.name="scale line",this.scaleLine.visible=!1,this.controller1.add(this.scaleLine);const{size:r}=e,s=Hne/Math.max(r.x,r.y,r.z),a=new Wt(Wne);a.name="box",a.scale.copy(r).multiplyScalar(s),a.visible=!1,this.controller1.userData.box=a,e.add(a);const o=a.clone();this.controller2.userData.box=o,e.add(o)}}hover(e){if(this.xrMode==="screen-space"||this.selectedController==e)return!1;const t=this.presentedScene,i=this.placementBox.controllerIntersection(t,e);return e.userData.box.visible=(i==null||e.userData.turning)&&!this.isTwoFingering,e.userData.line.scale.z=i==null?sF:i.distance,i!=null}controllerSeparation(){return this.controller1.position.distanceTo(this.controller2.position)}async stopPresenting(){if(!this.isPresenting)return;const e=new Promise(t=>{this.resolveCleanup=t});try{await this.currentSession.end(),await e}catch(t){console.warn("Error while trying to end WebXR AR session"),console.warn(t),this.postSessionCleanup()}}get isPresenting(){return this.presentedScene!=null}get target(){return this.oldTarget}updateTarget(){const e=this.presentedScene;if(e!=null){const t=e.getTarget();this.oldTarget.copy(t),this.placeOnWall?t.z=e.boundingBox.min.z:t.y=e.boundingBox.min.y,e.setTarget(t.x,t.y,t.z)}}postSessionCleanup(){const e=this.currentSession;e!=null&&(e.removeEventListener("selectstart",this.onSelectStart),e.removeEventListener("selectend",this.onSelectEnd),this.currentSession=null);const t=this.presentedScene;if(this._presentedScene=null,t!=null){const{element:a}=t;this.xrLight!=null&&(t.remove(this.xrLight),this.xrLight.dispose(),this.xrLight=null),t.add(t.pivot),t.pivot.quaternion.set(0,0,0,1),t.pivot.position.set(0,0,0),t.pivot.scale.set(1,1,1),t.setShadowOffset(0);const o=this.turntableRotation;o!=null&&(t.yaw=o);const c=this.oldShadowIntensity;c!=null&&t.setShadowIntensity(c),t.setEnvironmentAndSkybox(a[G1],a[H1]);const h=this.oldTarget;t.setTarget(h.x,h.y,h.z),t.xrCamera=null,t.element.removeEventListener("load",this.onUpdateScene),t.orientHotspots(0);const{width:p,height:g}=a.getBoundingClientRect();t.setSize(p,g),requestAnimationFrame(()=>{t.element.dispatchEvent(new CustomEvent("camera-change",{detail:{source:kr.NONE}}))})}this.renderer.height=0;const i=this.exitWebXRButtonContainer;i!=null&&(i.classList.remove("enabled"),i.removeEventListener("click",this.onExitWebXRButtonContainerClick),this.exitWebXRButtonContainer=null);const r=this.transientHitTestSource;r!=null&&(r.cancel(),this.transientHitTestSource=null);const s=this.initialHitSource;s!=null&&(s.cancel(),this.initialHitSource=null),this.placementBox!=null&&(this.placementBox.dispose(),this.placementBox=null),this.xrMode!=="screen-space"&&(this.controller1!=null&&(this.controller1.userData.turning=!1,this.controller1.userData.box.visible=!1,this.controller1.userData.line.visible=!0,this.controller1.removeEventListener("selectstart",this.onControllerSelectStart),this.controller1.removeEventListener("selectend",this.onControllerSelectEnd),this.controller1.removeFromParent(),this.controller1=null),this.controller2!=null&&(this.controller2.userData.turning=!1,this.controller2.userData.box.visible=!1,this.controller2.userData.line.visible=!0,this.controller2.removeEventListener("selectstart",this.onControllerSelectStart),this.controller2.removeEventListener("selectend",this.onControllerSelectEnd),this.controller2.removeFromParent(),this.controller2=null),this.selectedController=null,this.scaleLine.visible=!1),this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.lastTick=null,this.turntableRotation=null,this.oldShadowIntensity=null,this.frame=null,this.inputSource=null,this.overlay=null,this.resolveCleanup!=null&&this.resolveCleanup(),this.dispatchEvent({type:"status",status:Td.NOT_PRESENTING})}updateView(e){const t=this.presentedScene,i=this.threeRenderer.xr;i.updateCamera(jne),t.xrCamera=i.getCamera();const{elements:r}=t.getCamera().matrixWorld;if(t.orientHotspots(Math.atan2(r[1],r[5])),this.initialized||(this.placeInitially(),this.initialized=!0),e.requestViewportScale&&e.recommendedViewportScale){const a=e.recommendedViewportScale;e.requestViewportScale(Math.max(a,zne))}const s=i.getBaseLayer();if(s!=null){const a=s instanceof XRWebGLLayer?s.getViewport(e):i.getBinding().getViewSubImage(s,e).viewport;this.threeRenderer.setViewport(a.x,a.y,a.width,a.height)}}placeInitially(){const e=this.presentedScene,{pivot:t,element:i}=e,{position:r}=t,s=e.getCamera(),{width:a,height:o}=this.overlay.getBoundingClientRect();e.setSize(a,o),s.projectionMatrixInverse.copy(s.projectionMatrix).invert();const{theta:c}=i.getCameraOrbit(),h=s.getWorldDirection(A1);e.yaw=Math.atan2(-h.x,-h.z)-c,this.goalYaw=e.yaw;const p=Math.max(1,2*e.boundingSphere.radius);r.copy(s.position).add(h.multiplyScalar(p)),this.updateTarget();const g=e.getTarget();if(r.add(g).sub(this.oldTarget),this.goalPosition.copy(r),e.setHotspotsVisibility(!0),this.xrMode==="screen-space"){const{session:A}=this.frame;A.addEventListener("selectstart",this.onSelectStart),A.addEventListener("selectend",this.onSelectEnd),A.requestHitTestSourceForTransientInput({profile:"generic-touchscreen"}).then(v=>{this.transientHitTestSource=v})}}getTouchLocation(){const{axes:e}=this.inputSource.gamepad;let t=this.placementBox.getExpandedHit(this.presentedScene,e[0],e[1]);return t!=null&&(A1.copy(t).sub(this.presentedScene.getCamera().position),A1.length()>Gne)?null:t}getHitPoint(e){const t=this.threeRenderer.xr.getReferenceSpace(),i=e.getPose(t);if(i==null)return null;const r=Qne.fromArray(i.transform.matrix);return this.placeOnWall===!0&&(this.goalYaw=Math.atan2(r.elements[4],r.elements[6])),r.elements[5]>.75!==this.placeOnWall?Vne.setFromMatrixPosition(r):null}moveToFloor(e){const t=this.initialHitSource;if(t==null)return;const i=e.getHitTestResults(t);if(i.length==0)return;const r=i[0],s=this.getHitPoint(r);s!=null&&(this.placementBox.show=!0,this.isTranslating||(this.placeOnWall?this.goalPosition.copy(s):this.goalPosition.y=s.y),t.cancel(),this.initialHitSource=null,this.dispatchEvent({type:"status",status:Td.OBJECT_PLACED}))}fingerPolar(e){const t=e[0].inputSource.gamepad.axes,i=e[1].inputSource.gamepad.axes,r=i[0]-t[0],s=i[1]-t[1],a=Math.atan2(s,r);let o=this.lastAngle-a;return o>Math.PI?o-=2*Math.PI:o<-Math.PI&&(o+=2*Math.PI),this.lastAngle=a,{separation:Math.sqrt(r*r+s*s),deltaYaw:o}}setScale(e){const t=e/this.firstRatio;this.goalScale=Math.abs(t-1)<kne?1:t}processInput(e){const t=this.transientHitTestSource;if(t==null||!this.isTranslating&&!this.isTwoFingering&&!this.isRotating)return;const i=e.getHitTestResultsForTransientInput(t),r=this.presentedScene,s=r.pivot.scale.x;if(this.isTwoFingering){if(i.length<2)this.isTwoFingering=!1;else{const{separation:a,deltaYaw:o}=this.fingerPolar(i);this.placeOnWall===!1&&(this.goalYaw+=o),r.canScale&&this.setScale(a)}return}else if(i.length===2){this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!0;const{separation:a}=this.fingerPolar(i);this.firstRatio=a/s;return}if(this.isRotating){const a=this.inputSource.gamepad.axes[0]*rF;this.goalYaw+=a-this.lastAngle,this.lastAngle=a}else this.isTranslating&&i.forEach(a=>{if(a.inputSource!==this.inputSource)return;let o=null;if(a.results.length>0&&(o=this.getHitPoint(a.results[0])),o==null&&(o=this.getTouchLocation()),o!=null){if(this.goalPosition.sub(this.lastDragPosition),this.placeOnWall===!1){const c=o.y-this.lastDragPosition.y;if(c<0){this.placementBox.offsetHeight=c/s,this.presentedScene.setShadowOffset(c);const h=A1.copy(r.getCamera().position),p=-c/(h.y-o.y);h.multiplyScalar(p),o.multiplyScalar(1-p).add(h)}}this.goalPosition.add(o),this.lastDragPosition.copy(o)}})}moveScene(e){const t=this.presentedScene,{pivot:i}=t,r=this.placementBox;if(r.updateOpacity(e),this.controller1&&(this.controller1.userData.turning&&(i.quaternion.copy(this.controller1.quaternion).multiply(this.relativeOrientation),this.selectedController&&this.selectedController===this.controller2&&i.quaternion.premultiply(zA.copy(this.controller2.quaternion).invert())),this.controller1.userData.box.position.copy(this.controller1.position),i.getWorldQuaternion(this.controller1.userData.box.quaternion)),this.controller2&&(this.controller2.userData.turning&&(i.quaternion.copy(this.controller2.quaternion).multiply(this.relativeOrientation),this.selectedController&&this.selectedController===this.controller1&&i.quaternion.premultiply(zA.copy(this.controller1.quaternion).invert())),this.controller2.userData.box.position.copy(this.controller2.position),i.getWorldQuaternion(this.controller2.userData.box.quaternion)),this.controller1&&this.controller2&&this.isTwoFingering){const A=this.controllerSeparation();this.setScale(A),this.scaleLine.scale.z=-A,this.scaleLine.lookAt(this.controller2.position)}const s=t.pivot.scale.x;if(this.goalScale!==s){const A=this.scaleDamper.update(s,this.goalScale,e,1);t.pivot.scale.set(A,A,A)}if(i.parent!==t)return;const{position:a}=i,o=t.boundingSphere.radius,c=this.goalPosition;let h=kr.NONE;if(!c.equals(a)){h=kr.USER_INTERACTION;let{x:A,y:v,z:x}=a;if(A=this.xDamper.update(A,c.x,e,o),v=this.yDamper.update(v,c.y,e,o),x=this.zDamper.update(x,c.z,e,o),a.set(A,v,x),this.xrMode==="screen-space"&&!this.isTranslating){const S=c.y-v;this.placementComplete&&this.placeOnWall===!1?(r.offsetHeight=S/t.pivot.scale.x,t.setShadowOffset(S)):S===0&&(this.placementComplete=!0,r.show=!1,t.setShadowIntensity(iF))}this.xrMode!=="screen-space"&&c.equals(a)&&t.setShadowIntensity(iF)}t.updateTarget(e),zA.setFromAxisAngle(A1.set(0,1,0),this.goalYaw);const p=t.pivot.quaternion.angleTo(zA),g=p-this.yawDamper.update(p,0,e,Math.PI);t.pivot.quaternion.rotateTowards(zA,g),t.element.dispatchEvent(new CustomEvent("camera-change",{detail:{source:h}}))}onWebXRFrame(e,t){if(this.xrMode!=="screen-space"){const o=this.hover(this.controller1),c=this.hover(this.controller2);this.placementBox.show=(o||c)&&!this.isTwoFingering}this.frame=t,++this.frames;const i=this.threeRenderer.xr.getReferenceSpace(),r=t.getViewerPose(i);r==null&&this.tracking===!0&&this.frames>Pne&&(this.tracking=!1,this.dispatchEvent({type:"tracking",status:JR.NOT_TRACKING}));const s=this.presentedScene;if(r==null||s==null||!s.element.loaded){this.threeRenderer.clear();return}this.tracking===!1&&(this.tracking=!0,this.dispatchEvent({type:"tracking",status:JR.TRACKING}));let a=!0;for(const o of r.views){if(this.updateView(o),a){this.moveToFloor(t),this.processInput(t);const c=e-this.lastTick;this.moveScene(c),this.renderer.preRender(s,e,c),this.lastTick=e,s.renderShadow(this.threeRenderer)}this.threeRenderer.render(s,s.getCamera()),a=!1}}}function B9(n){const e=new Map,t=new Map,i=n.clone();return D9(n,i,function(r,s){e.set(s,r),t.set(r,s)}),i.traverse(function(r){if(!r.isSkinnedMesh)return;const s=r,a=e.get(r),o=a.skeleton.bones;s.skeleton=a.skeleton.clone(),s.bindMatrix.copy(a.bindMatrix),s.skeleton.bones=o.map(function(c){return t.get(c)}),s.bind(s.skeleton,s.bindMatrix)}),i}function D9(n,e,t){t(n,e);for(let i=0;i<n.children.length;i++)D9(n.children[i],e.children[i],t)}const oF=Symbol("prepared"),zw=Symbol("prepare"),ku=Symbol("preparedGLTF"),Gw=Symbol("clone");class Xne{static prepare(e){if(e.scene==null)throw new Error("Model does not have a scene");if(e[oF])return e;const t=this[zw](e);return t[oF]=!0,t}static[zw](e){const{scene:t}=e,i=[t];return Object.assign(Object.assign({},e),{scene:t,scenes:i})}get parser(){return this[ku].parser}get animations(){return this[ku].animations}get scene(){return this[ku].scene}get scenes(){return this[ku].scenes}get cameras(){return this[ku].cameras}get asset(){return this[ku].asset}get userData(){return this[ku].userData}constructor(e){this[ku]=e}clone(){const e=this.constructor,t=this[Gw]();return new e(t)}dispose(){this.scenes.forEach(e=>{e.traverse(t=>{const i=t;if(!i.material)return;(Array.isArray(i.material)?i.material:[i.material]).forEach(s=>{for(const a in s){const o=s[a];if(o instanceof Pi){const c=o.source.data;c.close!=null&&c.close(),o.dispose()}}s.dispose()}),i.geometry.dispose()})})}[Gw](){const e=this[ku],t=B9(this.scene);Yne(t,this.scene);const i=[t],r=e.userData?Object.assign({},e.userData):{};return Object.assign(Object.assign({},e),{scene:t,scenes:i,userData:r})}}const Yne=(n,e)=>{L9(n,e,(t,i)=>{i.userData.variantMaterials!==void 0&&(t.userData.variantMaterials=new Map(i.userData.variantMaterials)),i.userData.variantData!==void 0&&(t.userData.variantData=i.userData.variantData),i.userData.originalMaterial!==void 0&&(t.userData.originalMaterial=i.userData.originalMaterial)})},L9=(n,e,t)=>{t(n,e);for(let i=0;i<n.children.length;i++)L9(n.children[i],e.children[i],t)},lF=Symbol("threeGLTF"),cF=Symbol("gltf"),uF=Symbol("gltfElementMap"),hF=Symbol("threeObjectMap"),fF=Symbol("parallelTraverseThreeScene"),dF=Symbol("correlateOriginalThreeGLTF"),pF=Symbol("correlateCloneThreeGLTF");class Fb{static from(e,t){return t!=null?this[pF](e,t):this[dF](e)}static[dF](e){const t=e.parser.json,i=e.parser.associations,r=new Map,s={name:"Default"},a={index:-1};for(const o of i.keys())o instanceof ts&&i.get(o)==null&&(a.index<0&&(t.materials==null&&(t.materials=[]),a.index=t.materials.length,t.materials.push(s)),o.name=s.name,i.set(o,{materials:a.index}));for(const[o,c]of i){c&&(o.userData=o.userData||{},o.userData.associations=c);for(const h in c)if(h!=null&&h!=="primitives"){const p=h,A=(t[p]||[])[c[p]];if(A==null)continue;let v=r.get(A);v==null&&(v=new Set,r.set(A,v)),v.add(o)}}return new Fb(e,t,i,r)}static[pF](e,t){const i=t.threeGLTF,r=t.gltf,s=JSON.parse(JSON.stringify(r)),a=new Map,o=new Map;for(let c=0;c<i.scenes.length;c++)this[fF](i.scenes[c],e.scenes[c],(h,p)=>{const g=t.threeObjectMap.get(h);if(g!=null){for(const A in g)if(A!=null&&A!=="primitives"){const v=A,x=g[v],S=s[v][x],_=a.get(p)||{};_[v]=x,a.set(p,_);const E=o.get(S)||new Set;E.add(p),o.set(S,E)}}});return new Fb(e,s,a,o)}static[fF](e,t,i){const r=(s,a)=>{if(i(s,a),s.isObject3D){const o=s,c=a;if(o.material)if(Array.isArray(o.material))for(let h=0;h<o.material.length;++h)i(o.material[h],c.material[h]);else i(o.material,c.material);for(let h=0;h<s.children.length;++h)r(s.children[h],a.children[h])}};r(e,t)}get threeGLTF(){return this[lF]}get gltf(){return this[cF]}get gltfElementMap(){return this[uF]}get threeObjectMap(){return this[hF]}constructor(e,t,i,r){this[lF]=e,this[cF]=t,this[uF]=r,this[hF]=i}}const v1=Symbol("correlatedSceneGraph");class Kne extends Xne{static[zw](e){const t=super[zw](e);t[v1]==null&&(t[v1]=Fb.from(t));const{scene:i}=t,r=new jr(void 0,1/0);return i.traverse(s=>{s.renderOrder=1e3,s.frustumCulled=!1,s.name||(s.name=s.uuid);const a=s;if(a.material){const{geometry:o}=a;a.castShadow=!0,a.isSkinnedMesh&&(o.boundingSphere=r,o.boundingBox=null);const c=a.material;if(c.isMeshBasicMaterial===!0&&(c.toneMapped=!1),c.shadowSide=cc,c.aoMap){const{gltf:h,threeObjectMap:p}=t[v1],g=p.get(c);if(h.materials!=null&&g!=null&&g.materials!=null){const A=h.materials[g.materials];A.occlusionTexture&&A.occlusionTexture.texCoord===0&&o.attributes.uv!=null&&o.setAttribute("uv2",o.attributes.uv)}}}}),t}get correlatedSceneGraph(){return this[ku][v1]}[Gw](){const e=super[Gw](),t=new Map;return e.scene.traverse(i=>{const r=i;if(r.material){const a=r.material;if(a!=null){if(t.has(a.uuid)){r.material=t.get(a.uuid);return}r.material=a.clone(),t.set(a.uuid,r.material)}}const s=i;s.target!==void 0&&s.add(s.target)}),e[v1]=Fb.from(e,this.correlatedSceneGraph),e}}const N9=(n,e,t)=>{let i;switch(n){case xn:i=new Uint8ClampedArray(e*t*4);break;case ci:i=new Uint16Array(e*t*4);break;case fl:i=new Uint32Array(e*t*4);break;case AM:i=new Int8Array(e*t*4);break;case vM:i=new Int16Array(e*t*4);break;case $b:i=new Int32Array(e*t*4);break;case Si:i=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return i};let aE;const $ne=(n,e,t,i)=>{if(aE!==void 0)return aE;const r=new Vr(1,1,i);e.setRenderTarget(r);const s=new Wt(new ra,new ar({color:16777215}));e.render(s,t),e.setRenderTarget(null);const a=N9(n,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,a),r.dispose(),s.geometry.dispose(),s.material.dispose(),aE=a[0]!==0,aE};class G4{_renderer;_rendererIsDisposable=!1;_material;_scene;_camera;_quad;_renderTarget;_width;_height;_type;_colorSpace;_supportsReadPixels=!0;constructor(e){this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:Fi,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:e.renderTargetOptions?.anisotropy!==void 0?e.renderTargetOptions?.anisotropy:1,generateMipmaps:e.renderTargetOptions?.generateMipmaps!==void 0?e.renderTargetOptions?.generateMipmaps:!1,magFilter:e.renderTargetOptions?.magFilter!==void 0?e.renderTargetOptions?.magFilter:mn,minFilter:e.renderTargetOptions?.minFilter!==void 0?e.renderTargetOptions?.minFilter:mn,samples:e.renderTargetOptions?.samples!==void 0?e.renderTargetOptions?.samples:void 0,wrapS:e.renderTargetOptions?.wrapS!==void 0?e.renderTargetOptions?.wrapS:or,wrapT:e.renderTargetOptions?.wrapT!==void 0?e.renderTargetOptions?.wrapT:or};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=G4.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new uc,this._camera=new Yc,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!$ne(this._type,this._renderer,this._camera,t)){let i;this._type===ci&&(i=this._renderer.extensions.has("EXT_color_buffer_float")?Si:void 0),i!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Si}`),this._type=i):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Wt(new ra,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Vr(this.width,this.height,t),this._renderTarget.texture.mapping=e.renderTargetOptions?.mapping!==void 0?e.renderTargetOptions?.mapping:Hd}static instantiateRenderer(){const e=new ZM;return e.setSize(128,128),e}render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)};toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=N9(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new ll(this.toArray(),this.width,this.height,Fi,this._type,e?.mapping||Hd,e?.wrapS||or,e?.wrapT||or,e?.magFilter||mn,e?.minFilter||mn,e?.anisotropy||1,Xi);return t.generateMipmaps=e?.generateMipmaps!==void 0?e?.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof Fs&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof Pi&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof Pi&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class U9 extends Error{}class F9 extends Error{}const y1=(n,e,t)=>{const i=new RegExp(`${e}="([^"]*)"`,"i").exec(n);if(i)return i[1];const r=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(n);if(r){const s=r[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(a=>a.replace(/<\/?rdf:li>/g,"")):r[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},Jne=n=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(n):e=n.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const i=e.indexOf("x:xmpmeta>",t),r=e.slice(t,i+10);try{const s=y1(r,"hdrgm:GainMapMin","0"),a=y1(r,"hdrgm:GainMapMax"),o=y1(r,"hdrgm:Gamma","1"),c=y1(r,"hdrgm:OffsetSDR","0.015625"),h=y1(r,"hdrgm:OffsetHDR","0.015625"),p=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),g=p?p[1]:"0",A=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!A)throw new Error("Incomplete gainmap metadata");const v=A[1];return{gainMapMin:Array.isArray(s)?s.map(x=>parseFloat(x)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(a)?a.map(x=>parseFloat(x)):[parseFloat(a),parseFloat(a),parseFloat(a)],gamma:Array.isArray(o)?o.map(x=>parseFloat(x)):[parseFloat(o),parseFloat(o),parseFloat(o)],offsetSdr:Array.isArray(c)?c.map(x=>parseFloat(x)):[parseFloat(c),parseFloat(c),parseFloat(c)],offsetHdr:Array.isArray(h)?h.map(x=>parseFloat(x)):[parseFloat(h),parseFloat(h),parseFloat(h)],hdrCapacityMin:parseFloat(g),hdrCapacityMax:parseFloat(v)}}catch{}t=e.indexOf("<x:xmpmeta",i)}};class Zne{options;constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,i)=>{const r=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){i(new Error("Not a valid jpeg"));return}const a=s.byteLength;let o=2,c=0,h;for(;o<a;){if(++c>250){i(new Error(`Found no marker after ${c} loops `));return}if(s.getUint8(o)!==255){i(new Error(`Not a valid marker at offset 0x${o.toString(16)}, found: 0x${s.getUint8(o).toString(16)}`));return}if(h=s.getUint8(o+1),r&&console.log(`Marker: ${h.toString(16)}`),h===226){r&&console.log("Found APP2 marker (0xffe2)");const p=o+4;if(s.getUint32(p)===1297106432){const g=p+4;let A;if(s.getUint16(g)===18761)A=!1;else if(s.getUint16(g)===19789)A=!0;else{i(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(g+2,!A)!==42){i(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const v=s.getUint32(g+4,!A);if(v<8){i(new Error("Not valid TIFF data! (First offset less than 8)"));return}const x=g+v,S=s.getUint16(x,!A),_=x+2;let E=0;for(let B=_;B<_+12*S;B+=12)s.getUint16(B,!A)===45057&&(E=s.getUint32(B+8,!A));const T=x+2+S*12+4,R=[];for(let B=T;B<T+E*16;B+=16){const U={MPType:s.getUint32(B,!A),size:s.getUint32(B+4,!A),dataOffset:s.getUint32(B+8,!A),dependantImages:s.getUint32(B+12,!A),start:-1,end:-1,isFII:!1};U.dataOffset?(U.start=g+U.dataOffset,U.isFII=!1):(U.start=0,U.isFII=!0),U.end=U.start+U.size,R.push(U)}if(this.options.extractNonFII&&R.length){const B=new Blob([s]),U=[];for(const O of R){if(O.isFII&&!this.options.extractFII)continue;const F=B.slice(O.start,O.end+1,"image/jpeg");U.push(F)}t(U)}}}o+=2+s.getUint16(o+2)}})}}const eie=async n=>{const e=Jne(n);if(!e)throw new F9("Gain map XMP metadata not found");const i=await new Zne({extractFII:!0,extractNonFII:!0}).extract(n);if(i.length!==2)throw new U9("Gain map recovery image not found");return{sdr:new Uint8Array(await i[0].arrayBuffer()),gainMap:new Uint8Array(await i[1].arrayBuffer()),metadata:e}},mF=n=>new Promise((e,t)=>{const i=document.createElement("img");i.onload=()=>{e(i)},i.onerror=r=>{t(r)},i.src=URL.createObjectURL(n)});class tie extends zs{_renderer;_renderTargetOptions;_internalLoadingManager;_config;constructor(e,t){super(t),this._config=e,e.renderer&&(this._renderer=e.renderer),this._internalLoadingManager=new WM}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Pi,sdr:new Pi});return this._config.createQuadRenderer({width:16,height:16,type:ci,colorSpace:Xi,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(e,t,i){const r=t?new Blob([t],{type:"image/jpeg"}):void 0,s=new Blob([e],{type:"image/jpeg"});let a,o,c=!1;if(typeof createImageBitmap>"u"){const h=await Promise.all([r?mF(r):Promise.resolve(void 0),mF(s)]);o=h[0],a=h[1],c=i==="flipY"}else{const h=await Promise.all([r?createImageBitmap(r,{imageOrientation:i||"flipY"}):Promise.resolve(void 0),createImageBitmap(s,{imageOrientation:i||"flipY"})]);o=h[0],a=h[1]}return{sdrImage:a,gainMapImage:o,needsFlip:c}}createTextures(e,t,i){const r=new Pi(t||new ImageData(2,2),Hd,or,or,mn,NR,Fi,xn,1,Xi);r.flipY=i,r.needsUpdate=!0;const s=new Pi(e,Hd,or,or,mn,NR,Fi,xn,1,xi);return s.flipY=i,s.needsUpdate=!0,{gainMap:r,sdr:s}}updateQuadRenderer(e,t,i,r,s){e.width=t.width,e.height=t.height,e.material.gainMap=i,e.material.sdr=r,e.material.gainMapMin=s.gainMapMin,e.material.gainMapMax=s.gainMapMax,e.material.offsetHdr=s.offsetHdr,e.material.offsetSdr=s.offsetSdr,e.material.gamma=s.gamma,e.material.hdrCapacityMin=s.hdrCapacityMin,e.material.hdrCapacityMax=s.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,s.hdrCapacityMax),e.material.needsUpdate=!0}}const nie=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,iie=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class rie extends Fs{_maxDisplayBoost;_hdrCapacityMin;_hdrCapacityMax;constructor({gamma:e,offsetHdr:t,offsetSdr:i,gainMapMin:r,gainMapMax:s,maxDisplayBoost:a,hdrCapacityMin:o,hdrCapacityMax:c,sdr:h,gainMap:p}){super({name:"GainMapDecoderMaterial",vertexShader:nie,fragmentShader:iie,uniforms:{sdr:{value:h},gainMap:{value:p},gamma:{value:new ee(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new ee().fromArray(t)},offsetSdr:{value:new ee().fromArray(i)},gainMapMin:{value:new ee().fromArray(r)},gainMapMax:{value:new ee().fromArray(s)},weightFactor:{value:(Math.log2(a)-o)/(c-o)}},blending:lc,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=o,this._hdrCapacityMax=c,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class P9 extends tie{constructor(e,t){super({renderer:e,createMaterial:i=>new rie(i),createQuadRenderer:i=>new G4(i)},t)}async render(e,t,i,r){const{sdrImage:s,gainMapImage:a,needsFlip:o}=await this.processImages(i,r,"flipY"),{gainMap:c,sdr:h}=this.createTextures(s,a,o);this.updateQuadRenderer(e,s,c,h,t),e.render()}}class sie extends P9{load([e,t,i],r,s,a){const o=this.prepareQuadRenderer();let c,h,p;const g=async()=>{if(c&&h&&p){try{await this.render(o,p,c,h)}catch(L){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(i),typeof a=="function"&&a(L),o.disposeOnDemandRenderer();return}typeof r=="function"&&r(o),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(i),o.disposeOnDemandRenderer()}};let A=!0,v=0,x=0,S=!0,_=0,E=0,C=!0,T=0,R=0;const B=()=>{if(typeof s=="function"){const L=v+_+T,P=x+E+R,W=A&&S&&C;s(new ProgressEvent("progress",{lengthComputable:W,loaded:P,total:L}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(i);const U=new fs(this._internalLoadingManager);U.setResponseType("arraybuffer"),U.setRequestHeader(this.requestHeader),U.setPath(this.path),U.setWithCredentials(this.withCredentials),U.load(e,async L=>{if(typeof L=="string")throw new Error("Invalid sdr buffer");c=L,await g()},L=>{A=L.lengthComputable,x=L.loaded,v=L.total,B()},L=>{this.manager.itemError(e),typeof a=="function"&&a(L)});const O=new fs(this._internalLoadingManager);O.setResponseType("arraybuffer"),O.setRequestHeader(this.requestHeader),O.setPath(this.path),O.setWithCredentials(this.withCredentials),O.load(t,async L=>{if(typeof L=="string")throw new Error("Invalid gainmap buffer");h=L,await g()},L=>{S=L.lengthComputable,E=L.loaded,_=L.total,B()},L=>{this.manager.itemError(t),typeof a=="function"&&a(L)});const F=new fs(this._internalLoadingManager);return F.setRequestHeader(this.requestHeader),F.setPath(this.path),F.setWithCredentials(this.withCredentials),F.load(i,async L=>{if(typeof L!="string")throw new Error("Invalid metadata string");p=JSON.parse(L),await g()},L=>{C=L.lengthComputable,R=L.loaded,T=L.total,B()},L=>{this.manager.itemError(i),typeof a=="function"&&a(L)}),o}}class O9 extends P9{load(e,t,i,r){const s=this.prepareQuadRenderer(),a=new fs(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async o=>{if(typeof o=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const c=new Uint8Array(o);let h,p,g;try{const A=await eie(c);h=A.sdr,p=A.gainMap,g=A.metadata}catch(A){if(A instanceof F9||A instanceof U9)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),g={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},h=c;else throw A}try{await this.render(s,g,h.buffer,p?.buffer)}catch(A){this.manager.itemError(e),typeof r=="function"&&r(A),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},i,o=>{this.manager.itemError(e),typeof r=="function"&&r(o)}),s}}class aie extends qM{constructor(e){super(e),this.type=ci}parse(e){const a=function(F,L){switch(F){case 1:throw new Error("THREE.HDRLoader: Read Error: "+(L||""));case 2:throw new Error("THREE.HDRLoader: Write Error: "+(L||""));case 3:throw new Error("THREE.HDRLoader: Bad File Format: "+(L||""));default:case 4:throw new Error("THREE.HDRLoader: Memory Error: "+(L||""))}},g=function(F,L,P){L=L||1024;let j=F.pos,V=-1,q=0,re="",Q=String.fromCharCode.apply(null,new Uint16Array(F.subarray(j,j+128)));for(;0>(V=Q.indexOf(`
`))&&q<L&&j<F.byteLength;)re+=Q,q+=Q.length,j+=128,Q+=String.fromCharCode.apply(null,new Uint16Array(F.subarray(j,j+128)));return-1<V?(F.pos+=q+V+1,re+Q.slice(0,V)):!1},A=function(F){const L=/^#\?(\S+)/,P=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,W=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,j=/^\s*FORMAT=(\S+)\s*$/,V=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,q={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let re,Q;for((F.pos>=F.byteLength||!(re=g(F)))&&a(1,"no header found"),(Q=re.match(L))||a(3,"bad initial token"),q.valid|=1,q.programtype=Q[1],q.string+=re+`
`;re=g(F),re!==!1;){if(q.string+=re+`
`,re.charAt(0)==="#"){q.comments+=re+`
`;continue}if((Q=re.match(P))&&(q.gamma=parseFloat(Q[1])),(Q=re.match(W))&&(q.exposure=parseFloat(Q[1])),(Q=re.match(j))&&(q.valid|=2,q.format=Q[1]),(Q=re.match(V))&&(q.valid|=4,q.height=parseInt(Q[1],10),q.width=parseInt(Q[2],10)),q.valid&2&&q.valid&4)break}return q.valid&2||a(3,"missing format specifier"),q.valid&4||a(3,"missing image size specifier"),q},v=function(F,L,P){const W=L;if(W<8||W>32767||F[0]!==2||F[1]!==2||F[2]&128)return new Uint8Array(F);W!==(F[2]<<8|F[3])&&a(3,"wrong scanline width");const j=new Uint8Array(4*L*P);j.length||a(4,"unable to allocate buffer space");let V=0,q=0;const re=4*W,Q=new Uint8Array(4),K=new Uint8Array(re);let ce=P;for(;ce>0&&q<F.byteLength;){q+4>F.byteLength&&a(1),Q[0]=F[q++],Q[1]=F[q++],Q[2]=F[q++],Q[3]=F[q++],(Q[0]!=2||Q[1]!=2||(Q[2]<<8|Q[3])!=W)&&a(3,"bad rgbe scanline format");let ue=0,oe;for(;ue<re&&q<F.byteLength;){oe=F[q++];const $=oe>128;if($&&(oe-=128),(oe===0||ue+oe>re)&&a(3,"bad scanline data"),$){const ae=F[q++];for(let he=0;he<oe;he++)K[ue++]=ae}else K.set(F.subarray(q,q+oe),ue),ue+=oe,q+=oe}const z=W;for(let $=0;$<z;$++){let ae=0;j[V]=K[$+ae],ae+=W,j[V+1]=K[$+ae],ae+=W,j[V+2]=K[$+ae],ae+=W,j[V+3]=K[$+ae],V+=4}ce--}return j},x=function(F,L,P,W){const j=F[L+3],V=Math.pow(2,j-128)/255;P[W+0]=F[L+0]*V,P[W+1]=F[L+1]*V,P[W+2]=F[L+2]*V,P[W+3]=1},S=function(F,L,P,W){const j=F[L+3],V=Math.pow(2,j-128)/255;P[W+0]=Gc.toHalfFloat(Math.min(F[L+0]*V,65504)),P[W+1]=Gc.toHalfFloat(Math.min(F[L+1]*V,65504)),P[W+2]=Gc.toHalfFloat(Math.min(F[L+2]*V,65504)),P[W+3]=Gc.toHalfFloat(1)},_=new Uint8Array(e);_.pos=0;const E=A(_),C=E.width,T=E.height,R=v(_.subarray(_.pos),C,T);let B,U,O;switch(this.type){case Si:O=R.length/4;const F=new Float32Array(O*4);for(let P=0;P<O;P++)x(R,P*4,F,P*4);B=F,U=Si;break;case ci:O=R.length/4;const L=new Uint16Array(O*4);for(let P=0;P<O;P++)S(R,P*4,L,P*4);B=L,U=ci;break;default:throw new Error("THREE.HDRLoader: Unsupported type: "+this.type)}return{width:C,height:T,data:B,header:E.string,gamma:E.gamma,exposure:E.exposure,type:U}}setDataType(e){return this.type=e,this}load(e,t,i,r){function s(a,o){switch(a.type){case Si:case ci:a.colorSpace=Xi,a.minFilter=mn,a.magFilter=mn,a.generateMipmaps=!1,a.flipY=!0;break}t&&t(a,o)}return super.load(e,s,i,r)}}let oie=class extends aie{constructor(e){console.warn("RGBELoader has been deprecated. Please use HDRLoader instead."),super(e)}};const lie={topLight:{intensity:500,position:[.418,16.199,.3]},room:{position:[-.757,13.219,.717],scale:[31.713,28.305,28.591]},boxes:[{position:[-10.906,2.009,1.846],rotation:-.195,scale:[2.328,7.905,4.651]},{position:[-5.607,-.754,-.758],rotation:.994,scale:[1.97,1.534,3.955]},{position:[6.167,.857,7.803],rotation:.561,scale:[3.927,6.285,3.687]},{position:[-2.017,.018,6.124],rotation:.333,scale:[2.002,4.566,2.064]},{position:[2.291,-.756,-2.621],rotation:-.286,scale:[1.546,1.552,1.496]},{position:[-2.193,-.369,-5.547],rotation:.516,scale:[3.875,3.487,2.986]}],lights:[{intensity:50,position:[-16.116,14.37,8.208],scale:[.1,2.428,2.739]},{intensity:50,position:[-16.109,18.021,-8.207],scale:[.1,2.425,2.751]},{intensity:17,position:[14.904,12.198,-1.832],scale:[.15,4.265,6.331]},{intensity:43,position:[-.462,8.89,14.52],scale:[4.38,5.441,.088]},{intensity:20,position:[3.235,11.486,-12.541],scale:[2.5,2,.1]},{intensity:100,position:[0,20,0],scale:[1,.1,1]}]},cie={topLight:{intensity:400,position:[.5,14,.5]},room:{position:[0,13.2,0],scale:[31.5,28.5,31.5]},boxes:[{position:[-10.906,-1,1.846],rotation:-.195,scale:[2.328,7.905,4.651]},{position:[-5.607,-.754,-.758],rotation:.994,scale:[1.97,1.534,3.955]},{position:[6.167,-.16,7.803],rotation:.561,scale:[3.927,6.285,3.687]},{position:[-2.017,.018,6.124],rotation:.333,scale:[2.002,4.566,2.064]},{position:[2.291,-.756,-2.621],rotation:-.286,scale:[1.546,1.552,1.496]},{position:[-2.193,-.369,-5.547],rotation:.516,scale:[3.875,3.487,2.986]}],lights:[{intensity:80,position:[-14,10,8],scale:[.1,2.5,2.5]},{intensity:80,position:[-14,14,-4],scale:[.1,2.5,2.5]},{intensity:23,position:[14,12,0],scale:[.1,5,5]},{intensity:16,position:[0,9,14],scale:[5,5,.1]},{intensity:80,position:[7,8,-14],scale:[2.5,2.5,.1]},{intensity:80,position:[-7,16,-14],scale:[2.5,2.5,.1]},{intensity:1,position:[0,20,0],scale:[.1,.1,.1]}]};class gF extends uc{constructor(e){super(),this.position.y=-3.5;const t=new ba;t.deleteAttribute("uv");const i=new Ks({metalness:0,side:ia}),r=new Ks({metalness:0}),s=e=="legacy"?lie:cie,a=new XM(16777215,s.topLight.intensity,28,2);a.position.set(...s.topLight.position),this.add(a);const o=new Wt(t,i);o.position.set(...s.room.position),o.scale.set(...s.room.scale),this.add(o);for(const c of s.boxes){const h=new Wt(t,r);h.position.set(...c.position),h.rotation.set(0,c.rotation,0),h.scale.set(...c.scale),this.add(h)}for(const c of s.lights){const h=new Wt(t,this.createAreaLightMaterial(c.intensity));h.position.set(...c.position),h.scale.set(...c.scale),this.add(h)}}createAreaLightMaterial(e){const t=new ar;return t.color.setScalar(e),t}}const uie=.04,GA=20,hie=/\.hdr(\.js)?$/;class AF{constructor(e){this.threeRenderer=e,this.lottieLoaderUrl="",this._ldrLoader=null,this._imageLoader=null,this._hdrLoader=null,this._lottieLoader=null,this.generatedEnvironmentMap=null,this.generatedEnvironmentMapAlt=null,this.skyboxCache=new Map,this.blurMaterial=null,this.blurScene=null}ldrLoader(e){return this._ldrLoader==null&&(this._ldrLoader=new E4),this._ldrLoader.setWithCredentials(e),this._ldrLoader}imageLoader(e){return this._imageLoader==null&&(this._imageLoader=new O9(this.threeRenderer)),this._imageLoader.setWithCredentials(e),this._imageLoader}hdrLoader(e){return this._hdrLoader==null&&(this._hdrLoader=new oie,this._hdrLoader.setDataType(ci)),this._hdrLoader.setWithCredentials(e),this._hdrLoader}async getLottieLoader(e){if(this._lottieLoader==null){const{LottieLoader:t}=await import(this.lottieLoaderUrl);this._lottieLoader=new t}return this._lottieLoader.setWithCredentials(e),this._lottieLoader}async loadImage(e,t){const i=await new Promise((r,s)=>this.ldrLoader(t).load(e,r,()=>{},s));return i.name=e,i.flipY=!1,i}async loadLottie(e,t,i){const r=await this.getLottieLoader(i);r.setQuality(t);const s=await new Promise((a,o)=>r.load(e,a,()=>{},o));return s.name=e,s}async loadEquirect(e,t=!1,i=()=>{}){try{const r=hie.test(e),s=r?this.hdrLoader(t):this.imageLoader(t),a=await new Promise((o,c)=>s.load(e,h=>{const{renderTarget:p}=h;if(p!=null){const{texture:g}=p;h.dispose(!1),o(g)}else o(h)},h=>{i(h.loaded/h.total*.9)},c));return i(1),a.name=e,a.mapping=Om,r||(a.colorSpace=xi),a}finally{i&&i(1)}}async generateEnvironmentMapAndSkybox(e=null,t=null,i=()=>{},r=!1){const s=t!=="legacy";(t==="legacy"||t==="neutral")&&(t=null),t=M6(t);let a=Promise.resolve(null),o;e&&(a=this.loadEquirectFromUrl(e,r,i)),t?o=this.loadEquirectFromUrl(t,r,i):e?o=this.loadEquirectFromUrl(e,r,i):o=s?this.loadGeneratedEnvironmentMapAlt():this.loadGeneratedEnvironmentMap();const[c,h]=await Promise.all([o,a]);if(c==null)throw new Error("Failed to load environment map.");return{environmentMap:c,skybox:h}}async loadEquirectFromUrl(e,t,i){if(!this.skyboxCache.has(e)){const r=this.loadEquirect(e,t,i);this.skyboxCache.set(e,r)}return this.skyboxCache.get(e)}async GenerateEnvironmentMap(e,t){await lee();const i=this.threeRenderer,r=new rv(256,{generateMipmaps:!1,type:ci,format:Fi,colorSpace:Xi,depthBuffer:!0}),s=new Bw(.1,100,r),a=s.renderTarget.texture;a.name=t;const o=i.outputColorSpace,c=i.toneMapping;return i.toneMapping=ko,i.outputColorSpace=Xi,s.update(i,e),this.blurCubemap(r,uie),i.toneMapping=c,i.outputColorSpace=o,a}async loadGeneratedEnvironmentMap(){return this.generatedEnvironmentMap==null&&(this.generatedEnvironmentMap=this.GenerateEnvironmentMap(new gF("legacy"),"legacy")),this.generatedEnvironmentMap}async loadGeneratedEnvironmentMapAlt(){return this.generatedEnvironmentMapAlt==null&&(this.generatedEnvironmentMapAlt=this.GenerateEnvironmentMap(new gF("neutral"),"neutral")),this.generatedEnvironmentMapAlt}blurCubemap(e,t){if(this.blurMaterial==null){this.blurMaterial=this.getBlurShader(GA);const r=new ba,s=new Wt(r,this.blurMaterial);this.blurScene=new uc,this.blurScene.add(s)}const i=e.clone();this.halfblur(e,i,t,"latitudinal"),this.halfblur(i,e,t,"longitudinal")}halfblur(e,t,i,r){const a=e.width,o=isFinite(i)?Math.PI/(2*a):2*Math.PI/(2*GA-1),c=i/o,h=isFinite(i)?1+Math.floor(3*c):GA;h>GA&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${h} samples when the maximum is set to ${GA}`);const p=[];let g=0;for(let x=0;x<GA;++x){const S=x/c,_=Math.exp(-S*S/2);p.push(_),x==0?g+=_:x<h&&(g+=2*_)}for(let x=0;x<p.length;x++)p[x]=p[x]/g;const A=this.blurMaterial.uniforms;A.envMap.value=e.texture,A.samples.value=h,A.weights.value=p,A.latitudinal.value=r==="latitudinal",A.dTheta.value=o,new Bw(.1,100,t).update(this.threeRenderer,this.blurScene)}getBlurShader(e){const t=new Float32Array(e),i=new ee(0,1,0);return new Fs({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},poleAxis:{value:i}},vertexShader:`
      
      varying vec3 vOutputDirection;
  
      void main() {
  
        vOutputDirection = vec3( position );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
  
      }
    `,fragmentShader:`
        varying vec3 vOutputDirection;
  
        uniform samplerCube envMap;
        uniform int samples;
        uniform float weights[ n ];
        uniform bool latitudinal;
        uniform float dTheta;
        uniform vec3 poleAxis;
  
        vec3 getSample( float theta, vec3 axis ) {
  
          float cosTheta = cos( theta );
          // Rodrigues' axis-angle rotation
          vec3 sampleDirection = vOutputDirection * cosTheta
            + cross( axis, vOutputDirection ) * sin( theta )
            + axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );
  
          return vec3( textureCube( envMap, sampleDirection ) );
  
        }
  
        void main() {
  
          vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );
  
          if ( all( equal( axis, vec3( 0.0 ) ) ) ) {
  
            axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );
  
          }
  
          axis = normalize( axis );
  
          gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
          gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );
  
          for ( int i = 1; i < n; i++ ) {
  
            if ( i >= samples ) {
  
              break;
  
            }
  
            float theta = dTheta * float( i );
            gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
            gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );
  
          }
        }
      `,blending:lc,depthTest:!1,depthWrite:!1,side:ia})}async dispose(){for(const[,e]of this.skyboxCache)(await e).dispose();this.generatedEnvironmentMap!=null&&((await this.generatedEnvironmentMap).dispose(),this.generatedEnvironmentMap=null),this.generatedEnvironmentMapAlt!=null&&((await this.generatedEnvironmentMapAlt).dispose(),this.generatedEnvironmentMapAlt=null),this.blurMaterial!=null&&this.blurMaterial.dispose()}}const fie=.2,YT=40,KT=60,vF=5,HA=[1,.79,.62,.5,.4,.31,.25],die=3,yF="high-performance",pie=1.3;class Qc extends zo{static get singleton(){return this._singleton||(this._singleton=new Qc({powerPreference:(self.ModelViewerElement||{}).powerPreference||yF,debug:JN()})),this._singleton}static resetSingleton(){const e=this._singleton.dispose();for(const t of e)t.disconnectedCallback();this._singleton=new Qc({powerPreference:(self.ModelViewerElement||{}).powerPreference||yF,debug:JN()});for(const t of e)t.connectedCallback()}get canRender(){return this.threeRenderer!=null}get scaleFactor(){return HA[this.scaleStep]}set minScale(e){let t=1;for(;t<HA.length&&!(HA[t]<e);)++t;this.lastStep=t-1}constructor(e){super(),this.loader=new ro(Kne),this.width=0,this.height=0,this.dpr=1,this.scenes=new Set,this.multipleScenesVisible=!1,this.lastTick=performance.now(),this.renderedLastFrame=!1,this.scaleStep=0,this.lastStep=die,this.avgFrameDuration=(KT+YT)/2,this.onWebGLContextLost=t=>{this.dispatchEvent({type:"contextlost",sourceEvent:t})},this.onWebGLContextRestored=()=>{var t;(t=this.textureUtils)===null||t===void 0||t.dispose(),this.textureUtils=new AF(this.threeRenderer);for(const i of this.scenes)i.element[Ow]()},this.dpr=window.devicePixelRatio,this.canvas3D=document.createElement("canvas"),this.canvas3D.id="webgl-canvas",this.canvas3D.classList.add("show");try{this.threeRenderer=new ZM({canvas:this.canvas3D,alpha:!0,antialias:!0,powerPreference:e.powerPreference,preserveDrawingBuffer:!0}),this.threeRenderer.autoClear=!0,this.threeRenderer.setPixelRatio(1),this.threeRenderer.debug={checkShaderErrors:!!e.debug,onShaderError:null},this.threeRenderer.toneMapping=Pm}catch(t){console.warn(t)}this.arRenderer=new qne(this),this.textureUtils=this.canRender?new AF(this.threeRenderer):null,ro.initializeKTX2Loader(this.threeRenderer),this.canvas3D.addEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas3D.addEventListener("webglcontextrestored",this.onWebGLContextRestored),this.updateRendererSize()}registerScene(e){this.scenes.add(e),e.forceRescale();const t=new Ze;this.threeRenderer.getSize(t),e.canvas.width=t.x,e.canvas.height=t.y,this.canRender&&this.scenes.size>0&&this.threeRenderer.setAnimationLoop((i,r)=>this.render(i,r))}unregisterScene(e){this.scenes.delete(e),this.canvas3D.parentElement===e.canvas.parentElement&&e.canvas.parentElement.removeChild(this.canvas3D),this.canRender&&this.scenes.size===0&&this.threeRenderer.setAnimationLoop(null)}displayCanvas(e){return e.element.modelIsVisible&&!this.multipleScenesVisible?this.canvas3D:e.element[r2]}countVisibleScenes(){const{canvas3D:e}=this;let t=0,i=null;for(const s of this.scenes){const{element:a}=s;a.modelIsVisible&&s.externalRenderer==null&&++t,e.parentElement===s.canvas.parentElement&&(i=s)}const r=t>1;if(i!=null){const s=r&&!this.multipleScenesVisible,a=!i.element.modelIsVisible;if(s||a){const{width:o,height:c}=this.sceneSize(i);this.copyPixels(i,o,c),e.parentElement.removeChild(e)}}this.multipleScenesVisible=r}updateRendererSize(){var e;const t=window.devicePixelRatio;if(t!==this.dpr)for(const s of this.scenes){const{element:a}=s;a[s0](a.getBoundingClientRect())}let i=0,r=0;for(const s of this.scenes)i=Math.max(i,s.width),r=Math.max(r,s.height);if(!(i===this.width&&r===this.height&&t===this.dpr)){this.width=i,this.height=r,this.dpr=t,i=Math.ceil(i*t),r=Math.ceil(r*t),this.canRender&&this.threeRenderer.setSize(i,r,!1);for(const s of this.scenes){const{canvas:a}=s;a.width=i,a.height=r,s.forceRescale(),(e=s.effectRenderer)===null||e===void 0||e.setSize(i,r)}}}updateRendererScale(e){const t=this.scaleStep;this.avgFrameDuration+=Vu(fie*(e-this.avgFrameDuration),-vF,vF),this.avgFrameDuration>KT?++this.scaleStep:this.avgFrameDuration<YT&&this.scaleStep>0&&--this.scaleStep,this.scaleStep=Math.min(this.scaleStep,this.lastStep),t!==this.scaleStep&&(this.avgFrameDuration=(KT+YT)/2)}shouldRender(e){if(e.shouldRender())e.scaleStep!=this.scaleStep&&(e.scaleStep=this.scaleStep,this.rescaleCanvas(e));else if(e.scaleStep!=0)e.scaleStep=0,this.rescaleCanvas(e);else return!1;return!0}rescaleCanvas(e){const t=HA[e.scaleStep],i=Math.ceil(this.width/t),r=Math.ceil(this.height/t),{style:s}=e.canvas;s.width=`${i}px`,s.height=`${r}px`,this.canvas3D.style.width=`${i}px`,this.canvas3D.style.height=`${r}px`;const a=this.dpr*t,o=t<1?"GPU throttling":this.dpr!==window.devicePixelRatio?"No meta viewport tag":"";e.element.dispatchEvent(new CustomEvent("render-scale",{detail:{reportedDpr:window.devicePixelRatio,renderedDpr:a,minimumDpr:this.dpr*HA[this.lastStep],pixelWidth:Math.ceil(e.width*a),pixelHeight:Math.ceil(e.height*a),reason:o}}))}sceneSize(e){const{dpr:t}=this,i=HA[e.scaleStep],r=Math.min(Math.ceil(e.width*i*t),this.canvas3D.width),s=Math.min(Math.ceil(e.height*i*t),this.canvas3D.height);return{width:r,height:s}}copyPixels(e,t,i){const r=e.context;if(r==null){console.log("could not acquire 2d context");return}r.clearRect(0,0,t,i),r.drawImage(this.canvas3D,0,0,t,i,0,0,t,i),e.canvas.classList.add("show")}orderedScenes(){const e=[];for(const t of[!1,!0])for(const i of this.scenes)i.element.modelIsVisible===t&&e.push(i);return e}get isPresenting(){return this.arRenderer.isPresenting}preRender(e,t,i){const{element:r,exposure:s,toneMapping:a}=e;r[eh](t,i);const o=typeof s=="number"&&!Number.isNaN(s),c=r.environmentImage,h=r.skyboxImage,p=a===Pm&&(c==="neutral"||c==="legacy"||!c&&!h);this.threeRenderer.toneMappingExposure=(o?s:1)*(p?pie:1)}render(e,t){if(t!=null){this.arRenderer.onWebXRFrame(e,t);return}const i=e-this.lastTick;if(this.lastTick=e,!this.canRender||this.isPresenting)return;this.countVisibleScenes(),this.updateRendererSize(),this.renderedLastFrame&&(this.updateRendererScale(i),this.renderedLastFrame=!1);const{canvas3D:r}=this;for(const s of this.orderedScenes()){const{element:a}=s;if(!a.loaded||!a.modelIsVisible&&s.renderCount>0||(this.preRender(s,e,i),!this.shouldRender(s)))continue;if(s.externalRenderer!=null){const h=s.getCamera();h.updateMatrix();const{matrix:p,projectionMatrix:g}=h,A=p.elements.slice(),v=s.getTarget();A[12]+=v.x,A[13]+=v.y,A[14]+=v.z,s.externalRenderer.render({viewMatrix:A,projectionMatrix:g.elements});continue}if(!a.modelIsVisible&&!this.multipleScenesVisible)for(const h of this.scenes)h.element.modelIsVisible&&h.queueRender();const{width:o,height:c}=this.sceneSize(s);s.renderShadow(this.threeRenderer),this.threeRenderer.setRenderTarget(null),this.threeRenderer.setViewport(0,Math.ceil(this.height*this.dpr)-c,o,c),s.effectRenderer!=null?s.effectRenderer.render(i):(this.threeRenderer.autoClear=!0,this.threeRenderer.toneMapping=s.toneMapping,this.threeRenderer.render(s,s.camera)),this.multipleScenesVisible||!s.element.modelIsVisible&&s.renderCount===0?this.copyPixels(s,o,c):r.parentElement!==s.canvas.parentElement&&(s.canvas.parentElement.appendChild(r),s.canvas.classList.remove("show")),s.hasRendered(),++s.renderCount,this.renderedLastFrame=!0}}dispose(){this.textureUtils!=null&&this.textureUtils.dispose(),this.threeRenderer!=null&&this.threeRenderer.dispose(),this.textureUtils=null,this.threeRenderer=null;const e=[];for(const t of this.scenes)e.push(t.element);return this.canvas3D.removeEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas3D.removeEventListener("webglcontextrestored",this.onWebGLContextRestored),e}}const jn=Symbol("correlatedObjects"),Ni=Symbol("onUpdate");class ox{constructor(e,t){this[Ni]=e,this[jn]=t}}const bF=new ar,mie=new ra(2,2);let gie=0;const no=Symbol("threeTexture"),xF=Symbol("threeTextures");class Aie extends ox{get[no](){var e;return(e=this[jn])===null||e===void 0?void 0:e.values().next().value}get[xF](){return this[jn]}constructor(e,t){super(e,new Set(t?[t]:[])),this[no].image.src||(this[no].image.src=t.name?t.name:"adhoc_image"+gie++),this[no].image.name||(this[no].image.name=t&&t.image&&t.image.src?t.image.src.split("/").pop():"adhoc_image")}get name(){return this[no].image.name||""}get uri(){return this[no].image.src}get bufferView(){return this[no].image.bufferView}get element(){const e=this[no];if(e&&(e.isCanvasTexture||e.isVideoTexture))return e.image}get animation(){const e=this[no];if(e&&e.isCanvasTexture&&e.animation)return e.animation}get type(){return this.uri!=null?"external":"embedded"}set name(e){for(const t of this[xF])t.image.name=e}update(){const e=this[no];e&&e.isCanvasTexture&&!e.animation&&(this[no].needsUpdate=!0,this[Ni]())}async createThumbnail(e,t){const i=new uc;bF.map=this[no];const r=new Wt(mie,bF);i.add(r);const s=new Yc(-1,1,1,-1,0,1),{threeRenderer:a}=Qc.singleton,o=new Vr(e,t);a.setRenderTarget(o),a.render(i,s),a.setRenderTarget(null);const c=new Uint8Array(e*t*4);a.readRenderTargetPixels(o,0,0,e,t,c),Ld.width=e,Ld.height=t;const h=Ld.getContext("2d"),p=h.createImageData(e,t);return p.data.set(c),h.putImageData(p,0,0),new Promise(async(g,A)=>{Ld.toBlob(v=>{if(!v)return A("Failed to capture thumbnail.");g(URL.createObjectURL(v))},"image/png")})}}var Zs;(function(n){n[n.Nearest=9728]="Nearest",n[n.Linear=9729]="Linear",n[n.NearestMipmapNearest=9984]="NearestMipmapNearest",n[n.LinearMipmapNearest=9985]="LinearMipmapNearest",n[n.NearestMipmapLinear=9986]="NearestMipmapLinear",n[n.LinearMipmapLinear=9987]="LinearMipmapLinear"})(Zs||(Zs={}));var Od;(function(n){n[n.ClampToEdge=33071]="ClampToEdge",n[n.MirroredRepeat=33648]="MirroredRepeat",n[n.Repeat=10497]="Repeat"})(Od||(Od={}));const _F=new Map([[Od.Repeat,hl],[Od.ClampToEdge,or],[Od.MirroredRepeat,mf]]),ZR=new Map([[hl,Od.Repeat],[or,Od.ClampToEdge],[mf,Od.MirroredRepeat]]),vie=new Map([[Zs.Nearest,Ri],[Zs.Linear,mn],[Zs.NearestMipmapNearest,Kd],[Zs.LinearMipmapNearest,uf],[Zs.NearestMipmapLinear,Wu],[Zs.LinearMipmapLinear,ya]]),k9=new Map([[Ri,Zs.Nearest],[mn,Zs.Linear],[Kd,Zs.NearestMipmapNearest],[uf,Zs.LinearMipmapNearest],[Wu,Zs.NearestMipmapLinear],[ya,Zs.LinearMipmapLinear]]),yie=new Map([[Zs.Nearest,Ri],[Zs.Linear,mn]]),z9=new Map([[Ri,Zs.Nearest],[mn,Zs.Linear]]),bie=n=>k9.has(n),xie=n=>z9.has(n),_ie=n=>ZR.has(n),Sie=(n,e)=>{switch(n){case"minFilter":return bie(e);case"magFilter":return xie(e);case"wrapS":case"wrapT":return _ie(e);case"rotation":case"repeat":case"offset":return!0;default:throw new Error(`Cannot configure property "${n}" on Sampler`)}},$h=Symbol("threeTexture"),SF=Symbol("threeTextures"),Ad=Symbol("setProperty");class Eie extends ox{get[$h](){var e;return(e=this[jn])===null||e===void 0?void 0:e.values().next().value}get[SF](){return this[jn]}constructor(e,t){super(e,new Set(t?[t]:[]))}get name(){return this[$h].name||""}get minFilter(){return k9.get(this[$h].minFilter)}get magFilter(){return z9.get(this[$h].magFilter)}get wrapS(){return ZR.get(this[$h].wrapS)}get wrapT(){return ZR.get(this[$h].wrapT)}get rotation(){return this[$h].rotation}get scale(){return s2(this[$h].repeat)}get offset(){return s2(this[$h].offset)}setMinFilter(e){this[Ad]("minFilter",vie.get(e))}setMagFilter(e){this[Ad]("magFilter",yie.get(e))}setWrapS(e){this[Ad]("wrapS",_F.get(e))}setWrapT(e){this[Ad]("wrapT",_F.get(e))}setRotation(e){e==null&&(e=0),this[Ad]("rotation",e)}setScale(e){e==null&&(e={u:1,v:1}),this[Ad]("repeat",new Ze(e.u,e.v))}setOffset(e){e==null&&(e={u:0,v:0}),this[Ad]("offset",new Ze(e.u,e.v))}[Ad](e,t){if(Sie(e,t))for(const i of this[SF])i[e]=t,i.needsUpdate=!0;this[Ni]()}}const EF=Symbol("image"),wF=Symbol("sampler"),MF=Symbol("threeTexture");class G9 extends ox{get[MF](){var e;return(e=this[jn])===null||e===void 0?void 0:e.values().next().value}constructor(e,t){super(e,new Set(t?[t]:[])),this[wF]=new Eie(e,t),this[EF]=new Aie(e,t)}get name(){return this[MF].name||""}set name(e){for(const t of this[jn])t.name=e}get sampler(){return this[wF]}get source(){return this[EF]}}var H9,Q9,V9;const cm=Symbol("texture"),um=Symbol("transform"),$T=Symbol("materials"),CF=Symbol("usage"),QA=Symbol("onUpdate"),j1=Symbol("activeVideo");var Tn;(function(n){n[n.Base=0]="Base",n[n.MetallicRoughness=1]="MetallicRoughness",n[n.Normal=2]="Normal",n[n.Occlusion=3]="Occlusion",n[n.Emissive=4]="Emissive",n[n.Clearcoat=5]="Clearcoat",n[n.ClearcoatRoughness=6]="ClearcoatRoughness",n[n.ClearcoatNormal=7]="ClearcoatNormal",n[n.SheenColor=8]="SheenColor",n[n.SheenRoughness=9]="SheenRoughness",n[n.Transmission=10]="Transmission",n[n.Thickness=11]="Thickness",n[n.Specular=12]="Specular",n[n.SpecularColor=13]="SpecularColor",n[n.Iridescence=14]="Iridescence",n[n.IridescenceThickness=15]="IridescenceThickness",n[n.Anisotropy=16]="Anisotropy"})(Tn||(Tn={}));class l0{constructor(e,t,i,r){this[H9]=null,this[Q9]={rotation:0,scale:new Ze(1,1),offset:new Ze(0,0)},this[V9]=!1,i&&(this[um].rotation=i.rotation,this[um].scale.copy(i.repeat),this[um].offset.copy(i.offset),this[cm]=new G9(e,i)),this[QA]=e,this[$T]=r,this[CF]=t}get texture(){return this[cm]}setTexture(e){var t,i;const r=e!=null?e.source[no]:null,s=(t=this[cm])===null||t===void 0?void 0:t.source[no];if(s!=null&&s.isVideoTexture?this[j1]=!1:!((i=this[cm])===null||i===void 0)&&i.source.animation&&this[cm].source.animation.removeEventListener("enterFrame",this[QA]),this[cm]=e,r!=null&&r.isVideoTexture){const o=r.image;if(this[j1]=!0,o.requestVideoFrameCallback!=null){const c=()=>{this[j1]&&(this[QA](),o.requestVideoFrameCallback(c))};o.requestVideoFrameCallback(c)}else{const c=()=>{this[j1]&&(this[QA](),requestAnimationFrame(c))};requestAnimationFrame(c)}}else e?.source.animation!=null&&e.source.animation.addEventListener("enterFrame",this[QA]);let a=xi;if(this[$T])for(const o of this[$T]){switch(this[CF]){case Tn.Base:o.map=r;break;case Tn.MetallicRoughness:a=Xi,o.metalnessMap=r,o.roughnessMap=r;break;case Tn.Normal:a=Xi,o.normalMap=r;break;case Tn.Occlusion:a=Xi,o.aoMap=r;break;case Tn.Emissive:o.emissiveMap=r;break;case Tn.Clearcoat:o.clearcoatMap=r;break;case Tn.ClearcoatRoughness:o.clearcoatRoughnessMap=r;break;case Tn.ClearcoatNormal:o.clearcoatNormalMap=r;break;case Tn.SheenColor:o.sheenColorMap=r;break;case Tn.SheenRoughness:o.sheenRoughnessMap=r;break;case Tn.Transmission:o.transmissionMap=r;break;case Tn.Thickness:o.thicknessMap=r;break;case Tn.Specular:o.specularIntensityMap=r;break;case Tn.SpecularColor:o.specularColorMap=r;break;case Tn.Iridescence:o.iridescenceMap=r;break;case Tn.IridescenceThickness:o.iridescenceThicknessMap=r;break;case Tn.Anisotropy:o.anisotropyMap=r;break}o.needsUpdate=!0}r&&(r.colorSpace=a,r.rotation=this[um].rotation,r.repeat=this[um].scale,r.offset=this[um].offset),this[QA]()}}H9=cm,Q9=um,V9=j1;const b1=Symbol("threeMaterial"),oE=Symbol("threeMaterials"),TF=Symbol("baseColorTexture"),IF=Symbol("metallicRoughnessTexture");class wie extends ox{get[oE](){return this[jn]}get[b1](){var e;return(e=this[jn])===null||e===void 0?void 0:e.values().next().value}constructor(e,t){super(e,t);const{map:i,metalnessMap:r}=t.values().next().value;this[TF]=new l0(e,Tn.Base,i,t),this[IF]=new l0(e,Tn.MetallicRoughness,r,t)}get baseColorFactor(){const e=[0,0,0,this[b1].opacity];return this[b1].color.toArray(e),e}get metallicFactor(){return this[b1].metalness}get roughnessFactor(){return this[b1].roughness}get baseColorTexture(){return this[TF]}get metallicRoughnessTexture(){return this[IF]}setBaseColorFactor(e){const t=new Mt;e instanceof Array?t.fromArray(e):t.set(e);for(const i of this[oE])i.color.set(t),e instanceof Array&&e.length>3?i.opacity=e[3]:(e=[0,0,0,i.opacity],t.toArray(e));this[Ni]()}setMetallicFactor(e){for(const t of this[oE])t.metalness=e;this[Ni]()}setRoughnessFactor(e){for(const t of this[oE])t.roughness=e;this[Ni]()}}var RF,BF;const DF=Symbol("pbrMetallicRoughness"),LF=Symbol("normalTexture"),NF=Symbol("occlusionTexture"),UF=Symbol("emissiveTexture"),mr=Symbol("backingThreeMaterial"),FF=Symbol("applyAlphaCutoff"),JT=Symbol("getAlphaMode"),VA=Symbol("lazyLoadGLTFInfo"),ZT=Symbol("initialize"),e2=Symbol("getLoadedMaterial"),tn=Symbol("ensureMaterialIsLoaded"),PF=Symbol("gltfIndex"),W1=Symbol("setActive"),m0=Symbol("variantIndices"),eI=Symbol("isActive"),OF=Symbol("modelVariants"),tI=Symbol("name"),Do=Symbol("pbrTextures");class nI extends ox{get[(RF=m0,BF=Do,mr)](){return this[jn].values().next().value}constructor(e,t,i,r,s,a,o=void 0){super(e,s),this[RF]=new Set,this[BF]=new Map,this[PF]=t,this[eI]=i,this[OF]=r,this[tI]=a,o==null?this[ZT]():this[VA]=o}[ZT](){const e=this[Ni],t=this[jn];this[DF]=new wie(e,t);const{normalMap:i,aoMap:r,emissiveMap:s}=t.values().next().value;this[LF]=new l0(e,Tn.Normal,i,t),this[NF]=new l0(e,Tn.Occlusion,r,t),this[UF]=new l0(e,Tn.Emissive,s,t);const a=o=>{this[Do].set(o,new l0(e,o,null,t))};a(Tn.Clearcoat),a(Tn.ClearcoatRoughness),a(Tn.ClearcoatNormal),a(Tn.SheenColor),a(Tn.SheenRoughness),a(Tn.Transmission),a(Tn.Thickness),a(Tn.Specular),a(Tn.SpecularColor),a(Tn.Iridescence),a(Tn.IridescenceThickness),a(Tn.Anisotropy)}async[e2](){if(this[VA]!=null){const e=await this[VA].doLazyLoad();return this[ZT](),this[VA]=void 0,this.ensureLoaded=async()=>{},e}return null}colorFromRgb(e){const t=new Mt;return e instanceof Array?t.fromArray(e):t.set(e),t}[tn](){if(this[VA]!=null)throw new Error(`Material "${this.name}" has not been loaded, call 'await
    myMaterial.ensureLoaded()' before using an unloaded material.`)}async ensureLoaded(){await this[e2]()}get isLoaded(){return this[VA]==null}get isActive(){return this[eI]}[W1](e){this[eI]=e}get name(){return this[tI]||""}set name(e){if(this[tI]=e,this[jn]!=null)for(const t of this[jn])t.name=e}get pbrMetallicRoughness(){return this[tn](),this[DF]}get normalTexture(){return this[tn](),this[LF]}get occlusionTexture(){return this[tn](),this[NF]}get emissiveTexture(){return this[tn](),this[UF]}get emissiveFactor(){return this[tn](),this[mr].emissive.toArray()}get index(){return this[PF]}hasVariant(e){const t=this[OF].get(e);return t!=null&&this[m0].has(t.index)}setEmissiveFactor(e){this[tn]();const t=this.colorFromRgb(e);for(const i of this[jn])i.emissive.set(t);this[Ni]()}[JT](){return this[mr].transparent?"BLEND":this[mr].alphaTest>0?"MASK":"OPAQUE"}[FF](){this[tn]();for(const e of this[jn])this[JT]()==="MASK"?e.alphaTest==null&&(e.alphaTest=.5):e.alphaTest=void 0,e.needsUpdate=!0}setAlphaCutoff(e){this[tn]();for(const t of this[jn])t.alphaTest=e,t.needsUpdate=!0;this[FF](),this[Ni]()}getAlphaCutoff(){return this[tn](),this[mr].alphaTest}setDoubleSided(e){this[tn]();for(const t of this[jn])t.side=e?gi:cc,t.needsUpdate=!0;this[Ni]()}getDoubleSided(){return this[tn](),this[mr].side==gi}setAlphaMode(e){this[tn]();const t=(i,r)=>{i.transparent=r,i.depthWrite=!r};for(const i of this[jn])t(i,e==="BLEND"),e==="MASK"?i.alphaTest=.5:i.alphaTest=void 0,i.needsUpdate=!0;this[Ni]()}getAlphaMode(){return this[tn](),this[JT]()}get emissiveStrength(){return this[tn](),this[mr].emissiveIntensity}setEmissiveStrength(e){this[tn]();for(const t of this[jn])t.emissiveIntensity=e;this[Ni]()}get clearcoatFactor(){return this[tn](),this[mr].clearcoat}get clearcoatRoughnessFactor(){return this[tn](),this[mr].clearcoatRoughness}get clearcoatTexture(){return this[tn](),this[Do].get(Tn.Clearcoat)}get clearcoatRoughnessTexture(){return this[tn](),this[Do].get(Tn.ClearcoatRoughness)}get clearcoatNormalTexture(){return this[tn](),this[Do].get(Tn.ClearcoatNormal)}get clearcoatNormalScale(){return this[tn](),this[mr].clearcoatNormalScale.x}setClearcoatFactor(e){this[tn]();for(const t of this[jn])t.clearcoat=e;this[Ni]()}setClearcoatRoughnessFactor(e){this[tn]();for(const t of this[jn])t.clearcoatRoughness=e;this[Ni]()}setClearcoatNormalScale(e){this[tn]();for(const t of this[jn])t.clearcoatNormalScale=new Ze(e,e);this[Ni]()}get ior(){return this[tn](),this[mr].ior}setIor(e){this[tn]();for(const t of this[jn])t.ior=e;this[Ni]()}get sheenColorFactor(){return this[tn](),this[mr].sheenColor.toArray()}get sheenColorTexture(){return this[tn](),this[Do].get(Tn.SheenColor)}get sheenRoughnessFactor(){return this[tn](),this[mr].sheenRoughness}get sheenRoughnessTexture(){return this[tn](),this[Do].get(Tn.SheenRoughness)}setSheenColorFactor(e){this[tn]();const t=this.colorFromRgb(e);for(const i of this[jn])i.sheenColor.set(t),i.sheen=1;this[Ni]()}setSheenRoughnessFactor(e){this[tn]();for(const t of this[jn])t.sheenRoughness=e,t.sheen=1;this[Ni]()}get transmissionFactor(){return this[tn](),this[mr].transmission}get transmissionTexture(){return this[tn](),this[Do].get(Tn.Transmission)}setTransmissionFactor(e){this[tn]();for(const t of this[jn])t.transmission=e;this[Ni]()}get thicknessFactor(){return this[tn](),this[mr].thickness}get thicknessTexture(){return this[tn](),this[Do].get(Tn.Thickness)}get attenuationDistance(){return this[tn](),this[mr].attenuationDistance}get attenuationColor(){return this[tn](),this[mr].attenuationColor.toArray()}setThicknessFactor(e){this[tn]();for(const t of this[jn])t.thickness=e;this[Ni]()}setAttenuationDistance(e){this[tn]();for(const t of this[jn])t.attenuationDistance=e;this[Ni]()}setAttenuationColor(e){this[tn]();const t=this.colorFromRgb(e);for(const i of this[jn])i.attenuationColor.set(t);this[Ni]()}get specularFactor(){return this[tn](),this[mr].specularIntensity}get specularTexture(){return this[tn](),this[Do].get(Tn.Specular)}get specularColorFactor(){return this[tn](),this[mr].specularColor.toArray()}get specularColorTexture(){return this[tn](),this[Do].get(Tn.SheenColor)}setSpecularFactor(e){this[tn]();for(const t of this[jn])t.specularIntensity=e;this[Ni]()}setSpecularColorFactor(e){this[tn]();const t=this.colorFromRgb(e);for(const i of this[jn])i.specularColor.set(t);this[Ni]()}get iridescenceFactor(){return this[tn](),this[mr].iridescence}get iridescenceTexture(){return this[tn](),this[Do].get(Tn.Iridescence)}get iridescenceIor(){return this[tn](),this[mr].iridescenceIOR}get iridescenceThicknessMinimum(){return this[tn](),this[mr].iridescenceThicknessRange[0]}get iridescenceThicknessMaximum(){return this[tn](),this[mr].iridescenceThicknessRange[1]}get iridescenceThicknessTexture(){return this[tn](),this[Do].get(Tn.IridescenceThickness)}setIridescenceFactor(e){this[tn]();for(const t of this[jn])t.iridescence=e;this[Ni]()}setIridescenceIor(e){this[tn]();for(const t of this[jn])t.iridescenceIOR=e;this[Ni]()}setIridescenceThicknessMinimum(e){this[tn]();for(const t of this[jn])t.iridescenceThicknessRange[0]=e;this[Ni]()}setIridescenceThicknessMaximum(e){this[tn]();for(const t of this[jn])t.iridescenceThicknessRange[1]=e;this[Ni]()}get anisotropyStrength(){return this[tn](),this[mr].anisotropy}get anisotropyRotation(){return this[tn](),this[mr].anisotropyRotation}get anisotropyTexture(){return this[tn](),this[Do].get(Tn.Anisotropy)}setAnisotropyStrength(e){this[tn]();for(const t of this[jn])t.anisotropy=e;this[Ni]()}setAnisotropyRotation(e){this[tn]();for(const t of this[jn])t.anisotropyRotation=e;this[Ni]()}}let j9=class{constructor(e){this.name="",this.children=new Array,this.name=e}};class iI extends j9{constructor(e,t,i,r){super(e.name),this.materials=new Map,this.variantToMaterialMap=new Map,this.initialMaterialIdx=0,this.activeMaterialIdx=0,this.mesh=e;const{gltf:s,threeGLTF:a,threeObjectMap:o}=r;this.parser=a.parser,this.modelVariants=i,this.mesh.userData.variantData=i;const c=o.get(e.material);c.materials!=null?this.initialMaterialIdx=this.activeMaterialIdx=c.materials:console.error(`Primitive (${e.name}) missing initial material reference.`);const h=e.userData.associations||{};if(h.meshes==null){console.error("Mesh is missing primitive index association");return}const A=((s.meshes||[])[h.meshes].primitives||[])[h.primitives];if(A==null){console.error("Mesh primitive definition is missing.");return}if(A.material!=null)this.materials.set(A.material,t[A.material]);else{const v=t.findIndex(x=>x.name==="Default");v>=0?this.materials.set(v,t[v]):console.warn("gltfPrimitive has no material!")}if(A.extensions&&A.extensions.KHR_materials_variants){const v=A.extensions.KHR_materials_variants,S=a.parser.json.extensions.KHR_materials_variants.variants;for(const _ of v.mappings){const E=t[_.material];this.materials.set(_.material,E);for(const C of _.variants){const{name:T}=S[C];this.variantToMaterialMap.set(C,E),E[m0].add(C),i.has(T)||i.set(T,{name:T,index:C})}}}}async setActiveMaterial(e){const t=this.materials.get(e);if(e!==this.activeMaterialIdx){const i=t[jn],r=await t[e2]();r!=null?this.mesh.material=r:this.mesh.material=i.values().next().value,this.parser.assignFinalMaterial(this.mesh),i.add(this.mesh.material),this.activeMaterialIdx=e}return this.mesh.material}getActiveMaterial(){return this.materials.get(this.activeMaterialIdx)}getMaterial(e){return this.materials.get(e)}async enableVariant(e){if(e==null)return this.setActiveMaterial(this.initialMaterialIdx);if(this.variantToMaterialMap!=null&&this.modelVariants.has(e)){const t=this.modelVariants.get(e);return this.enableVariantHelper(t.index)}return null}async enableVariantHelper(e){if(this.variantToMaterialMap!=null&&e!=null){const t=this.variantToMaterialMap.get(e);if(t!=null)return this.setActiveMaterial(t.index)}return null}async instantiateVariants(){if(this.variantToMaterialMap!=null)for(const e of this.variantToMaterialMap.keys()){const t=this.mesh.userData.variantMaterials.get(e);if(t.material!=null)continue;const i=await this.enableVariantHelper(e);i!=null&&(t.material=i)}}get variantInfo(){return this.variantToMaterialMap}addVariant(e,t){if(!this.ensureVariantIsUnused(t))return!1;this.modelVariants.has(t)||this.modelVariants.set(t,{name:t,index:this.modelVariants.size});const r=this.modelVariants.get(t).index;return e[m0].add(r),this.variantToMaterialMap.set(r,e),this.materials.set(e.index,e),this.updateVariantUserData(r,e),!0}deleteVariant(e){if(this.variantInfo.has(e)){this.variantInfo.delete(e);const t=this.mesh.userData.variantMaterials;t?.delete(e)}}updateVariantUserData(e,t){t[m0].add(e),this.mesh.userData.variantData=this.modelVariants,this.mesh.userData.variantMaterials=this.mesh.userData.variantMaterials||new Map,this.mesh.userData.variantMaterials.set(e,{material:t[jn].values().next().value,gltfMaterialIndex:t.index})}ensureVariantIsUnused(e){const t=this.modelVariants.get(e);return t!=null&&this.variantInfo.has(t.index)?(console.warn(`Primitive cannot add variant '${e}' for this material, it already exists.`),!1):!0}}var kF,zF,GF,HF,QF,VF;const nm=Symbol("materials"),lE=Symbol("hierarchy"),jF=Symbol("roots"),Jh=Symbol("primitives"),W9=Symbol("prepareVariantsForExport"),q9=Symbol("switchVariant"),X9=Symbol("materialFromPoint"),t2=Symbol("nodeFromPoint"),Y9=Symbol("nodeFromIndex"),Fa=Symbol("variantData"),n2=Symbol("availableVariants"),rI=Symbol("modelOnUpdate"),WF=Symbol("cloneMaterial");class Mie{constructor(e,t,i,r){this.gltf=e,this.gltfElementMap=t,this.mapKey=i,this.doLazyLoad=r}}class Cie{constructor(e,t=()=>{}){this[kF]=new Array,this[zF]=new Array,this[GF]=new Array,this[HF]=new Array,this[QF]=()=>{},this[VF]=new Map,this[rI]=t;const{gltf:i,threeGLTF:r,gltfElementMap:s}=e;for(const[c,h]of i.materials.entries()){const p=s.get(h);if(p!=null)this[nm].push(new nI(t,c,!0,this[Fa],p,h.name));else{const A=(i.materials||[])[c],v=new Set;s.set(A,v);const x=async()=>{const S=await r.parser.getDependency("material",c);return v.add(S),S};this[nm].push(new nI(t,c,!1,this[Fa],v,h.name,new Mie(i,s,A,x)))}}const a=new Map,o=new Array;for(const c of r.scene.children)o.push(c);for(;o.length>0;){const c=o.pop();let h=null;c instanceof Wt?(h=new iI(c,this.materials,this[Fa],e),this[Jh].push(h)):h=new j9(c.name);const p=a.get(c);p!=null?p.children.push(h):this[jF].push(h),this[lE].push(h);for(const g of c.children)o.push(g),a.set(c,h)}}get materials(){return this[nm]}[(kF=nm,zF=lE,GF=jF,HF=Jh,QF=rI,VF=Fa,n2)](){const e=Array.from(this[Fa].values());return e.sort((t,i)=>t.index-i.index),e.map(t=>t.name)}getMaterialByName(e){const t=this[nm].filter(i=>i.name===e);return t.length>0?t[0]:null}[Y9](e,t){const i=this[lE].find(r=>{if(r instanceof iI){const{meshes:s,primitives:a}=r.mesh.userData.associations;if(s==e&&a==t)return!0}return!1});return i??null}[t2](e){return this[lE].find(t=>t instanceof iI&&t.mesh===e.object)}[X9](e){return this[t2](e).getActiveMaterial()}async[q9](e){for(const t of this[Jh])await t.enableVariant(e);for(const t of this.materials)t[W1](!1);for(const t of this[Jh])this.materials[t.getActiveMaterial().index][W1](!0)}async[W9](){const e=new Array;for(const t of this[Jh])e.push(t.instantiateVariants());await Promise.all(e)}[WF](e,t){const i=this.materials[e];i.isLoaded||console.error(`Cloning an unloaded material,
           call 'material.ensureLoaded() before cloning the material.`);const r=i[jn],s=new Set;for(const[o,c]of r.entries()){const h=c.clone();h.name=t+(r.size>1?"_inst"+o:""),s.add(h)}const a=new nI(this[rI],this[nm].length,!1,this[Fa],s,t);return this[nm].push(a),a}createMaterialInstanceForVariant(e,t,i,r=!0){let s=null;for(const a of this[Jh]){const o=this[Fa].get(i);o!=null&&a.variantInfo.has(o.index)||a.getMaterial(e)!=null&&(this.hasVariant(i)||this.createVariant(i),s==null&&(s=this[WF](e,t)),a.addVariant(s,i))}if(r&&s!=null){s[W1](!0),this.materials[e][W1](!1);for(const a of this[Jh])a.enableVariant(i)}return s}createVariant(e){this[Fa].has(e)?console.warn(`Variant '${e}'' already exists`):this[Fa].set(e,{name:e,index:this[Fa].size})}hasVariant(e){return this[Fa].has(e)}setMaterialToVariant(e,t){if(this[n2]().find(i=>i===t)==null){console.warn(`Can't add material to '${t}', the variant does not exist.'`);return}if(e<0||e>=this.materials.length){console.error("setMaterialToVariant(): materialIndex is out of bounds.");return}for(const i of this[Jh]){const r=i.getMaterial(e);r!=null&&i.addVariant(r,t)}}updateVariantName(e,t){const i=this[Fa].get(e);i!=null&&(i.name=t,this[Fa].set(t,i),this[Fa].delete(e))}deleteVariant(e){const t=this[Fa].get(e);if(t!=null){for(const i of this.materials)i.hasVariant(e)&&i[m0].delete(t.index);for(const i of this[Jh])i.deleteVariant(t.index);this[Fa].delete(e)}}}var sI=function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(s=(r<3?a(s):r>3?a(e,t,s):a(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};const KE=Symbol("currentGLTF"),$E=Symbol("originalGltfJson"),hm=Symbol("model"),aI=Symbol("getOnUpdateMethod"),x1=Symbol("buildTexture"),Tie=n=>{var e,t,i;class r extends n{constructor(){super(...arguments),this[e]=void 0,this[t]=null,this[i]=null,this.variantName=null,this.orientation="0 0 0",this.scale="1 1 1"}get model(){return this[hm]}get availableVariants(){return this.model?this.model[n2]():[]}get originalGltfJson(){return this[$E]}[(e=hm,t=KE,i=$E,aI)](){return()=>{this[ta]()}}[x1](a){return a.colorSpace=xi,a.wrapS=hl,a.wrapT=hl,new G9(this[aI](),a)}async createTexture(a,o="image/png"){const{textureUtils:c}=this[zi],h=await c.loadImage(a,this.withCredentials);return h.userData.mimeType=o,this[x1](h)}async createLottieTexture(a,o=1){const{textureUtils:c}=this[zi],h=await c.loadLottie(a,o,this.withCredentials);return this[x1](h)}createVideoTexture(a){const o=document.createElement("video");o.crossOrigin=this.withCredentials?"use-credentials":"anonymous",o.src=a,o.muted=!0,o.playsInline=!0,o.loop=!0,o.play();const c=new NM(o);return this[x1](c)}createCanvasTexture(){const a=document.createElement("canvas"),o=new d4(a);return this[x1](o)}async updated(a){if(super.updated(a),a.has("variantName")){const o=this[Km].beginActivity("variant-update");o(.1);const c=this[hm],{variantName:h}=this;c!=null&&(await c[q9](h),this[ta](),this.dispatchEvent(new CustomEvent("variant-applied"))),o(1)}if(a.has("orientation")||a.has("scale")){if(!this.loaded)return;const o=this[Rt];o.applyTransform(),o.updateBoundingBox(),o.updateShadow(),this[zi].arRenderer.onUpdateScene(),this[ta]()}}[th](){super[th]();const{currentGLTF:a}=this[Rt];if(a!=null){const{correlatedSceneGraph:o}=a;o!=null&&a!==this[KE]&&(this[hm]=new Cie(o,this[aI]()),this[$E]=JSON.parse(JSON.stringify(o.gltf))),"variants"in a.userData&&this.requestUpdate("variantName")}this[KE]=a}async exportScene(a){const o=this[Rt];return new Promise(async(c,h)=>{const p={binary:!0,onlyVisible:!0,maxTextureSize:1/0,includeCustomExtensions:!1,forceIndices:!1};Object.assign(p,a),p.animations=o.animations,p.truncateDrawRange=!0;const g=o.shadow;let A=!1;g!=null&&(A=g.visible,g.visible=!1),await this[hm][W9](),new kw().register(x=>new Yte(x)).parse(o.model,x=>c(new Blob([p.binary?x:JSON.stringify(x)],{type:p.binary?"application/octet-stream":"application/json"})),()=>h("glTF export failed"),p),g!=null&&(g.visible=A)})}materialFromPoint(a,o){const c=this[hm];if(c==null)return null;const h=this[Rt],p=h.getNDC(a,o),g=h.hitFromPoint(p);return g==null||g.face==null?null:c[X9](g)}}return sI([wn({type:String,attribute:"variant-name"})],r.prototype,"variantName",void 0),sI([wn({type:String,attribute:"orientation"})],r.prototype,"orientation",void 0),sI([wn({type:String,attribute:"scale"})],r.prototype,"scale",void 0),r};class Iie extends Wt{constructor(){super(void 0,new ar({depthWrite:!1})),this.height=0,this.radius=0,this.resolution=0,this.userData.noHit=!0}get map(){return this.material.map}set map(e){this.material.map=e}isUsable(){return this.height>0&&this.radius>0&&this.geometry!=null&&this.map!=null}updateGeometry(e=this.height,t=this.radius,i=128){(e!=this.height||t!=this.radius||i!=this.resolution)&&(this.height=e,this.radius=t,this.resolution=i,e>0&&t>0&&(this.geometry.dispose(),this.geometry=Rie(e,t,i)))}}function Rie(n,e,t){const i=new hc(e,2*t,t);i.scale(1,1,-1);const r=i.getAttribute("position"),s=new ee;for(let a=0;a<r.count;++a)if(s.fromBufferAttribute(r,a),s.y<0){const o=-n*3/2,c=s.y<o?-n/s.y:1-s.y*s.y/(3*o*o);s.multiplyScalar(c),s.toArray(r.array,3*a)}return r.needsUpdate=!0,i}const cE=new ee,oI=new ee,lI=new ee,uE=new Rn,qF=new ea,XF=new Bi;class K9 extends Ste{constructor(e){super(document.createElement("div")),this.normal=new ee(0,1,0),this.initialized=!1,this.referenceCount=1,this.pivot=document.createElement("div"),this.slot=document.createElement("slot"),this.element.classList.add("annotation-wrapper"),this.slot.name=e.name,this.element.appendChild(this.pivot),this.pivot.appendChild(this.slot),this.updatePosition(e.position),this.updateNormal(e.normal),this.surface=e.surface}get facingCamera(){return!this.element.classList.contains("hide")}show(){(!this.facingCamera||!this.initialized)&&this.updateVisibility(!0)}hide(){(this.facingCamera||!this.initialized)&&this.updateVisibility(!1)}increment(){this.referenceCount++}decrement(){return this.referenceCount>0&&--this.referenceCount,this.referenceCount===0}updatePosition(e){if(e==null)return;const t=lf(e)[0].terms;for(let i=0;i<3;++i)this.position.setComponent(i,Yu(t[i]).number);this.updateMatrixWorld()}updateNormal(e){if(e==null)return;const t=lf(e)[0].terms;for(let i=0;i<3;++i)this.normal.setComponent(i,t[i].number)}updateSurface(){const{mesh:e,tri:t,bary:i}=this;if(e==null||t==null||i==null)return;e.getVertexPosition(t.x,cE),e.getVertexPosition(t.y,oI),e.getVertexPosition(t.z,lI),cE.toArray(uE.elements,0),oI.toArray(uE.elements,3),lI.toArray(uE.elements,6),this.position.copy(i).applyMatrix3(uE);const r=this.parent;r.worldToLocal(e.localToWorld(this.position)),qF.set(cE,oI,lI),qF.getNormal(this.normal).transformDirection(e.matrixWorld);const s=r.parent;XF.setFromAxisAngle(cE.set(0,1,0),-s.rotation.y),this.normal.applyQuaternion(XF)}orient(e){this.pivot.style.transform=`rotate(${e}rad)`}updateVisibility(e){this.element.classList.toggle("hide",!e),this.slot.assignedNodes().forEach(t=>{if(t.nodeType!==Node.ELEMENT_NODE)return;const i=t,r=i.dataset.visibilityAttribute;if(r!=null){const s=`data-${r}`;i.toggleAttribute(s,e)}i.dispatchEvent(new CustomEvent("hotspot-visibility",{detail:{visible:e}}))}),this.initialized=!0}}const Bie={name:"HorizontalBlurShader",uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float h;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

			gl_FragColor = sum;

		}`},Die={name:"VerticalBlurShader",uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float v;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

			gl_FragColor = sum;

		}`};function JE(n,e,t){return Math.max(e,Math.min(t,n))}function YF(n,e,t){return(1-t)*n+t*e}const KF=9,Lie=6,cI=2,Nie=.3;class Uie extends Gn{constructor(e,t,i){super(),this.camera=new Yc,this.renderTarget=null,this.renderTargetBlur=null,this.depthMaterial=new sx,this.horizontalBlurMaterial=new Fs(Bie),this.verticalBlurMaterial=new Fs(Die),this.intensity=0,this.softness=1,this.boundingBox=new gr,this.size=new ee,this.maxDimension=0,this.isAnimated=!1,this.needsUpdate=!1;const{camera:r}=this;r.rotation.x=Math.PI/2,r.left=-.5,r.right=.5,r.bottom=-.5,r.top=.5,this.add(r);const s=new ra,a=new ar({opacity:1,transparent:!0,side:ia});this.floor=new Wt(s,a),this.floor.userData.noHit=!0,r.add(this.floor),this.blurPlane=new Wt(s),this.blurPlane.visible=!1,r.add(this.blurPlane),e.target.add(this),this.depthMaterial.onBeforeCompile=function(o){o.fragmentShader=o.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * opacity );")},this.depthMaterial.side=gi,this.horizontalBlurMaterial.depthTest=!1,this.verticalBlurMaterial.depthTest=!1,this.setScene(e,t,i)}setScene(e,t,i){const{boundingBox:r,size:s,rotation:a,position:o}=this;if(this.isAnimated=e.animationNames.length>0,this.boundingBox.copy(e.boundingBox),this.size.copy(e.size),this.maxDimension=Math.max(s.x,s.y,s.z)*(this.isAnimated?cI:1),this.boundingBox.getCenter(o),i==="back"){const{min:c,max:h}=r;[c.y,c.z]=[c.z,c.y],[h.y,h.z]=[h.z,h.y],[s.y,s.z]=[s.z,s.y],a.x=Math.PI/2,a.y=Math.PI}else a.x=0,a.y=0;if(this.isAnimated){const c=r.min.y,h=r.max.y;s.y=this.maxDimension,r.expandByVector(s.subScalar(this.maxDimension).multiplyScalar(-.5)),r.min.y=c,r.max.y=h,s.set(this.maxDimension,h-c,this.maxDimension)}i==="bottom"?o.y=r.min.y:o.z=r.min.y,this.setSoftness(t)}setSoftness(e){this.softness=e;const{size:t,camera:i}=this,r=this.isAnimated?cI:1,s=r*Math.pow(2,KF-e*(KF-Lie));this.setMapSize(s);const a=t.y/2,o=t.y*r;i.near=0,i.far=YF(o,a,e),this.depthMaterial.opacity=1/e,i.updateProjectionMatrix(),this.setIntensity(this.intensity),this.setOffset(0)}setMapSize(e){const{size:t}=this;this.isAnimated&&(e*=cI);const i=Math.floor(t.x>t.z?e:e*t.x/t.z),r=Math.floor(t.x>t.z?e*t.z/t.x:e),s=10,a=s+i,o=s+r;if(this.renderTarget!=null&&(this.renderTarget.width!==a||this.renderTarget.height!==o)&&(this.renderTarget.dispose(),this.renderTarget=null,this.renderTargetBlur.dispose(),this.renderTargetBlur=null),this.renderTarget==null){const c={format:Fi};this.renderTarget=new Vr(a,o,c),this.renderTargetBlur=new Vr(a,o,c),this.floor.material.map=this.renderTarget.texture}this.camera.scale.set(t.x*(1+s/i),t.z*(1+s/r),1),this.needsUpdate=!0}setIntensity(e){this.intensity=e,e>0?(this.visible=!0,this.floor.visible=!0,this.floor.material.opacity=e*YF(Nie,1,this.softness*this.softness)):(this.visible=!1,this.floor.visible=!1)}getIntensity(){return this.intensity}setOffset(e){this.floor.position.z=-e+this.gap()}gap(){return .001*this.maxDimension}render(e,t){t.overrideMaterial=this.depthMaterial;const i=e.getClearAlpha();e.setClearAlpha(0),this.floor.visible=!1;const r=e.xr.enabled;e.xr.enabled=!1;const s=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.render(t,this.camera),t.overrideMaterial=null,this.floor.visible=!0,this.blurShadow(e),e.xr.enabled=r,e.setRenderTarget(s),e.setClearAlpha(i)}blurShadow(e){const{camera:t,horizontalBlurMaterial:i,verticalBlurMaterial:r,renderTarget:s,renderTargetBlur:a,blurPlane:o}=this;o.visible=!0,o.material=i,i.uniforms.h.value=1/this.renderTarget.width,i.uniforms.tDiffuse.value=this.renderTarget.texture,e.setRenderTarget(a),e.render(o,t),o.material=r,r.uniforms.v.value=1/this.renderTarget.height,r.uniforms.tDiffuse.value=this.renderTargetBlur.texture,e.setRenderTarget(s),e.render(o,t),o.visible=!1}dispose(){this.renderTarget!=null&&this.renderTarget.dispose(),this.renderTargetBlur!=null&&this.renderTargetBlur.dispose(),this.depthMaterial.dispose(),this.horizontalBlurMaterial.dispose(),this.verticalBlurMaterial.dispose(),this.floor.material.dispose(),this.floor.geometry.dispose(),this.blurPlane.geometry.dispose(),this.removeFromParent()}}const $F=10,uI=100,hI=new ee,JF=new ee,ZF=new ee,hE=new ep,Fie=new ee,_1=new Ze;class Pie extends uc{constructor({canvas:e,element:t,width:i,height:r}){super(),this.annotationRenderer=new Ete,this.effectRenderer=null,this.schemaElement=document.createElement("script"),this.width=1,this.height=1,this.aspect=1,this.scaleStep=0,this.renderCount=0,this.externalRenderer=null,this.appendedAnimations=[],this.markedAnimations=[],this.camera=new Gr(45,1,.1,100),this.xrCamera=null,this.url=null,this.pivot=new Gn,this.target=new Gn,this.animationNames=[],this.boundingBox=new gr,this.boundingSphere=new jr,this.size=new ee,this.idealAspect=0,this.framedFoVDeg=0,this.shadow=null,this.shadowIntensity=0,this.shadowSoftness=1,this.bakedShadows=new Set,this.exposure=1,this.toneMapping=Pm,this.canScale=!0,this.isDirty=!1,this.goalTarget=new ee,this.targetDamperX=new ao,this.targetDamperY=new ao,this.targetDamperZ=new ao,this._currentGLTF=null,this._model=null,this.cancelPendingSourceChange=null,this.animationsByName=new Map,this.currentAnimationAction=null,this.groundedSkybox=new Iie,this.name="ModelScene",this.element=t,this.canvas=e,this.camera=new Gr(45,1,.1,100),this.camera.name="MainCamera",this.add(this.pivot),this.pivot.name="Pivot",this.pivot.add(this.target),this.setSize(i,r),this.target.name="Target",this.mixer=new o6(this.target);const{domElement:s}=this.annotationRenderer,{style:a}=s;a.display="none",a.pointerEvents="none",a.position="absolute",a.top="0",this.element.shadowRoot.querySelector(".default").appendChild(s),this.schemaElement.setAttribute("type","application/ld+json")}get context(){return this.canvas.getContext("2d")}getCamera(){return this.xrCamera!=null?this.xrCamera:this.camera}queueRender(){this.isDirty=!0}shouldRender(){return this.isDirty}hasRendered(){this.isDirty=!1}forceRescale(){this.scaleStep=-1,this.queueRender()}async setObject(e){this.reset(),this._model=e,this.target.add(e),await this.setupScene()}async setSource(e,t=()=>{}){if(!e||e===this.url){t(1);return}if(this.reset(),this.url=e,this.externalRenderer!=null){const o=await this.externalRenderer.load(t);this.boundingSphere.radius=o.framedRadius,this.idealAspect=o.fieldOfViewAspect;return}this.cancelPendingSourceChange!=null&&(this.cancelPendingSourceChange(),this.cancelPendingSourceChange=null);let i;try{i=await new Promise(async(o,c)=>{this.cancelPendingSourceChange=()=>c();try{const h=await this.element[zi].loader.load(e,this.element,t);o(h)}catch(h){c(h)}})}catch(o){if(o==null)return;throw o}this.cancelPendingSourceChange=null,this.reset(),this.url=e,this._currentGLTF=i,i!=null&&(this._model=i.scene,this.target.add(i.scene));const{animations:r}=i,s=new Map,a=[];for(const o of r)s.set(o.name,o),a.push(o.name);this.animations=r,this.animationsByName=s,this.animationNames=a,await this.setupScene()}async setupScene(){this.applyTransform(),this.updateBoundingBox(),await this.updateFraming(),this.updateShadow(),this.setShadowIntensity(this.shadowIntensity),this.setGroundedSkybox()}reset(){this.url=null,this.renderCount=0,this.queueRender(),this.shadow!=null&&this.shadow.setIntensity(0),this.bakedShadows.clear();const{_model:e}=this;e!=null&&(e.removeFromParent(),this._model=null);const t=this._currentGLTF;t!=null&&(t.dispose(),this._currentGLTF=null),this.currentAnimationAction!=null&&(this.currentAnimationAction.stop(),this.currentAnimationAction=null),this.mixer.stopAllAction(),this.mixer.uncacheRoot(this)}dispose(){this.reset(),this.shadow!=null&&(this.shadow.dispose(),this.shadow=null),this.element[KE]=null,this.element[$E]=null,this.element[hm]=null}get currentGLTF(){return this._currentGLTF}setSize(e,t){if(!(this.width===e&&this.height===t)){if(this.width=Math.max(e,1),this.height=Math.max(t,1),this.annotationRenderer.setSize(e,t),this.aspect=this.width/this.height,this.externalRenderer!=null){const i=window.devicePixelRatio;this.externalRenderer.resize(e*i,t*i)}this.queueRender()}}markBakedShadow(e){e.userData.noHit=!0,this.bakedShadows.add(e)}unmarkBakedShadow(e){e.userData.noHit=!1,e.visible=!0,this.bakedShadows.delete(e),this.boundingBox.expandByObject(e)}findBakedShadows(e){const t=new gr;e.traverse(i=>{const r=i;if(!r.material||!r.material.transparent)return;t.setFromObject(r);const a=t.getSize(Fie),o=Math.min(a.x,a.y,a.z);Math.max(a.x,a.y,a.z)<uI*o||this.markBakedShadow(r)})}checkBakedShadows(){const{min:e,max:t}=this.boundingBox,i=new gr;this.boundingBox.getSize(this.size);for(const r of this.bakedShadows)i.setFromObject(r),!(i.min.y<e.y+this.size.y/uI&&i.min.x<=e.x&&i.max.x>=t.x&&i.min.z<=e.z&&i.max.z>=t.z)&&(i.min.z<e.z+this.size.z/uI&&i.min.x<=e.x&&i.max.x>=t.x&&i.min.y<=e.y&&i.max.y>=t.y||this.unmarkBakedShadow(r))}applyTransform(){const{model:e}=this;if(e==null)return;const t=lf(this.element.orientation)[0].terms,i=Yu(t[0]).number,r=Yu(t[1]).number,s=Yu(t[2]).number;e.quaternion.setFromEuler(new Us(r,s,i,"YXZ"));const a=lf(this.element.scale)[0].terms;e.scale.set(a[0].number,a[1].number,a[2].number)}updateBoundingBox(){const{model:e}=this;if(e==null)return;this.target.remove(e),this.findBakedShadows(e);const t=(i,r)=>i.expandByPoint(r);this.setBakedShadowVisibility(!1),this.boundingBox=YS(e,t,new gr),this.boundingBox.isEmpty()&&(this.setBakedShadowVisibility(!0),this.bakedShadows.forEach(i=>this.unmarkBakedShadow(i)),this.boundingBox=YS(e,t,new gr)),this.checkBakedShadows(),this.setBakedShadowVisibility(),this.boundingBox.getSize(this.size),this.target.add(e)}async updateFraming(){const{model:e}=this;if(e==null)return;this.target.remove(e),this.setBakedShadowVisibility(!1);const{center:t}=this.boundingSphere;this.element.requestUpdate("cameraTarget"),await this.element.updateComplete,t.copy(this.getTarget());const i=(s,a)=>Math.max(s,t.distanceToSquared(a));this.boundingSphere.radius=Math.sqrt(YS(e,i,0));const r=(s,a)=>{a.sub(t);const o=Math.sqrt(a.x*a.x+a.z*a.z);return Math.max(s,o/(this.idealCameraDistance()-Math.abs(a.y)))};this.idealAspect=YS(e,r,0)/Math.tan(this.framedFoVDeg/2*Math.PI/180),this.setBakedShadowVisibility(),this.target.add(e)}setBakedShadowVisibility(e=this.shadowIntensity<=0){for(const t of this.bakedShadows)t.visible=e}idealCameraDistance(){const e=this.framedFoVDeg/2*Math.PI/180;return this.boundingSphere.radius/Math.sin(e)}adjustedFoV(e){const t=Math.tan(e/2*Math.PI/180)*Math.max(1,this.idealAspect/this.aspect);return 2*Math.atan(t)*180/Math.PI}getNDC(e,t){if(this.xrCamera!=null)_1.set(e/window.screen.width,t/window.screen.height);else{const i=this.element.getBoundingClientRect();_1.set((e-i.x)/this.width,(t-i.y)/this.height)}return _1.multiplyScalar(2).subScalar(1),_1.y*=-1,_1}getSize(){return{width:this.width,height:this.height}}setEnvironmentAndSkybox(e,t){this.element[zi].arRenderer.presentedScene!==this&&(this.environment=e,this.setBackground(t),this.queueRender())}setBackground(e){this.groundedSkybox.map=e,this.groundedSkybox.isUsable()?(this.target.add(this.groundedSkybox),this.background=null):(this.target.remove(this.groundedSkybox),this.background=e)}farRadius(){return this.boundingSphere.radius*(this.groundedSkybox.parent!=null?$F:1)}setGroundedSkybox(){const e=lf(this.element.skyboxHeight)[0].terms[0],t=Yu(e).number,i=$F*this.boundingSphere.radius;this.groundedSkybox.updateGeometry(t,i),this.groundedSkybox.position.y=t-(this.shadow?2*this.shadow.gap():0),this.setBackground(this.groundedSkybox.map)}setTarget(e,t,i){this.goalTarget.set(-e,-t,-i)}setTargetDamperDecayTime(e){this.targetDamperX.setDecayTime(e),this.targetDamperY.setDecayTime(e),this.targetDamperZ.setDecayTime(e)}getTarget(){return this.goalTarget.clone().multiplyScalar(-1)}getDynamicTarget(){return this.target.position.clone().multiplyScalar(-1)}jumpToGoal(){this.updateTarget(m9)}updateTarget(e){const t=this.goalTarget,i=this.target.position;if(t.equals(i))return!1;{const r=this.boundingSphere.radius/10;let{x:s,y:a,z:o}=i;return s=this.targetDamperX.update(s,t.x,e,r),a=this.targetDamperY.update(a,t.y,e,r),o=this.targetDamperZ.update(o,t.z,e,r),this.groundedSkybox.position.x=-s,this.groundedSkybox.position.z=-o,this.target.position.set(s,a,o),this.target.updateMatrixWorld(),this.queueRender(),!0}}pointTowards(e,t){const{x:i,z:r}=this.position;this.yaw=Math.atan2(e-i,t-r)}get model(){return this._model}set yaw(e){this.pivot.rotation.y=e,this.groundedSkybox.rotation.y=-e,this.queueRender()}get yaw(){return this.pivot.rotation.y}set animationTime(e){this.mixer.setTime(e),this.queueShadowRender()}get animationTime(){if(this.currentAnimationAction!=null){const e=Math.max(this.currentAnimationAction._loopCount,0);return this.currentAnimationAction.loop===Eb&&(e&1)===1?this.duration-this.currentAnimationAction.time:this.currentAnimationAction.time}return 0}set animationTimeScale(e){this.mixer.timeScale=e}get animationTimeScale(){return this.mixer.timeScale}get duration(){return this.currentAnimationAction!=null&&this.currentAnimationAction.getClip()?this.currentAnimationAction.getClip().duration:0}get hasActiveAnimation(){return this.currentAnimationAction!=null}playAnimation(e=null,t=0,i=Tm,r=1/0){if(this._currentGLTF==null)return;const{animations:s}=this;if(s==null||s.length===0)return;let a=null;if(e!=null&&(a=this.animationsByName.get(e),a==null)){const o=parseInt(e);!isNaN(o)&&o>=0&&o<s.length&&(a=s[o])}a==null&&(a=s[0]);try{const{currentAnimationAction:o}=this,c=this.mixer.clipAction(a,this);c.timeScale!=this.element.timeScale&&(c.timeScale=this.element.timeScale),this.currentAnimationAction=c,this.element.paused?this.mixer.stopAllAction():(c.paused=!1,o!=null&&c!==o?c.crossFadeFrom(o,t,!1):this.animationTimeScale>0&&this.animationTime==this.duration&&(this.animationTime=0)),c.setLoop(i,r),c.enabled=!0,c.clampWhenFinished=!0,c.play()}catch(o){console.error(o)}}appendAnimation(e="",t=Tm,i=1/0,r=1,s=1,a=!1,o=!1,c=!0,h=null,p=!1){if(this._currentGLTF==null||e===this.element.animationName)return;const{animations:g}=this;if(g==null||g.length===0)return;let A=null;const v=1.25;if(e&&(A=this.animationsByName.get(e)),A!=null){typeof i=="string"?isNaN(i)?(i=1/0,console.warn("Invalid repetitionCount value, repetitionCount is set to Infinity")):i=Math.max(parseInt(i),1):typeof i=="number"&&i<1&&(i=1),i===1&&t!==T0&&(t=T0),typeof r=="string"&&(isNaN(r)?(r=1,console.warn("Invalid weight value, weight is set to 1")):r=parseFloat(r)),typeof s=="string"&&(isNaN(s)?(s=1,console.warn("Invalid timeScale value, timeScale is set to 1")):s=parseFloat(s)),typeof a=="string"&&(a.toLowerCase().trim()==="true"?a=!0:a.toLowerCase().trim()==="false"?a=!1:isNaN(a)?(a=!1,console.warn("Invalid fade value, fade is set to false")):a=parseFloat(a)),typeof o=="string"&&(o.toLowerCase().trim()==="true"?o=!0:o.toLowerCase().trim()==="false"?o=!1:isNaN(o)?(o=!1,console.warn("Invalid warp value, warp is set to false")):o=parseFloat(o)),typeof h=="string"&&(isNaN(h)||(h=parseFloat(h)));try{const x=this.mixer.existingAction(A)||this.mixer.clipAction(A,this),S=x.timeScale;p&&this.appendedAnimations.includes(e)&&(this.markedAnimations.map(_=>_.name).includes(e)||this.markedAnimations.push({name:e,loopMode:t,repetitionCount:i})),typeof h=="number"&&(x.time=Math.min(Math.max(h,0),A.duration)),typeof a=="boolean"&&a?x.fadeIn(v):typeof a=="number"?x.fadeIn(Math.max(a,0)):r>=0&&(x.weight=Math.min(Math.max(r,0),1)),typeof o=="boolean"&&o?x.warp(c?S:0,s,v):typeof o=="number"?x.warp(c?S:0,s,Math.max(o,0)):x.timeScale=s,x.isRunning()||(x.time==A.duration&&x.stop(),x.setLoop(t,i),x.paused=!1,x.enabled=!0,x.clampWhenFinished=!0,x.play()),this.appendedAnimations.includes(e)||this.element[Rt].appendedAnimations.push(e)}catch(x){console.error(x)}}}detachAnimation(e="",t=!0){if(this._currentGLTF==null||e===this.element.animationName)return;const{animations:i}=this;if(i==null||i.length===0)return;let r=null;const s=1.5;if(e&&(r=this.animationsByName.get(e)),r!=null){typeof t=="string"&&(t.toLowerCase().trim()==="true"?t=!0:t.toLowerCase().trim()==="false"?t=!1:isNaN(t)?(t=!0,console.warn("Invalid fade value, fade is set to true")):t=parseFloat(t));try{const a=this.mixer.existingAction(r)||this.mixer.clipAction(r,this);typeof t=="boolean"&&t?a.fadeOut(s):typeof t=="number"?a.fadeOut(Math.max(t,0)):a.stop();const o=this.element[Rt].appendedAnimations.filter(c=>c!==e);this.element[Rt].appendedAnimations=o}catch(a){console.error(a)}}}updateAnimationLoop(e="",t=Tm,i=1/0){if(this._currentGLTF==null||e===this.element.animationName)return;const{animations:r}=this;if(r==null||r.length===0)return;let s=null;if(e&&(s=this.animationsByName.get(e)),s!=null)try{const a=this.mixer.existingAction(s)||this.mixer.clipAction(s,this);a.stop(),a.setLoop(t,i),a.play()}catch(a){console.error(a)}}stopAnimation(){this.currentAnimationAction=null,this.mixer.stopAllAction()}updateAnimation(e){this.mixer.update(e),this.queueShadowRender()}subscribeMixerEvent(e,t){this.mixer.addEventListener(e,t)}updateShadow(){const e=this.shadow;if(e!=null){const t=this.element.arPlacement==="wall"?"back":"bottom";e.setScene(this,this.shadowSoftness,t),e.needsUpdate=!0}}renderShadow(e){const t=this.shadow;t!=null&&t.needsUpdate==!0&&(t.render(e,this),t.needsUpdate=!1)}queueShadowRender(){this.shadow!=null&&(this.shadow.needsUpdate=!0)}setShadowIntensity(e){if(this.shadowIntensity=e,this._currentGLTF!=null&&(this.setBakedShadowVisibility(),!(e<=0&&this.shadow==null))){if(this.shadow==null){const t=this.element.arPlacement==="wall"?"back":"bottom";this.shadow=new Uie(this,this.shadowSoftness,t)}this.shadow.setIntensity(e)}}setShadowSoftness(e){this.shadowSoftness=e;const t=this.shadow;t?.setSoftness(e)}setShadowOffset(e){const t=this.shadow;t?.setOffset(e)}getHit(e=this){return hE.intersectObject(e,!0).find(i=>i.object.visible&&!i.object.userData.noHit)}hitFromController(e,t=this){return hE.setFromXRController(e),this.getHit(t)}hitFromPoint(e,t=this){return hE.setFromCamera(e,this.getCamera()),this.getHit(t)}positionAndNormalFromPoint(e,t=this){var i;const r=this.hitFromPoint(e,t);if(r==null)return null;const s=r.point,a=r.face!=null?r.face.normal.clone().applyNormalMatrix(new Rn().getNormalMatrix(r.object.matrixWorld)):hE.ray.direction.clone().multiplyScalar(-1),o=(i=r.uv)!==null&&i!==void 0?i:null;return{position:s,normal:a,uv:o}}surfaceFromPoint(e,t=this){const i=this.element.model;if(i==null)return null;const r=this.hitFromPoint(e,t);if(r==null||r.face==null)return null;const s=i[t2](r),{meshes:a,primitives:o}=s.mesh.userData.associations,c=new ee,h=new ee,p=new ee,{a:g,b:A,c:v}=r.face,x=r.object;x.getVertexPosition(g,c),x.getVertexPosition(A,h),x.getVertexPosition(v,p);const S=new ea(c,h,p),_=new ee;return S.getBarycoord(x.worldToLocal(r.point),_),`${a} ${o} ${g} ${A} ${v} ${_.x.toFixed(3)} ${_.y.toFixed(3)} ${_.z.toFixed(3)}`}addHotspot(e){this.target.add(e),this.annotationRenderer.domElement.appendChild(e.element),this.updateSurfaceHotspot(e)}removeHotspot(e){this.target.remove(e)}forHotspots(e){const{children:t}=this.target;for(let i=0,r=t.length;i<r;i++){const s=t[i];s instanceof K9&&e(s)}}updateSurfaceHotspot(e){if(e.surface==null||this.element.model==null)return;const t=lf(e.surface)[0].terms;if(t.length!=8){console.warn(e.surface+" does not have exactly 8 numbers.");return}const i=this.element.model[Y9](t[0].number,t[1].number);if(i==null){console.warn(e.surface+" does not match a node/primitive in this glTF! Skipping this hotspot.");return}const r=i.mesh.geometry.attributes.position.count,s=new ee(t[2].number,t[3].number,t[4].number);if(s.x>=r||s.y>=r||s.z>=r){console.warn(e.surface+" vertex indices out of range in this glTF! Skipping this hotspot.");return}const a=new ee(t[5].number,t[6].number,t[7].number);e.mesh=i.mesh,e.tri=s,e.bary=a,e.updateSurface()}animateSurfaceHotspots(){this.element.paused||this.forHotspots(e=>{e.updateSurface()})}updateHotspotsVisibility(e){this.forHotspots(t=>{hI.copy(e),JF.setFromMatrixPosition(t.matrixWorld),hI.sub(JF),ZF.copy(t.normal).transformDirection(this.target.matrixWorld),hI.dot(ZF)<0?t.hide():t.show()})}orientHotspots(e){this.forHotspots(t=>{t.orient(e)})}setHotspotsVisibility(e){this.forHotspots(t=>{t.visible=e})}updateSchema(e){var t;const{schemaElement:i,element:r}=this,{alt:s,poster:a,iosSrc:o}=r;if(e!=null){const c=[{"@type":"MediaObject",contentUrl:e,encodingFormat:((t=e.split(".").pop())===null||t===void 0?void 0:t.toLowerCase())==="gltf"?"model/gltf+json":"model/gltf-binary"}];o&&c.push({"@type":"MediaObject",contentUrl:o,encodingFormat:"model/vnd.usdz+zip"});const h={"@context":"http://schema.org/","@type":"3DModel",image:a??void 0,name:s??void 0,encoding:c};i.textContent=JSON.stringify(h),document.head.appendChild(i)}else i.parentElement!=null&&i.parentElement.removeChild(i)}}class Oie extends EventTarget{constructor(){super(...arguments),this.ongoingActivities=new Set,this.totalProgress=0}get ongoingActivityCount(){return this.ongoingActivities.size}beginActivity(e){const t={progress:0,completed:!1};return this.ongoingActivities.add(t),this.ongoingActivityCount===1&&this.announceTotalProgress(t,0,e),i=>{let r;return r=Math.max(Vu(i,0,1),t.progress),r!==t.progress&&this.announceTotalProgress(t,r,e),t.progress}}announceTotalProgress(e,t,i){let r=0,s=0;t==1&&(e.completed=!0);for(const c of this.ongoingActivities){const{progress:h}=c;r+=1-h,c.completed&&s++}const a=e.progress;e.progress=t,this.totalProgress+=(t-a)*(1-this.totalProgress)/r;const o=s===this.ongoingActivityCount?1:this.totalProgress;this.dispatchEvent(new CustomEvent("progress",{detail:{totalProgress:o,reason:i}})),s===this.ongoingActivityCount&&(this.totalProgress=0,this.ongoingActivities.clear())}}var iC=function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(s=(r<3?a(s):r>3?a(e,t,s):a(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},eP,tP,nP,iP,rP,sP,aP,oP,lP,cP,uP,hP,fP;const kie=10,zie=50,Gie=0,Hie=300,Qie=150,Ld=document.createElement("canvas"),fI=Symbol("fallbackResizeHandler"),dP=Symbol("defaultAriaLabel"),fE=Symbol("resizeObserver"),jA=Symbol("clearModelTimeout"),dI=Symbol("onContextLost"),WA=Symbol("loaded"),pI=Symbol("status"),mI=Symbol("onFocus"),gI=Symbol("onBlur"),s0=Symbol("updateSize"),dE=Symbol("intersectionObserver"),fm=Symbol("isElementInViewport"),Hw=Symbol("announceModelVisibility"),c0=Symbol("ariaLabel"),i2=Symbol("altDefaulted"),S1=Symbol("statusElement"),Qw=Symbol("updateStatus"),q1=Symbol("loadedTime"),g0=Symbol("updateSource"),pP=Symbol("markLoaded"),ZE=Symbol("container"),zc=Symbol("input"),r2=Symbol("canvas"),Rt=Symbol("scene"),ta=Symbol("needsRender"),eh=Symbol("tick"),th=Symbol("onModelLoad"),Vw=Symbol("onResize"),zi=Symbol("renderer"),Km=Symbol("progressTracker"),mP=Symbol("getLoaded"),$m=Symbol("getModelIsVisible"),k0=Symbol("shouldAttemptPreload"),Id=n=>({x:n.x,y:n.y,z:n.z,toString(){return`${this.x}m ${this.y}m ${this.z}m`}}),s2=n=>({u:n.x,v:n.y,toString(){return`${this.u} ${this.v}`}});class lx extends dm{static get is(){return"model-viewer"}static set modelCacheSize(e){ro[Sd].evictionThreshold=e}static get modelCacheSize(){return ro[Sd].evictionThreshold}static set minimumRenderScale(e){e>1&&console.warn("<model-viewer> minimumRenderScale has been clamped to a maximum value of 1."),e<=0&&console.warn("<model-viewer> minimumRenderScale has been clamped to a minimum value of 0.25."),Qc.singleton.minScale=e}static get minimumRenderScale(){return Qc.singleton.minScale}get loaded(){return this[mP]()}get[(eP=fm,tP=WA,nP=q1,iP=pI,rP=jA,sP=fI,aP=Hw,oP=fE,lP=dE,cP=Km,zi)](){return Qc.singleton}get modelIsVisible(){return this[$m]()}constructor(){super(),this.alt=null,this.src=null,this.withCredentials=!1,this.generateSchema=!1,this[eP]=!1,this[tP]=!1,this[nP]=0,this[iP]="",this[rP]=null,this[sP]=$N(()=>{const r=this.getBoundingClientRect();this[s0](r)},zie),this[aP]=$N(r=>{const s=this.modelIsVisible;s!==r&&this.dispatchEvent(new CustomEvent("model-visibility",{detail:{visible:s}}))},Gie),this[oP]=null,this[lP]=null,this[cP]=new Oie,this[uP]=()=>{this[S1].textContent=this[pI]},this[hP]=()=>{this[S1].textContent=""},this[fP]=r=>{this.dispatchEvent(new CustomEvent("error",{detail:{type:"webglcontextlost",sourceError:r.sourceEvent}}))},this.attachShadow({mode:"open"});const e=this.shadowRoot;yee(e),this[ZE]=e.querySelector(".container"),this[zc]=e.querySelector(".userInput"),this[r2]=e.querySelector("canvas"),this[S1]=e.querySelector("#status"),this[dP]=this[zc].getAttribute("aria-label");let t,i;if(this.isConnected){const r=this.getBoundingClientRect();t=r.width,i=r.height}else t=Hie,i=Qie;this[Rt]=new Pie({canvas:this[r2],element:this,width:t,height:i}),Promise.resolve().then(()=>{this[s0](this.getBoundingClientRect())}),yT&&(this[fE]=new ResizeObserver(r=>{if(!this[zi].isPresenting)for(let s of r)s.target===this&&this[s0](s.contentRect)})),bT?this[dE]=new IntersectionObserver(r=>{for(let s of r)if(s.target===this){const a=this.modelIsVisible;this[fm]=s.isIntersecting,this[Hw](a),this[fm]&&!this.loaded&&this[g0]()}},{root:null,rootMargin:"0px",threshold:1e-5}):this[fm]=!0}connectedCallback(){super.connectedCallback&&super.connectedCallback(),yT?this[fE].observe(this):self.addEventListener("resize",this[fI]),bT&&this[dE].observe(this),this.addEventListener("focus",this[mI]),this.addEventListener("blur",this[gI]);const e=this[zi];e.addEventListener("contextlost",this[dI]),e.registerScene(this[Rt]),this[jA]!=null&&(self.clearTimeout(this[jA]),this[jA]=null,this.requestUpdate("src",null))}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback(),yT?this[fE].unobserve(this):self.removeEventListener("resize",this[fI]),bT&&this[dE].unobserve(this),this.removeEventListener("focus",this[mI]),this.removeEventListener("blur",this[gI]);const e=this[zi];e.removeEventListener("contextlost",this[dI]),e.unregisterScene(this[Rt]),this[jA]=self.setTimeout(()=>{this[Rt].dispose(),this[jA]=null},kie)}updated(e){super.updated(e),e.has("src")&&(this.src==null?(this[WA]=!1,this[q1]=0,this[Rt].reset()):this.src!==this[Rt].url&&(this[WA]=!1,this[q1]=0,this[g0]())),e.has("alt")&&this[zc].setAttribute("aria-label",this[c0]),e.has("generateSchema")&&(this.generateSchema?this[Rt].updateSchema(this.src):this[Rt].updateSchema(null))}toDataURL(e,t){return this[zi].displayCanvas(this[Rt]).toDataURL(e,t)}async toBlob(e){const t=e?e.mimeType:void 0,i=e?e.qualityArgument:void 0,r=e?e.idealAspect:void 0,{width:s,height:a,idealAspect:o,aspect:c}=this[Rt],{dpr:h,scaleFactor:p}=this[zi];let g=s*p*h,A=a*p*h,v=0,x=0;if(r===!0)if(o>c){const S=A;A=Math.round(g/o),x=(S-A)/2}else{const S=g;g=Math.round(A*o),v=(S-g)/2}Ld.width=g,Ld.height=A;try{return new Promise(async(S,_)=>{Ld.getContext("2d").drawImage(this[zi].displayCanvas(this[Rt]),v,x,g,A,0,0,g,A),Ld.toBlob(E=>{if(!E)return _(new Error("Unable to retrieve canvas blob"));S(E)},t,i)})}finally{this[s0]({width:s,height:a})}}registerEffectComposer(e){e.setRenderer(this[zi].threeRenderer),e.setMainCamera(this[Rt].getCamera()),e.setMainScene(this[Rt]),this[Rt].effectRenderer=e}unregisterEffectComposer(){this[Rt].effectRenderer=null}registerRenderer(e){this[Rt].externalRenderer=e}unregisterRenderer(){this[Rt].externalRenderer=null}get[c0](){return this[i2]}get[i2](){return this.alt==null||this.alt==="null"?this[dP]:this.alt}[mP](){return this[WA]}[$m](){return this.loaded&&this[fm]}[k0](){return!!this.src&&this[fm]}[s0]({width:e,height:t}){e===0||t===0||(this[ZE].style.width=`${e}px`,this[ZE].style.height=`${t}px`,this[Vw]({width:e,height:t}))}[eh](e,t){var i;(i=this[Rt].effectRenderer)===null||i===void 0||i.beforeRender(e,t)}[pP](){this[WA]||(this[WA]=!0,this[q1]=performance.now())}[ta](){this[Rt].queueRender()}[th](){}[Qw](e){this[pI]=e;const t=this.getRootNode();t!=null&&t.activeElement===this&&this[S1].textContent!=e&&(this[S1].textContent=e)}[(uP=mI,hP=gI,Vw)](e){this[Rt].setSize(e.width,e.height)}async[(fP=dI,g0)](){const e=this[Rt];if(this.loaded||!this[k0]()||this.src===e.url)return;this.generateSchema&&e.updateSchema(this.src),this[Qw]("Loading"),e.stopAnimation();const t=this[Km].beginActivity("model-load"),i=this.src;try{const r=e.setSource(i,a=>t(Vu(a,0,1)*.95)),s=this[Ow]();await Promise.all([r,s]),this[pP](),this[th](),this.updateComplete.then(()=>{this.dispatchEvent(new CustomEvent("before-render"))}),await new Promise(a=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.dispatchEvent(new CustomEvent("load",{detail:{url:i}})),a()})})})}catch(r){this.dispatchEvent(new CustomEvent("error",{detail:{type:"loadfailure",sourceError:r}}))}finally{t(1)}}}iC([wn({type:String})],lx.prototype,"alt",void 0);iC([wn({type:String})],lx.prototype,"src",void 0);iC([wn({type:Boolean,attribute:"with-credentials"})],lx.prototype,"withCredentials",void 0);iC([wn({type:Boolean,attribute:"generate-schema"})],lx.prototype,"generateSchema",void 0);var AI=function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(s=(r<3?a(s):r>3?a(e,t,s):a(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};const gP=1e3,pE=Symbol("changeAnimation"),AP=Symbol("appendAnimation"),vP=Symbol("detachAnimation"),Zo=Symbol("paused"),Vie={repetitions:1/0,pingpong:!1},jie={pingpong:!1,repetitions:null,weight:1,timeScale:1,fade:!1,warp:!1,relativeWarp:!0,time:null},Wie={fade:!0},qie=n=>{var e;class t extends n{constructor(...r){super(r),this.autoplay=!1,this.animationName=void 0,this.animationCrossfadeDuration=300,this[e]=!0,this[Rt].subscribeMixerEvent("loop",s=>{const a=s.action._loopCount,o=s.action._clip.name,c=s.action._clip.uuid,h=this[Rt].markedAnimations.find(p=>p.name===o);if(h){this[Rt].updateAnimationLoop(h.name,h.loopMode,h.repetitionCount);const p=this[Rt].markedAnimations.filter(g=>g.name!==o);this[Rt].markedAnimations=p}this.dispatchEvent(new CustomEvent("loop",{detail:{count:a,name:o,uuid:c}}))}),this[Rt].subscribeMixerEvent("finished",s=>{if(!this[Rt].appendedAnimations.includes(s.action._clip.name))this[Zo]=!0;else{const a=this[Rt].appendedAnimations.filter(o=>o!==s.action._clip.name);this[Rt].appendedAnimations=a}this.dispatchEvent(new CustomEvent("finished"))})}get availableAnimations(){return this.loaded?this[Rt].animationNames:[]}get duration(){return this[Rt].duration}get paused(){return this[Zo]}get currentTime(){return this[Rt].animationTime}get appendedAnimations(){return this[Rt].appendedAnimations}set currentTime(r){this[Rt].animationTime=r,this[ta]()}get timeScale(){return this[Rt].animationTimeScale}set timeScale(r){this[Rt].animationTimeScale=r}pause(){this[Zo]||(this[Zo]=!0,this.dispatchEvent(new CustomEvent("pause")))}play(r){this.availableAnimations.length>0&&(this[Zo]=!1,this[pE](r),this.dispatchEvent(new CustomEvent("play")))}appendAnimation(r,s){this.availableAnimations.length>0&&(this[Zo]=!1,this[AP](r,s),this.dispatchEvent(new CustomEvent("append-animation")))}detachAnimation(r,s){this.availableAnimations.length>0&&(this[Zo]=!1,this[vP](r,s),this.dispatchEvent(new CustomEvent("detach-animation")))}[(e=Zo,th)](){super[th](),this[Zo]=!0,this.animationName!=null&&this[pE](),this.autoplay&&this.play()}[eh](r,s){super[eh](r,s),!(this[Zo]||!this[$m]()&&!this[zi].isPresenting)&&(this[Rt].updateAnimation(s/gP),this[ta]())}updated(r){super.updated(r),r.has("autoplay")&&this.autoplay&&this.play(),r.has("animationName")&&this[pE]()}[pE](r=Vie){var s;const a=(s=r.repetitions)!==null&&s!==void 0?s:1/0,o=r.pingpong?Eb:a===1?T0:Tm;this[Rt].playAnimation(this.animationName,this.animationCrossfadeDuration/gP,o,a),this[Zo]&&(this[Rt].updateAnimation(0),this[ta]())}[AP](r="",s=jie){var a;const o=(a=s.repetitions)!==null&&a!==void 0?a:1/0,c=s.pingpong?Eb:o===1?T0:Tm,h=!!s.repetitions||"pingpong"in s;this[Rt].appendAnimation(r||this.animationName,c,o,s.weight,s.timeScale,s.fade,s.warp,s.relativeWarp,s.time,h),this[Zo]&&(this[Rt].updateAnimation(0),this[ta]())}[vP](r="",s=Wie){this[Rt].detachAnimation(r||this.animationName,s.fade),this[Zo]&&(this[Rt].updateAnimation(0),this[ta]())}}return AI([wn({type:Boolean})],t.prototype,"autoplay",void 0),AI([wn({type:String,attribute:"animation-name"})],t.prototype,"animationName",void 0),AI([wn({type:Number,attribute:"animation-crossfade-duration"})],t.prototype,"animationCrossfadeDuration",void 0),t};const im=Symbol("hotspotMap"),vI=Symbol("mutationCallback"),E1=Symbol("observer"),yI=Symbol("addHotspot"),yP=Symbol("removeHotspot"),bI=new qt,Xie=n=>{var e,t,i;class r extends n{constructor(){super(...arguments),this[e]=new Map,this[t]=a=>{a.forEach(o=>{(!(o instanceof MutationRecord)||o.type==="childList")&&(o.addedNodes.forEach(c=>{this[yI](c)}),o.removedNodes.forEach(c=>{this[yP](c)}),this[ta]())})},this[i]=new MutationObserver(this[vI])}connectedCallback(){super.connectedCallback();for(let o=0;o<this.children.length;++o)this[yI](this.children[o]);const{ShadyDOM:a}=self;a==null?this[E1].observe(this,{childList:!0}):this[E1]=a.observeChildren(this,this[vI])}disconnectedCallback(){super.disconnectedCallback();const{ShadyDOM:a}=self;a==null?this[E1].disconnect():a.unobserveChildren(this[E1])}[(e=im,t=vI,i=E1,th)](){super[th]();const a=this[Rt];a.forHotspots(o=>{a.updateSurfaceHotspot(o)})}[eh](a,o){super[eh](a,o);const c=this[Rt],{annotationRenderer:h}=c,p=c.getCamera();c.shouldRender()&&(c.animateSurfaceHotspots(),c.updateHotspotsVisibility(p.position),h.domElement.style.display="",h.render(c,p))}updateHotspot(a){const o=this[im].get(a.name);o!=null&&(o.updatePosition(a.position),o.updateNormal(a.normal),o.surface=a.surface,this[Rt].updateSurfaceHotspot(o),this[ta]())}queryHotspot(a){const o=this[im].get(a);if(o==null)return null;const c=Id(o.position),h=Id(o.normal),p=o.facingCamera,g=this[Rt],A=g.getCamera(),v=new ee;v.setFromMatrixPosition(o.matrixWorld),v.project(A);const x=g.width/2,S=g.height/2;v.x=v.x*x+x,v.y=-(v.y*S)+S;const _=Id(new ee(v.x,v.y,v.z));return!Number.isFinite(_.x)||!Number.isFinite(_.y)?null:{position:c,normal:h,canvasPosition:_,facingCamera:p}}positionAndNormalFromPoint(a,o){const c=this[Rt],h=c.getNDC(a,o),p=c.positionAndNormalFromPoint(h);if(p==null)return null;bI.copy(c.target.matrixWorld).invert();const g=Id(p.position.applyMatrix4(bI)),A=Id(p.normal.transformDirection(bI));let v=null;return p.uv!=null&&(v=s2(p.uv)),{position:g,normal:A,uv:v}}surfaceFromPoint(a,o){const c=this[Rt],h=c.getNDC(a,o);return c.surfaceFromPoint(h)}[yI](a){if(!(a instanceof HTMLElement&&a.slot.indexOf("hotspot")===0))return;let o=this[im].get(a.slot);o!=null?o.increment():(o=new K9({name:a.slot,position:a.dataset.position,normal:a.dataset.normal,surface:a.dataset.surface}),this[im].set(a.slot,o),this[Rt].addHotspot(o)),this[Rt].queueRender()}[yP](a){if(!(a instanceof HTMLElement))return;const o=this[im].get(a.slot);o&&(o.decrement()&&(this[Rt].removeHotspot(o),this[im].delete(a.slot)),this[Rt].queueRender())}}return r};var ka=Uint8Array,al=Uint16Array,H4=Int32Array,Q4=new ka([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),V4=new ka([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),bP=new ka([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$9=function(n,e){for(var t=new al(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];for(var r=new H4(t[30]),i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)r[s]=s-t[i]<<5|i;return{b:t,r}},J9=$9(Q4,2),Yie=J9.b,a2=J9.r;Yie[28]=258,a2[258]=28;var Kie=$9(V4,0),xP=Kie.r,o2=new al(32768);for(var Ar=0;Ar<32768;++Ar){var vd=(Ar&43690)>>1|(Ar&21845)<<1;vd=(vd&52428)>>2|(vd&13107)<<2,vd=(vd&61680)>>4|(vd&3855)<<4,o2[Ar]=((vd&65280)>>8|(vd&255)<<8)>>1}var ib=(function(n,e,t){for(var i=n.length,r=0,s=new al(e);r<i;++r)n[r]&&++s[n[r]-1];var a=new al(e);for(r=1;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;var o;if(t){o=new al(1<<e);var c=15-e;for(r=0;r<i;++r)if(n[r])for(var h=r<<4|n[r],p=e-n[r],g=a[n[r]-1]++<<p,A=g|(1<<p)-1;g<=A;++g)o[o2[g]>>c]=h}else for(o=new al(i),r=0;r<i;++r)n[r]&&(o[r]=o2[a[n[r]-1]++]>>15-n[r]);return o}),Jm=new ka(288);for(var Ar=0;Ar<144;++Ar)Jm[Ar]=8;for(var Ar=144;Ar<256;++Ar)Jm[Ar]=9;for(var Ar=256;Ar<280;++Ar)Jm[Ar]=7;for(var Ar=280;Ar<288;++Ar)Jm[Ar]=8;var jw=new ka(32);for(var Ar=0;Ar<32;++Ar)jw[Ar]=5;var $ie=ib(Jm,9,0),Jie=ib(jw,5,0),Z9=function(n){return(n+7)/8|0},ez=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new ka(n.subarray(e,t))},Zie=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],rC=function(n,e,t){var i=new Error(e||Zie[n]);if(i.code=n,Error.captureStackTrace&&Error.captureStackTrace(i,rC),!t)throw i;return i},Zh=function(n,e,t){t<<=e&7;var i=e/8|0;n[i]|=t,n[i+1]|=t>>8},w1=function(n,e,t){t<<=e&7;var i=e/8|0;n[i]|=t,n[i+1]|=t>>8,n[i+2]|=t>>16},xI=function(n,e){for(var t=[],i=0;i<n.length;++i)n[i]&&t.push({s:i,f:n[i]});var r=t.length,s=t.slice();if(!r)return{t:nz,l:0};if(r==1){var a=new ka(t[0].s+1);return a[t[0].s]=1,{t:a,l:1}}t.sort(function(B,U){return B.f-U.f}),t.push({s:-1,f:25001});var o=t[0],c=t[1],h=0,p=1,g=2;for(t[0]={s:-1,f:o.f+c.f,l:o,r:c};p!=r-1;)o=t[t[h].f<t[g].f?h++:g++],c=t[h!=p&&t[h].f<t[g].f?h++:g++],t[p++]={s:-1,f:o.f+c.f,l:o,r:c};for(var A=s[0].s,i=1;i<r;++i)s[i].s>A&&(A=s[i].s);var v=new al(A+1),x=l2(t[p-1],v,0);if(x>e){var i=0,S=0,_=x-e,E=1<<_;for(s.sort(function(U,O){return v[O.s]-v[U.s]||U.f-O.f});i<r;++i){var C=s[i].s;if(v[C]>e)S+=E-(1<<x-v[C]),v[C]=e;else break}for(S>>=_;S>0;){var T=s[i].s;v[T]<e?S-=1<<e-v[T]++-1:++i}for(;i>=0&&S;--i){var R=s[i].s;v[R]==e&&(--v[R],++S)}x=e}return{t:new ka(v),l:x}},l2=function(n,e,t){return n.s==-1?Math.max(l2(n.l,e,t+1),l2(n.r,e,t+1)):e[n.s]=t},_P=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new al(++e),i=0,r=n[0],s=1,a=function(c){t[i++]=c},o=1;o<=e;++o)if(n[o]==r&&o!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(r),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(r);s=1,r=n[o]}return{c:t.subarray(0,i),n:e}},M1=function(n,e){for(var t=0,i=0;i<e.length;++i)t+=n[i]*e[i];return t},tz=function(n,e,t){var i=t.length,r=Z9(e+2);n[r]=i&255,n[r+1]=i>>8,n[r+2]=n[r]^255,n[r+3]=n[r+1]^255;for(var s=0;s<i;++s)n[r+s+4]=t[s];return(r+4+i)*8},SP=function(n,e,t,i,r,s,a,o,c,h,p){Zh(e,p++,t),++r[256];for(var g=xI(r,15),A=g.t,v=g.l,x=xI(s,15),S=x.t,_=x.l,E=_P(A),C=E.c,T=E.n,R=_P(S),B=R.c,U=R.n,O=new al(19),F=0;F<C.length;++F)++O[C[F]&31];for(var F=0;F<B.length;++F)++O[B[F]&31];for(var L=xI(O,7),P=L.t,W=L.l,j=19;j>4&&!P[bP[j-1]];--j);var V=h+5<<3,q=M1(r,Jm)+M1(s,jw)+a,re=M1(r,A)+M1(s,S)+a+14+3*j+M1(O,P)+2*O[16]+3*O[17]+7*O[18];if(c>=0&&V<=q&&V<=re)return tz(e,p,n.subarray(c,c+h));var Q,K,ce,ue;if(Zh(e,p,1+(re<q)),p+=2,re<q){Q=ib(A,v,0),K=A,ce=ib(S,_,0),ue=S;var oe=ib(P,W,0);Zh(e,p,T-257),Zh(e,p+5,U-1),Zh(e,p+10,j-4),p+=14;for(var F=0;F<j;++F)Zh(e,p+3*F,P[bP[F]]);p+=3*j;for(var z=[C,B],$=0;$<2;++$)for(var ae=z[$],F=0;F<ae.length;++F){var he=ae[F]&31;Zh(e,p,oe[he]),p+=P[he],he>15&&(Zh(e,p,ae[F]>>5&127),p+=ae[F]>>12)}}else Q=$ie,K=Jm,ce=Jie,ue=jw;for(var F=0;F<o;++F){var me=i[F];if(me>255){var he=me>>18&31;w1(e,p,Q[he+257]),p+=K[he+257],he>7&&(Zh(e,p,me>>23&31),p+=Q4[he]);var le=me&31;w1(e,p,ce[le]),p+=ue[le],le>3&&(w1(e,p,me>>5&8191),p+=V4[le])}else w1(e,p,Q[me]),p+=K[me]}return w1(e,p,Q[256]),p+K[256]},ere=new H4([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),nz=new ka(0),tre=function(n,e,t,i,r,s){var a=s.z||n.length,o=new ka(i+a+5*(1+Math.ceil(a/7e3))+r),c=o.subarray(i,o.length-r),h=s.l,p=(s.r||0)&7;if(e){p&&(c[0]=s.r>>3);for(var g=ere[e-1],A=g>>13,v=g&8191,x=(1<<t)-1,S=s.p||new al(32768),_=s.h||new al(x+1),E=Math.ceil(t/3),C=2*E,T=function(Be){return(n[Be]^n[Be+1]<<E^n[Be+2]<<C)&x},R=new H4(25e3),B=new al(288),U=new al(32),O=0,F=0,L=s.i||0,P=0,W=s.w||0,j=0;L+2<a;++L){var V=T(L),q=L&32767,re=_[V];if(S[q]=re,_[V]=q,W<=L){var Q=a-L;if((O>7e3||P>24576)&&(Q>423||!h)){p=SP(n,c,0,R,B,U,F,P,j,L-j,p),P=O=F=0,j=L;for(var K=0;K<286;++K)B[K]=0;for(var K=0;K<30;++K)U[K]=0}var ce=2,ue=0,oe=v,z=q-re&32767;if(Q>2&&V==T(L-z))for(var $=Math.min(A,Q)-1,ae=Math.min(32767,L),he=Math.min(258,Q);z<=ae&&--oe&&q!=re;){if(n[L+ce]==n[L+ce-z]){for(var me=0;me<he&&n[L+me]==n[L+me-z];++me);if(me>ce){if(ce=me,ue=z,me>$)break;for(var le=Math.min(z,me-2),fe=0,K=0;K<le;++K){var _e=L-z+K&32767,Pe=S[_e],et=_e-Pe&32767;et>fe&&(fe=et,re=_e)}}}q=re,re=S[q],z+=q-re&32767}if(ue){R[P++]=268435456|a2[ce]<<18|xP[ue];var ot=a2[ce]&31,Je=xP[ue]&31;F+=Q4[ot]+V4[Je],++B[257+ot],++U[Je],W=L+ce,++O}else R[P++]=n[L],++B[n[L]]}}for(L=Math.max(L,W);L<a;++L)R[P++]=n[L],++B[n[L]];p=SP(n,c,h,R,B,U,F,P,j,L-j,p),h||(s.r=p&7|c[p/8|0]<<3,p-=7,s.h=_,s.p=S,s.i=L,s.w=W)}else{for(var L=s.w||0;L<a+h;L+=65535){var _t=L+65535;_t>=a&&(c[p/8|0]=h,_t=a),p=tz(c,p+1,n.subarray(L,_t))}s.i=a}return ez(o,0,i+Z9(p)+r)},nre=(function(){for(var n=new Int32Array(256),e=0;e<256;++e){for(var t=e,i=9;--i;)t=(t&1&&-306674912)^t>>>1;n[e]=t}return n})(),ire=function(){var n=-1;return{p:function(e){for(var t=n,i=0;i<e.length;++i)t=nre[t&255^e[i]]^t>>>8;n=t},d:function(){return~n}}},rre=function(n,e,t,i,r){if(!r&&(r={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),a=new ka(s.length+n.length);a.set(s),a.set(n,s.length),n=a,r.w=s.length}return tre(n,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,i,r)},iz=function(n,e){var t={};for(var i in n)t[i]=n[i];for(var i in e)t[i]=e[i];return t},Aa=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8};function sre(n,e){return rre(n,e||{},0,0)}var rz=function(n,e,t,i){for(var r in n){var s=n[r],a=e+r,o=i;Array.isArray(s)&&(o=iz(i,s[1]),s=s[0]),s instanceof ka?t[a]=[s,o]:(t[a+="/"]=[new ka(0),o],rz(s,a,t,i))}},EP=typeof TextEncoder<"u"&&new TextEncoder,are=typeof TextDecoder<"u"&&new TextDecoder,ore=0;try{are.decode(nz,{stream:!0}),ore=1}catch{}function Ww(n,e){var t;if(EP)return EP.encode(n);for(var i=n.length,r=new ka(n.length+(n.length>>1)),s=0,a=function(h){r[s++]=h},t=0;t<i;++t){if(s+5>r.length){var o=new ka(s+8+(i-t<<1));o.set(r),r=o}var c=n.charCodeAt(t);c<128||e?a(c):c<2048?(a(192|c>>6),a(128|c&63)):c>55295&&c<57344?(c=65536+(c&1047552)|n.charCodeAt(++t)&1023,a(240|c>>18),a(128|c>>12&63),a(128|c>>6&63),a(128|c&63)):(a(224|c>>12),a(128|c>>6&63),a(128|c&63))}return ez(r,0,s)}var c2=function(n){var e=0;if(n)for(var t in n){var i=n[t].length;i>65535&&rC(9),e+=i+4}return e},wP=function(n,e,t,i,r,s,a,o){var c=i.length,h=t.extra,p=o&&o.length,g=c2(h);Aa(n,e,a!=null?33639248:67324752),e+=4,a!=null&&(n[e++]=20,n[e++]=t.os),n[e]=20,e+=2,n[e++]=t.flag<<1|(s<0&&8),n[e++]=r&&8,n[e++]=t.compression&255,n[e++]=t.compression>>8;var A=new Date(t.mtime==null?Date.now():t.mtime),v=A.getFullYear()-1980;if((v<0||v>119)&&rC(10),Aa(n,e,v<<25|A.getMonth()+1<<21|A.getDate()<<16|A.getHours()<<11|A.getMinutes()<<5|A.getSeconds()>>1),e+=4,s!=-1&&(Aa(n,e,t.crc),Aa(n,e+4,s<0?-s-2:s),Aa(n,e+8,t.size)),Aa(n,e+12,c),Aa(n,e+14,g),e+=16,a!=null&&(Aa(n,e,p),Aa(n,e+6,t.attrs),Aa(n,e+10,a),e+=14),n.set(i,e),e+=c,g)for(var x in h){var S=h[x],_=S.length;Aa(n,e,+x),Aa(n,e+2,_),n.set(S,e+4),e+=4+_}return p&&(n.set(o,e),e+=p),e},lre=function(n,e,t,i,r){Aa(n,e,101010256),Aa(n,e+8,t),Aa(n,e+10,t),Aa(n,e+12,i),Aa(n,e+16,r)};function cre(n,e){e||(e={});var t={},i=[];rz(n,"",t,e);var r=0,s=0;for(var a in t){var o=t[a],c=o[0],h=o[1],p=h.level==0?0:8,g=Ww(a),A=g.length,v=h.comment,x=v&&Ww(v),S=x&&x.length,_=c2(h.extra);A>65535&&rC(11);var E=p?sre(c,h):c,C=E.length,T=ire();T.p(c),i.push(iz(h,{size:c.length,crc:T.d(),c:E,f:g,m:x,u:A!=a.length||x&&v.length!=S,o:r,compression:p})),r+=30+A+_+C,s+=76+2*(A+_)+(S||0)+C}for(var R=new ka(s+22),B=r,U=s-r,O=0;O<i.length;++O){var g=i[O];wP(R,g.o,g,g.f,g.u,g.c.length);var F=30+g.f.length+c2(g.extra);R.set(g.c,g.o+F),wP(R,r,g,g.f,g.u,g.c.length,g.o,g.m),r+=16+F+(g.m?g.m.length:0)}return lre(R,r,i.length,U,B),R}class il{constructor(e,t="",i=[],r=[]){this.name=e,this.type=t,this.metadata=i,this.properties=r,this.children=[]}addMetadata(e,t){this.metadata.push({key:e,value:t})}addProperty(e,t=[]){this.properties.push({property:e,metadata:t})}addChild(e){this.children.push(e)}toString(e=0){const t="	".repeat(e),i=this.metadata.map(p=>{const g=p.key,A=p.value;if(Array.isArray(A)){const v=[];return v.push(`${g} = {`),A.forEach(x=>{v.push(`${t}		${x}`)}),v.push(`${t}	}`),v.join(`
`)}else return`${g} = ${A}`}),r=i.length?` (
${i.map(p=>`${t}	${p}`).join(`
`)}
${t})`:"",s=this.properties.map(p=>{const g=p.property,A=p.metadata.length?` (
${p.metadata.map(v=>`${t}		${v}`).join(`
`)}
${t}	)`:"";return`${t}	${g}${A}`}),a=this.children.map(p=>p.toString(e+1)),o=[];if(s.length>0&&o.push(...s),a.length>0){s.length>0&&o.push("");for(let p=0;p<a.length;p++)o.push(a[p]),p<a.length-1&&o.push("")}const c=o.join(`
`),h=this.type?this.type+" ":"";return`${t}def ${h}"${this.name}"${r}
${t}{
${c}
${t}}`}}class ure{constructor(){this.textureUtils=null}setTextureUtils(e){this.textureUtils=e}parse(e,t,i,r){this.parseAsync(e,r).then(t).catch(i)}async parseAsync(e,t={}){t=Object.assign({ar:{anchoring:{type:"plane"},planeAnchoring:{alignment:"horizontal"}},includeAnchoringProperties:!0,onlyVisible:!0,quickLookCompatible:!1,maxTextureSize:1024},t);const i=new Set,r={},s="model.usda";r[s]=null;const a=new il("Root","Xform"),o=new il("Scenes","Scope");o.addMetadata("kind",'"sceneLibrary"'),a.addChild(o);const c="Scene",h=new il(c,"Xform");h.addMetadata("customData",["bool preliminary_collidesWithEnvironment = 0",`string sceneName = "${c}"`]),h.addMetadata("sceneName",`"${c}"`),t.includeAnchoringProperties&&(h.addProperty(`token preliminary:anchoring:type = "${t.ar.anchoring.type}"`),h.addProperty(`token preliminary:planeAnchoring:alignment = "${t.ar.planeAnchoring.alignment}"`)),o.addChild(h);let p;const g={},A={};oz(e,h,g,i,r,t);const v=vre(g,A,t.quickLookCompatible);p=az()+`
`+a.toString()+`

`+v.toString(),r[s]=Ww(p),p=null;for(const S in A){let _=A[S];if(_.isCompressedTexture===!0){if(this.textureUtils===null)throw new Error("THREE.USDZExporter: setTextureUtils() must be called to process compressed textures.");_=await this.textureUtils.decompress(_)}const E=hre(_.image,_.flipY,t.maxTextureSize),C=await new Promise(T=>E.toBlob(T,"image/png",1));r[`textures/Texture_${S}.png`]=new Uint8Array(await C.arrayBuffer())}let x=0;for(const S in r){const _=r[S],E=34+S.length;x+=E;const C=x&63;if(C!==4){const T=64-C,R=new Uint8Array(T);r[S]=[_,{extra:{12345:R}}]}x=_.length}return cre(r,{level:0})}}function sz(n,e){let t=n.name;return t=t.replace(/[^A-Za-z0-9_]/g,""),/^[0-9]/.test(t)&&(t="_"+t),t===""&&(n.isCamera?t="Camera":t="Object"),e.has(t)&&(t=t+"_"+n.id),e.add(t),t}function hre(n,e,t){if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas||typeof ImageBitmap<"u"&&n instanceof ImageBitmap){const i=t/Math.max(n.width,n.height),r=document.createElement("canvas");r.width=n.width*Math.min(1,i),r.height=n.height*Math.min(1,i);const s=r.getContext("2d");return e===!0&&(s.translate(0,r.height),s.scale(1,-1)),s.drawImage(n,0,0,r.width,r.height),r}else throw new Error("THREE.USDZExporter: No valid image data found. Unable to process texture.")}const Oo=7;function az(){return`#usda 1.0
(
	customLayerData = {
		string creator = "Three.js USDZExporter"
	}
	defaultPrim = "Root"
	metersPerUnit = 1
	upAxis = "Y"
)
`}function oz(n,e,t,i,r,s){for(let a=0,o=n.children.length;a<o;a++){const c=n.children[a];if(c.visible===!1&&s.onlyVisible===!0)continue;let h;if(c.isMesh){const p=c.geometry,g=c.material;if(g.isMeshStandardMaterial){const A="geometries/Geometry_"+p.id+".usda";if(!(A in r)){const v=dre(p);r[A]=Ww(az()+`
`+v.toString())}g.uuid in t||(t[g.uuid]=g),h=fre(c,p,t[g.uuid],i)}else console.warn("THREE.USDZExporter: Unsupported material type (USDZ only supports MeshStandardMaterial)",c)}else c.isCamera?h=xre(c,i):h=lz(c,i);h&&(e.addChild(h),oz(c,h,t,i,r,s))}}function lz(n,e){const t=sz(n,e),i=cz(n.matrix);n.matrix.determinant()<0&&console.warn("THREE.USDZExporter: USDZ does not support negative scales",n);const r=new il(t,"Xform");return r.addProperty(`matrix4d xformOp:transform = ${i}`),r.addProperty('uniform token[] xformOpOrder = ["xformOp:transform"]'),r}function fre(n,e,t,i){const r=lz(n,i);return r.addMetadata("prepend references",`@./geometries/Geometry_${e.id}.usda@</Geometry>`),r.addMetadata("prepend apiSchemas",'["MaterialBindingAPI"]'),r.addProperty(`rel material:binding = </Materials/Material_${t.id}>`),r}function cz(n){const e=n.elements;return`( ${mE(e,0)}, ${mE(e,4)}, ${mE(e,8)}, ${mE(e,12)} )`}function mE(n,e){return`(${n[e+0]}, ${n[e+1]}, ${n[e+2]}, ${n[e+3]})`}function dre(n){const e=new il("Geometry"),t=pre(n);return e.addChild(t),e}function pre(n){const e="Geometry",t=n.attributes,i=t.position.count,r=new il(e,"Mesh");r.addProperty(`int[] faceVertexCounts = [${mre(n)}]`),r.addProperty(`int[] faceVertexIndices = [${gre(n)}]`),r.addProperty(`normal3f[] normals = [${_I(t.normal,i)}]`,['interpolation = "vertex"']),r.addProperty(`point3f[] points = [${_I(t.position,i)}]`);for(let a=0;a<4;a++){const o=a>0?a:"",c=t["uv"+o];c!==void 0&&r.addProperty(`texCoord2f[] primvars:st${o} = [${Are(c)}]`,['interpolation = "vertex"'])}const s=t.color;return s!==void 0&&r.addProperty(`color3f[] primvars:displayColor = [${_I(s,i)}]`,['interpolation = "vertex"']),r.addProperty('uniform token subdivisionScheme = "none"'),r}function mre(n){const e=n.index!==null?n.index.count:n.attributes.position.count;return Array(e/3).fill(3).join(", ")}function gre(n){const e=n.index,t=[];if(e!==null)for(let i=0;i<e.count;i++)t.push(e.getX(i));else{const i=n.attributes.position.count;for(let r=0;r<i;r++)t.push(r)}return t.join(", ")}function _I(n,e){if(n===void 0)return console.warn("USDZExporter: Normals missing."),Array(e).fill("(0, 0, 0)").join(", ");const t=[];for(let i=0;i<n.count;i++){const r=n.getX(i),s=n.getY(i),a=n.getZ(i);t.push(`(${r.toPrecision(Oo)}, ${s.toPrecision(Oo)}, ${a.toPrecision(Oo)})`)}return t.join(", ")}function Are(n){const e=[];for(let t=0;t<n.count;t++){const i=n.getX(t),r=n.getY(t);e.push(`(${i.toPrecision(Oo)}, ${1-r.toPrecision(Oo)})`)}return e.join(", ")}function vre(n,e,t=!1){const i=new il("Materials");for(const r in n){const s=n[r];i.addChild(yre(s,e,t))}return i}function yre(n,e,t=!1){const i=new il(`Material_${n.id}`,"Material");function r(a,o,c){const h=a.source.id+"_"+a.flipY;e[h]=a;const p=a.channel>0?"st"+a.channel:"st",g={1e3:"repeat",1001:"clamp",1002:"mirror"},A=a.repeat.clone(),v=a.offset.clone(),x=a.rotation,S=Math.sin(x),_=Math.cos(x);v.y=1-v.y-A.y,t?(v.x=v.x/A.x,v.y=v.y/A.y,v.x+=S/A.x,v.y+=_-1):(v.x+=S*A.x,v.y+=(1-_)*A.y);const E=new il(`PrimvarReader_${o}`,"Shader");E.addProperty('uniform token info:id = "UsdPrimvarReader_float2"'),E.addProperty("float2 inputs:fallback = (0.0, 0.0)"),E.addProperty(`string inputs:varname = "${p}"`),E.addProperty("float2 outputs:result");const C=new il(`Transform2d_${o}`,"Shader");C.addProperty('uniform token info:id = "UsdTransform2d"'),C.addProperty(`float2 inputs:in.connect = </Materials/Material_${n.id}/PrimvarReader_${o}.outputs:result>`),C.addProperty(`float inputs:rotation = ${(x*(180/Math.PI)).toFixed(Oo)}`),C.addProperty(`float2 inputs:scale = ${CP(A)}`),C.addProperty(`float2 inputs:translation = ${CP(v)}`),C.addProperty("float2 outputs:result");const T=new il(`Texture_${a.id}_${o}`,"Shader");return T.addProperty('uniform token info:id = "UsdUVTexture"'),T.addProperty(`asset inputs:file = @textures/Texture_${h}.png@`),T.addProperty(`float2 inputs:st.connect = </Materials/Material_${n.id}/Transform2d_${o}.outputs:result>`),c!==void 0&&T.addProperty(`float4 inputs:scale = ${bre(c)}`),o==="normal"&&(T.addProperty("float4 inputs:scale = (2, 2, 2, 1)"),T.addProperty("float4 inputs:bias = (-1, -1, -1, 0)")),T.addProperty(`token inputs:sourceColorSpace = "${a.colorSpace===nl?"raw":"sRGB"}"`),T.addProperty(`token inputs:wrapS = "${g[a.wrapS]}"`),T.addProperty(`token inputs:wrapT = "${g[a.wrapT]}"`),T.addProperty("float outputs:r"),T.addProperty("float outputs:g"),T.addProperty("float outputs:b"),T.addProperty("float3 outputs:rgb"),(n.transparent||n.alphaTest>0)&&T.addProperty("float outputs:a"),[E,C,T]}n.side===gi&&console.warn("THREE.USDZExporter: USDZ does not support double sided materials",n);const s=new il("PreviewSurface","Shader");if(s.addProperty('uniform token info:id = "UsdPreviewSurface"'),n.map!==null?(s.addProperty(`color3f inputs:diffuseColor.connect = </Materials/Material_${n.id}/Texture_${n.map.id}_diffuse.outputs:rgb>`),n.transparent?s.addProperty(`float inputs:opacity.connect = </Materials/Material_${n.id}/Texture_${n.map.id}_diffuse.outputs:a>`):n.alphaTest>0&&(s.addProperty(`float inputs:opacity.connect = </Materials/Material_${n.id}/Texture_${n.map.id}_diffuse.outputs:a>`),s.addProperty(`float inputs:opacityThreshold = ${n.alphaTest}`)),r(n.map,"diffuse",n.color).forEach(o=>i.addChild(o))):s.addProperty(`color3f inputs:diffuseColor = ${MP(n.color)}`),n.emissiveMap!==null){s.addProperty(`color3f inputs:emissiveColor.connect = </Materials/Material_${n.id}/Texture_${n.emissiveMap.id}_emissive.outputs:rgb>`);const a=new Mt(n.emissive.r*n.emissiveIntensity,n.emissive.g*n.emissiveIntensity,n.emissive.b*n.emissiveIntensity);r(n.emissiveMap,"emissive",a).forEach(c=>i.addChild(c))}else n.emissive.getHex()>0&&s.addProperty(`color3f inputs:emissiveColor = ${MP(n.emissive)}`);if(n.normalMap!==null&&(s.addProperty(`normal3f inputs:normal.connect = </Materials/Material_${n.id}/Texture_${n.normalMap.id}_normal.outputs:rgb>`),r(n.normalMap,"normal").forEach(o=>i.addChild(o))),n.aoMap!==null){s.addProperty(`float inputs:occlusion.connect = </Materials/Material_${n.id}/Texture_${n.aoMap.id}_occlusion.outputs:r>`);const a=new Mt(n.aoMapIntensity,n.aoMapIntensity,n.aoMapIntensity);r(n.aoMap,"occlusion",a).forEach(c=>i.addChild(c))}if(n.roughnessMap!==null){s.addProperty(`float inputs:roughness.connect = </Materials/Material_${n.id}/Texture_${n.roughnessMap.id}_roughness.outputs:g>`);const a=new Mt(n.roughness,n.roughness,n.roughness);r(n.roughnessMap,"roughness",a).forEach(c=>i.addChild(c))}else s.addProperty(`float inputs:roughness = ${n.roughness}`);if(n.metalnessMap!==null){s.addProperty(`float inputs:metallic.connect = </Materials/Material_${n.id}/Texture_${n.metalnessMap.id}_metallic.outputs:b>`);const a=new Mt(n.metalness,n.metalness,n.metalness);r(n.metalnessMap,"metallic",a).forEach(c=>i.addChild(c))}else s.addProperty(`float inputs:metallic = ${n.metalness}`);if(n.alphaMap!==null?(s.addProperty(`float inputs:opacity.connect = </Materials/Material_${n.id}/Texture_${n.alphaMap.id}_opacity.outputs:r>`),s.addProperty("float inputs:opacityThreshold = 0.0001"),r(n.alphaMap,"opacity").forEach(o=>i.addChild(o))):s.addProperty(`float inputs:opacity = ${n.opacity}`),n.isMeshPhysicalMaterial){if(n.clearcoatMap!==null){s.addProperty(`float inputs:clearcoat.connect = </Materials/Material_${n.id}/Texture_${n.clearcoatMap.id}_clearcoat.outputs:r>`);const a=new Mt(n.clearcoat,n.clearcoat,n.clearcoat);r(n.clearcoatMap,"clearcoat",a).forEach(c=>i.addChild(c))}else s.addProperty(`float inputs:clearcoat = ${n.clearcoat}`);if(n.clearcoatRoughnessMap!==null){s.addProperty(`float inputs:clearcoatRoughness.connect = </Materials/Material_${n.id}/Texture_${n.clearcoatRoughnessMap.id}_clearcoatRoughness.outputs:g>`);const a=new Mt(n.clearcoatRoughness,n.clearcoatRoughness,n.clearcoatRoughness);r(n.clearcoatRoughnessMap,"clearcoatRoughness",a).forEach(c=>i.addChild(c))}else s.addProperty(`float inputs:clearcoatRoughness = ${n.clearcoatRoughness}`);s.addProperty(`float inputs:ior = ${n.ior}`)}return s.addProperty("int inputs:useSpecularWorkflow = 0"),s.addProperty("token outputs:surface"),i.addChild(s),i.addProperty(`token outputs:surface.connect = </Materials/Material_${n.id}/PreviewSurface.outputs:surface>`),i}function MP(n){return`(${n.r}, ${n.g}, ${n.b})`}function bre(n){return`(${n.r}, ${n.g}, ${n.b}, 1.0)`}function CP(n){return`(${n.x}, ${n.y})`}function xre(n,e){const t=sz(n,e),i=cz(n.matrix);n.matrix.determinant()<0&&console.warn("THREE.USDZExporter: USDZ does not support negative scales",n);const r=new il(t,"Camera");r.addProperty(`matrix4d xformOp:transform = ${i}`),r.addProperty('uniform token[] xformOpOrder = ["xformOp:transform"]');const s=n.isOrthographicCamera?"orthographic":"perspective";r.addProperty(`token projection = "${s}"`);const a=`(${n.near.toPrecision(Oo)}, ${n.far.toPrecision(Oo)})`;r.addProperty(`float2 clippingRange = ${a}`);let o;n.isOrthographicCamera?o=((Math.abs(n.left)+Math.abs(n.right))*10).toPrecision(Oo):o=n.getFilmWidth().toPrecision(Oo),r.addProperty(`float horizontalAperture = ${o}`);let c;if(n.isOrthographicCamera?c=((Math.abs(n.top)+Math.abs(n.bottom))*10).toPrecision(Oo):c=n.getFilmHeight().toPrecision(Oo),r.addProperty(`float verticalAperture = ${c}`),n.isPerspectiveCamera){const h=n.getFocalLength().toPrecision(Oo);r.addProperty(`float focalLength = ${h}`);const p=n.focus.toPrecision(Oo);r.addProperty(`float focusDistance = ${p}`)}return r}const _re=n=>e=>{try{const t=lf(e),i=(t.length?t[0].terms:[]).filter(r=>r&&r.type==="ident").map(r=>r.value).filter(r=>n.indexOf(r)>-1);return new Set(i)}catch{}return new Set};var rm=function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(s=(r<3?a(s):r>3?a(e,t,s):a(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};let TP=!1,IP=!1;const RP="#model-viewer-no-ar-fallback",Sre=_re(["quick-look","scene-viewer","webxr","none"]),Ere="webxr scene-viewer quick-look",$l={QUICK_LOOK:"quick-look",SCENE_VIEWER:"scene-viewer",WEBXR:"webxr",NONE:"none"},ef=Symbol("arButtonContainer"),BP=Symbol("enterARWithWebXR"),DP=Symbol("openSceneViewer"),LP=Symbol("openIOSARQuickLook"),wre=Symbol("canActivateAR"),gE=Symbol("arMode"),SI=Symbol("arModes"),qA=Symbol("arAnchor"),AE=Symbol("preload"),vE=Symbol("onARButtonContainerClick"),EI=Symbol("onARStatus"),wI=Symbol("onARTracking"),MI=Symbol("onARTap"),C1=Symbol("selectARMode"),CI=Symbol("triggerLoad"),Mre=n=>{var e,t,i,r,s,a,o,c,h,p;class g extends n{constructor(){super(...arguments),this.ar=!1,this.arScale="auto",this.arUsdzMaxTextureSize="auto",this.arPlacement="floor",this.arModes=Ere,this.iosSrc=null,this.xrEnvironment=!1,this[e]=!1,this[t]=this.shadowRoot.querySelector(".ar-button"),this[i]=document.createElement("a"),this[r]=new Set,this[s]=$l.NONE,this[a]=!1,this[o]=v=>{v.preventDefault(),this.activateAR()},this[c]=({status:v})=>{(v===Td.NOT_PRESENTING||this[zi].arRenderer.presentedScene===this[Rt])&&(this.setAttribute("ar-status",v),this.dispatchEvent(new CustomEvent("ar-status",{detail:{status:v}})),v===Td.NOT_PRESENTING?this.removeAttribute("ar-tracking"):v===Td.SESSION_STARTED&&this.setAttribute("ar-tracking",JR.TRACKING))},this[h]=({status:v})=>{this.setAttribute("ar-tracking",v),this.dispatchEvent(new CustomEvent("ar-tracking",{detail:{status:v}}))},this[p]=v=>{v.data=="_apple_ar_quicklook_button_tapped"&&this.dispatchEvent(new CustomEvent("quick-look-button-tapped"))}}get canActivateAR(){return this[gE]!==$l.NONE}connectedCallback(){super.connectedCallback(),this[zi].arRenderer.addEventListener("status",this[EI]),this.setAttribute("ar-status",Td.NOT_PRESENTING),this[zi].arRenderer.addEventListener("tracking",this[wI]),this[qA].addEventListener("message",this[MI])}disconnectedCallback(){super.disconnectedCallback(),this[zi].arRenderer.removeEventListener("status",this[EI]),this[zi].arRenderer.removeEventListener("tracking",this[wI]),this[qA].removeEventListener("message",this[MI])}update(v){super.update(v),v.has("arScale")&&(this[Rt].canScale=this.arScale!=="fixed"),v.has("arPlacement")&&(this[Rt].updateShadow(),this[ta]()),v.has("arModes")&&(this[SI]=Sre(this.arModes)),(v.has("ar")||v.has("arModes")||v.has("src")||v.has("iosSrc")||v.has("arUsdzMaxTextureSize"))&&this[C1]()}async activateAR(){switch(this[gE]){case $l.QUICK_LOOK:await this[LP]();break;case $l.WEBXR:await this[BP]();break;case $l.SCENE_VIEWER:this[DP]();break;default:console.warn("No AR Mode can be activated. This is probably due to missing configuration or device capabilities");break}}async[(e=wre,t=ef,i=qA,r=SI,s=gE,a=AE,o=vE,c=EI,h=wI,p=MI,C1)](){var v;let x=$l.NONE;if(this.ar){if(this.src!=null)for(const S of this[SI]){if(S==="webxr"&&w6&&!TP&&await this[zi].arRenderer.supportsPresentation()){x=$l.WEBXR;break}if(S==="scene-viewer"&&!IP&&(ree||navigator.userAgentData&&navigator.userAgentData.getHighEntropyValues&&(!((v=(await navigator.userAgentData.getHighEntropyValues(["formFactor"])).formFactor)===null||v===void 0)&&v.includes("XR")))){x=$l.SCENE_VIEWER;break}if(S==="quick-look"&&YN){x=$l.QUICK_LOOK;break}}x===$l.NONE&&this.iosSrc!=null&&YN&&(x=$l.QUICK_LOOK)}if(x!==$l.NONE)this[ef].classList.add("enabled"),this[ef].addEventListener("click",this[vE]);else if(this[ef].classList.contains("enabled")){this[ef].removeEventListener("click",this[vE]),this[ef].classList.remove("enabled");const S=Td.FAILED;this.setAttribute("ar-status",S),this.dispatchEvent(new CustomEvent("ar-status",{detail:{status:S}}))}this[gE]=x}async[BP](){console.log("Attempting to present in AR with WebXR..."),await this[CI]();try{this[ef].removeEventListener("click",this[vE]);const{arRenderer:v}=this[zi];v.placeOnWall=this.arPlacement==="wall",await v.present(this[Rt],this.xrEnvironment)}catch(v){console.warn("Error while trying to present in AR with WebXR"),console.error(v),await this[zi].arRenderer.stopPresenting(),TP=!0,console.warn("Falling back to next ar-mode"),await this[C1](),this.activateAR()}finally{this[C1]()}}async[CI](){this.loaded||(this[AE]=!0,this[g0](),await cee(this,"load"),this[AE]=!1)}[k0](){return super[k0]()||this[AE]}[DP](){const v=self.location.toString(),x=new URL(v),S=new URL(this.src,v);S.hash&&(S.hash="");const _=new URLSearchParams(S.search);if(x.hash=RP,_.set("mode","ar_preferred"),_.has("disable_occlusion")||_.set("disable_occlusion","true"),this.arScale==="fixed"&&_.set("resizable","false"),this.arPlacement==="wall"&&_.set("enable_vertical_placement","true"),_.has("sound")){const T=new URL(_.get("sound"),v);_.set("sound",T.toString())}if(_.has("link")){const T=new URL(_.get("link"),v);_.set("link",T.toString())}const E=`intent://arvr.google.com/scene-viewer/1.2?${_.toString()+"&file="+encodeURIComponent(S.toString())}#Intent;scheme=https;package=com.google.android.googlequicksearchbox;action=android.intent.action.VIEW;S.browser_fallback_url=${encodeURIComponent(x.toString())};end;`,C=()=>{self.location.hash===RP&&(IP=!0,self.history.back(),console.warn("Error while trying to present in AR with Scene Viewer"),console.warn("Falling back to next ar-mode"),this[C1]())};self.addEventListener("hashchange",C,{once:!0}),this[qA].setAttribute("href",E),console.log("Attempting to present in AR with Scene Viewer..."),this[qA].click()}async[LP](){const v=!this.iosSrc;this[ef].classList.remove("enabled");const x=v?await this.prepareUSDZ():this.iosSrc,S=new URL(x,self.location.toString());if(v){const C=self.location.toString(),T=new URL(C),R=new URL(this.src,T);R.hash&&(S.hash=R.hash)}this.arScale==="fixed"&&(S.hash&&(S.hash+="&"),S.hash+="allowsContentScaling=0");const _=this[qA];_.setAttribute("rel","ar");const E=document.createElement("img");_.appendChild(E),_.setAttribute("href",S.toString()),v&&_.setAttribute("download","model.usdz"),_.style.display="none",_.isConnected||this.shadowRoot.appendChild(_),console.log("Attempting to present in AR with Quick Look..."),_.click(),_.removeChild(E),v&&URL.revokeObjectURL(x),this[ef].classList.add("enabled")}async prepareUSDZ(){const v=this[Km].beginActivity("usdz-conversion");await this[CI]();const{model:x,shadow:S,target:_}=this[Rt];if(x==null)return"";let E=!1;S!=null&&(E=S.visible,S.visible=!1),v(.2);const C=new ure;_.remove(x),x.position.copy(_.position),x.updateWorldMatrix(!1,!0);const T=await C.parseAsync(x,{maxTextureSize:isNaN(this.arUsdzMaxTextureSize)?1/0:Math.max(parseInt(this.arUsdzMaxTextureSize),16)});x.position.set(0,0,0),_.add(x);const R=new Blob([T],{type:"model/vnd.usdz+zip"}),B=URL.createObjectURL(R);return v(1),S!=null&&(S.visible=E),B}}return rm([wn({type:Boolean,attribute:"ar"})],g.prototype,"ar",void 0),rm([wn({type:String,attribute:"ar-scale"})],g.prototype,"arScale",void 0),rm([wn({type:String,attribute:"ar-usdz-max-texture-size"})],g.prototype,"arUsdzMaxTextureSize",void 0),rm([wn({type:String,attribute:"ar-placement"})],g.prototype,"arPlacement",void 0),rm([wn({type:String,attribute:"ar-modes"})],g.prototype,"arModes",void 0),rm([wn({type:String,attribute:"ios-src"})],g.prototype,"iosSrc",void 0),rm([wn({type:Boolean,attribute:"xr-environment"})],g.prototype,"xrEnvironment",void 0),g};var TI=function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(s=(r<3?a(s):r>3?a(e,t,s):a(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};const Cre=100,Tre="https://www.gstatic.com/draco/versioned/decoders/1.5.6/",Ire="https://www.gstatic.com/basis-universal/versioned/2021-04-15-ba1c3e4/",Rre="https://cdn.jsdelivr.net/npm/three@0.149.0/examples/jsm/loaders/LottieLoader.js",II={AUTO:"auto"},NP={AUTO:"auto",EAGER:"eager"},XA=Symbol("defaultProgressBarElement"),RI=Symbol("posterContainerElement"),YA=Symbol("defaultPosterElement"),T1=Symbol("shouldDismissPoster"),BI=Symbol("hidePoster"),yE=Symbol("modelIsRevealed"),DI=Symbol("updateProgressBar"),Bre=Symbol("ariaLabelCallToAction"),LI=Symbol("onProgress"),Dre=n=>{var e,t,i,r,s,a,o,c;class h extends n{static set dracoDecoderLocation(g){ro.setDRACODecoderLocation(g)}static get dracoDecoderLocation(){return ro.getDRACODecoderLocation()}static set ktx2TranscoderLocation(g){ro.setKTX2TranscoderLocation(g)}static get ktx2TranscoderLocation(){return ro.getKTX2TranscoderLocation()}static set meshoptDecoderLocation(g){ro.setMeshoptDecoderLocation(g)}static get meshoptDecoderLocation(){return ro.getMeshoptDecoderLocation()}static set lottieLoaderLocation(g){Qc.singleton.textureUtils.lottieLoaderUrl=g}static get lottieLoaderLocation(){return Qc.singleton.textureUtils.lottieLoaderUrl}static mapURLs(g){Qc.singleton.loader[lm].manager.setURLModifier(g)}dismissPoster(){this.loaded?this[BI]():(this[T1]=!0,this[g0]())}showPoster(){const g=this[RI];if(g.classList.contains("show"))return;g.classList.add("show"),this[zc].classList.remove("show");const A=this[YA];A.removeAttribute("tabindex"),A.removeAttribute("aria-hidden");const v=this.modelIsVisible;this[yE]=!1,this[Hw](v)}getDimensions(){return Id(this[Rt].size)}getBoundingBoxCenter(){return Id(this[Rt].boundingBox.getCenter(new ee))}constructor(...g){super(...g),this.poster=null,this.reveal=II.AUTO,this.loading=NP.AUTO,this[e]=!1,this[t]=!1,this[i]=this.shadowRoot.querySelector(".slot.poster"),this[r]=this.shadowRoot.querySelector("#default-poster"),this[s]=this.shadowRoot.querySelector("#default-progress-bar > .bar"),this[a]=this[YA].getAttribute("aria-label"),this[o]=oee(_=>{const E=this[XA].parentNode;requestAnimationFrame(()=>{this[XA].style.transform=`scaleX(${_})`,_===0&&(E.removeChild(this[XA]),E.appendChild(this[XA])),this[XA].classList.toggle("hide",_===1)})},Cre),this[c]=_=>{const E=_.detail.totalProgress,C=_.detail.reason;E===1&&(this[DI].flush(),this.loaded&&(this[T1]||this.reveal===II.AUTO)&&this[BI]()),this[DI](E),this.dispatchEvent(new CustomEvent("progress",{detail:{totalProgress:E,reason:C}}))};const A=self.ModelViewerElement||{},v=A.dracoDecoderLocation||Tre;ro.setDRACODecoderLocation(v);const x=A.ktx2TranscoderLocation||Ire;ro.setKTX2TranscoderLocation(x),A.meshoptDecoderLocation&&ro.setMeshoptDecoderLocation(A.meshoptDecoderLocation);const S=A.lottieLoaderLocation||Rre;Qc.singleton.textureUtils.lottieLoaderUrl=S}connectedCallback(){super.connectedCallback(),this.loaded||this.showPoster(),this[Km].addEventListener("progress",this[LI])}disconnectedCallback(){super.disconnectedCallback(),this[Km].removeEventListener("progress",this[LI])}async updated(g){super.updated(g),g.has("poster")&&this.poster!=null&&(this[YA].style.backgroundImage=`url(${this.poster})`),g.has("alt")&&this[YA].setAttribute("aria-label",this[i2]),(g.has("reveal")||g.has("loading"))&&this[g0]()}[(e=yE,t=T1,i=RI,r=YA,s=XA,a=Bre,o=DI,c=LI,k0)](){return!!this.src&&(this[T1]||this.loading===NP.EAGER||this.reveal===II.AUTO&&this[fm])}[BI](){this[T1]=!1;const g=this[RI];if(!g.classList.contains("show"))return;g.classList.remove("show"),this[zc].classList.add("show");const A=this.modelIsVisible;this[yE]=!0,this[Hw](A);const v=this.getRootNode();v&&v.activeElement===this&&this[zc].focus();const x=this[YA];x.setAttribute("aria-hidden","true"),x.tabIndex=-1,this.dispatchEvent(new CustomEvent("poster-dismissed"))}[$m](){return super[$m]()&&this[yE]}}return TI([wn({type:String})],h.prototype,"poster",void 0),TI([wn({type:String})],h.prototype,"reveal",void 0),TI([wn({type:String})],h.prototype,"loading",void 0),h};var NI=function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(s=(r<3?a(s):r>3?a(e,t,s):a(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};const Lre=Math.PI/32,Nre=3e3,Ure={basis:[nC(Oa(Lre,"rad"))],keywords:{auto:[null]}},KA=Symbol("autoRotateStartTime"),UI=Symbol("radiansPerSecond"),UP=Symbol("syncRotationRate"),FI=Symbol("onCameraChange"),Fre=n=>{var e,t,i;class r extends n{constructor(){super(...arguments),this.autoRotate=!1,this.autoRotateDelay=Nre,this.rotationPerSecond="auto",this[e]=performance.now(),this[t]=0,this[i]=a=>{this.autoRotate&&a.detail.source==="user-interaction"&&(this[KA]=performance.now())}}connectedCallback(){super.connectedCallback(),this.addEventListener("camera-change",this[FI]),this[KA]=performance.now()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("camera-change",this[FI]),this[KA]=performance.now()}updated(a){super.updated(a),a.has("autoRotate")&&(this[KA]=performance.now())}[(e=KA,t=UI,UP)](a){this[UI]=a[0]}[eh](a,o){if(super[eh](a,o),!this.autoRotate||!this[$m]()||this[zi].isPresenting)return;const c=Math.min(o,a-this[KA]-this.autoRotateDelay);c>0&&(this[Rt].yaw=this.turntableRotation+this[UI]*c*.001)}get turntableRotation(){return this[Rt].yaw}resetTurntableRotation(a=0){this[Rt].yaw=a}}return i=FI,NI([wn({type:Boolean,attribute:"auto-rotate"})],r.prototype,"autoRotate",void 0),NI([wn({type:Number,attribute:"auto-rotate-delay"})],r.prototype,"autoRotateDelay",void 0),NI([_d({intrinsics:Ure,updateHandler:UP}),wn({type:String,attribute:"rotation-per-second"})],r.prototype,"rotationPerSecond",void 0),r};const uz=Xie(Tie(Fre(pee(Dne(Mre(Dre(qie(lx))))))));customElements.define("model-viewer",uz);const Pre=Object.freeze(Object.defineProperty({__proto__:null,CanvasTexture:d4,FileLoader:fs,Loader:zs,ModelViewerElement:uz,NearestFilter:Ri},Symbol.toStringTag,{value:"Module"})),Ore=[{name:"Astronaut",src:"https://modelviewer.dev/shared-assets/models/Astronaut.glb",poster:"https://modelviewer.dev/shared-assets/models/Astronaut.webp"},{name:"Robot",src:"https://modelviewer.dev/shared-assets/models/RobotExpressive.glb",poster:""},{name:"Boom Box",src:"https://modelviewer.dev/shared-assets/models/glTF-Sample-Assets/Models/BoomBox/glTF-Binary/BoomBox.glb",poster:""}];function kre(){return X.useEffect(()=>{customElements.get("model-viewer")||Uk(()=>Promise.resolve().then(()=>Pre),[])},[]),D.jsxs("div",{className:"experiment-page model-viewer-page",children:[D.jsxs("header",{className:"experiment-header",children:[D.jsx(nh,{to:"/",className:"back-link",children:" Back"}),D.jsxs("div",{children:[D.jsx("h1",{children:"Model Viewer"}),D.jsx("p",{children:"3D models with built-in AR support"})]})]}),D.jsx("main",{className:"model-grid",children:Ore.map(n=>D.jsxs("div",{className:"model-card",children:[D.jsx("div",{dangerouslySetInnerHTML:{__html:`
                  <model-viewer
                    src="${n.src}"
                    alt="${n.name}"
                    ar
                    ar-modes="webxr scene-viewer quick-look"
                    camera-controls
                    auto-rotate
                    shadow-intensity="1"
                    environment-image="neutral"
                    loading="lazy"
                    style="width: 100%; height: 300px; background-color: #1a1a1a;"
                  >
                    <button slot="ar-button" class="ar-button">
                       View in AR
                    </button>
                  </model-viewer>
                `}}),D.jsx("h3",{children:n.name})]},n.name))}),D.jsxs("section",{className:"info-section",children:[D.jsx("h2",{children:"How It Works"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"iOS:"})," Uses AR Quick Look (native Safari)"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Android:"})," Uses Scene Viewer or WebXR"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Desktop:"})," 3D preview only (no AR)"]})]}),D.jsx("h2",{children:"Supported Formats"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"glTF / GLB"}),"  Best for web"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"USDZ"}),"  Required for iOS AR Quick Look"]})]}),D.jsx("h2",{children:"Use Cases"}),D.jsxs("ul",{children:[D.jsx("li",{children:"Product previews (furniture, fashion, electronics)"}),D.jsx("li",{children:"Educational models (anatomy, architecture)"}),D.jsx("li",{children:"Art & collectibles (NFTs, sculptures)"})]})]})]})}const $A={NOSE_TIP:1,NOSE_BRIDGE:168,FOREHEAD:10},PI=[{id:"glasses",name:"Glasses",emoji:"",description:"Classic black frames",type:"primitive",anchor:$A.NOSE_BRIDGE,create:()=>{const n=new Ds,e=new Ks({color:1710618,metalness:.8,roughness:.2}),t=new Ks({color:4491519,transparent:!0,opacity:.3,metalness:.1,roughness:0}),i=new Wt(new Vm(.035,32),t);i.position.set(-.035,.01,.01);const r=new Wt(new Vm(.035,32),t);r.position.set(.035,.01,.01);const s=new Wt(new Qu(.035,.003,8,32),e);s.position.set(-.035,.01,.01);const a=new Wt(new Qu(.035,.003,8,32),e);a.position.set(.035,.01,.01);const o=new Wt(new Wd(.003,.003,.02,8),e);o.rotation.z=Math.PI/2,o.position.set(0,.01,.01);const c=new Wt(new ba(.08,.004,.004),e);c.position.set(-.09,.01,-.02),c.rotation.y=-.3;const h=new Wt(new ba(.08,.004,.004),e);return h.position.set(.09,.01,-.02),h.rotation.y=.3,n.add(i,r,s,a,o,c,h),n}},{id:"nose-sphere",name:"Clown Nose",emoji:"",description:"Big red nose",type:"primitive",anchor:$A.NOSE_TIP,create:()=>{const n=new hc(.03,32,16),e=new Ks({color:16711680,metalness:.1,roughness:.8}),t=new Wt(n,e);return t.position.set(0,0,.01),t}},{id:"crown",name:"Crown",emoji:"",description:"Royal golden crown",type:"primitive",anchor:$A.FOREHEAD,create:()=>{const n=new Ds,e=new Ks({color:16766720,metalness:.9,roughness:.1}),t=new Wt(new Qu(.06,.008,8,32,Math.PI),e);t.rotation.x=Math.PI/2,t.position.set(0,.02,0);const i=new ov(.01,.04,4);[-.04,-.02,0,.02,.04].forEach(c=>{const h=new Wt(i,e);h.position.set(c,.05,0),n.add(h)});const s=new Ks({color:16711765,metalness:.3,roughness:.2,emissive:3342353,emissiveIntensity:.3}),a=new lv(.008);return[-.03,0,.03].forEach(c=>{const h=new Wt(a,s);h.position.set(c,.03,.01),n.add(h)}),n.add(t),n}},{id:"mustache",name:"Mustache",emoji:"",description:"Dapper stache",type:"primitive",anchor:$A.NOSE_TIP,create:()=>{const n=new Ds,e=new Ks({color:2758672,roughness:1,metalness:0}),t=new Wt(new Qu(.02,.006,8,16,Math.PI/2),e);t.position.set(-.025,-.025,.015),t.rotation.z=Math.PI/4;const i=new Wt(new Qu(.02,.006,8,16,Math.PI/2),e);i.position.set(.025,-.025,.015),i.rotation.z=-Math.PI/4-Math.PI/2;const r=new Wt(new ba(.03,.012,.008),e);return r.position.set(0,-.025,.015),n.add(t,i,r),n}},{id:"sunglasses",name:"Sunglasses",emoji:"",description:"Cool shades",type:"primitive",anchor:$A.NOSE_BRIDGE,create:()=>{const n=new Ds,e=new Ks({color:1710618,metalness:.9,roughness:.1}),t=new Ks({color:1118481,transparent:!0,opacity:.85,metalness:.5,roughness:0}),i=c=>{const h=new df,p=.04,g=.045;h.moveTo(0,g*.5),h.quadraticCurveTo(p*.6,g*.6,p,0),h.quadraticCurveTo(p*.8,-g*.6,0,-g*.5),h.quadraticCurveTo(-p*.3,-g*.3,-p*.3,0),h.quadraticCurveTo(-p*.3,g*.3,0,g*.5);const A=new cv(h),v=new Wt(A,t);return v.position.set(c?-.035:.035,.005,.01),c||(v.scale.x=-1),v};n.add(i(!0)),n.add(i(!1));const r=new Wt(new Wd(.003,.003,.015,8),e);r.rotation.z=Math.PI/2,r.position.set(0,.01,.01),n.add(r);const s=new ba(.1,.006,.004),a=new Wt(s,e);a.position.set(-.1,.01,-.02),a.rotation.y=-.25;const o=new Wt(s,e);return o.position.set(.1,.01,-.02),o.rotation.y=.25,n.add(a,o),n}},{id:"particles",name:"Sparkles",emoji:"",description:"Floating particles",type:"primitive",anchor:$A.NOSE_BRIDGE,create:()=>{const n=new Ds,e=30,t=new hc(.004,8,8);for(let i=0;i<e;i++){const r=new Ks({color:new Mt().setHSL(Math.random(),.8,.6),emissive:new Mt().setHSL(Math.random(),.8,.3),emissiveIntensity:.5,metalness:.8,roughness:.2}),s=new Wt(t,r);s.position.set((Math.random()-.5)*.2,(Math.random()-.5)*.2+.05,(Math.random()-.5)*.1),s.userData={originalY:s.position.y,speed:.5+Math.random()*1.5,phase:Math.random()*Math.PI*2},n.add(s)}return n.userData.animate=i=>{n.children.forEach(r=>{r.userData.originalY!==void 0&&(r.position.y=r.userData.originalY+Math.sin(i*r.userData.speed+r.userData.phase)*.02,r.rotation.y=i*r.userData.speed)})},n}}];function zre(){const n=X.useRef(null),e=X.useRef(null),t=X.useRef(null),i=X.useRef(new Map),r=X.useRef(new Map),[s,a]=X.useState(!0),[o,c]=X.useState(!1),[h,p]=X.useState(new Set(["glasses"])),[g,A]=X.useState(null),[v,x]=X.useState("Initializing..."),S=X.useCallback(async()=>window.MindARThree?!0:(x("Loading MindAR..."),new Promise(U=>{const O=document.createElement("script");O.type="module",O.src="/ar-lab/mindar-loader.js";const F=()=>{window.removeEventListener("mindar-loaded",F),clearTimeout(P),U(!0)},L=()=>{clearTimeout(P),console.error("MindAR script failed to load"),U(!1)};window.addEventListener("mindar-loaded",F),O.addEventListener("error",L),document.head.appendChild(O);const P=setTimeout(()=>{window.MindARThree||(window.removeEventListener("mindar-loaded",F),console.error("MindAR load timed out"),U(!1))},2e4)})),[]),_=X.useCallback(async()=>{if(!n.current||!window.MindARThree)return!1;try{x("Setting up camera...");const U=new window.MindARThree({container:n.current});e.current=U;const{scene:O}=U,F=new YM(16777215,.7);O.add(F);const L=new hv(16777215,.5);return L.position.set(0,1,1),O.add(L),new Set(PI.map(W=>W.anchor)).forEach(W=>{const j=U.addAnchor(W);r.current.set(W,j.group)}),x("Ready!"),!0}catch(U){return console.error("AR init failed:",U),A("Failed to initialize AR. Please check camera permissions."),!1}},[]),E=X.useCallback(async U=>{const O=r.current.get(U.anchor);if(!O)return;const F=new ax,L=await U.create(e.current.scene,F);O.add(L),i.current.set(U.id,L)},[]),C=X.useCallback(U=>{const O=i.current.get(U.id),F=r.current.get(U.anchor);O&&F&&(F.remove(O),i.current.delete(U.id))},[]),T=X.useCallback(U=>{p(O=>{const F=new Set(O);return F.has(U.id)?(F.delete(U.id),C(U)):(F.add(U.id),o&&E(U)),F})},[o,E,C]),R=X.useCallback(async()=>{if(e.current)try{x("Starting camera..."),await e.current.start();for(const O of PI)h.has(O.id)&&await E(O);const U=()=>{if(!e.current)return;const O=performance.now()/1e3;i.current.forEach(F=>{F.userData.animate&&F.userData.animate(O)}),e.current.renderer.render(e.current.scene,e.current.camera),t.current=requestAnimationFrame(U)};U(),c(!0),a(!1)}catch(U){console.error("Failed to start AR:",U),A("Failed to start camera. Please grant camera permissions and try again.")}},[h,E]),B=X.useCallback(()=>{t.current&&(cancelAnimationFrame(t.current),t.current=null),e.current&&e.current.stop(),i.current.clear(),c(!1)},[]);return X.useEffect(()=>{let U=!0;return(async()=>{const F=await S();if(!U)return;if(!F){A("Failed to load MindAR. Please check your internet connection."),a(!1);return}const L=await _();U&&L&&a(!1)})(),()=>{U=!1,B()}},[S,_,B]),D.jsxs("div",{className:"experiment-page face-tracking-page",children:[D.jsxs("header",{className:"experiment-header",children:[D.jsx(nh,{to:"/",className:"back-link",children:" Back"}),D.jsxs("div",{children:[D.jsx("h1",{children:"Face Tracking"}),D.jsx("p",{children:"AR filters with real-time face detection"})]})]}),D.jsxs("div",{className:"ar-container-wrapper",children:[D.jsxs("div",{ref:n,className:`ar-container ${o?"active":""}`,children:[s&&D.jsxs("div",{className:"loading-overlay",children:[D.jsx("div",{className:"loading-spinner"}),D.jsx("p",{children:v})]}),g&&D.jsxs("div",{className:"error-overlay",children:[D.jsx("span",{className:"error-icon",children:""}),D.jsx("p",{children:g}),D.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]}),!o&&!s&&!g&&D.jsxs("div",{className:"start-overlay",children:[D.jsx("button",{onClick:R,className:"start-button",children:" Start Camera"}),D.jsx("p",{className:"permission-note",children:"Requires camera permission"})]})]}),o&&D.jsx("button",{onClick:B,className:"stop-button",children:" Stop"})]}),D.jsxs("div",{className:"filters-section",children:[D.jsx("h2",{children:"Filters"}),D.jsx("div",{className:"filters-grid",children:PI.map(U=>D.jsxs("button",{className:`filter-button ${h.has(U.id)?"active":""}`,onClick:()=>T(U),children:[D.jsx("span",{className:"filter-emoji",children:U.emoji}),D.jsx("span",{className:"filter-name",children:U.name}),D.jsx("span",{className:"filter-desc",children:U.description})]},U.id))})]}),D.jsxs("section",{className:"info-section",children:[D.jsx("h2",{children:"How It Works"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"MindAR.js"}),"  Open-source face tracking library"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"MediaPipe"}),"  Google's ML face detection (468 landmarks)"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Three.js"}),"  3D rendering and filter effects"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"WebRTC"}),"  Camera access via getUserMedia"]})]}),D.jsx("h2",{children:"Browser Requirements"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"Chrome / Edge / Safari"}),"  Recommended"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Camera permission"}),"  Required"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"HTTPS"}),"  Required for camera access"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"WebGL"}),"  Hardware acceleration helps"]})]}),D.jsx("h2",{children:"Face Anchor Points"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"Nose Bridge (168)"}),"  Glasses, masks"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Nose Tip (1)"}),"  Nose effects"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Forehead (10)"}),"  Hats, crowns"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Ears (127, 356)"}),"  Earrings"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Mouth (13)"}),"  Mouth effects"]})]}),D.jsx("h2",{children:"Use Cases"}),D.jsxs("ul",{children:[D.jsx("li",{children:"Virtual try-on (glasses, makeup, accessories)"}),D.jsx("li",{children:"Social media filters and effects"}),D.jsx("li",{children:"Video conferencing enhancements"}),D.jsx("li",{children:"Interactive marketing experiences"})]})]})]})}const Gre=[{id:"cube",name:"Spinning Cube",emoji:""},{id:"model",name:"3D Robot",emoji:""},{id:"info-card",name:"Info Panel",emoji:""},{id:"portal",name:"AR Portal",emoji:""}];function Hre(){const n=X.useRef(null),e=X.useRef(null),t=X.useRef(null),i=X.useRef(null),[r,s]=X.useState(!0),[a,o]=X.useState(!1),[c,h]=X.useState("cube"),[p,g]=X.useState(!1),[A,v]=X.useState(null),[x,S]=X.useState("Initializing..."),_=X.useCallback(async()=>window.MindARThreeImage?!0:(S("Loading MindAR Image Tracking..."),new Promise(U=>{const O=document.createElement("script");O.src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-three.prod.js",O.onload=()=>{const F=window;F.MINDAR?.IMAGE?.MindARThree&&(window.MindARThreeImage=F.MINDAR.IMAGE.MindARThree),U(!!window.MindARThreeImage)},O.onerror=()=>{console.error("Failed to load MindAR Image script"),U(!1)},document.head.appendChild(O),setTimeout(()=>{window.MindARThreeImage||U(!1)},15e3)})),[]),E=X.useCallback((U,O)=>{switch(U){case"cube":{const F=new ba(.5,.5,.5),L=new Ks({color:6717162,metalness:.5,roughness:.3}),P=new Wt(F,L);return P.position.set(0,.25,0),P.userData.animate=W=>{P.rotation.y=W,P.rotation.x=Math.sin(W*.5)*.3},P}case"model":{const F=new Ds;return new ax().load("https://modelviewer.dev/shared-assets/models/RobotExpressive.glb",P=>{const W=P.scene;W.scale.set(.15,.15,.15),W.position.set(0,0,0),F.add(W),F.userData.animate=j=>{W.position.y=Math.sin(j*2)*.05,W.rotation.y=j*.5}},void 0,P=>console.error("Failed to load model:",P)),F}case"info-card":{const F=new Ds,L=new ra(.6,.4),P=new ar({color:1710638,side:gi}),W=new Wt(L,P);W.position.z=.01,F.add(W);const j=new ra(.62,.42),V=new ar({color:6717162,side:gi}),q=new Wt(j,V);F.add(q);const re=20;for(let Q=0;Q<re;Q++){const K=new hc(.01,8,8),ce=new ar({color:new Mt().setHSL(.6+Math.random()*.2,.8,.6)}),ue=new Wt(K,ce);ue.position.set((Math.random()-.5)*.6,(Math.random()-.5)*.4,.05+Math.random()*.1),ue.userData.speed=.5+Math.random(),ue.userData.phase=Math.random()*Math.PI*2,F.add(ue)}return F.userData.animate=Q=>{F.children.forEach(K=>{K.userData.speed&&(K.position.z=.05+Math.sin(Q*K.userData.speed+K.userData.phase)*.03)})},F}case"portal":{const F=new Ds,L=new Qu(.25,.02,16,32),P=new Ks({color:6717162,emissive:3359863,emissiveIntensity:.5,metalness:.8,roughness:.2}),W=new Wt(L,P);F.add(W);const j=new Vm(.23,32),V=new ar({color:51,transparent:!0,opacity:.8,side:gi}),q=new Wt(j,V);q.position.z=.01,F.add(q);const re=30;for(let Q=0;Q<re;Q++){const K=Q/re*Math.PI*2,ce=.1+Math.random()*.12,ue=new hc(.008,8,8),oe=new ar({color:new Mt().setHSL(.6+Math.random()*.2,.8,.7)}),z=new Wt(ue,oe);z.userData.angle=K,z.userData.radius=ce,z.userData.speed=.5+Math.random()*1,F.add(z)}return F.userData.animate=Q=>{W.rotation.z=Q*.3,F.children.forEach(K=>{if(K.userData.angle!==void 0){const ce=K.userData.angle+Q*K.userData.speed;K.position.x=Math.cos(ce)*K.userData.radius,K.position.y=Math.sin(ce)*K.userData.radius,K.position.z=.02+Math.sin(Q*2+K.userData.angle)*.02}})},F}default:return new Ds}},[]),C=X.useCallback(async()=>{if(!n.current||!window.MindARThreeImage)return!1;try{S("Setting up image tracking...");const U=new window.MindARThreeImage({container:n.current,imageTargetSrc:"https://cdn.jsdelivr.net/gh/nicolo-rancan/AR-mind-file-targets@main/targets.mind",maxTrack:1,uiLoading:"no",uiScanning:"no",uiError:"no"});e.current=U;const{scene:O}=U,F=new YM(16777215,.8);O.add(F);const L=new hv(16777215,.6);L.position.set(0,1,1),O.add(L);const P=U.addAnchor(0),W=E(c,O);return i.current=W,P.group.add(W),P.onTargetFound=()=>{g(!0)},P.onTargetLost=()=>{g(!1)},S("Ready!"),!0}catch(U){return console.error("AR init failed:",U),v("Failed to initialize AR. Please check camera permissions."),!1}},[E,c]),T=X.useCallback(async()=>{if(!(!e.current&&!await C()))try{S("Starting camera..."),await e.current.start();const U=()=>{if(!e.current)return;const O=performance.now()/1e3;i.current?.userData.animate&&i.current.userData.animate(O),e.current.renderer.render(e.current.scene,e.current.camera),t.current=requestAnimationFrame(U)};U(),o(!0),s(!1)}catch(U){console.error("Failed to start AR:",U),v("Failed to start camera. Please grant camera permissions and try again.")}},[C]),R=X.useCallback(()=>{t.current&&(cancelAnimationFrame(t.current),t.current=null),e.current&&(e.current.stop(),e.current=null),i.current=null,o(!1),g(!1)},[]),B=X.useCallback(U=>{h(U),a&&R()},[a,R]);return X.useEffect(()=>{let U=!0;return(async()=>{const F=await _();if(U){if(!F){v("Failed to load MindAR. Please check your internet connection."),s(!1);return}s(!1)}})(),()=>{U=!1,R()}},[_,R]),D.jsxs("div",{className:"experiment-page image-tracking-page",children:[D.jsxs("header",{className:"experiment-header",children:[D.jsx(nh,{to:"/",className:"back-link",children:" Back"}),D.jsxs("div",{children:[D.jsx("h1",{children:"Image Tracking"}),D.jsx("p",{children:"Recognize images and overlay 3D content"})]})]}),D.jsxs("div",{className:"ar-container-wrapper",children:[D.jsxs("div",{ref:n,className:`ar-container ${a?"active":""} ${p?"tracking":""}`,children:[r&&D.jsxs("div",{className:"loading-overlay",children:[D.jsx("div",{className:"loading-spinner"}),D.jsx("p",{children:x})]}),A&&D.jsxs("div",{className:"error-overlay",children:[D.jsx("span",{className:"error-icon",children:""}),D.jsx("p",{children:A}),D.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]}),!a&&!r&&!A&&D.jsxs("div",{className:"start-overlay",children:[D.jsx("button",{onClick:T,className:"start-button",children:" Start Camera"}),D.jsx("p",{className:"permission-note",children:"Requires camera permission"})]}),a&&D.jsx("div",{className:"tracking-indicator",children:p?D.jsx("span",{className:"tracking-found",children:" Target Found"}):D.jsx("span",{className:"tracking-searching",children:" Searching for target..."})})]}),a&&D.jsx("button",{onClick:R,className:"stop-button",children:" Stop"})]}),D.jsxs("div",{className:"content-section",children:[D.jsx("h2",{children:"3D Content"}),D.jsx("p",{className:"section-desc",children:"Select what appears when an image is detected:"}),D.jsx("div",{className:"content-grid",children:Gre.map(U=>D.jsxs("button",{className:`content-button ${c===U.id?"active":""}`,onClick:()=>B(U.id),children:[D.jsx("span",{className:"content-emoji",children:U.emoji}),D.jsx("span",{className:"content-name",children:U.name})]},U.id))})]}),D.jsxs("div",{className:"target-section",children:[D.jsx("h2",{children:" Print a Target Image"}),D.jsx("p",{children:"Image tracking requires a physical image to detect. Print or display one of these targets:"}),D.jsxs("div",{className:"target-images",children:[D.jsxs("a",{href:"https://cdn.jsdelivr.net/gh/nicolo-rancan/AR-mind-file-targets@main/musicband-cover.png",target:"_blank",rel:"noopener noreferrer",className:"target-link",children:[D.jsx("img",{src:"https://cdn.jsdelivr.net/gh/nicolo-rancan/AR-mind-file-targets@main/musicband-cover.png",alt:"Target 1",className:"target-preview"}),D.jsx("span",{children:"Target Image 1"})]}),D.jsxs("a",{href:"https://cdn.jsdelivr.net/gh/nicolo-rancan/AR-mind-file-targets@main/musicband-cover-2.png",target:"_blank",rel:"noopener noreferrer",className:"target-link",children:[D.jsx("img",{src:"https://cdn.jsdelivr.net/gh/nicolo-rancan/AR-mind-file-targets@main/musicband-cover-2.png",alt:"Target 2",className:"target-preview"}),D.jsx("span",{children:"Target Image 2"})]})]}),D.jsx("p",{className:"target-tip",children:" Tip: Open the image on another screen or print it for best results"})]}),D.jsxs("section",{className:"info-section",children:[D.jsx("h2",{children:"How It Works"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"MindAR.js"}),"  Open-source image tracking library"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"NFT (Natural Feature Tracking)"}),"  Detects natural image features"]}),D.jsxs("li",{children:[D.jsx("strong",{children:".mind files"}),"  Pre-compiled image data for fast detection"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Three.js"}),"  3D content rendering"]})]}),D.jsx("h2",{children:"Creating Custom Targets"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"Image Compiler"}),"  Use MindAR's online tool to create .mind files"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Best images"}),"  High contrast, unique patterns, no repetition"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Avoid"}),"  Solid colors, simple shapes, reflective surfaces"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Size"}),"  Larger printed targets work better at distance"]})]}),D.jsx("h2",{children:"Use Cases"}),D.jsxs("ul",{children:[D.jsx("li",{children:"Product packaging with AR content"}),D.jsx("li",{children:"Museum exhibits and art installations"}),D.jsx("li",{children:"Educational materials with interactive 3D"}),D.jsx("li",{children:"Business cards with AR portfolios"}),D.jsx("li",{children:"Book covers that come to life"})]})]})]})}var OI={exports:{}},kI={},zI={exports:{}},GI={};var FP;function Qre(){if(FP)return GI;FP=1;var n=jb();function e(g,A){return g===A&&(g!==0||1/g===1/A)||g!==g&&A!==A}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(g,A){var v=A(),x=i({inst:{value:v,getSnapshot:A}}),S=x[0].inst,_=x[1];return s(function(){S.value=v,S.getSnapshot=A,c(S)&&_({inst:S})},[g,v,A]),r(function(){return c(S)&&_({inst:S}),g(function(){c(S)&&_({inst:S})})},[g]),a(v),v}function c(g){var A=g.getSnapshot;g=g.value;try{var v=A();return!t(g,v)}catch{return!0}}function h(g,A){return A()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:o;return GI.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:p,GI}var PP;function Vre(){return PP||(PP=1,zI.exports=Qre()),zI.exports}var OP;function jre(){if(OP)return kI;OP=1;var n=jb(),e=Vre();function t(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,c=n.useDebugValue;return kI.useSyncExternalStoreWithSelector=function(h,p,g,A,v){var x=s(null);if(x.current===null){var S={hasValue:!1,value:null};x.current=S}else S=x.current;x=o(function(){function E(U){if(!C){if(C=!0,T=U,U=A(U),v!==void 0&&S.hasValue){var O=S.value;if(v(O,U))return R=O}return R=U}if(O=R,i(T,U))return O;var F=A(U);return v!==void 0&&v(O,F)?(T=U,O):(T=U,R=F)}var C=!1,T,R,B=g===void 0?null:g;return[function(){return E(p())},B===null?void 0:function(){return E(B())}]},[p,g,A,v]);var _=r(h,x[0],x[1]);return a(function(){S.hasValue=!0,S.value=_},[_]),c(_),_},kI}var kP;function Wre(){return kP||(kP=1,OI.exports=jre()),OI.exports}var qre=Wre();const j4=j2(qre),zP=n=>{let e;const t=new Set,i=(h,p)=>{const g=typeof h=="function"?h(e):h;if(!Object.is(g,e)){const A=e;e=p??(typeof g!="object"||g===null)?g:Object.assign({},e,g),t.forEach(v=>v(e,A))}},r=()=>e,o={setState:i,getState:r,getInitialState:()=>c,subscribe:h=>(t.add(h),()=>t.delete(h))},c=e=n(i,r,o);return o},Xre=(n=>n?zP(n):zP),{useSyncExternalStoreWithSelector:Yre}=j4,Kre=n=>n;function $re(n,e=Kre,t){const i=Yre(n.subscribe,n.getState,n.getInitialState,e,t);return Gd.useDebugValue(i),i}const GP=(n,e)=>{const t=Xre(n),i=(r,s=e)=>$re(t,r,s);return Object.assign(i,t),i},hz=((n,e)=>n?GP(n,e):GP),Jre=n=>typeof n=="object"&&typeof n.then=="function",bm=[];function fz(n,e,t=(i,r)=>i===r){if(n===e)return!0;if(!n||!e)return!1;const i=n.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!t(n[r],e[r]))return!1;return!0}function dz(n,e=null,t=!1,i={}){e===null&&(e=[n]);for(const s of bm)if(fz(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return i.lifespan&&i.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,i.lifespan)),s.response;if(!t)throw s.promise}const r={keys:e,equal:i.equal,remove:()=>{const s=bm.indexOf(r);s!==-1&&bm.splice(s,1)},promise:(Jre(n)?n:n(...e)).then(s=>{r.response=s,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(s=>r.error=s)};if(bm.push(r),!t)throw r.promise}const W4=(n,e,t)=>dz(n,e,!1,t),Zre=(n,e,t)=>{dz(n,e,!0,t)},ese=n=>{if(n===void 0||n.length===0)bm.splice(0,bm.length);else{const e=bm.find(t=>fz(n,t.keys,t.equal));e&&e.remove()}};var u2=pk();const tse=j2(u2);function q4(n,e,t){if(!n)return;if(t(n)===!0)return n;let i=e?n.return:n.child;for(;i;){const r=q4(i,e,t);if(r)return r;i=e?null:i.sibling}}function pz(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const X4=pz(X.createContext(null));let mz=class extends X.Component{render(){return X.createElement(X4.Provider,{value:this._reactInternals},this.props.children)}};function gz(){const n=X.useContext(X4);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=X.useId();return X.useMemo(()=>{for(const t of[n,n?.alternate]){if(!t)continue;const i=q4(t,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(i)return i}},[n,e])}const nse=Symbol.for("react.context"),ise=n=>n!==null&&typeof n=="object"&&"$$typeof"in n&&n.$$typeof===nse;function rse(){const n=gz(),[e]=X.useState(()=>new Map);e.clear();let t=n;for(;t;){const i=t.type;ise(i)&&i!==X4&&!e.has(i)&&e.set(i,X.use(pz(i))),t=t.return}return e}function sse(){const n=rse();return X.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>i=>X.createElement(e,null,X.createElement(t.Provider,{...i,value:n.get(t)})),e=>X.createElement(mz,{...e})),[n])}function Az(n){let e=n.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const vz=n=>n&&n.isOrthographicCamera,ase=n=>n&&n.hasOwnProperty("current"),ose=n=>n!=null&&(typeof n=="string"||typeof n=="number"||n.isColor),cx=((n,e)=>typeof window<"u"&&(((n=window.document)==null?void 0:n.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?X.useLayoutEffect:X.useEffect;function Y4(n){const e=X.useRef(n);return cx(()=>{e.current=n},[n]),e}function lse(){const n=gz(),e=sse();return X.useMemo(()=>({children:t})=>{const r=!!q4(n,!0,s=>s.type===X.StrictMode)?X.StrictMode:X.Fragment;return D.jsx(r,{children:D.jsx(e,{children:t})})},[n,e])}function cse({set:n}){return cx(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}const use=(n=>(n=class extends X.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},n.getDerivedStateFromError=()=>({error:!0}),n))();function yz(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}function JA(n){var e;return(e=n.__r3f)==null?void 0:e.root.getState()}const wr={obj:n=>n===Object(n)&&!wr.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,nul:n=>n===null,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:i="reference",strict:r=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(wr.str(n)||wr.num(n)||wr.boo(n))return n===e;const s=wr.obj(n);if(s&&i==="reference")return n===e;const a=wr.arr(n);if(a&&t==="reference")return n===e;if((a||s)&&n===e)return!0;let o;for(o in n)if(!(o in e))return!1;if(s&&t==="shallow"&&i==="shallow"){for(o in r?e:n)if(!wr.equ(n[o],e[o],{strict:r,objects:"reference"}))return!1}else for(o in r?e:n)if(n[o]!==e[o])return!1;if(wr.und(o)){if(a&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function hse(n){const e={nodes:{},materials:{},meshes:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function fse(n){n.type!=="Scene"&&(n.dispose==null||n.dispose());for(const e in n){const t=n[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const bz=["children","key","ref"];function dse(n){const e={};for(const t in n)bz.includes(t)||(e[t]=n[t]);return e}function qw(n,e,t,i){const r=n;let s=r?.__r3f;return s||(s={root:e,type:t,parent:null,children:[],props:dse(i),object:r,eventCount:0,handlers:{},isHidden:!1},r&&(r.__r3f=s)),s}function Pb(n,e){if(!e.includes("-"))return{root:n,key:e,target:n[e]};if(e in n)return{root:n,key:e,target:n[e]};let t=n;const i=e.split("-");for(const r of i){if(typeof t!="object"||t===null){if(t!==void 0){const s=i.slice(i.indexOf(r)).join("-");return{root:t,key:s,target:void 0}}return{root:n,key:e,target:void 0}}e=r,n=t,t=t[e]}return{root:n,key:e,target:t}}const HP=/-\d+$/;function Xw(n,e){if(wr.str(e.props.attach)){if(HP.test(e.props.attach)){const r=e.props.attach.replace(HP,""),{root:s,key:a}=Pb(n.object,r);Array.isArray(s[a])||(s[a]=[])}const{root:t,key:i}=Pb(n.object,e.props.attach);e.previousAttach=t[i],t[i]=e.object}else wr.fun(e.props.attach)&&(e.previousAttach=e.props.attach(n.object,e.object))}function Yw(n,e){if(wr.str(e.props.attach)){const{root:t,key:i}=Pb(n.object,e.props.attach),r=e.previousAttach;r===void 0?delete t[i]:t[i]=r}else e.previousAttach==null||e.previousAttach(n.object,e.object);delete e.previousAttach}const h2=[...bz,"args","dispose","attach","object","onUpdate","dispose"],QP=new Map;function pse(n){let e=QP.get(n.constructor);try{e||(e=new n.constructor,QP.set(n.constructor,e))}catch{}return e}function mse(n,e){const t={};for(const i in e)if(!h2.includes(i)&&!wr.equ(e[i],n.props[i])){t[i]=e[i];for(const r in e)r.startsWith(`${i}-`)&&(t[r]=e[r])}for(const i in n.props){if(h2.includes(i)||e.hasOwnProperty(i))continue;const{root:r,key:s}=Pb(n.object,i);if(r.constructor&&r.constructor.length===0){const a=pse(r);wr.und(a)||(t[s]=a[s])}else t[s]=0}return t}const gse=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],Ase=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function ju(n,e){var t;const i=n.__r3f,r=i&&Az(i).getState(),s=i?.eventCount;for(const o in e){let c=e[o];if(h2.includes(o))continue;if(i&&Ase.test(o)){typeof c=="function"?i.handlers[o]=c:delete i.handlers[o],i.eventCount=Object.keys(i.handlers).length;continue}if(c===void 0)continue;let{root:h,key:p,target:g}=Pb(n,o);if(g===void 0&&(typeof h!="object"||h===null))throw Error(`R3F: Cannot set "${o}". Ensure it is an object before setting "${p}".`);if(g instanceof L0&&c instanceof L0)g.mask=c.mask;else if(g instanceof Mt&&ose(c))g.set(c);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&typeof g.copy=="function"&&c!=null&&c.constructor&&g.constructor===c.constructor)g.copy(c);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&Array.isArray(c))typeof g.fromArray=="function"?g.fromArray(c):g.set(...c);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&typeof c=="number")typeof g.setScalar=="function"?g.setScalar(c):g.set(c);else{var a;h[p]=c,r&&!r.linear&&gse.includes(p)&&(a=h[p])!=null&&a.isTexture&&h[p].format===Fi&&h[p].type===xn&&(h[p].colorSpace=xi)}}if(i!=null&&i.parent&&r!=null&&r.internal&&(t=i.object)!=null&&t.isObject3D&&s!==i.eventCount){const o=i.object,c=r.internal.interaction.indexOf(o);c>-1&&r.internal.interaction.splice(c,1),i.eventCount&&o.raycast!==null&&r.internal.interaction.push(o)}return i&&i.props.attach===void 0&&(i.object.isBufferGeometry?i.props.attach="geometry":i.object.isMaterial&&(i.props.attach="material")),i&&pv(i),n}function pv(n){var e;if(!n.parent)return;n.props.onUpdate==null||n.props.onUpdate(n.object);const t=(e=n.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function xz(n,e){n.manual||(vz(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix())}const so=n=>n?.isObject3D;function bE(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function _z(n,e,t,i){const r=t.get(e);r&&(t.delete(e),t.size===0&&(n.delete(i),r.target.releasePointerCapture(i)))}function vse(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(i=>i!==e),t.initialHits=t.initialHits.filter(i=>i!==e),t.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((i,r)=>{_z(t.capturedMap,e,i,r)})}function yse(n){function e(c){const{internal:h}=n.getState(),p=c.offsetX-h.initialClick[0],g=c.offsetY-h.initialClick[1];return Math.round(Math.sqrt(p*p+g*g))}function t(c){return c.filter(h=>["Move","Over","Enter","Out","Leave"].some(p=>{var g;return(g=h.__r3f)==null?void 0:g.handlers["onPointer"+p]}))}function i(c,h){const p=n.getState(),g=new Set,A=[],v=h?h(p.internal.interaction):p.internal.interaction;for(let E=0;E<v.length;E++){const C=JA(v[E]);C&&(C.raycaster.camera=void 0)}p.previousRoot||p.events.compute==null||p.events.compute(c,p);function x(E){const C=JA(E);if(!C||!C.events.enabled||C.raycaster.camera===null)return[];if(C.raycaster.camera===void 0){var T;C.events.compute==null||C.events.compute(c,C,(T=C.previousRoot)==null?void 0:T.getState()),C.raycaster.camera===void 0&&(C.raycaster.camera=null)}return C.raycaster.camera?C.raycaster.intersectObject(E,!0):[]}let S=v.flatMap(x).sort((E,C)=>{const T=JA(E.object),R=JA(C.object);return!T||!R?E.distance-C.distance:R.events.priority-T.events.priority||E.distance-C.distance}).filter(E=>{const C=bE(E);return g.has(C)?!1:(g.add(C),!0)});p.events.filter&&(S=p.events.filter(S,p));for(const E of S){let C=E.object;for(;C;){var _;(_=C.__r3f)!=null&&_.eventCount&&A.push({...E,eventObject:C}),C=C.parent}}if("pointerId"in c&&p.internal.capturedMap.has(c.pointerId))for(let E of p.internal.capturedMap.get(c.pointerId).values())g.has(bE(E.intersection))||A.push(E.intersection);return A}function r(c,h,p,g){if(c.length){const A={stopped:!1};for(const v of c){let x=JA(v.object);if(x||v.object.traverseAncestors(S=>{const _=JA(S);if(_)return x=_,!1}),x){const{raycaster:S,pointer:_,camera:E,internal:C}=x,T=new ee(_.x,_.y,0).unproject(E),R=L=>{var P,W;return(P=(W=C.capturedMap.get(L))==null?void 0:W.has(v.eventObject))!=null?P:!1},B=L=>{const P={intersection:v,target:h.target};C.capturedMap.has(L)?C.capturedMap.get(L).set(v.eventObject,P):C.capturedMap.set(L,new Map([[v.eventObject,P]])),h.target.setPointerCapture(L)},U=L=>{const P=C.capturedMap.get(L);P&&_z(C.capturedMap,v.eventObject,P,L)};let O={};for(let L in h){let P=h[L];typeof P!="function"&&(O[L]=P)}let F={...v,...O,pointer:_,intersections:c,stopped:A.stopped,delta:p,unprojectedPoint:T,ray:S.ray,camera:E,stopPropagation(){const L="pointerId"in h&&C.capturedMap.get(h.pointerId);if((!L||L.has(v.eventObject))&&(F.stopped=A.stopped=!0,C.hovered.size&&Array.from(C.hovered.values()).find(P=>P.eventObject===v.eventObject))){const P=c.slice(0,c.indexOf(v));s([...P,v])}},target:{hasPointerCapture:R,setPointerCapture:B,releasePointerCapture:U},currentTarget:{hasPointerCapture:R,setPointerCapture:B,releasePointerCapture:U},nativeEvent:h};if(g(F),A.stopped===!0)break}}}return c}function s(c){const{internal:h}=n.getState();for(const p of h.hovered.values())if(!c.length||!c.find(g=>g.object===p.object&&g.index===p.index&&g.instanceId===p.instanceId)){const A=p.eventObject.__r3f;if(h.hovered.delete(bE(p)),A!=null&&A.eventCount){const v=A.handlers,x={...p,intersections:c};v.onPointerOut==null||v.onPointerOut(x),v.onPointerLeave==null||v.onPointerLeave(x)}}}function a(c,h){for(let p=0;p<h.length;p++){const g=h[p].__r3f;g==null||g.handlers.onPointerMissed==null||g.handlers.onPointerMissed(c)}}function o(c){switch(c){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return h=>{const{internal:p}=n.getState();"pointerId"in h&&p.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{p.capturedMap.has(h.pointerId)&&(p.capturedMap.delete(h.pointerId),s([]))})}}return function(p){const{onPointerMissed:g,internal:A}=n.getState();A.lastEvent.current=p;const v=c==="onPointerMove",x=c==="onClick"||c==="onContextMenu"||c==="onDoubleClick",_=i(p,v?t:void 0),E=x?e(p):0;c==="onPointerDown"&&(A.initialClick=[p.offsetX,p.offsetY],A.initialHits=_.map(T=>T.eventObject)),x&&!_.length&&E<=2&&(a(p,A.interaction),g&&g(p)),v&&s(_);function C(T){const R=T.eventObject,B=R.__r3f;if(!(B!=null&&B.eventCount))return;const U=B.handlers;if(v){if(U.onPointerOver||U.onPointerEnter||U.onPointerOut||U.onPointerLeave){const O=bE(T),F=A.hovered.get(O);F?F.stopped&&T.stopPropagation():(A.hovered.set(O,T),U.onPointerOver==null||U.onPointerOver(T),U.onPointerEnter==null||U.onPointerEnter(T))}U.onPointerMove==null||U.onPointerMove(T)}else{const O=U[c];O?(!x||A.initialHits.includes(R))&&(a(p,A.interaction.filter(F=>!A.initialHits.includes(F))),O(T)):x&&A.initialHits.includes(R)&&a(p,A.interaction.filter(F=>!A.initialHits.includes(F)))}}r(_,p,E,C)}}return{handlePointer:o}}const VP=n=>!!(n!=null&&n.render),ux=X.createContext(null),bse=(n,e)=>{const t=hz((o,c)=>{const h=new ee,p=new ee,g=new ee;function A(E=c().camera,C=p,T=c().size){const{width:R,height:B,top:U,left:O}=T,F=R/B;C.isVector3?g.copy(C):g.set(...C);const L=E.getWorldPosition(h).distanceTo(g);if(vz(E))return{width:R/E.zoom,height:B/E.zoom,top:U,left:O,factor:1,distance:L,aspect:F};{const P=E.fov*Math.PI/180,W=2*Math.tan(P/2)*L,j=W*(R/B);return{width:j,height:W,top:U,left:O,factor:R/j,distance:L,aspect:F}}}let v;const x=E=>o(C=>({performance:{...C.performance,current:E}})),S=new Ze;return{set:o,get:c,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(E=1)=>n(c(),E),advance:(E,C)=>e(E,C,c()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new B4,pointer:S,mouse:S,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const E=c();v&&clearTimeout(v),E.performance.current!==E.performance.min&&x(E.performance.min),v=setTimeout(()=>x(c().performance.max),E.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:A},setEvents:E=>o(C=>({...C,events:{...C.events,...E}})),setSize:(E,C,T=0,R=0)=>{const B=c().camera,U={width:E,height:C,top:T,left:R};o(O=>({size:U,viewport:{...O.viewport,...A(B,p,U)}}))},setDpr:E=>o(C=>{const T=yz(E);return{viewport:{...C.viewport,dpr:T,initialDpr:C.viewport.initialDpr||T}}}),setFrameloop:(E="always")=>{const C=c().clock;C.stop(),C.elapsedTime=0,E!=="never"&&(C.start(),C.elapsedTime=0),o(()=>({frameloop:E}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:X.createRef(),active:!1,frames:0,priority:0,subscribe:(E,C,T)=>{const R=c().internal;return R.priority=R.priority+(C>0?1:0),R.subscribers.push({ref:E,priority:C,store:T}),R.subscribers=R.subscribers.sort((B,U)=>B.priority-U.priority),()=>{const B=c().internal;B!=null&&B.subscribers&&(B.priority=B.priority-(C>0?1:0),B.subscribers=B.subscribers.filter(U=>U.ref!==E))}}}}}),i=t.getState();let r=i.size,s=i.viewport.dpr,a=i.camera;return t.subscribe(()=>{const{camera:o,size:c,viewport:h,gl:p,set:g}=t.getState();if(c.width!==r.width||c.height!==r.height||h.dpr!==s){r=c,s=h.dpr,xz(o,c),h.dpr>0&&p.setPixelRatio(h.dpr);const A=typeof HTMLCanvasElement<"u"&&p.domElement instanceof HTMLCanvasElement;p.setSize(c.width,c.height,A)}o!==a&&(a=o,g(A=>({viewport:{...A.viewport,...A.viewport.getCurrentViewport(o)}})))}),t.subscribe(o=>n(o)),t};function ih(){const n=X.useContext(ux);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function dl(n=t=>t,e){return ih()(n,e)}function Gi(n,e=0){const t=ih(),i=t.getState().internal.subscribe,r=Y4(n);return cx(()=>i(r,e,t),[e,i,t]),null}const jP=new WeakMap,xse=n=>{var e;return typeof n=="function"&&(n==null||(e=n.prototype)==null?void 0:e.constructor)===n};function Sz(n,e){return function(t,...i){let r;return xse(t)?(r=jP.get(t),r||(r=new t,jP.set(t,r))):r=t,n&&n(r),Promise.all(i.map(s=>new Promise((a,o)=>r.load(s,c=>{so(c?.scene)&&Object.assign(c,hse(c.scene)),a(c)},e,c=>o(new Error(`Could not load ${s}: ${c?.message}`))))))}}function Zm(n,e,t,i){const r=Array.isArray(e)?e:[e],s=W4(Sz(t,i),[n,...r],{equal:wr.equ});return Array.isArray(e)?s:s[0]}Zm.preload=function(n,e,t){const i=Array.isArray(e)?e:[e];return Zre(Sz(t),[n,...i])};Zm.clear=function(n,e){const t=Array.isArray(e)?e:[e];return ese([n,...t])};const _se=1,Sse=8,Ese=32,wse=2;var Mse={version:"9.5.0"};function Cse(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var WP={exports:{}},qP={exports:{}},XP;function Tse(){return XP||(XP=1,(function(n){n.exports=function(e){function t(f,d,b,w){return new qv(f,d,b,w)}function i(){}function r(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)d+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(f){var d=f,b=f;if(f.alternate)for(;d.return;)d=d.return;else{f=d;do d=f,(d.flags&4098)!==0&&(b=d.return),f=d.return;while(f)}return d.tag===3?b:null}function a(f){if(s(f)!==f)throw Error(r(188))}function o(f){var d=f.alternate;if(!d){if(d=s(f),d===null)throw Error(r(188));return d!==f?null:f}for(var b=f,w=d;;){var N=b.return;if(N===null)break;var k=N.alternate;if(k===null){if(w=N.return,w!==null){b=w;continue}break}if(N.child===k.child){for(k=N.child;k;){if(k===b)return a(N),f;if(k===w)return a(N),d;k=k.sibling}throw Error(r(188))}if(b.return!==w.return)b=N,w=k;else{for(var te=!1,ye=N.child;ye;){if(ye===b){te=!0,b=N,w=k;break}if(ye===w){te=!0,w=N,b=k;break}ye=ye.sibling}if(!te){for(ye=k.child;ye;){if(ye===b){te=!0,b=k,w=N;break}if(ye===w){te=!0,w=k,b=N;break}ye=ye.sibling}if(!te)throw Error(r(189))}}if(b.alternate!==w)throw Error(r(190))}if(b.tag!==3)throw Error(r(188));return b.stateNode.current===b?f:d}function c(f){var d=f.tag;if(d===5||d===26||d===27||d===6)return f;for(f=f.child;f!==null;){if(d=c(f),d!==null)return d;f=f.sibling}return null}function h(f){var d=f.tag;if(d===5||d===26||d===27||d===6)return f;for(f=f.child;f!==null;){if(f.tag!==4&&(d=h(f),d!==null))return d;f=f.sibling}return null}function p(f){return f===null||typeof f!="object"?null:(f=Ec&&f[Ec]||f["@@iterator"],typeof f=="function"?f:null)}function g(f){if(f==null)return null;if(typeof f=="function")return f.$$typeof===vu?null:f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case Eh:return"Fragment";case Mh:return"Profiler";case wh:return"StrictMode";case Ng:return"Suspense";case Sc:return"SuspenseList";case yp:return"Activity"}if(typeof f=="object")switch(f.$$typeof){case Sh:return"Portal";case yo:return f.displayName||"Context";case vp:return(f._context.displayName||"Context")+".Consumer";case zf:var d=f.render;return f=f.displayName,f||(f=d.displayName||d.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case Ug:return d=f.displayName||null,d!==null?d:g(f.type)||"Memo";case ca:d=f._payload,f=f._init;try{return g(f(d))}catch{}}return null}function A(f){return{current:f}}function v(f){0>Bh||(f.current=Xg[Bh],Xg[Bh]=null,Bh--)}function x(f,d){Bh++,Xg[Bh]=f.current,f.current=d}function S(f){return f>>>=0,f===0?32:31-(Yg(f)/U_|0)|0}function _(f){var d=f&42;if(d!==0)return d;switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return f&261888;case 262144:case 524288:case 1048576:case 2097152:return f&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return f&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return f}}function E(f,d,b){var w=f.pendingLanes;if(w===0)return 0;var N=0,k=f.suspendedLanes,te=f.pingedLanes;f=f.warmLanes;var ye=w&134217727;return ye!==0?(w=ye&~k,w!==0?N=_(w):(te&=ye,te!==0?N=_(te):b||(b=ye&~f,b!==0&&(N=_(b))))):(ye=w&~k,ye!==0?N=_(ye):te!==0?N=_(te):b||(b=w&~f,b!==0&&(N=_(b)))),N===0?0:d!==0&&d!==N&&(d&k)===0&&(k=N&-N,b=d&-d,k>=b||k===32&&(b&4194048)!==0)?d:N}function C(f,d){return(f.pendingLanes&~(f.suspendedLanes&~f.pingedLanes)&d)===0}function T(f,d){switch(f){case 1:case 2:case 4:case 8:case 64:return d+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function R(){var f=qf;return qf<<=1,(qf&62914560)===0&&(qf=4194304),f}function B(f){for(var d=[],b=0;31>b;b++)d.push(f);return d}function U(f,d){f.pendingLanes|=d,d!==268435456&&(f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0)}function O(f,d,b,w,N,k){var te=f.pendingLanes;f.pendingLanes=b,f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0,f.expiredLanes&=b,f.entangledLanes&=b,f.errorRecoveryDisabledLanes&=b,f.shellSuspendCounter=0;var ye=f.entanglements,Ke=f.expirationTimes,vt=f.hiddenUpdates;for(b=te&~b;0<b;){var Pt=31-Ca(b),Et=1<<Pt;ye[Pt]=0,Ke[Pt]=-1;var Xt=vt[Pt];if(Xt!==null)for(vt[Pt]=null,Pt=0;Pt<Xt.length;Pt++){var Bn=Xt[Pt];Bn!==null&&(Bn.lane&=-536870913)}b&=~Et}w!==0&&F(f,w,0),k!==0&&N===0&&f.tag!==0&&(f.suspendedLanes|=k&~(te&~d))}function F(f,d,b){f.pendingLanes|=d,f.suspendedLanes&=~d;var w=31-Ca(d);f.entangledLanes|=d,f.entanglements[w]=f.entanglements[w]|1073741824|b&261930}function L(f,d){var b=f.entangledLanes|=d;for(f=f.entanglements;b;){var w=31-Ca(b),N=1<<w;N&d|f[w]&d&&(f[w]|=d),b&=~N}}function P(f,d){var b=d&-d;return b=(b&42)!==0?1:W(b),(b&(f.suspendedLanes|d))!==0?0:b}function W(f){switch(f){case 2:f=1;break;case 8:f=4;break;case 32:f=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:f=128;break;case 268435456:f=134217728;break;default:f=0}return f}function j(f){return f&=-f,2<f?8<f?(f&134217727)!==0?32:268435456:8:2}function V(f){if(typeof Dy=="function"&&O_(f),Ta&&typeof Ta.setStrictMode=="function")try{Ta.setStrictMode(Lh,f)}catch{}}function q(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}function re(f){if(tA===void 0)try{throw Error()}catch(b){var d=b.stack.trim().match(/\n( *(at )?)/);tA=d&&d[1]||"",zl=-1<b.stack.indexOf(`
    at`)?" (<anonymous>)":-1<b.stack.indexOf("@")?"@unknown:0:0":""}return`
`+tA+f+zl}function Q(f,d){if(!f||Tp)return"";Tp=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(d){var Et=function(){throw Error()};if(Object.defineProperty(Et.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Et,[])}catch(Bn){var Xt=Bn}Reflect.construct(f,[],Et)}else{try{Et.call()}catch(Bn){Xt=Bn}f.call(Et.prototype)}}else{try{throw Error()}catch(Bn){Xt=Bn}(Et=f())&&typeof Et.catch=="function"&&Et.catch(function(){})}}catch(Bn){if(Bn&&Xt&&typeof Bn.stack=="string")return[Bn.stack,Xt.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=w.DetermineComponentFrameRoot(),te=k[0],ye=k[1];if(te&&ye){var Ke=te.split(`
`),vt=ye.split(`
`);for(N=w=0;w<Ke.length&&!Ke[w].includes("DetermineComponentFrameRoot");)w++;for(;N<vt.length&&!vt[N].includes("DetermineComponentFrameRoot");)N++;if(w===Ke.length||N===vt.length)for(w=Ke.length-1,N=vt.length-1;1<=w&&0<=N&&Ke[w]!==vt[N];)N--;for(;1<=w&&0<=N;w--,N--)if(Ke[w]!==vt[N]){if(w!==1||N!==1)do if(w--,N--,0>N||Ke[w]!==vt[N]){var Pt=`
`+Ke[w].replace(" at new "," at ");return f.displayName&&Pt.includes("<anonymous>")&&(Pt=Pt.replace("<anonymous>",f.displayName)),Pt}while(1<=w&&0<=N);break}}}finally{Tp=!1,Error.prepareStackTrace=b}return(b=f?f.displayName||f.name:"")?re(b):""}function K(f,d){switch(f.tag){case 26:case 27:case 5:return re(f.type);case 16:return re("Lazy");case 13:return f.child!==d&&d!==null?re("Suspense Fallback"):re("Suspense");case 19:return re("SuspenseList");case 0:case 15:return Q(f.type,!1);case 11:return Q(f.type.render,!1);case 1:return Q(f.type,!0);case 31:return re("Activity");default:return""}}function ce(f){try{var d="",b=null;do d+=K(f,b),b=f,f=f.return;while(f);return d}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}function ue(f,d){if(typeof f=="object"&&f!==null){var b=Ly.get(f);return b!==void 0?b:(d={value:f,source:d,stack:ce(d)},Ly.set(f,d),d)}return{value:f,source:d,stack:ce(d)}}function oe(f,d){Cc[Gl++]=Ip,Cc[Gl++]=Li,Li=f,Ip=d}function z(f,d,b){_o[Xa++]=Ts,_o[Xa++]=qo,_o[Xa++]=So,So=f;var w=Ts;f=qo;var N=32-Ca(w)-1;w&=~(1<<N),b+=1;var k=32-Ca(d)+N;if(30<k){var te=N-N%5;k=(w&(1<<te)-1).toString(32),w>>=te,N-=te,Ts=1<<32-Ca(d)+N|b<<N|w,qo=k+f}else Ts=1<<k|b<<N|w,qo=f}function $(f){f.return!==null&&(oe(f,1),z(f,1,0))}function ae(f){for(;f===Li;)Li=Cc[--Gl],Cc[Gl]=null,Ip=Cc[--Gl],Cc[Gl]=null;for(;f===So;)So=_o[--Xa],_o[Xa]=null,qo=_o[--Xa],_o[Xa]=null,Ts=_o[--Xa],_o[Xa]=null}function he(f,d){_o[Xa++]=Ts,_o[Xa++]=qo,_o[Xa++]=So,Ts=d.id,qo=d.overflow,So=f}function me(f,d){x(Is,d),x(Tc,f),x(vs,null),f=$x(d),v(vs),x(vs,f)}function le(){v(vs),v(Tc),v(Is)}function fe(f){f.memoizedState!==null&&x(Rp,f);var d=vs.current,b=Qf(d,f.type);d!==b&&(x(Tc,f),x(vs,b))}function _e(f){Tc.current===f&&(v(vs),v(Tc)),Rp.current===f&&(v(Rp),Lr?Ih._currentValue=Th:Ih._currentValue2=Th)}function Pe(f){var d=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Le(ue(d,f)),nA}function et(f,d){if(!nr)throw Error(r(175));S_(f.stateNode,f.type,f.memoizedProps,d,f)||Pe(f,!0)}function ot(f){for(ss=f.return;ss;)switch(ss.tag){case 5:case 31:case 13:ha=!1;return;case 27:case 3:ha=!0;return;default:ss=ss.return}}function Je(f){if(!nr||f!==ss)return!1;if(!Xn)return ot(f),Xn=!0,!1;var d=f.tag;if(rs?d!==3&&d!==27&&(d!==5||Wf(f.type)&&!ua(f.type,f.memoizedProps))&&ir&&Pe(f):d!==3&&(d!==5||Wf(f.type)&&!ua(f.type,f.memoizedProps))&&ir&&Pe(f),ot(f),d===13){if(!nr)throw Error(r(316));if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));ir=xy(f)}else if(d===31){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));ir=w_(f)}else ir=rs&&d===27?m_(f.type,ir):ss?p_(f.stateNode):null;return!0}function _t(){nr&&(ir=ss=null,Xn=!1)}function Be(){var f=Hl;return f!==null&&(Ba===null?Ba=f:Ba.push.apply(Ba,f),Hl=null),f}function Le(f){Hl===null?Hl=[f]:Hl.push(f)}function Te(f,d,b){Lr?(x(Eo,d._currentValue),d._currentValue=b):(x(Eo,d._currentValue2),d._currentValue2=b)}function Ye(f){var d=Eo.current;Lr?f._currentValue=d:f._currentValue2=d,v(Eo)}function ne(f,d,b){for(;f!==null;){var w=f.alternate;if((f.childLanes&d)!==d?(f.childLanes|=d,w!==null&&(w.childLanes|=d)):w!==null&&(w.childLanes&d)!==d&&(w.childLanes|=d),f===b)break;f=f.return}}function ft(f,d,b,w){var N=f.child;for(N!==null&&(N.return=f);N!==null;){var k=N.dependencies;if(k!==null){var te=N.child;k=k.firstContext;e:for(;k!==null;){var ye=k;k=N;for(var Ke=0;Ke<d.length;Ke++)if(ye.context===d[Ke]){k.lanes|=b,ye=k.alternate,ye!==null&&(ye.lanes|=b),ne(k.return,b,f),w||(te=null);break e}k=ye.next}}else if(N.tag===18){if(te=N.return,te===null)throw Error(r(341));te.lanes|=b,k=te.alternate,k!==null&&(k.lanes|=b),ne(te,b,f),te=null}else te=N.child;if(te!==null)te.return=N;else for(te=N;te!==null;){if(te===f){te=null;break}if(N=te.sibling,N!==null){N.return=te.return,te=N;break}te=te.return}N=te}}function qe(f,d,b,w){f=null;for(var N=d,k=!1;N!==null;){if(!k){if((N.flags&524288)!==0)k=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var te=N.alternate;if(te===null)throw Error(r(387));if(te=te.memoizedProps,te!==null){var ye=N.type;Ur(N.pendingProps.value,te.value)||(f!==null?f.push(ye):f=[ye])}}else if(N===Rp.current){if(te=N.alternate,te===null)throw Error(r(387));te.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(f!==null?f.push(Ih):f=[Ih])}N=N.return}f!==null&&ft(d,f,b,w),d.flags|=262144}function Ne(f){for(f=f.firstContext;f!==null;){var d=f.context;if(!Ur(Lr?d._currentValue:d._currentValue2,f.memoizedValue))return!0;f=f.next}return!1}function tt(f){Vi=f,Xo=null,f=f.dependencies,f!==null&&(f.firstContext=null)}function Z(f){return de(Vi,f)}function H(f,d){return Vi===null&&tt(f),de(f,d)}function de(f,d){var b=Lr?d._currentValue:d._currentValue2;if(d={context:d,memoizedValue:b,next:null},Xo===null){if(f===null)throw Error(r(308));Xo=d,f.dependencies={lanes:0,firstContext:d},f.flags|=524288}else Xo=Xo.next=d;return b}function De(){return{controller:new k_,data:new Map,refCount:0}}function Ie(f){f.refCount--,f.refCount===0&&ys($C,function(){f.controller.abort()})}function we(){}function st(f){f!==Ei&&f.next===null&&(Ei===null?Bp=Ei=f:Ei=Ei.next=f),wo=!0,Ws||(Ws=!0,bt())}function it(f,d){if(!iA&&wo){iA=!0;do for(var b=!1,w=Bp;w!==null;){if(f!==0){var N=w.pendingLanes;if(N===0)var k=0;else{var te=w.suspendedLanes,ye=w.pingedLanes;k=(1<<31-Ca(42|f)+1)-1,k&=N&~(te&~ye),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(b=!0,at(w,k))}else k=Yn,k=E(w,w===On?k:0,w.cancelPendingCommit!==null||w.timeoutHandle!==Ma),(k&3)===0||C(w,k)||(b=!0,at(w,k));w=w.next}while(b);iA=!1}}function It(){Ot()}function Ot(){wo=Ws=!1;var f=0;Su!==0&&Ch()&&(f=Su);for(var d=js(),b=null,w=Bp;w!==null;){var N=w.next,k=Qe(w,d);k===0?(w.next=null,b===null?Bp=N:b.next=N,N===null&&(Ei=b)):(b=w,(f!==0||(k&3)!==0)&&(wo=!0)),w=N}Jr!==0&&Jr!==5||it(f),Su!==0&&(Su=0)}function Qe(f,d){for(var b=f.suspendedLanes,w=f.pingedLanes,N=f.expirationTimes,k=f.pendingLanes&-62914561;0<k;){var te=31-Ca(k),ye=1<<te,Ke=N[te];Ke===-1?((ye&b)===0||(ye&w)!==0)&&(N[te]=T(ye,d)):Ke<=d&&(f.expiredLanes|=ye),k&=~ye}if(d=On,b=Yn,b=E(f,f===d?b:0,f.cancelPendingCommit!==null||f.timeoutHandle!==Ma),w=f.callbackNode,b===0||f===d&&(Mi===2||Mi===9)||f.cancelPendingCommit!==null)return w!==null&&w!==null&&$g(w),f.callbackNode=null,f.callbackPriority=0;if((b&3)===0||C(f,b)){if(d=b&-b,d===f.callbackPriority)return d;switch(w!==null&&$g(w),j(b)){case 2:case 8:b=P_;break;case 32:b=Cp;break;case 268435456:b=Zg;break;default:b=Cp}return w=Ve.bind(null,f),b=Mp(b,w),f.callbackPriority=d,f.callbackNode=b,d}return w!==null&&w!==null&&$g(w),f.callbackPriority=2,f.callbackNode=null,2}function Ve(f,d){if(Jr!==0&&Jr!==5)return f.callbackNode=null,f.callbackPriority=0,null;var b=f.callbackNode;if(Pl()&&f.callbackNode!==b)return null;var w=Yn;return w=E(f,f===On?w:0,f.cancelPendingCommit!==null||f.timeoutHandle!==Ma),w===0?null:(Wo(f,w,d),Qe(f,js()),f.callbackNode!=null&&f.callbackNode===b?Ve.bind(null,f):null)}function at(f,d){if(Pl())return null;Wo(f,d,!0)}function bt(){sy?ay(function(){(Qn&6)!==0?Mp(Jg,It):Ot()}):Mp(Jg,It)}function ht(){if(Su===0){var f=Ic;f===0&&(f=Kg,Kg<<=1,(Kg&261888)===0&&(Kg=256)),Su=f}return Su}function Vt(f,d){if(Xf===null){var b=Xf=[];Ny=0,Ic=ht(),as={status:"pending",value:void 0,then:function(w){b.push(w)}}}return Ny++,d.then(ve,ve),d}function ve(){if(--Ny===0&&Xf!==null){as!==null&&(as.status="fulfilled");var f=Xf;Xf=null,Ic=0,as=null;for(var d=0;d<f.length;d++)(0,f[d])()}}function Me(f,d){var b=[],w={status:"pending",value:null,reason:null,then:function(N){b.push(N)}};return f.then(function(){w.status="fulfilled",w.value=d;for(var N=0;N<b.length;N++)(0,b[N])(d)},function(N){for(w.status="rejected",w.reason=N,N=0;N<b.length;N++)(0,b[N])(void 0)}),w}function rt(){var f=Eu.current;return f!==null?f:On.pooledCache}function Ut(f,d){d===null?x(Eu,Eu.current):x(Eu,d.pool)}function nt(){var f=rt();return f===null?null:{parent:Lr?rr._currentValue:rr._currentValue2,pool:f}}function ke(f,d){if(Ur(f,d))return!0;if(typeof f!="object"||f===null||typeof d!="object"||d===null)return!1;var b=Object.keys(f),w=Object.keys(d);if(b.length!==w.length)return!1;for(w=0;w<b.length;w++){var N=b[w];if(!KC.call(d,N)||!Ur(f[N],d[N]))return!1}return!0}function gt(f){return f=f.status,f==="fulfilled"||f==="rejected"}function Qt(f,d,b){switch(b=f[b],b===void 0?f.push(d):b!==d&&(d.then(we,we),d=b),d.status){case"fulfilled":return d.value;case"rejected":throw f=d.reason,ti(f),f;default:if(typeof d.status=="string")d.then(we,we);else{if(f=On,f!==null&&100<f.shellSuspendCounter)throw Error(r(482));f=d,f.status="pending",f.then(function(w){if(d.status==="pending"){var N=d;N.status="fulfilled",N.value=w}},function(w){if(d.status==="pending"){var N=d;N.status="rejected",N.reason=w}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw f=d.reason,ti(f),f}throw fa=d,os}}function kt(f){try{var d=f._init;return d(f._payload)}catch(b){throw b!==null&&typeof b=="object"&&typeof b.then=="function"?(fa=b,os):b}}function rn(){if(fa===null)throw Error(r(459));var f=fa;return fa=null,f}function ti(f){if(f===os||f===Co)throw Error(r(483))}function ui(f){var d=Nh;return Nh+=1,wu===null&&(wu=[]),Qt(wu,f,d)}function vi(f,d){d=d.props.ref,f.ref=d!==void 0?d:null}function yr(f,d){throw d.$$typeof===_h?Error(r(525)):(f=Object.prototype.toString.call(d),Error(r(31,f==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":f)))}function Ir(f){function d(ze,Re){if(f){var We=ze.deletions;We===null?(ze.deletions=[Re],ze.flags|=16):We.push(Re)}}function b(ze,Re){if(!f)return null;for(;Re!==null;)d(ze,Re),Re=Re.sibling;return null}function w(ze){for(var Re=new Map;ze!==null;)ze.key!==null?Re.set(ze.key,ze):Re.set(ze.index,ze),ze=ze.sibling;return Re}function N(ze,Re){return ze=Wa(ze,Re),ze.index=0,ze.sibling=null,ze}function k(ze,Re,We){return ze.index=We,f?(We=ze.alternate,We!==null?(We=We.index,We<Re?(ze.flags|=67108866,Re):We):(ze.flags|=67108866,Re)):(ze.flags|=1048576,Re)}function te(ze){return f&&ze.alternate===null&&(ze.flags|=67108866),ze}function ye(ze,Re,We,Nt){return Re===null||Re.tag!==6?(Re=Xv(We,ze.mode,Nt),Re.return=ze,Re):(Re=N(Re,We),Re.return=ze,Re)}function Ke(ze,Re,We,Nt){var pn=We.type;return pn===Eh?Pt(ze,Re,We.props.children,Nt,We.key):Re!==null&&(Re.elementType===pn||typeof pn=="object"&&pn!==null&&pn.$$typeof===ca&&kt(pn)===Re.type)?(Re=N(Re,We.props),vi(Re,We),Re.return=ze,Re):(Re=_c(We.type,We.key,We.props,null,ze.mode,Nt),vi(Re,We),Re.return=ze,Re)}function vt(ze,Re,We,Nt){return Re===null||Re.tag!==4||Re.stateNode.containerInfo!==We.containerInfo||Re.stateNode.implementation!==We.implementation?(Re=Kv(We,ze.mode,Nt),Re.return=ze,Re):(Re=N(Re,We.children||[]),Re.return=ze,Re)}function Pt(ze,Re,We,Nt,pn){return Re===null||Re.tag!==7?(Re=vo(We,ze.mode,Nt,pn),Re.return=ze,Re):(Re=N(Re,We),Re.return=ze,Re)}function Et(ze,Re,We){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return Re=Xv(""+Re,ze.mode,We),Re.return=ze,Re;if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case Ol:return We=_c(Re.type,Re.key,Re.props,null,ze.mode,We),vi(We,Re),We.return=ze,We;case Sh:return Re=Kv(Re,ze.mode,We),Re.return=ze,Re;case ca:return Re=kt(Re),Et(ze,Re,We)}if(yu(Re)||p(Re))return Re=vo(Re,ze.mode,We,null),Re.return=ze,Re;if(typeof Re.then=="function")return Et(ze,ui(Re),We);if(Re.$$typeof===yo)return Et(ze,H(ze,Re),We);yr(ze,Re)}return null}function Xt(ze,Re,We,Nt){var pn=Re!==null?Re.key:null;if(typeof We=="string"&&We!==""||typeof We=="number"||typeof We=="bigint")return pn!==null?null:ye(ze,Re,""+We,Nt);if(typeof We=="object"&&We!==null){switch(We.$$typeof){case Ol:return We.key===pn?Ke(ze,Re,We,Nt):null;case Sh:return We.key===pn?vt(ze,Re,We,Nt):null;case ca:return We=kt(We),Xt(ze,Re,We,Nt)}if(yu(We)||p(We))return pn!==null?null:Pt(ze,Re,We,Nt,null);if(typeof We.then=="function")return Xt(ze,Re,ui(We),Nt);if(We.$$typeof===yo)return Xt(ze,Re,H(ze,We),Nt);yr(ze,We)}return null}function Bn(ze,Re,We,Nt,pn){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return ze=ze.get(We)||null,ye(Re,ze,""+Nt,pn);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case Ol:return ze=ze.get(Nt.key===null?We:Nt.key)||null,Ke(Re,ze,Nt,pn);case Sh:return ze=ze.get(Nt.key===null?We:Nt.key)||null,vt(Re,ze,Nt,pn);case ca:return Nt=kt(Nt),Bn(ze,Re,We,Nt,pn)}if(yu(Nt)||p(Nt))return ze=ze.get(We)||null,Pt(Re,ze,Nt,pn,null);if(typeof Nt.then=="function")return Bn(ze,Re,We,ui(Nt),pn);if(Nt.$$typeof===yo)return Bn(ze,Re,We,H(Re,Nt),pn);yr(Re,Nt)}return null}function Or(ze,Re,We,Nt){for(var pn=null,pr=null,gn=Re,oi=Re=0,bs=null;gn!==null&&oi<We.length;oi++){gn.index>oi?(bs=gn,gn=null):bs=gn.sibling;var pi=Xt(ze,gn,We[oi],Nt);if(pi===null){gn===null&&(gn=bs);break}f&&gn&&pi.alternate===null&&d(ze,gn),Re=k(pi,Re,oi),pr===null?pn=pi:pr.sibling=pi,pr=pi,gn=bs}if(oi===We.length)return b(ze,gn),Xn&&oe(ze,oi),pn;if(gn===null){for(;oi<We.length;oi++)gn=Et(ze,We[oi],Nt),gn!==null&&(Re=k(gn,Re,oi),pr===null?pn=gn:pr.sibling=gn,pr=gn);return Xn&&oe(ze,oi),pn}for(gn=w(gn);oi<We.length;oi++)bs=Bn(gn,ze,oi,We[oi],Nt),bs!==null&&(f&&bs.alternate!==null&&gn.delete(bs.key===null?oi:bs.key),Re=k(bs,Re,oi),pr===null?pn=bs:pr.sibling=bs,pr=bs);return f&&gn.forEach(function(Ro){return d(ze,Ro)}),Xn&&oe(ze,oi),pn}function nd(ze,Re,We,Nt){if(We==null)throw Error(r(151));for(var pn=null,pr=null,gn=Re,oi=Re=0,bs=null,pi=We.next();gn!==null&&!pi.done;oi++,pi=We.next()){gn.index>oi?(bs=gn,gn=null):bs=gn.sibling;var Ro=Xt(ze,gn,pi.value,Nt);if(Ro===null){gn===null&&(gn=bs);break}f&&gn&&Ro.alternate===null&&d(ze,gn),Re=k(Ro,Re,oi),pr===null?pn=Ro:pr.sibling=Ro,pr=Ro,gn=bs}if(pi.done)return b(ze,gn),Xn&&oe(ze,oi),pn;if(gn===null){for(;!pi.done;oi++,pi=We.next())pi=Et(ze,pi.value,Nt),pi!==null&&(Re=k(pi,Re,oi),pr===null?pn=pi:pr.sibling=pi,pr=pi);return Xn&&oe(ze,oi),pn}for(gn=w(gn);!pi.done;oi++,pi=We.next())pi=Bn(gn,ze,oi,pi.value,Nt),pi!==null&&(f&&pi.alternate!==null&&gn.delete(pi.key===null?oi:pi.key),Re=k(pi,Re,oi),pr===null?pn=pi:pr.sibling=pi,pr=pi);return f&&gn.forEach(function(JC){return d(ze,JC)}),Xn&&oe(ze,oi),pn}function Lu(ze,Re,We,Nt){if(typeof We=="object"&&We!==null&&We.type===Eh&&We.key===null&&(We=We.props.children),typeof We=="object"&&We!==null){switch(We.$$typeof){case Ol:e:{for(var pn=We.key;Re!==null;){if(Re.key===pn){if(pn=We.type,pn===Eh){if(Re.tag===7){b(ze,Re.sibling),Nt=N(Re,We.props.children),Nt.return=ze,ze=Nt;break e}}else if(Re.elementType===pn||typeof pn=="object"&&pn!==null&&pn.$$typeof===ca&&kt(pn)===Re.type){b(ze,Re.sibling),Nt=N(Re,We.props),vi(Nt,We),Nt.return=ze,ze=Nt;break e}b(ze,Re);break}else d(ze,Re);Re=Re.sibling}We.type===Eh?(Nt=vo(We.props.children,ze.mode,Nt,We.key),Nt.return=ze,ze=Nt):(Nt=_c(We.type,We.key,We.props,null,ze.mode,Nt),vi(Nt,We),Nt.return=ze,ze=Nt)}return te(ze);case Sh:e:{for(pn=We.key;Re!==null;){if(Re.key===pn)if(Re.tag===4&&Re.stateNode.containerInfo===We.containerInfo&&Re.stateNode.implementation===We.implementation){b(ze,Re.sibling),Nt=N(Re,We.children||[]),Nt.return=ze,ze=Nt;break e}else{b(ze,Re);break}else d(ze,Re);Re=Re.sibling}Nt=Kv(We,ze.mode,Nt),Nt.return=ze,ze=Nt}return te(ze);case ca:return We=kt(We),Lu(ze,Re,We,Nt)}if(yu(We))return Or(ze,Re,We,Nt);if(p(We)){if(pn=p(We),typeof pn!="function")throw Error(r(150));return We=pn.call(We),nd(ze,Re,We,Nt)}if(typeof We.then=="function")return Lu(ze,Re,ui(We),Nt);if(We.$$typeof===yo)return Lu(ze,Re,H(ze,We),Nt);yr(ze,We)}return typeof We=="string"&&We!==""||typeof We=="number"||typeof We=="bigint"?(We=""+We,Re!==null&&Re.tag===6?(b(ze,Re.sibling),Nt=N(Re,We),Nt.return=ze,ze=Nt):(b(ze,Re),Nt=Xv(We,ze.mode,Nt),Nt.return=ze,ze=Nt),te(ze)):b(ze,Re)}return function(ze,Re,We,Nt){try{Nh=0;var pn=Lu(ze,Re,We,Nt);return wu=null,pn}catch(gn){if(gn===os||gn===Co)throw gn;var pr=t(29,gn,null,ze.mode);return pr.lanes=Nt,pr.return=ze,pr}}}function qr(){for(var f=Vl,d=Uh=Vl=0;d<f;){var b=Bs[d];Bs[d++]=null;var w=Bs[d];Bs[d++]=null;var N=Bs[d];Bs[d++]=null;var k=Bs[d];if(Bs[d++]=null,w!==null&&N!==null){var te=w.pending;te===null?N.next=N:(N.next=te.next,te.next=N),w.pending=N}k!==0&&di(b,N,k)}}function Ki(f,d,b,w){Bs[Vl++]=f,Bs[Vl++]=d,Bs[Vl++]=b,Bs[Vl++]=w,Uh|=w,f.lanes|=w,f=f.alternate,f!==null&&(f.lanes|=w)}function Rr(f,d,b,w){return Ki(f,d,b,w),hi(f)}function en(f,d){return Ki(f,null,null,d),hi(f)}function di(f,d,b){f.lanes|=b;var w=f.alternate;w!==null&&(w.lanes|=b);for(var N=!1,k=f.return;k!==null;)k.childLanes|=b,w=k.alternate,w!==null&&(w.childLanes|=b),k.tag===22&&(f=k.stateNode,f===null||f._visibility&1||(N=!0)),f=k,k=k.return;return f.tag===3?(k=f.stateNode,N&&d!==null&&(N=31-Ca(b),f=k.hiddenUpdates,w=f[N],w===null?f[N]=[d]:w.push(d),d.lane=b|536870912),k):null}function hi(f){if(50<fi)throw fi=0,Pp=null,Error(r(185));for(var d=f.return;d!==null;)f=d,d=f.return;return f.tag===3?f.stateNode:null}function Y(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function se(f,d){f=f.updateQueue,d.updateQueue===f&&(d.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,callbacks:null})}function ge(f){return{lane:f,tag:0,payload:null,callback:null,next:null}}function Ue(f,d,b){var w=f.updateQueue;if(w===null)return null;if(w=w.shared,(Qn&2)!==0){var N=w.pending;return N===null?d.next=d:(d.next=N.next,N.next=d),w.pending=d,d=hi(f),di(f,null,b),d}return Ki(f,w,d,b),hi(f)}function je(f,d,b){if(d=d.updateQueue,d!==null&&(d=d.shared,(b&4194048)!==0)){var w=d.lanes;w&=f.pendingLanes,b|=w,d.lanes=b,L(f,b)}}function Xe(f,d){var b=f.updateQueue,w=f.alternate;if(w!==null&&(w=w.updateQueue,b===w)){var N=null,k=null;if(b=b.firstBaseUpdate,b!==null){do{var te={lane:b.lane,tag:b.tag,payload:b.payload,callback:null,next:null};k===null?N=k=te:k=k.next=te,b=b.next}while(b!==null);k===null?N=k=d:k=k.next=d}else N=k=d;b={baseState:w.baseState,firstBaseUpdate:N,lastBaseUpdate:k,shared:w.shared,callbacks:w.callbacks},f.updateQueue=b;return}f=b.lastBaseUpdate,f===null?b.firstBaseUpdate=d:f.next=d,b.lastBaseUpdate=d}function xt(){if(sA){var f=as;if(f!==null)throw f}}function At(f,d,b,w){sA=!1;var N=f.updateQueue;Ya=!1;var k=N.firstBaseUpdate,te=N.lastBaseUpdate,ye=N.shared.pending;if(ye!==null){N.shared.pending=null;var Ke=ye,vt=Ke.next;Ke.next=null,te===null?k=vt:te.next=vt,te=Ke;var Pt=f.alternate;Pt!==null&&(Pt=Pt.updateQueue,ye=Pt.lastBaseUpdate,ye!==te&&(ye===null?Pt.firstBaseUpdate=vt:ye.next=vt,Pt.lastBaseUpdate=Ke))}if(k!==null){var Et=N.baseState;te=0,Pt=vt=Ke=null,ye=k;do{var Xt=ye.lane&-536870913,Bn=Xt!==ye.lane;if(Bn?(Yn&Xt)===Xt:(w&Xt)===Xt){Xt!==0&&Xt===Ic&&(sA=!0),Pt!==null&&(Pt=Pt.next={lane:0,tag:ye.tag,payload:ye.payload,callback:null,next:null});e:{var Or=f,nd=ye;Xt=d;var Lu=b;switch(nd.tag){case 1:if(Or=nd.payload,typeof Or=="function"){Et=Or.call(Lu,Et,Xt);break e}Et=Or;break e;case 3:Or.flags=Or.flags&-65537|128;case 0:if(Or=nd.payload,Xt=typeof Or=="function"?Or.call(Lu,Et,Xt):Or,Xt==null)break e;Et=Lg({},Et,Xt);break e;case 2:Ya=!0}}Xt=ye.callback,Xt!==null&&(f.flags|=64,Bn&&(f.flags|=8192),Bn=N.callbacks,Bn===null?N.callbacks=[Xt]:Bn.push(Xt))}else Bn={lane:Xt,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null},Pt===null?(vt=Pt=Bn,Ke=Et):Pt=Pt.next=Bn,te|=Xt;if(ye=ye.next,ye===null){if(ye=N.shared.pending,ye===null)break;Bn=ye,ye=Bn.next,Bn.next=null,N.lastBaseUpdate=Bn,N.shared.pending=null}}while(!0);Pt===null&&(Ke=Et),N.baseState=Ke,N.firstBaseUpdate=vt,N.lastBaseUpdate=Pt,k===null&&(N.shared.lanes=0),Bc|=te,f.lanes=te,f.memoizedState=Et}}function Ct(f,d){if(typeof f!="function")throw Error(r(191,f));f.call(d)}function Tt(f,d){var b=f.callbacks;if(b!==null)for(f.callbacks=null,f=0;f<b.length;f++)Ct(b[f],d)}function Dt(f,d){f=Wl,x(Mu,f),x(Fh,d),Wl=f|d.baseLanes}function He(){x(Mu,Wl),x(Fh,Fh.current)}function J(){Wl=Mu.current,v(Fh),v(Mu)}function pe(f){var d=f.alternate;x(xr,xr.current&1),x(Ia,f),Ra===null&&(d===null||Fh.current!==null||d.memoizedState!==null)&&(Ra=f)}function xe(f){x(xr,xr.current),x(Ia,f),Ra===null&&(Ra=f)}function Se(f){f.tag===22?(x(xr,xr.current),x(Ia,f),Ra===null&&(Ra=f)):be()}function be(){x(xr,xr.current),x(Ia,Ia.current)}function ct(f){v(Ia),Ra===f&&(Ra=null),v(xr)}function yt(f){for(var d=f;d!==null;){if(d.tag===13){var b=d.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||xu(b)||Gg(b)))return d}else if(d.tag===19&&(d.memoizedProps.revealOrder==="forwards"||d.memoizedProps.revealOrder==="backwards"||d.memoizedProps.revealOrder==="unstable_legacy-backwards"||d.memoizedProps.revealOrder==="together")){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===f)break;for(;d.sibling===null;){if(d.return===null||d.return===f)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}function ut(){throw Error(r(321))}function Ft(f,d){if(d===null)return!1;for(var b=0;b<d.length&&b<f.length;b++)if(!Ur(f[b],d[b]))return!1;return!0}function wt(f,d,b,w,N,k){return Rc=k,Ln=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,hn.H=f===null||f.memoizedState===null?hr:jl,ii=!1,k=b(w,N),ii=!1,Un&&(k=Bt(d,b,w,N)),Yt(f),k}function Yt(f){hn.H=Ka;var d=an!==null&&an.next!==null;if(Rc=0,Cn=an=Ln=null,Pn=!1,To=0,Yo=null,d)throw Error(r(300));f===null||Yi||(f=f.dependencies,f!==null&&Ne(f)&&(Yi=!0))}function Bt(f,d,b,w){Ln=f;var N=0;do{if(Un&&(Yo=null),To=0,Un=!1,25<=N)throw Error(r(301));if(N+=1,Cn=an=null,f.updateQueue!=null){var k=f.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}hn.H=Cu,k=d(b,w)}while(Un);return k}function jt(){var f=hn.H,d=f.useState()[0];return d=typeof d.then=="function"?Lt(d):d,f=f.useState()[0],(an!==null?an.memoizedState:null)!==f&&(Ln.flags|=1024),d}function yn(){var f=qs!==0;return qs=0,f}function Kn(f,d,b){d.updateQueue=f.updateQueue,d.flags&=-2053,f.lanes&=~b}function Sn(f){if(Pn){for(f=f.memoizedState;f!==null;){var d=f.queue;d!==null&&(d.pending=null),f=f.next}Pn=!1}Rc=0,Cn=an=Ln=null,Un=!1,To=qs=0,Yo=null}function zt(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cn===null?Ln.memoizedState=Cn=f:Cn=Cn.next=f,Cn}function St(){if(an===null){var f=Ln.alternate;f=f!==null?f.memoizedState:null}else f=an.next;var d=Cn===null?Ln.memoizedState:Cn.next;if(d!==null)Cn=d,an=f;else{if(f===null)throw Ln.alternate===null?Error(r(467)):Error(r(310));an=f,f={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},Cn===null?Ln.memoizedState=Cn=f:Cn=Cn.next=f}return Cn}function $t(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Lt(f){var d=To;return To+=1,Yo===null&&(Yo=[]),f=Qt(Yo,f,d),d=Ln,(Cn===null?d.memoizedState:Cn.next)===null&&(d=d.alternate,hn.H=d===null||d.memoizedState===null?hr:jl),f}function ni(f){if(f!==null&&typeof f=="object"){if(typeof f.then=="function")return Lt(f);if(f.$$typeof===yo)return Z(f)}throw Error(r(438,String(f)))}function $i(f){var d=null,b=Ln.updateQueue;if(b!==null&&(d=b.memoCache),d==null){var w=Ln.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(d={data:w.data.map(function(N){return N.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),b===null&&(b=$t(),Ln.updateQueue=b),b.memoCache=d,b=d.data[d.index],b===void 0)for(b=d.data[d.index]=Array(f),w=0;w<f;w++)b[w]=Jv;return d.index++,b}function In(f,d){return typeof d=="function"?d(f):d}function Oi(f){var d=St();return $n(d,an,f)}function $n(f,d,b){var w=f.queue;if(w===null)throw Error(r(311));w.lastRenderedReducer=b;var N=f.baseQueue,k=w.pending;if(k!==null){if(N!==null){var te=N.next;N.next=k.next,k.next=te}d.baseQueue=N=k,w.pending=null}if(k=f.baseState,N===null)f.memoizedState=k;else{d=N.next;var ye=te=null,Ke=null,vt=d,Pt=!1;do{var Et=vt.lane&-536870913;if(Et!==vt.lane?(Yn&Et)===Et:(Rc&Et)===Et){var Xt=vt.revertLane;if(Xt===0)Ke!==null&&(Ke=Ke.next={lane:0,revertLane:0,gesture:null,action:vt.action,hasEagerState:vt.hasEagerState,eagerState:vt.eagerState,next:null}),Et===Ic&&(Pt=!0);else if((Rc&Xt)===Xt){vt=vt.next,Xt===Ic&&(Pt=!0);continue}else Et={lane:0,revertLane:vt.revertLane,gesture:null,action:vt.action,hasEagerState:vt.hasEagerState,eagerState:vt.eagerState,next:null},Ke===null?(ye=Ke=Et,te=k):Ke=Ke.next=Et,Ln.lanes|=Xt,Bc|=Xt;Et=vt.action,ii&&b(k,Et),k=vt.hasEagerState?vt.eagerState:b(k,Et)}else Xt={lane:Et,revertLane:vt.revertLane,gesture:vt.gesture,action:vt.action,hasEagerState:vt.hasEagerState,eagerState:vt.eagerState,next:null},Ke===null?(ye=Ke=Xt,te=k):Ke=Ke.next=Xt,Ln.lanes|=Et,Bc|=Et;vt=vt.next}while(vt!==null&&vt!==d);if(Ke===null?te=k:Ke.next=ye,!Ur(k,f.memoizedState)&&(Yi=!0,Pt&&(b=as,b!==null)))throw b;f.memoizedState=k,f.baseState=te,f.baseQueue=Ke,w.lastRenderedState=k}return N===null&&(w.lanes=0),[f.memoizedState,w.dispatch]}function Ji(f){var d=St(),b=d.queue;if(b===null)throw Error(r(311));b.lastRenderedReducer=f;var w=b.dispatch,N=b.pending,k=d.memoizedState;if(N!==null){b.pending=null;var te=N=N.next;do k=f(k,te.action),te=te.next;while(te!==N);Ur(k,d.memoizedState)||(Yi=!0),d.memoizedState=k,d.baseQueue===null&&(d.baseState=k),b.lastRenderedState=k}return[k,w]}function Zi(f,d,b){var w=Ln,N=St(),k=Xn;if(k){if(b===void 0)throw Error(r(407));b=b()}else b=d();var te=!Ur((an||N).memoizedState,b);if(te&&(N.memoizedState=b,Yi=!0),N=N.queue,ho(Ho.bind(null,w,N,f),[f]),N.getSnapshot!==d||te||Cn!==null&&Cn.memoizedState.tag&1){if(w.flags|=2048,Hs(9,{destroy:void 0},Dr.bind(null,w,N,b,d),null),On===null)throw Error(r(349));k||(Rc&127)!==0||Br(w,d,b)}return b}function Br(f,d,b){f.flags|=16384,f={getSnapshot:d,value:b},d=Ln.updateQueue,d===null?(d=$t(),Ln.updateQueue=d,d.stores=[f]):(b=d.stores,b===null?d.stores=[f]:b.push(f))}function Dr(f,d,b,w){d.value=b,d.getSnapshot=w,ps(d)&&ip(f)}function Ho(f,d,b){return b(function(){ps(d)&&ip(f)})}function ps(f){var d=f.getSnapshot;f=f.value;try{var b=d();return!Ur(f,b)}catch{return!0}}function ip(f){var d=en(f,2);d!==null&&cr(d,f,2)}function eu(f){var d=zt();if(typeof f=="function"){var b=f;if(f=b(),ii){V(!0);try{b()}finally{V(!1)}}}return d.memoizedState=d.baseState=f,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:In,lastRenderedState:f},d}function co(f,d,b,w){return f.baseState=b,$n(f,an,typeof w=="function"?w:In)}function Gs(f,d,b,w,N){if(dg(f))throw Error(r(485));if(f=d.action,f!==null){var k={payload:N,action:f,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(te){k.listeners.push(te)}};hn.T!==null?b(!0):k.isTransition=!1,w(k),b=d.pending,b===null?(k.next=d.pending=k,xl(d,k)):(k.next=b.next,d.pending=b.next=k)}}function xl(f,d){var b=d.action,w=d.payload,N=f.state;if(d.isTransition){var k=hn.T,te={};hn.T=te;try{var ye=b(N,w),Ke=hn.S;Ke!==null&&Ke(te,ye),ch(f,d,ye)}catch(vt){uo(f,d,vt)}finally{k!==null&&te.types!==null&&(k.types=te.types),hn.T=k}}else try{k=b(N,w),ch(f,d,k)}catch(vt){uo(f,d,vt)}}function ch(f,d,b){b!==null&&typeof b=="object"&&typeof b.then=="function"?b.then(function(w){Ga(f,d,w)},function(w){return uo(f,d,w)}):Ga(f,d,b)}function Ga(f,d,b){d.status="fulfilled",d.value=b,uh(d),f.state=b,d=f.pending,d!==null&&(b=d.next,b===d?f.pending=null:(b=b.next,d.next=b,xl(f,b)))}function uo(f,d,b){var w=f.pending;if(f.pending=null,w!==null){w=w.next;do d.status="rejected",d.reason=b,uh(d),d=d.next;while(d!==w)}f.action=null}function uh(f){f=f.listeners;for(var d=0;d<f.length;d++)(0,f[d])()}function hh(f,d){return d}function tu(f,d){if(Xn){var b=On.formState;if(b!==null){e:{var w=Ln;if(Xn){if(ir){var N=d_(ir,ha);if(N){ir=p_(N),w=Ay(N);break e}}Pe(w)}w=!1}w&&(d=b[0])}}b=zt(),b.memoizedState=b.baseState=d,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hh,lastRenderedState:d},b.queue=w,b=jo.bind(null,Ln,w),w.dispatch=b,w=eu(!1);var k=fg.bind(null,Ln,!1,w.queue);return w=zt(),N={state:d,dispatch:null,action:f,pending:null},w.queue=N,b=Gs.bind(null,Ln,N,k,b),N.dispatch=b,w.memoizedState=f,[d,b,!1]}function _l(f){var d=St();return Ha(d,an,f)}function Ha(f,d,b){if(d=$n(f,d,hh)[0],f=Oi(In)[0],typeof d=="object"&&d!==null&&typeof d.then=="function")try{var w=Lt(d)}catch(te){throw te===os?Co:te}else w=d;d=St();var N=d.queue,k=N.dispatch;return b!==d.memoizedState&&(Ln.flags|=2048,Hs(9,{destroy:void 0},aa.bind(null,N,b),null)),[w,k,f]}function aa(f,d){f.action=d}function Sl(f){var d=St(),b=an;if(b!==null)return Ha(d,b,f);St(),d=d.memoizedState,b=St();var w=b.queue.dispatch;return b.memoizedState=f,[d,w,!1]}function Hs(f,d,b,w){return f={tag:f,create:b,deps:w,inst:d,next:null},d=Ln.updateQueue,d===null&&(d=$t(),Ln.updateQueue=d),b=d.lastEffect,b===null?d.lastEffect=f.next=f:(w=b.next,b.next=f,f.next=w,d.lastEffect=f),f}function fh(){return St().memoizedState}function Qo(f,d,b,w){var N=zt();Ln.flags|=f,N.memoizedState=Hs(1|d,{destroy:void 0},b,w===void 0?null:w)}function nu(f,d,b,w){var N=St();w=w===void 0?null:w;var k=N.memoizedState.inst;an!==null&&w!==null&&Ft(w,an.memoizedState.deps)?N.memoizedState=Hs(d,k,b,w):(Ln.flags|=f,N.memoizedState=Hs(1|d,k,b,w))}function iu(f,d){Qo(8390656,8,f,d)}function ho(f,d){nu(2048,8,f,d)}function ru(f){Ln.flags|=4;var d=Ln.updateQueue;if(d===null)d=$t(),Ln.updateQueue=d,d.events=[f];else{var b=d.events;b===null?d.events=[f]:b.push(f)}}function er(f){var d=St().memoizedState;return ru({ref:d,nextImpl:f}),function(){if((Qn&2)!==0)throw Error(r(440));return d.impl.apply(void 0,arguments)}}function Vo(f,d){return nu(4,2,f,d)}function gc(f,d){return nu(4,4,f,d)}function El(f,d){if(typeof d=="function"){f=f();var b=d(f);return function(){typeof b=="function"?b():d(null)}}if(d!=null)return f=f(),d.current=f,function(){d.current=null}}function su(f,d,b){b=b!=null?b.concat([f]):null,nu(4,4,El.bind(null,d,f),b)}function au(){}function wl(f,d){var b=St();d=d===void 0?null:d;var w=b.memoizedState;return d!==null&&Ft(d,w[1])?w[0]:(b.memoizedState=[f,d],f)}function Ml(f,d){var b=St();d=d===void 0?null:d;var w=b.memoizedState;if(d!==null&&Ft(d,w[1]))return w[0];if(w=f(),ii){V(!0);try{f()}finally{V(!1)}}return b.memoizedState=[w,d],w}function Xr(f,d,b){return b===void 0||(Rc&1073741824)!==0&&(Yn&261930)===0?f.memoizedState=d:(f.memoizedState=b,f=yc(),Ln.lanes|=f,Bc|=f,b)}function rp(f,d,b,w){return Ur(b,d)?b:Fh.current!==null?(f=Xr(f,b,w),Ur(f,d)||(Yi=!0),f):(Rc&42)===0||(Rc&1073741824)!==0&&(Yn&261930)===0?(Yi=!0,f.memoizedState=b):(f=yc(),Ln.lanes|=f,Bc|=f,d)}function dh(f,d,b,w,N){var k=bo();qn(k!==0&&8>k?k:8);var te=hn.T,ye={};hn.T=ye,fg(f,!1,d,b);try{var Ke=N(),vt=hn.S;if(vt!==null&&vt(ye,Ke),Ke!==null&&typeof Ke=="object"&&typeof Ke.then=="function"){var Pt=Me(Ke,w);ou(f,d,Pt,tr(f))}else ou(f,d,w,tr(f))}catch(Et){ou(f,d,{then:function(){},status:"rejected",reason:Et},tr())}finally{qn(k),te!==null&&ye.types!==null&&(te.types=ye.types),hn.T=te}}function ph(f){var d=f.memoizedState;if(d!==null)return d;d={memoizedState:Th,baseState:Th,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:In,lastRenderedState:Th},next:null};var b={};return d.next={memoizedState:b,baseState:b,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:In,lastRenderedState:b},next:null},f.memoizedState=d,f=f.alternate,f!==null&&(f.memoizedState=d),d}function Ef(){return Z(Ih)}function wf(){return St().memoizedState}function Ms(){return St().memoizedState}function Qa(f){for(var d=f.return;d!==null;){switch(d.tag){case 24:case 3:var b=tr();f=ge(b);var w=Ue(d,f,b);w!==null&&(cr(w,d,b),je(w,d,b)),d={cache:De()},f.payload=d;return}d=d.return}}function Qs(f,d,b){var w=tr();b={lane:w,revertLane:0,gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},dg(f)?Mx(d,b):(b=Rr(f,d,b,w),b!==null&&(cr(b,f,w),Cx(b,d,w)))}function jo(f,d,b){var w=tr();ou(f,d,b,w)}function ou(f,d,b,w){var N={lane:w,revertLane:0,gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null};if(dg(f))Mx(d,N);else{var k=f.alternate;if(f.lanes===0&&(k===null||k.lanes===0)&&(k=d.lastRenderedReducer,k!==null))try{var te=d.lastRenderedState,ye=k(te,b);if(N.hasEagerState=!0,N.eagerState=ye,Ur(ye,te))return Ki(f,d,N,0),On===null&&qr(),!1}catch{}if(b=Rr(f,d,N,w),b!==null)return cr(b,f,w),Cx(b,d,w),!0}return!1}function fg(f,d,b,w){if(w={lane:2,revertLane:ht(),gesture:null,action:w,hasEagerState:!1,eagerState:null,next:null},dg(f)){if(d)throw Error(r(479))}else d=Rr(f,b,w,2),d!==null&&cr(d,f,2)}function dg(f){var d=f.alternate;return f===Ln||d!==null&&d===Ln}function Mx(f,d){Un=Pn=!0;var b=f.pending;b===null?d.next=d:(d.next=b.next,b.next=d),f.pending=d}function Cx(f,d,b){if((b&4194048)!==0){var w=d.lanes;w&=f.pendingLanes,b|=w,d.lanes=b,L(f,b)}}function Iv(f,d,b,w){d=f.memoizedState,b=b(w,d),b=b==null?d:Lg({},d,b),f.memoizedState=b,f.lanes===0&&(f.updateQueue.baseState=b)}function pg(f,d,b,w,N,k,te){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(w,k,te):d.prototype&&d.prototype.isPureReactComponent?!ke(b,w)||!ke(N,k):!0}function Tx(f,d,b,w){f=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(b,w),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(b,w),d.state!==f&&Dp.enqueueReplaceState(d,d.state,null)}function mh(f,d){var b=d;if("ref"in d){b={};for(var w in d)w!=="ref"&&(b[w]=d[w])}if(f=f.defaultProps){b===d&&(b=Lg({},b));for(var N in f)b[N]===void 0&&(b[N]=f[N])}return b}function mg(f,d){try{var b=f.onUncaughtError;b(d.value,{componentStack:d.stack})}catch(w){setTimeout(function(){throw w})}}function Rv(f,d,b){try{var w=f.onCaughtError;w(b.value,{componentStack:b.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Bv(f,d,b){return b=ge(b),b.tag=3,b.payload={element:null},b.callback=function(){mg(f,d)},b}function Ix(f){return f=ge(f),f.tag=3,f}function Rx(f,d,b,w){var N=b.type.getDerivedStateFromError;if(typeof N=="function"){var k=w.value;f.payload=function(){return N(k)},f.callback=function(){Rv(d,b,w)}}var te=b.stateNode;te!==null&&typeof te.componentDidCatch=="function"&&(f.callback=function(){Rv(d,b,w),typeof N!="function"&&(Dc===null?Dc=new Set([this]):Dc.add(this));var ye=w.stack;this.componentDidCatch(w.value,{componentStack:ye!==null?ye:""})})}function HC(f,d,b,w,N){if(b.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(d=b.alternate,d!==null&&qe(d,b,N,!0),b=Ia.current,b!==null){switch(b.tag){case 31:case 13:return Ra===null?Ff():b.alternate===null&&dr===0&&(dr=3),b.flags&=-257,b.flags|=65536,b.lanes=N,w===Ql?b.flags|=16384:(d=b.updateQueue,d===null?b.updateQueue=new Set([w]):d.add(w),kf(f,w,N)),!1;case 22:return b.flags|=65536,w===Ql?b.flags|=16384:(d=b.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([w])},b.updateQueue=d):(b=d.retryQueue,b===null?d.retryQueue=new Set([w]):b.add(w)),kf(f,w,N)),!1}throw Error(r(435,b.tag))}return kf(f,w,N),Ff(),!1}if(Xn)return d=Ia.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=N,w!==nA&&(f=Error(r(422),{cause:w}),Le(ue(f,b)))):(w!==nA&&(d=Error(r(423),{cause:w}),Le(ue(d,b))),f=f.current.alternate,f.flags|=65536,N&=-N,f.lanes|=N,w=ue(w,b),N=Bv(f.stateNode,w,N),Xe(f,N),dr!==4&&(dr=2)),!1;var k=Error(r(520),{cause:w});if(k=ue(k,b),Np===null?Np=[k]:Np.push(k),dr!==4&&(dr=2),d===null)return!0;w=ue(w,b),b=d;do{switch(b.tag){case 3:return b.flags|=65536,f=N&-N,b.lanes|=f,f=Bv(b.stateNode,w,f),Xe(b,f),!1;case 1:if(d=b.type,k=b.stateNode,(b.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Dc===null||!Dc.has(k))))return b.flags|=65536,N&=-N,b.lanes|=N,N=Ix(N),Rx(N,f,b,w),Xe(b,N),!1}b=b.return}while(b!==null);return!1}function Cs(f,d,b,w){d.child=f===null?Uy(d,null,b,w):Rs(d,f.child,b,w)}function Bx(f,d,b,w,N){b=b.render;var k=d.ref;if("ref"in w){var te={};for(var ye in w)ye!=="ref"&&(te[ye]=w[ye])}else te=w;return tt(d),w=wt(f,d,b,te,k,N),ye=yn(),f!==null&&!Yi?(Kn(f,d,N),Cl(f,d,N)):(Xn&&ye&&$(d),d.flags|=1,Cs(f,d,w,N),d.child)}function Dx(f,d,b,w,N){if(f===null){var k=b.type;return typeof k=="function"&&!bh(k)&&k.defaultProps===void 0&&b.compare===null?(d.tag=15,d.type=k,Lx(f,d,k,w,N)):(f=_c(b.type,null,w,d,d.mode,N),f.ref=d.ref,f.return=d,d.child=f)}if(k=f.child,!ap(f,N)){var te=k.memoizedProps;if(b=b.compare,b=b!==null?b:ke,b(te,w)&&f.ref===d.ref)return Cl(f,d,N)}return d.flags|=1,f=Wa(k,w),f.ref=d.ref,f.return=d,d.child=f}function Lx(f,d,b,w,N){if(f!==null){var k=f.memoizedProps;if(ke(k,w)&&f.ref===d.ref)if(Yi=!1,d.pendingProps=w=k,ap(f,N))(f.flags&131072)!==0&&(Yi=!0);else return d.lanes=f.lanes,Cl(f,d,N)}return Ag(f,d,b,w,N)}function Nx(f,d,b,w){var N=w.children,k=f!==null?f.memoizedState:null;if(f===null&&d.stateNode===null&&(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),w.mode==="hidden"){if((d.flags&128)!==0){if(k=k!==null?k.baseLanes|b:b,f!==null){for(w=d.child=f.child,N=0;w!==null;)N=N|w.lanes|w.childLanes,w=w.sibling;w=N&~k}else w=0,d.child=null;return Mf(f,d,k,b,w)}if((b&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},f!==null&&Ut(d,k!==null?k.cachePool:null),k!==null?Dt(d,k):He(),Se(d);else return w=d.lanes=536870912,Mf(f,d,k!==null?k.baseLanes|b:b,b,w)}else k!==null?(Ut(d,k.cachePool),Dt(d,k),be(),d.memoizedState=null):(f!==null&&Ut(d,null),He(),be());return Cs(f,d,N,b),d.child}function gh(f,d){return f!==null&&f.tag===22||d.stateNode!==null||(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.sibling}function Mf(f,d,b,w,N){var k=rt();return k=k===null?null:{parent:Lr?rr._currentValue:rr._currentValue2,pool:k},d.memoizedState={baseLanes:b,cachePool:k},f!==null&&Ut(d,null),He(),Se(d),f!==null&&qe(f,d,w,!0),d.childLanes=N,null}function gg(f,d){return d=lu({mode:d.mode,children:d.children},f.mode),d.ref=f.ref,f.child=d,d.return=f,d}function Dv(f,d,b){return Rs(d,f.child,null,b),f=gg(d,d.pendingProps),f.flags|=2,ct(d),d.memoizedState=null,f}function Ux(f,d,b){var w=d.pendingProps,N=(d.flags&128)!==0;if(d.flags&=-129,f===null){if(Xn){if(w.mode==="hidden")return f=gg(d,w),d.lanes=536870912,gh(null,f);if(xe(d),(f=ir)?(f=yy(f,ha),f!==null&&(d.memoizedState={dehydrated:f,treeContext:So!==null?{id:Ts,overflow:qo}:null,retryLane:536870912,hydrationErrors:null},b=Yv(f),b.return=d,d.child=b,ss=d,ir=null)):f=null,f===null)throw Pe(d);return d.lanes=536870912,null}return gg(d,w)}var k=f.memoizedState;if(k!==null){var te=k.dehydrated;if(xe(d),N)if(d.flags&256)d.flags&=-257,d=Dv(f,d,b);else if(d.memoizedState!==null)d.child=f.child,d.flags|=128,d=null;else throw Error(r(558));else if(Yi||qe(f,d,b,!1),N=(b&f.childLanes)!==0,Yi||N){if(w=On,w!==null&&(te=P(w,b),te!==0&&te!==k.retryLane))throw k.retryLane=te,en(f,te),cr(w,f,te),da;Ff(),d=Dv(f,d,b)}else f=k.treeContext,nr&&(ir=v_(te),ss=d,Xn=!0,Hl=null,ha=!1,f!==null&&he(d,f)),d=gg(d,w),d.flags|=4096;return d}return f=Wa(f.child,{mode:w.mode,children:w.children}),f.ref=d.ref,d.child=f,f.return=d,f}function sp(f,d){var b=d.ref;if(b===null)f!==null&&f.ref!==null&&(d.flags|=4194816);else{if(typeof b!="function"&&typeof b!="object")throw Error(r(284));(f===null||f.ref!==b)&&(d.flags|=4194816)}}function Ag(f,d,b,w,N){return tt(d),b=wt(f,d,b,w,void 0,N),w=yn(),f!==null&&!Yi?(Kn(f,d,N),Cl(f,d,N)):(Xn&&w&&$(d),d.flags|=1,Cs(f,d,b,N),d.child)}function Lv(f,d,b,w,N,k){return tt(d),d.updateQueue=null,b=Bt(d,w,b,N),Yt(f),w=yn(),f!==null&&!Yi?(Kn(f,d,k),Cl(f,d,k)):(Xn&&w&&$(d),d.flags|=1,Cs(f,d,b,k),d.child)}function Ah(f,d,b,w,N){if(tt(d),d.stateNode===null){var k=kl,te=b.contextType;typeof te=="object"&&te!==null&&(k=Z(te)),k=new b(w,k),d.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=Dp,d.stateNode=k,k._reactInternals=d,k=d.stateNode,k.props=w,k.state=d.memoizedState,k.refs={},Y(d),te=b.contextType,k.context=typeof te=="object"&&te!==null?Z(te):kl,k.state=d.memoizedState,te=b.getDerivedStateFromProps,typeof te=="function"&&(Iv(d,b,te,w),k.state=d.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(te=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),te!==k.state&&Dp.enqueueReplaceState(k,k.state,null),At(d,w,k,N),xt(),k.state=d.memoizedState),typeof k.componentDidMount=="function"&&(d.flags|=4194308),w=!0}else if(f===null){k=d.stateNode;var ye=d.memoizedProps,Ke=mh(b,ye);k.props=Ke;var vt=k.context,Pt=b.contextType;te=kl,typeof Pt=="object"&&Pt!==null&&(te=Z(Pt));var Et=b.getDerivedStateFromProps;Pt=typeof Et=="function"||typeof k.getSnapshotBeforeUpdate=="function",ye=d.pendingProps!==ye,Pt||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(ye||vt!==te)&&Tx(d,k,w,te),Ya=!1;var Xt=d.memoizedState;k.state=Xt,At(d,w,k,N),xt(),vt=d.memoizedState,ye||Xt!==vt||Ya?(typeof Et=="function"&&(Iv(d,b,Et,w),vt=d.memoizedState),(Ke=Ya||pg(d,b,Ke,w,Xt,vt,te))?(Pt||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(d.flags|=4194308)):(typeof k.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=w,d.memoizedState=vt),k.props=w,k.state=vt,k.context=te,w=Ke):(typeof k.componentDidMount=="function"&&(d.flags|=4194308),w=!1)}else{k=d.stateNode,se(f,d),te=d.memoizedProps,Pt=mh(b,te),k.props=Pt,Et=d.pendingProps,Xt=k.context,vt=b.contextType,Ke=kl,typeof vt=="object"&&vt!==null&&(Ke=Z(vt)),ye=b.getDerivedStateFromProps,(vt=typeof ye=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(te!==Et||Xt!==Ke)&&Tx(d,k,w,Ke),Ya=!1,Xt=d.memoizedState,k.state=Xt,At(d,w,k,N),xt();var Bn=d.memoizedState;te!==Et||Xt!==Bn||Ya||f!==null&&f.dependencies!==null&&Ne(f.dependencies)?(typeof ye=="function"&&(Iv(d,b,ye,w),Bn=d.memoizedState),(Pt=Ya||pg(d,b,Pt,w,Xt,Bn,Ke)||f!==null&&f.dependencies!==null&&Ne(f.dependencies))?(vt||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(w,Bn,Ke),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(w,Bn,Ke)),typeof k.componentDidUpdate=="function"&&(d.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof k.componentDidUpdate!="function"||te===f.memoizedProps&&Xt===f.memoizedState||(d.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||te===f.memoizedProps&&Xt===f.memoizedState||(d.flags|=1024),d.memoizedProps=w,d.memoizedState=Bn),k.props=w,k.state=Bn,k.context=Ke,w=Pt):(typeof k.componentDidUpdate!="function"||te===f.memoizedProps&&Xt===f.memoizedState||(d.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||te===f.memoizedProps&&Xt===f.memoizedState||(d.flags|=1024),w=!1)}return k=w,sp(f,d),w=(d.flags&128)!==0,k||w?(k=d.stateNode,b=w&&typeof b.getDerivedStateFromError!="function"?null:k.render(),d.flags|=1,f!==null&&w?(d.child=Rs(d,f.child,null,N),d.child=Rs(d,null,b,N)):Cs(f,d,b,N),d.memoizedState=k.state,f=d.child):f=Cl(f,d,N),f}function Fx(f,d,b,w){return _t(),d.flags|=256,Cs(f,d,b,w),d.child}function Nv(f){return{baseLanes:f,cachePool:nt()}}function Uv(f,d,b){return f=f!==null?f.childLanes&~b:0,d&&(f|=pa),f}function Fv(f,d,b){var w=d.pendingProps,N=!1,k=(d.flags&128)!==0,te;if((te=k)||(te=f!==null&&f.memoizedState===null?!1:(xr.current&2)!==0),te&&(N=!0,d.flags&=-129),te=(d.flags&32)!==0,d.flags&=-33,f===null){if(Xn){if(N?pe(d):be(),(f=ir)?(f=__(f,ha),f!==null&&(d.memoizedState={dehydrated:f,treeContext:So!==null?{id:Ts,overflow:qo}:null,retryLane:536870912,hydrationErrors:null},b=Yv(f),b.return=d,d.child=b,ss=d,ir=null)):f=null,f===null)throw Pe(d);return Gg(f)?d.lanes=32:d.lanes=536870912,null}var ye=w.children;return w=w.fallback,N?(be(),N=d.mode,ye=lu({mode:"hidden",children:ye},N),w=vo(w,N,b,null),ye.return=d,w.return=d,ye.sibling=w,d.child=ye,w=d.child,w.memoizedState=Nv(b),w.childLanes=Uv(f,te,b),d.memoizedState=Ph,gh(null,w)):(pe(d),vg(d,ye))}var Ke=f.memoizedState;if(Ke!==null&&(ye=Ke.dehydrated,ye!==null)){if(k)d.flags&256?(pe(d),d.flags&=-257,d=vh(f,d,b)):d.memoizedState!==null?(be(),d.child=f.child,d.flags|=128,d=null):(be(),ye=w.fallback,N=d.mode,w=lu({mode:"visible",children:w.children},N),ye=vo(ye,N,b,null),ye.flags|=2,w.return=d,ye.return=d,w.sibling=ye,d.child=w,Rs(d,f.child,null,b),w=d.child,w.memoizedState=Nv(b),w.childLanes=Uv(f,te,b),d.memoizedState=Ph,d=gh(null,w));else if(pe(d),Gg(ye))te=Hg(ye).digest,w=Error(r(419)),w.stack="",w.digest=te,Le({value:w,source:null,stack:null}),d=vh(f,d,b);else if(Yi||qe(f,d,b,!1),te=(b&f.childLanes)!==0,Yi||te){if(te=On,te!==null&&(w=P(te,b),w!==0&&w!==Ke.retryLane))throw Ke.retryLane=w,en(f,w),cr(te,f,w),da;xu(ye)||Ff(),d=vh(f,d,b)}else xu(ye)?(d.flags|=192,d.child=f.child,d=null):(f=Ke.treeContext,nr&&(ir=y_(ye),ss=d,Xn=!0,Hl=null,ha=!1,f!==null&&he(d,f)),d=vg(d,w.children),d.flags|=4096);return d}return N?(be(),ye=w.fallback,N=d.mode,Ke=f.child,k=Ke.sibling,w=Wa(Ke,{mode:"hidden",children:w.children}),w.subtreeFlags=Ke.subtreeFlags&65011712,k!==null?ye=Wa(k,ye):(ye=vo(ye,N,b,null),ye.flags|=2),ye.return=d,w.return=d,w.sibling=ye,d.child=w,gh(null,w),w=d.child,ye=f.child.memoizedState,ye===null?ye=Nv(b):(N=ye.cachePool,N!==null?(Ke=Lr?rr._currentValue:rr._currentValue2,N=N.parent!==Ke?{parent:Ke,pool:Ke}:N):N=nt(),ye={baseLanes:ye.baseLanes|b,cachePool:N}),w.memoizedState=ye,w.childLanes=Uv(f,te,b),d.memoizedState=Ph,gh(f.child,w)):(pe(d),b=f.child,f=b.sibling,b=Wa(b,{mode:"visible",children:w.children}),b.return=d,b.sibling=null,f!==null&&(te=d.deletions,te===null?(d.deletions=[f],d.flags|=16):te.push(f)),d.child=b,d.memoizedState=null,b)}function vg(f,d){return d=lu({mode:"visible",children:d},f.mode),d.return=f,f.child=d}function lu(f,d){return f=t(22,f,null,d),f.lanes=0,f}function vh(f,d,b){return Rs(d,f.child,null,b),f=vg(d,d.pendingProps.children),f.flags|=2,d.memoizedState=null,f}function Px(f,d,b){f.lanes|=d;var w=f.alternate;w!==null&&(w.lanes|=d),ne(f.return,d,b)}function Cf(f,d,b,w,N,k){var te=f.memoizedState;te===null?f.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:w,tail:b,tailMode:N,treeForkCount:k}:(te.isBackwards=d,te.rendering=null,te.renderingStartTime=0,te.last=w,te.tail=b,te.tailMode=N,te.treeForkCount=k)}function Pv(f,d,b){var w=d.pendingProps,N=w.revealOrder,k=w.tail;w=w.children;var te=xr.current,ye=(te&2)!==0;if(ye?(te=te&1|2,d.flags|=128):te&=1,x(xr,te),Cs(f,d,w,b),w=Xn?Ip:0,!ye&&f!==null&&(f.flags&128)!==0)e:for(f=d.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&Px(f,b,d);else if(f.tag===19)Px(f,b,d);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===d)break e;for(;f.sibling===null;){if(f.return===null||f.return===d)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}switch(N){case"forwards":for(b=d.child,N=null;b!==null;)f=b.alternate,f!==null&&yt(f)===null&&(N=b),b=b.sibling;b=N,b===null?(N=d.child,d.child=null):(N=b.sibling,b.sibling=null),Cf(d,!1,N,b,k,w);break;case"backwards":case"unstable_legacy-backwards":for(b=null,N=d.child,d.child=null;N!==null;){if(f=N.alternate,f!==null&&yt(f)===null){d.child=N;break}f=N.sibling,N.sibling=b,b=N,N=f}Cf(d,!0,b,null,k,w);break;case"together":Cf(d,!1,null,null,void 0,w);break;default:d.memoizedState=null}return d.child}function Cl(f,d,b){if(f!==null&&(d.dependencies=f.dependencies),Bc|=d.lanes,(b&d.childLanes)===0)if(f!==null){if(qe(f,d,b,!1),(b&d.childLanes)===0)return null}else return null;if(f!==null&&d.child!==f.child)throw Error(r(153));if(d.child!==null){for(f=d.child,b=Wa(f,f.pendingProps),d.child=b,b.return=d;f.sibling!==null;)f=f.sibling,b=b.sibling=Wa(f,f.pendingProps),b.return=d;b.sibling=null}return d.child}function ap(f,d){return(f.lanes&d)!==0?!0:(f=f.dependencies,!!(f!==null&&Ne(f)))}function Ov(f,d,b){switch(d.tag){case 3:me(d,d.stateNode.containerInfo),Te(d,rr,f.memoizedState.cache),_t();break;case 27:case 5:fe(d);break;case 4:me(d,d.stateNode.containerInfo);break;case 10:Te(d,d.type,d.memoizedProps.value);break;case 31:if(d.memoizedState!==null)return d.flags|=128,xe(d),null;break;case 13:var w=d.memoizedState;if(w!==null)return w.dehydrated!==null?(pe(d),d.flags|=128,null):(b&d.child.childLanes)!==0?Fv(f,d,b):(pe(d),f=Cl(f,d,b),f!==null?f.sibling:null);pe(d);break;case 19:var N=(f.flags&128)!==0;if(w=(b&d.childLanes)!==0,w||(qe(f,d,b,!1),w=(b&d.childLanes)!==0),N){if(w)return Pv(f,d,b);d.flags|=128}if(N=d.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),x(xr,xr.current),w)break;return null;case 22:return d.lanes=0,Nx(f,d,b,d.pendingProps);case 24:Te(d,rr,f.memoizedState.cache)}return Cl(f,d,b)}function kv(f,d,b){if(f!==null)if(f.memoizedProps!==d.pendingProps)Yi=!0;else{if(!ap(f,b)&&(d.flags&128)===0)return Yi=!1,Ov(f,d,b);Yi=(f.flags&131072)!==0}else Yi=!1,Xn&&(d.flags&1048576)!==0&&z(d,Ip,d.index);switch(d.lanes=0,d.tag){case 16:e:{var w=d.pendingProps;if(f=kt(d.elementType),d.type=f,typeof f=="function")bh(f)?(w=mh(f,w),d.tag=1,d=Ah(null,d,f,w,b)):(d.tag=0,d=Ag(null,d,f,w,b));else{if(f!=null){var N=f.$$typeof;if(N===zf){d.tag=11,d=Bx(null,d,f,w,b);break e}else if(N===Ug){d.tag=14,d=Dx(null,d,f,w,b);break e}}throw d=g(f)||f,Error(r(306,d,""))}}return d;case 0:return Ag(f,d,d.type,d.pendingProps,b);case 1:return w=d.type,N=mh(w,d.pendingProps),Ah(f,d,w,N,b);case 3:e:{if(me(d,d.stateNode.containerInfo),f===null)throw Error(r(387));var k=d.pendingProps;N=d.memoizedState,w=N.element,se(f,d),At(d,k,null,b);var te=d.memoizedState;if(k=te.cache,Te(d,rr,k),k!==N.cache&&ft(d,[rr],b,!0),xt(),k=te.element,nr&&N.isDehydrated)if(N={element:k,isDehydrated:!1,cache:te.cache},d.updateQueue.baseState=N,d.memoizedState=N,d.flags&256){d=Fx(f,d,k,b);break e}else if(k!==w){w=ue(Error(r(424)),d),Le(w),d=Fx(f,d,k,b);break e}else for(nr&&(ir=A_(d.stateNode.containerInfo),ss=d,Xn=!0,Hl=null,ha=!0),b=Uy(d,null,k,b),d.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(_t(),k===w){d=Cl(f,d,b);break e}Cs(f,d,k,b)}d=d.child}return d;case 26:if(xo)return sp(f,d),f===null?(b=Ey(d.type,null,d.pendingProps,null))?d.memoizedState=b:Xn||(d.stateNode=Wg(d.type,d.pendingProps,Is.current,d)):d.memoizedState=Ey(d.type,f.memoizedProps,d.pendingProps,f.memoizedState),null;case 27:if(rs)return fe(d),f===null&&rs&&Xn&&(w=d.stateNode=qg(d.type,d.pendingProps,Is.current,vs.current,!1),ss=d,ha=!0,ir=vy(d.type,w,ir)),Cs(f,d,d.pendingProps.children,b),sp(f,d),f===null&&(d.flags|=4194304),d.child;case 5:return f===null&&Xn&&(B_(d.type,d.pendingProps,vs.current),(N=w=ir)&&(w=b_(w,d.type,d.pendingProps,ha),w!==null?(d.stateNode=w,ss=d,ir=g_(w),ha=!1,N=!0):N=!1),N||Pe(d)),fe(d),N=d.type,k=d.pendingProps,te=f!==null?f.memoizedProps:null,w=k.children,ua(N,k)?w=null:te!==null&&ua(N,te)&&(d.flags|=32),d.memoizedState!==null&&(N=wt(f,d,jt,null,null,b),Lr?Ih._currentValue=N:Ih._currentValue2=N),sp(f,d),Cs(f,d,w,b),d.child;case 6:return f===null&&Xn&&(Sy(d.pendingProps,vs.current),(f=b=ir)&&(b=x_(b,d.pendingProps,ha),b!==null?(d.stateNode=b,ss=d,ir=null,f=!0):f=!1),f||Pe(d)),null;case 13:return Fv(f,d,b);case 4:return me(d,d.stateNode.containerInfo),w=d.pendingProps,f===null?d.child=Rs(d,null,w,b):Cs(f,d,w,b),d.child;case 11:return Bx(f,d,d.type,d.pendingProps,b);case 7:return Cs(f,d,d.pendingProps,b),d.child;case 8:return Cs(f,d,d.pendingProps.children,b),d.child;case 12:return Cs(f,d,d.pendingProps.children,b),d.child;case 10:return w=d.pendingProps,Te(d,d.type,w.value),Cs(f,d,w.children,b),d.child;case 9:return N=d.type._context,w=d.pendingProps.children,tt(d),N=Z(N),w=w(N),d.flags|=1,Cs(f,d,w,b),d.child;case 14:return Dx(f,d,d.type,d.pendingProps,b);case 15:return Lx(f,d,d.type,d.pendingProps,b);case 19:return Pv(f,d,b);case 31:return Ux(f,d,b);case 22:return Nx(f,d,b,d.pendingProps);case 24:return tt(d),w=Z(rr),f===null?(N=rt(),N===null&&(N=On,k=De(),N.pooledCache=k,k.refCount++,k!==null&&(N.pooledCacheLanes|=b),N=k),d.memoizedState={parent:w,cache:N},Y(d),Te(d,rr,N)):((f.lanes&b)!==0&&(se(f,d),At(d,null,null,b),xt()),N=f.memoizedState,k=d.memoizedState,N.parent!==w?(N={parent:w,cache:w},d.memoizedState=N,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=N),Te(d,rr,w)):(w=k.cache,Te(d,rr,w),w!==N.cache&&ft(d,[rr],b,!0))),Cs(f,d,d.pendingProps.children,b),d.child;case 29:throw d.pendingProps}throw Error(r(156,d.tag))}function fo(f){f.flags|=4}function op(f){qa&&(f.flags|=8)}function Ox(f,d){if(f!==null&&f.child===d.child)return!1;if((d.flags&16)!==0)return!0;for(f=d.child;f!==null;){if((f.flags&8218)!==0||(f.subtreeFlags&8218)!==0)return!0;f=f.sibling}return!1}function zv(f,d,b,w){if(Zn)for(b=d.child;b!==null;){if(b.tag===5||b.tag===6)xp(f,b.stateNode);else if(!(b.tag===4||rs&&b.tag===27)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===d)break;for(;b.sibling===null;){if(b.return===null||b.return===d)return;b=b.return}b.sibling.return=b.return,b=b.sibling}else if(qa)for(var N=d.child;N!==null;){if(N.tag===5){var k=N.stateNode;b&&w&&(k=f_(k,N.type,N.memoizedProps)),xp(f,k)}else if(N.tag===6)k=N.stateNode,b&&w&&(k=gy(k,N.memoizedProps)),xp(f,k);else if(N.tag!==4){if(N.tag===22&&N.memoizedState!==null)k=N.child,k!==null&&(k.return=N),zv(f,N,!0,!0);else if(N.child!==null){N.child.return=N,N=N.child;continue}}if(N===d)break;for(;N.sibling===null;){if(N.return===null||N.return===d)return;N=N.return}N.sibling.return=N.return,N=N.sibling}}function kx(f,d,b,w){var N=!1;if(qa)for(var k=d.child;k!==null;){if(k.tag===5){var te=k.stateNode;b&&w&&(te=f_(te,k.type,k.memoizedProps)),py(f,te)}else if(k.tag===6)te=k.stateNode,b&&w&&(te=gy(te,k.memoizedProps)),py(f,te);else if(k.tag!==4){if(k.tag===22&&k.memoizedState!==null)N=k.child,N!==null&&(N.return=k),kx(f,k,!0,!0),N=!0;else if(k.child!==null){k.child.return=k,k=k.child;continue}}if(k===d)break;for(;k.sibling===null;){if(k.return===null||k.return===d)return N;k=k.return}k.sibling.return=k.return,k=k.sibling}return N}function zx(f,d){if(qa&&Ox(f,d)){f=d.stateNode;var b=f.containerInfo,w=dy();kx(w,d,!1,!1),f.pendingChildren=w,fo(d),h_(b,w)}}function Gv(f,d,b,w){if(Zn)f.memoizedProps!==w&&fo(d);else if(qa){var N=f.stateNode,k=f.memoizedProps;if((f=Ox(f,d))||k!==w){var te=vs.current;k=u_(N,b,k,w,!f,null),k===N?d.stateNode=N:(op(d),wa(k,b,w,te)&&fo(d),d.stateNode=k,f&&zv(k,d,!1,!1))}else d.stateNode=N}}function oa(f,d,b,w,N){if((f.mode&32)!==0&&(b===null?_p(d,w):jf(d,b,w))){if(f.flags|=16777216,(N&335544128)===N||ny(d,w))if(ur(f.stateNode,d,w))f.flags|=8192;else if(Jn())f.flags|=8192;else throw fa=Ql,rA}else f.flags&=-16777217}function Tf(f,d){if(Ty(d)){if(f.flags|=16777216,!Iy(d))if(Jn())f.flags|=8192;else throw fa=Ql,rA}else f.flags&=-16777217}function lp(f,d){d!==null&&(f.flags|=4),f.flags&16384&&(d=f.tag!==22?R():536870912,f.lanes|=d,ed|=d)}function If(f,d){if(!Xn)switch(f.tailMode){case"hidden":d=f.tail;for(var b=null;d!==null;)d.alternate!==null&&(b=d),d=d.sibling;b===null?f.tail=null:b.sibling=null;break;case"collapsed":b=f.tail;for(var w=null;b!==null;)b.alternate!==null&&(w=b),b=b.sibling;w===null?d||f.tail===null?f.tail=null:f.tail.sibling=null:w.sibling=null}}function Hi(f){var d=f.alternate!==null&&f.alternate.child===f.child,b=0,w=0;if(d)for(var N=f.child;N!==null;)b|=N.lanes|N.childLanes,w|=N.subtreeFlags&65011712,w|=N.flags&65011712,N.return=f,N=N.sibling;else for(N=f.child;N!==null;)b|=N.lanes|N.childLanes,w|=N.subtreeFlags,w|=N.flags,N.return=f,N=N.sibling;return f.subtreeFlags|=w,f.childLanes=b,d}function Gx(f,d,b){var w=d.pendingProps;switch(ae(d),d.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hi(d),null;case 1:return Hi(d),null;case 3:return b=d.stateNode,w=null,f!==null&&(w=f.memoizedState.cache),d.memoizedState.cache!==w&&(d.flags|=2048),Ye(rr),le(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(f===null||f.child===null)&&(Je(d)?fo(d):f===null||f.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Be())),zx(f,d),Hi(d),null;case 26:if(xo){var N=d.type,k=d.memoizedState;return f===null?(fo(d),k!==null?(Hi(d),Tf(d,k)):(Hi(d),oa(d,N,null,w,b))):k?k!==f.memoizedState?(fo(d),Hi(d),Tf(d,k)):(Hi(d),d.flags&=-16777217):(k=f.memoizedProps,Zn?k!==w&&fo(d):Gv(f,d,N,w),Hi(d),oa(d,N,k,w,b)),null}case 27:if(rs){if(_e(d),b=Is.current,N=d.type,f!==null&&d.stateNode!=null)Zn?f.memoizedProps!==w&&fo(d):Gv(f,d,N,w);else{if(!w){if(d.stateNode===null)throw Error(r(166));return Hi(d),null}f=vs.current,Je(d)?et(d,f):(f=qg(N,w,b,f,!0),d.stateNode=f,fo(d))}return Hi(d),null}case 5:if(_e(d),N=d.type,f!==null&&d.stateNode!=null)Gv(f,d,N,w);else{if(!w){if(d.stateNode===null)throw Error(r(166));return Hi(d),null}if(k=vs.current,Je(d))et(d,k),T_(d.stateNode,N,w,k)&&(d.flags|=64);else{var te=ey(N,w,Is.current,k,d);op(d),zv(te,d,!1,!1),d.stateNode=te,wa(te,N,w,k)&&fo(d)}}return Hi(d),oa(d,d.type,f===null?null:f.memoizedProps,d.pendingProps,b),null;case 6:if(f&&d.stateNode!=null)b=f.memoizedProps,Zn?b!==w&&fo(d):qa&&(b!==w?(f=Is.current,b=vs.current,op(d),d.stateNode=wc(w,f,b,d)):d.stateNode=f.stateNode);else{if(typeof w!="string"&&d.stateNode===null)throw Error(r(166));if(f=Is.current,b=vs.current,Je(d)){if(!nr)throw Error(r(176));if(f=d.stateNode,b=d.memoizedProps,w=null,N=ss,N!==null)switch(N.tag){case 27:case 5:w=N.memoizedProps}qC(f,b,d,w)||Pe(d,!0)}else op(d),d.stateNode=wc(w,f,b,d)}return Hi(d),null;case 31:if(b=d.memoizedState,f===null||f.memoizedState!==null){if(w=Je(d),b!==null){if(f===null){if(!w)throw Error(r(318));if(!nr)throw Error(r(556));if(f=d.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(557));by(f,d)}else _t(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Hi(d),f=!1}else b=Be(),f!==null&&f.memoizedState!==null&&(f.memoizedState.hydrationErrors=b),f=!0;if(!f)return d.flags&256?(ct(d),d):(ct(d),null);if((d.flags&128)!==0)throw Error(r(558))}return Hi(d),null;case 13:if(w=d.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(N=Je(d),w!==null&&w.dehydrated!==null){if(f===null){if(!N)throw Error(r(318));if(!nr)throw Error(r(344));if(N=d.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));E_(N,d)}else _t(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Hi(d),N=!1}else N=Be(),f!==null&&f.memoizedState!==null&&(f.memoizedState.hydrationErrors=N),N=!0;if(!N)return d.flags&256?(ct(d),d):(ct(d),null)}return ct(d),(d.flags&128)!==0?(d.lanes=b,d):(b=w!==null,f=f!==null&&f.memoizedState!==null,b&&(w=d.child,N=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(N=w.alternate.memoizedState.cachePool.pool),k=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(k=w.memoizedState.cachePool.pool),k!==N&&(w.flags|=2048)),b!==f&&b&&(d.child.flags|=8192),lp(d,d.updateQueue),Hi(d),null);case 4:return le(),zx(f,d),f===null&&Di(d.stateNode.containerInfo),Hi(d),null;case 10:return Ye(d.type),Hi(d),null;case 19:if(v(xr),w=d.memoizedState,w===null)return Hi(d),null;if(N=(d.flags&128)!==0,k=w.rendering,k===null)if(N)If(w,!1);else{if(dr!==0||f!==null&&(f.flags&128)!==0)for(f=d.child;f!==null;){if(k=yt(f),k!==null){for(d.flags|=128,If(w,!1),f=k.updateQueue,d.updateQueue=f,lp(d,f),d.subtreeFlags=0,f=b,b=d.child;b!==null;)Rg(b,f),b=b.sibling;return x(xr,xr.current&1|2),Xn&&oe(d,w.treeForkCount),d.child}f=f.sibling}w.tail!==null&&js()>Du&&(d.flags|=128,N=!0,If(w,!1),d.lanes=4194304)}else{if(!N)if(f=yt(k),f!==null){if(d.flags|=128,N=!0,f=f.updateQueue,d.updateQueue=f,lp(d,f),If(w,!0),w.tail===null&&w.tailMode==="hidden"&&!k.alternate&&!Xn)return Hi(d),null}else 2*js()-w.renderingStartTime>Du&&b!==536870912&&(d.flags|=128,N=!0,If(w,!1),d.lanes=4194304);w.isBackwards?(k.sibling=d.child,d.child=k):(f=w.last,f!==null?f.sibling=k:d.child=k,w.last=k)}return w.tail!==null?(f=w.tail,w.rendering=f,w.tail=f.sibling,w.renderingStartTime=js(),f.sibling=null,b=xr.current,x(xr,N?b&1|2:b&1),Xn&&oe(d,w.treeForkCount),f):(Hi(d),null);case 22:case 23:return ct(d),J(),w=d.memoizedState!==null,f!==null?f.memoizedState!==null!==w&&(d.flags|=8192):w&&(d.flags|=8192),w?(b&536870912)!==0&&(d.flags&128)===0&&(Hi(d),d.subtreeFlags&6&&(d.flags|=8192)):Hi(d),b=d.updateQueue,b!==null&&lp(d,b.retryQueue),b=null,f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),w=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(w=d.memoizedState.cachePool.pool),w!==b&&(d.flags|=2048),f!==null&&v(Eu),null;case 24:return b=null,f!==null&&(b=f.memoizedState.cache),d.memoizedState.cache!==b&&(d.flags|=2048),Ye(rr),Hi(d),null;case 25:return null;case 30:return null}throw Error(r(156,d.tag))}function Hv(f,d){switch(ae(d),d.tag){case 1:return f=d.flags,f&65536?(d.flags=f&-65537|128,d):null;case 3:return Ye(rr),le(),f=d.flags,(f&65536)!==0&&(f&128)===0?(d.flags=f&-65537|128,d):null;case 26:case 27:case 5:return _e(d),null;case 31:if(d.memoizedState!==null){if(ct(d),d.alternate===null)throw Error(r(340));_t()}return f=d.flags,f&65536?(d.flags=f&-65537|128,d):null;case 13:if(ct(d),f=d.memoizedState,f!==null&&f.dehydrated!==null){if(d.alternate===null)throw Error(r(340));_t()}return f=d.flags,f&65536?(d.flags=f&-65537|128,d):null;case 19:return v(xr),null;case 4:return le(),null;case 10:return Ye(d.type),null;case 22:case 23:return ct(d),J(),f!==null&&v(Eu),f=d.flags,f&65536?(d.flags=f&-65537|128,d):null;case 24:return Ye(rr),null;case 25:return null;default:return null}}function Hx(f,d){switch(ae(d),d.tag){case 3:Ye(rr),le();break;case 26:case 27:case 5:_e(d);break;case 4:le();break;case 31:d.memoizedState!==null&&ct(d);break;case 13:ct(d);break;case 19:v(xr);break;case 10:Ye(d.type);break;case 22:case 23:ct(d),J(),f!==null&&v(Eu);break;case 24:Ye(rr)}}function Tl(f,d){try{var b=d.updateQueue,w=b!==null?b.lastEffect:null;if(w!==null){var N=w.next;b=N;do{if((b.tag&f)===f){w=void 0;var k=b.create,te=b.inst;w=k(),te.destroy=w}b=b.next}while(b!==N)}}catch(ye){En(d,d.return,ye)}}function Il(f,d,b){try{var w=d.updateQueue,N=w!==null?w.lastEffect:null;if(N!==null){var k=N.next;w=k;do{if((w.tag&f)===f){var te=w.inst,ye=te.destroy;if(ye!==void 0){te.destroy=void 0,N=d;var Ke=b,vt=ye;try{vt()}catch(Pt){En(N,Ke,Pt)}}}w=w.next}while(w!==k)}}catch(Pt){En(d,d.return,Pt)}}function Rf(f){var d=f.updateQueue;if(d!==null){var b=f.stateNode;try{Tt(d,b)}catch(w){En(f,f.return,w)}}}function yg(f,d,b){b.props=mh(f.type,f.memoizedProps),b.state=f.memoizedState;try{b.componentWillUnmount()}catch(w){En(f,d,w)}}function Bf(f,d){try{var b=f.ref;if(b!==null){switch(f.tag){case 26:case 27:case 5:var w=Hf(f.stateNode);break;case 30:w=f.stateNode;break;default:w=f.stateNode}typeof b=="function"?f.refCleanup=b(w):b.current=w}}catch(N){En(f,d,N)}}function Vs(f,d){var b=f.ref,w=f.refCleanup;if(b!==null)if(typeof w=="function")try{w()}catch(N){En(f,d,N)}finally{f.refCleanup=null,f=f.alternate,f!=null&&(f.refCleanup=null)}else if(typeof b=="function")try{b(null)}catch(N){En(f,d,N)}else b.current=null}function yh(f){var d=f.type,b=f.memoizedProps,w=f.stateNode;try{n_(w,d,b,f)}catch(N){En(f,f.return,N)}}function cp(f,d,b){try{i_(f.stateNode,f.type,b,d,f)}catch(w){En(f,f.return,w)}}function Qv(f){return f.tag===5||f.tag===3||(xo?f.tag===26:!1)||(rs?f.tag===27&&Rh(f.type):!1)||f.tag===4}function Ac(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||Qv(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(rs&&f.tag===27&&Rh(f.type)||f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function bg(f,d,b){var w=f.tag;if(w===5||w===6)f=f.stateNode,d?s_(b,f,d):cy(b,f);else if(w!==4&&(rs&&w===27&&Rh(f.type)&&(b=f.stateNode,d=null),f=f.child,f!==null))for(bg(f,d,b),f=f.sibling;f!==null;)bg(f,d,b),f=f.sibling}function up(f,d,b){var w=f.tag;if(w===5||w===6)f=f.stateNode,d?r_(b,f,d):ly(b,f);else if(w!==4&&(rs&&w===27&&Rh(f.type)&&(b=f.stateNode),f=f.child,f!==null))for(up(f,d,b),f=f.sibling;f!==null;)up(f,d,b),f=f.sibling}function Vv(f,d,b){f=f.containerInfo;try{my(f,b)}catch(w){En(d,d.return,w)}}function Qx(f){var d=f.stateNode,b=f.memoizedProps;try{Kr(f.type,b,d,f)}catch(w){En(f,f.return,w)}}function QC(f,d){for(Fg(f.containerInfo),Fr=d;Fr!==null;)if(f=Fr,d=f.child,(f.subtreeFlags&1028)!==0&&d!==null)d.return=f,Fr=d;else for(;Fr!==null;){f=Fr;var b=f.alternate;switch(d=f.flags,f.tag){case 0:if((d&4)!==0&&(d=f.updateQueue,d=d!==null?d.events:null,d!==null))for(var w=0;w<d.length;w++){var N=d[w];N.ref.impl=N.nextImpl}break;case 11:case 15:break;case 1:if((d&1024)!==0&&b!==null){d=void 0,w=f,N=b.memoizedProps,b=b.memoizedState;var k=w.stateNode;try{var te=mh(w.type,N);d=k.getSnapshotBeforeUpdate(te,b),k.__reactInternalSnapshotBeforeUpdate=d}catch(ye){En(w,w.return,ye)}}break;case 3:(d&1024)!==0&&Zn&&fy(f.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(r(163))}if(d=f.sibling,d!==null){d.return=f.return,Fr=d;break}Fr=f.return}}function Vx(f,d,b){var w=b.flags;switch(b.tag){case 0:case 11:case 15:la(f,b),w&4&&Tl(5,b);break;case 1:if(la(f,b),w&4)if(f=b.stateNode,d===null)try{f.componentDidMount()}catch(te){En(b,b.return,te)}else{var N=mh(b.type,d.memoizedProps);d=d.memoizedState;try{f.componentDidUpdate(N,d,f.__reactInternalSnapshotBeforeUpdate)}catch(te){En(b,b.return,te)}}w&64&&Rf(b),w&512&&Bf(b,b.return);break;case 3:if(la(f,b),w&64&&(w=b.updateQueue,w!==null)){if(f=null,b.child!==null)switch(b.child.tag){case 27:case 5:f=Hf(b.child.stateNode);break;case 1:f=b.child.stateNode}try{Tt(w,f)}catch(te){En(b,b.return,te)}}break;case 27:rs&&d===null&&w&4&&Qx(b);case 26:case 5:if(la(f,b),d===null){if(w&4)yh(b);else if(w&64){f=b.type,d=b.memoizedProps,N=b.stateNode;try{M_(N,f,d,b)}catch(te){En(b,b.return,te)}}}w&512&&Bf(b,b.return);break;case 12:la(f,b);break;case 31:la(f,b),w&4&&mo(f,b);break;case 13:la(f,b),w&4&&fp(f,b),w&64&&(w=b.memoizedState,w!==null&&(w=w.dehydrated,w!==null&&(b=VC.bind(null,b),Qg(w,b))));break;case 22:if(w=b.memoizedState!==null||_r,!w){d=d!==null&&d.memoizedState!==null||Sr,N=_r;var k=Sr;_r=w,(Sr=d)&&!k?Ao(f,b,(b.subtreeFlags&8772)!==0):la(f,b),_r=N,Sr=k}break;case 30:break;default:la(f,b)}}function jv(f){var d=f.alternate;d!==null&&(f.alternate=null,jv(d)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(d=f.stateNode,d!==null&&Pg(d)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function po(f,d,b){for(b=b.child;b!==null;)hp(f,d,b),b=b.sibling}function hp(f,d,b){if(Ta&&typeof Ta.onCommitFiberUnmount=="function")try{Ta.onCommitFiberUnmount(Lh,b)}catch{}switch(b.tag){case 26:if(xo){Sr||Vs(b,d),po(f,d,b),b.memoizedState?_u(b.memoizedState):b.stateNode&&Cy(b.stateNode);break}case 27:if(rs){Sr||Vs(b,d);var w=fr,N=Pr;Rh(b.type)&&(fr=b.stateNode,Pr=!1),po(f,d,b),As(b.stateNode),fr=w,Pr=N;break}case 5:Sr||Vs(b,d);case 6:if(Zn){if(w=fr,N=Pr,fr=null,po(f,d,b),fr=w,Pr=N,fr!==null)if(Pr)try{uy(fr,b.stateNode)}catch(k){En(b,d,k)}else try{a_(fr,b.stateNode)}catch(k){En(b,d,k)}}else po(f,d,b);break;case 18:Zn&&fr!==null&&(Pr?Vg(fr,b.stateNode):_y(fr,b.stateNode));break;case 4:Zn?(w=fr,N=Pr,fr=b.stateNode.containerInfo,Pr=!0,po(f,d,b),fr=w,Pr=N):(qa&&Vv(b.stateNode,b,dy()),po(f,d,b));break;case 0:case 11:case 14:case 15:Il(2,b,d),Sr||Il(4,b,d),po(f,d,b);break;case 1:Sr||(Vs(b,d),w=b.stateNode,typeof w.componentWillUnmount=="function"&&yg(b,d,w)),po(f,d,b);break;case 21:po(f,d,b);break;case 22:Sr=(w=Sr)||b.memoizedState!==null,po(f,d,b),Sr=w;break;default:po(f,d,b)}}function mo(f,d){if(nr&&d.memoizedState===null&&(f=d.alternate,f!==null&&(f=f.memoizedState,f!==null))){f=f.dehydrated;try{XC(f)}catch(b){En(d,d.return,b)}}}function fp(f,d){if(nr&&d.memoizedState===null&&(f=d.alternate,f!==null&&(f=f.memoizedState,f!==null&&(f=f.dehydrated,f!==null))))try{YC(f)}catch(b){En(d,d.return,b)}}function go(f){switch(f.tag){case 31:case 13:case 19:var d=f.stateNode;return d===null&&(d=f.stateNode=new Py),d;case 22:return f=f.stateNode,d=f._retryCache,d===null&&(d=f._retryCache=new Py),d;default:throw Error(r(435,f.tag))}}function vc(f,d){var b=go(f);d.forEach(function(w){if(!b.has(w)){b.add(w);var N=jC.bind(null,f,w);w.then(N,N)}})}function ms(f,d){var b=d.deletions;if(b!==null)for(var w=0;w<b.length;w++){var N=b[w],k=f,te=d;if(Zn){var ye=te;e:for(;ye!==null;){switch(ye.tag){case 27:if(rs){if(Rh(ye.type)){fr=ye.stateNode,Pr=!1;break e}break}case 5:fr=ye.stateNode,Pr=!1;break e;case 3:case 4:fr=ye.stateNode.containerInfo,Pr=!0;break e}ye=ye.return}if(fr===null)throw Error(r(160));hp(k,te,N),fr=null,Pr=!1}else hp(k,te,N);k=N.alternate,k!==null&&(k.return=null),N.return=null}if(d.subtreeFlags&13886)for(d=d.child;d!==null;)dp(d,f),d=d.sibling}function dp(f,d){var b=f.alternate,w=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:ms(d,f),gs(f),w&4&&(Il(3,f,f.return),Tl(3,f),Il(5,f,f.return));break;case 1:ms(d,f),gs(f),w&512&&(Sr||b===null||Vs(b,b.return)),w&64&&_r&&(f=f.updateQueue,f!==null&&(w=f.callbacks,w!==null&&(b=f.shared.hiddenCallbacks,f.shared.hiddenCallbacks=b===null?w:b.concat(w))));break;case 26:if(xo){var N=wi;if(ms(d,f),gs(f),w&512&&(Sr||b===null||Vs(b,b.return)),w&4){w=b!==null?b.memoizedState:null;var k=f.memoizedState;b===null?k===null?f.stateNode===null?f.stateNode=D_(N,f.type,f.memoizedProps,f):My(N,f.type,f.stateNode):f.stateNode=wy(N,k,f.memoizedProps):w!==k?(w===null?b.stateNode!==null&&Cy(b.stateNode):_u(w),k===null?My(N,f.type,f.stateNode):wy(N,k,f.memoizedProps)):k===null&&f.stateNode!==null&&cp(f,f.memoizedProps,b.memoizedProps)}break}case 27:if(rs){ms(d,f),gs(f),w&512&&(Sr||b===null||Vs(b,b.return)),b!==null&&w&4&&cp(f,f.memoizedProps,b.memoizedProps);break}case 5:if(ms(d,f),gs(f),w&512&&(Sr||b===null||Vs(b,b.return)),Zn){if(f.flags&32){N=f.stateNode;try{hy(N)}catch(Et){En(f,f.return,Et)}}w&4&&f.stateNode!=null&&(N=f.memoizedProps,cp(f,N,b!==null?b.memoizedProps:N)),w&1024&&(Yf=!0)}else qa&&f.alternate!==null&&(f.alternate.stateNode=f.stateNode);break;case 6:if(ms(d,f),gs(f),w&4&&Zn){if(f.stateNode===null)throw Error(r(162));w=f.memoizedProps,b=b!==null?b.memoizedProps:w,N=f.stateNode;try{t_(N,b,w)}catch(Et){En(f,f.return,Et)}}break;case 3:if(xo?(L_(),N=wi,wi=wp(d.containerInfo),ms(d,f),wi=N):ms(d,f),gs(f),w&4){if(Zn&&nr&&b!==null&&b.memoizedState.isDehydrated)try{C_(d.containerInfo)}catch(Et){En(f,f.return,Et)}if(qa){w=d.containerInfo,b=d.pendingChildren;try{my(w,b)}catch(Et){En(f,f.return,Et)}}}Yf&&(Yf=!1,xg(f));break;case 4:xo?(b=wi,wi=wp(f.stateNode.containerInfo),ms(d,f),gs(f),wi=b):(ms(d,f),gs(f)),w&4&&qa&&Vv(f.stateNode,f,f.stateNode.pendingChildren);break;case 12:ms(d,f),gs(f);break;case 31:ms(d,f),gs(f),w&4&&(w=f.updateQueue,w!==null&&(f.updateQueue=null,vc(f,w)));break;case 13:ms(d,f),gs(f),f.child.flags&8192&&f.memoizedState!==null!=(b!==null&&b.memoizedState!==null)&&(Up=js()),w&4&&(w=f.updateQueue,w!==null&&(f.updateQueue=null,vc(f,w)));break;case 22:N=f.memoizedState!==null;var te=b!==null&&b.memoizedState!==null,ye=_r,Ke=Sr;if(_r=ye||N,Sr=Ke||te,ms(d,f),Sr=Ke,_r=ye,gs(f),w&8192&&(d=f.stateNode,d._visibility=N?d._visibility&-2:d._visibility|1,N&&(b===null||te||_r||Sr||cu(f)),Zn)){e:if(b=null,Zn)for(d=f;;){if(d.tag===5||xo&&d.tag===26){if(b===null){te=b=d;try{k=te.stateNode,N?WC(k):l_(te.stateNode,te.memoizedProps)}catch(Et){En(te,te.return,Et)}}}else if(d.tag===6){if(b===null){te=d;try{var vt=te.stateNode;N?o_(vt):c_(vt,te.memoizedProps)}catch(Et){En(te,te.return,Et)}}}else if(d.tag===18){if(b===null){te=d;try{var Pt=te.stateNode;N?I_(Pt):R_(te.stateNode)}catch(Et){En(te,te.return,Et)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===f)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===f)break e;for(;d.sibling===null;){if(d.return===null||d.return===f)break e;b===d&&(b=null),d=d.return}b===d&&(b=null),d.sibling.return=d.return,d=d.sibling}}w&4&&(w=f.updateQueue,w!==null&&(b=w.retryQueue,b!==null&&(w.retryQueue=null,vc(f,b))));break;case 19:ms(d,f),gs(f),w&4&&(w=f.updateQueue,w!==null&&(f.updateQueue=null,vc(f,w)));break;case 30:break;case 21:break;default:ms(d,f),gs(f)}}function gs(f){var d=f.flags;if(d&2){try{for(var b,w=f.return;w!==null;){if(Qv(w)){b=w;break}w=w.return}if(Zn){if(b==null)throw Error(r(160));switch(b.tag){case 27:if(rs){var N=b.stateNode,k=Ac(f);up(f,k,N);break}case 5:var te=b.stateNode;b.flags&32&&(hy(te),b.flags&=-33);var ye=Ac(f);up(f,ye,te);break;case 3:case 4:var Ke=b.stateNode.containerInfo,vt=Ac(f);bg(f,vt,Ke);break;default:throw Error(r(161))}}}catch(Pt){En(f,f.return,Pt)}f.flags&=-3}d&4096&&(f.flags&=-4097)}function xg(f){if(f.subtreeFlags&1024)for(f=f.child;f!==null;){var d=f;xg(d),d.tag===5&&d.flags&1024&&ry(d.stateNode),f=f.sibling}}function la(f,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)Vx(f,d.alternate,d),d=d.sibling}function cu(f){for(f=f.child;f!==null;){var d=f;switch(d.tag){case 0:case 11:case 14:case 15:Il(4,d,d.return),cu(d);break;case 1:Vs(d,d.return);var b=d.stateNode;typeof b.componentWillUnmount=="function"&&yg(d,d.return,b),cu(d);break;case 27:rs&&As(d.stateNode);case 26:case 5:Vs(d,d.return),cu(d);break;case 22:d.memoizedState===null&&cu(d);break;case 30:cu(d);break;default:cu(d)}f=f.sibling}}function Ao(f,d,b){for(b=b&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var w=d.alternate,N=f,k=d,te=k.flags;switch(k.tag){case 0:case 11:case 15:Ao(N,k,b),Tl(4,k);break;case 1:if(Ao(N,k,b),w=k,N=w.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(vt){En(w,w.return,vt)}if(w=k,N=w.updateQueue,N!==null){var ye=w.stateNode;try{var Ke=N.shared.hiddenCallbacks;if(Ke!==null)for(N.shared.hiddenCallbacks=null,N=0;N<Ke.length;N++)Ct(Ke[N],ye)}catch(vt){En(w,w.return,vt)}}b&&te&64&&Rf(k),Bf(k,k.return);break;case 27:rs&&Qx(k);case 26:case 5:Ao(N,k,b),b&&w===null&&te&4&&yh(k),Bf(k,k.return);break;case 12:Ao(N,k,b);break;case 31:Ao(N,k,b),b&&te&4&&mo(N,k);break;case 13:Ao(N,k,b),b&&te&4&&fp(N,k);break;case 22:k.memoizedState===null&&Ao(N,k,b),Bf(k,k.return);break;case 30:break;default:Ao(N,k,b)}d=d.sibling}}function uu(f,d){var b=null;f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),f=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(f=d.memoizedState.cachePool.pool),f!==b&&(f!=null&&f.refCount++,b!=null&&Ie(b))}function Wv(f,d){f=null,d.alternate!==null&&(f=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==f&&(d.refCount++,f!=null&&Ie(f))}function lr(f,d,b,w){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)_g(f,d,b,w),d=d.sibling}function _g(f,d,b,w){var N=d.flags;switch(d.tag){case 0:case 11:case 15:lr(f,d,b,w),N&2048&&Tl(9,d);break;case 1:lr(f,d,b,w);break;case 3:lr(f,d,b,w),N&2048&&(f=null,d.alternate!==null&&(f=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==f&&(d.refCount++,f!=null&&Ie(f)));break;case 12:if(N&2048){lr(f,d,b,w),f=d.stateNode;try{var k=d.memoizedProps,te=k.id,ye=k.onPostCommit;typeof ye=="function"&&ye(te,d.alternate===null?"mount":"update",f.passiveEffectDuration,-0)}catch(Ke){En(d,d.return,Ke)}}else lr(f,d,b,w);break;case 31:lr(f,d,b,w);break;case 13:lr(f,d,b,w);break;case 23:break;case 22:k=d.stateNode,te=d.alternate,d.memoizedState!==null?k._visibility&2?lr(f,d,b,w):Df(f,d):k._visibility&2?lr(f,d,b,w):(k._visibility|=2,_a(f,d,b,w,(d.subtreeFlags&10256)!==0||!1)),N&2048&&uu(te,d);break;case 24:lr(f,d,b,w),N&2048&&Wv(d.alternate,d);break;default:lr(f,d,b,w)}}function _a(f,d,b,w,N){for(N=N&&((d.subtreeFlags&10256)!==0||!1),d=d.child;d!==null;){var k=f,te=d,ye=b,Ke=w,vt=te.flags;switch(te.tag){case 0:case 11:case 15:_a(k,te,ye,Ke,N),Tl(8,te);break;case 23:break;case 22:var Pt=te.stateNode;te.memoizedState!==null?Pt._visibility&2?_a(k,te,ye,Ke,N):Df(k,te):(Pt._visibility|=2,_a(k,te,ye,Ke,N)),N&&vt&2048&&uu(te.alternate,te);break;case 24:_a(k,te,ye,Ke,N),N&&vt&2048&&Wv(te.alternate,te);break;default:_a(k,te,ye,Ke,N)}d=d.sibling}}function Df(f,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var b=f,w=d,N=w.flags;switch(w.tag){case 22:Df(b,w),N&2048&&uu(w.alternate,w);break;case 24:Df(b,w),N&2048&&Wv(w.alternate,w);break;default:Df(b,w)}d=d.sibling}}function Rl(f,d,b){if(f.subtreeFlags&$a)for(f=f.child;f!==null;)hu(f,d,b),f=f.sibling}function hu(f,d,b){switch(f.tag){case 26:if(Rl(f,d,b),f.flags&$a)if(f.memoizedState!==null)N_(b,wi,f.memoizedState,f.memoizedProps);else{var w=f.stateNode,N=f.type;f=f.memoizedProps,((d&335544128)===d||ny(N,f))&&Og(b,w,N,f)}break;case 5:Rl(f,d,b),f.flags&$a&&(w=f.stateNode,N=f.type,f=f.memoizedProps,((d&335544128)===d||ny(N,f))&&Og(b,w,N,f));break;case 3:case 4:xo?(w=wi,wi=wp(f.stateNode.containerInfo),Rl(f,d,b),wi=w):Rl(f,d,b);break;case 22:f.memoizedState===null&&(w=f.alternate,w!==null&&w.memoizedState!==null?(w=$a,$a=16777216,Rl(f,d,b),$a=w):Rl(f,d,b));break;default:Rl(f,d,b)}}function Sg(f){var d=f.alternate;if(d!==null&&(f=d.child,f!==null)){d.child=null;do d=f.sibling,f.sibling=null,f=d;while(f!==null)}}function Lf(f){var d=f.deletions;if((f.flags&16)!==0){if(d!==null)for(var b=0;b<d.length;b++){var w=d[b];Fr=w,Va(w,f)}Sg(f)}if(f.subtreeFlags&10256)for(f=f.child;f!==null;)Eg(f),f=f.sibling}function Eg(f){switch(f.tag){case 0:case 11:case 15:Lf(f),f.flags&2048&&Il(9,f,f.return);break;case 3:Lf(f);break;case 12:Lf(f);break;case 22:var d=f.stateNode;f.memoizedState!==null&&d._visibility&2&&(f.return===null||f.return.tag!==13)?(d._visibility&=-3,pp(f)):Lf(f);break;default:Lf(f)}}function pp(f){var d=f.deletions;if((f.flags&16)!==0){if(d!==null)for(var b=0;b<d.length;b++){var w=d[b];Fr=w,Va(w,f)}Sg(f)}for(f=f.child;f!==null;){switch(d=f,d.tag){case 0:case 11:case 15:Il(8,d,d.return),pp(d);break;case 22:b=d.stateNode,b._visibility&2&&(b._visibility&=-3,pp(d));break;default:pp(d)}f=f.sibling}}function Va(f,d){for(;Fr!==null;){var b=Fr;switch(b.tag){case 0:case 11:case 15:Il(8,b,d);break;case 23:case 22:if(b.memoizedState!==null&&b.memoizedState.cachePool!==null){var w=b.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:Ie(b.memoizedState.cache)}if(w=b.child,w!==null)w.return=b,Fr=w;else e:for(b=f;Fr!==null;){w=Fr;var N=w.sibling,k=w.return;if(jv(w),w===b){Fr=null;break e}if(N!==null){N.return=k,Fr=N;break e}Fr=k}}}function fu(f){var d=Dn(f);if(d!=null){if(typeof d.memoizedProps["data-testname"]!="string")throw Error(r(364));return d}if(f=Nr(f),f===null)throw Error(r(362));return f.stateNode.current}function du(f,d){var b=f.tag;switch(d.$$typeof){case Io:if(f.type===d.value)return!0;break;case $f:e:{for(d=d.value,f=[f,0],b=0;b<f.length;){var w=f[b++],N=w.tag,k=f[b++],te=d[k];if(N!==5&&N!==26&&N!==27||!bu(w)){for(;te!=null&&du(w,te);)k++,te=d[k];if(k===d.length){d=!0;break e}else for(w=w.child;w!==null;)f.push(w,k),w=w.sibling}}d=!1}return d;case Jf:if((b===5||b===26||b===27)&&oy(f.stateNode,d.value))return!0;break;case Tu:if((b===5||b===6||b===26||b===27)&&(f=Sp(f),f!==null&&0<=f.indexOf(d.value)))return!0;break;case Lp:if((b===5||b===26||b===27)&&(f=f.memoizedProps["data-testname"],typeof f=="string"&&f.toLowerCase()===d.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Nf(f){switch(f.$$typeof){case Io:return"<"+(g(f.value)||"Unknown")+">";case $f:return":has("+(Nf(f)||"")+")";case Jf:return'[role="'+f.value+'"]';case Tu:return'"'+f.value+'"';case Lp:return'[data-testname="'+f.value+'"]';default:throw Error(r(365))}}function Uf(f,d){var b=[];f=[f,0];for(var w=0;w<f.length;){var N=f[w++],k=N.tag,te=f[w++],ye=d[te];if(k!==5&&k!==26&&k!==27||!bu(N)){for(;ye!=null&&du(N,ye);)te++,ye=d[te];if(te===d.length)b.push(N);else for(N=N.child;N!==null;)f.push(N,te),N=N.sibling}}return b}function Sa(f,d){if(!is)throw Error(r(363));f=fu(f),f=Uf(f,d),d=[],f=Array.from(f);for(var b=0;b<f.length;){var w=f[b++],N=w.tag;if(N===5||N===26||N===27)bu(w)||d.push(w.stateNode);else for(w=w.child;w!==null;)f.push(w),w=w.sibling}return d}function tr(){return(Qn&2)!==0&&Yn!==0?Yn&-Yn:hn.T!==null?ht():Vf()}function yc(){if(pa===0)if((Yn&536870912)===0||Xn){var f=Dh;Dh<<=1,(Dh&3932160)===0&&(Dh=262144),pa=f}else pa=536870912;return f=Ia.current,f!==null&&(f.flags|=32),pa}function cr(f,d,b){(f===On&&(Mi===2||Mi===9)||f.cancelPendingCommit!==null)&&(br(f,0),Dl(f,Yn,pa,!1)),U(f,b),((Qn&2)===0||f!==On)&&(f===On&&((Qn&2)===0&&(Bu|=b),dr===4&&Dl(f,Yn,pa,!1)),st(f))}function Wo(f,d,b){if((Qn&6)!==0)throw Error(r(327));var w=!b&&(d&127)===0&&(d&f.expiredLanes)===0||C(f,d),N=w?qx(f,d):Ll(f,d,!0),k=w;do{if(N===0){Iu&&!w&&Dl(f,d,0,!1);break}else{if(b=f.current.alternate,k&&!jx(b)){N=Ll(f,d,!1),k=!1;continue}if(N===2){if(k=d,f.errorRecoveryDisabledLanes&k)var te=0;else te=f.pendingLanes&-536870913,te=te!==0?te:te&536870912?536870912:0;if(te!==0){d=te;e:{var ye=f;N=Np;var Ke=nr&&ye.current.memoizedState.isDehydrated;if(Ke&&(br(ye,te).flags|=256),te=Ll(ye,te,!1),te!==2){if(Ru&&!Ke){ye.errorRecoveryDisabledLanes|=k,Bu|=k,N=4;break e}k=Ba,Ba=N,k!==null&&(Ba===null?Ba=k:Ba.push.apply(Ba,k))}N=te}if(k=!1,N!==2)continue}}if(N===1){br(f,0),Dl(f,d,0,!0);break}e:{switch(w=f,k=N,k){case 0:case 1:throw Error(r(345));case 4:if((d&4194048)!==d)break;case 6:Dl(w,d,pa,!Ko);break e;case 2:Ba=null;break;case 3:case 5:break;default:throw Error(r(329))}if((d&62914560)===d&&(N=Up+300-js(),10<N)){if(Dl(w,d,pa,!Ko),E(w,0,!0)!==0)break e;ql=d,w.timeoutHandle=ty(Bl.bind(null,w,b,Ba,Fp,aA,d,pa,Bu,ed,Ko,k,"Throttled",-0,0),N);break e}Bl(w,b,Ba,Fp,aA,d,pa,Bu,ed,Ko,k,null,-0,0)}}break}while(!0);st(f)}function Bl(f,d,b,w,N,k,te,ye,Ke,vt,Pt,Et,Xt,Bn){if(f.timeoutHandle=Ma,Et=d.subtreeFlags,Et&8192||(Et&16785408)===16785408){Et=iy(),hu(d,k,Et);var Or=(k&62914560)===k?Up-js():(k&4194048)===k?kh-js():0;if(Or=e_(Et,Or),Or!==null){ql=k,f.cancelPendingCommit=Or(Ul.bind(null,f,d,k,b,w,N,te,ye,Ke,Pt,Et,null,Xt,Bn)),Dl(f,k,te,!vt);return}}Ul(f,d,k,b,w,N,te,ye,Ke)}function jx(f){for(var d=f;;){var b=d.tag;if((b===0||b===11||b===15)&&d.flags&16384&&(b=d.updateQueue,b!==null&&(b=b.stores,b!==null)))for(var w=0;w<b.length;w++){var N=b[w],k=N.getSnapshot;N=N.value;try{if(!Ur(k(),N))return!1}catch{return!1}}if(b=d.child,d.subtreeFlags&16384&&b!==null)b.return=d,d=b;else{if(d===f)break;for(;d.sibling===null;){if(d.return===null||d.return===f)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Dl(f,d,b,w){d&=~Zf,d&=~Bu,f.suspendedLanes|=d,f.pingedLanes&=~d,w&&(f.warmLanes|=d),w=f.expirationTimes;for(var N=d;0<N;){var k=31-Ca(N),te=1<<k;w[k]=-1,N&=~te}b!==0&&F(f,b,d)}function wg(){return(Qn&6)===0?(it(0),!1):!0}function Mg(){if(Vn!==null){if(Mi===0)var f=Vn.return;else f=Vn,Xo=Vi=null,Sn(f),wu=null,Nh=0,f=Vn;for(;f!==null;)Hx(f.alternate,f),f=f.return;Vn=null}}function br(f,d){var b=f.timeoutHandle;b!==Ma&&(f.timeoutHandle=Ma,Zx(b)),b=f.cancelPendingCommit,b!==null&&(f.cancelPendingCommit=null,b()),ql=0,Mg(),On=f,Vn=b=Wa(f.current,null),Yn=d,Mi=0,$r=null,Ko=!1,Iu=C(f,d),Ru=!1,ed=pa=Zf=Bu=Bc=dr=0,Ba=Np=null,aA=!1,(d&8)!==0&&(d|=d&32);var w=f.entangledLanes;if(w!==0)for(f=f.entanglements,w&=d;0<w;){var N=31-Ca(w),k=1<<N;d|=f[N],w&=~k}return Wl=d,qr(),b}function Qi(f,d){Ln=null,hn.H=Ka,d===os||d===Co?(d=rn(),Mi=3):d===rA?(d=rn(),Mi=4):Mi=d===da?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,$r=d,Vn===null&&(dr=1,mg(f,ue(d,f.current)))}function Jn(){var f=Ia.current;return f===null?!0:(Yn&4194048)===Yn?Ra===null:(Yn&62914560)===Yn||(Yn&536870912)!==0?f===Ra:!1}function bc(){var f=hn.H;return hn.H=Ka,f===null?Ka:f}function ja(){var f=hn.A;return hn.A=Kf,f}function Ff(){dr=4,Ko||(Yn&4194048)!==Yn&&Ia.current!==null||(Iu=!0),(Bc&134217727)===0&&(Bu&134217727)===0||On===null||Dl(On,Yn,pa,!1)}function Ll(f,d,b){var w=Qn;Qn|=2;var N=bc(),k=ja();(On!==f||Yn!==d)&&(Fp=null,br(f,d)),d=!1;var te=dr;e:do try{if(Mi!==0&&Vn!==null){var ye=Vn,Ke=$r;switch(Mi){case 8:Mg(),te=6;break e;case 3:case 2:case 9:case 6:Ia.current===null&&(d=!0);var vt=Mi;if(Mi=0,$r=null,Nl(f,ye,Ke,vt),b&&Iu){te=0;break e}break;default:vt=Mi,Mi=0,$r=null,Nl(f,ye,Ke,vt)}}Wx(),te=dr;break}catch(Pt){Qi(f,Pt)}while(!0);return d&&f.shellSuspendCounter++,Xo=Vi=null,Qn=w,hn.H=N,hn.A=k,Vn===null&&(On=null,Yn=0,qr()),te}function Wx(){for(;Vn!==null;)pu(Vn)}function qx(f,d){var b=Qn;Qn|=2;var w=bc(),N=ja();On!==f||Yn!==d?(Fp=null,Du=js()+500,br(f,d)):Iu=C(f,d);e:do try{if(Mi!==0&&Vn!==null){d=Vn;var k=$r;t:switch(Mi){case 1:Mi=0,$r=null,Nl(f,d,k,1);break;case 2:case 9:if(gt(k)){Mi=0,$r=null,Cg(d);break}d=function(){Mi!==2&&Mi!==9||On!==f||(Mi=7),st(f)},k.then(d,d);break e;case 3:Mi=7;break e;case 4:Mi=5;break e;case 7:gt(k)?(Mi=0,$r=null,Cg(d)):(Mi=0,$r=null,Nl(f,d,k,7));break;case 5:var te=null;switch(Vn.tag){case 26:te=Vn.memoizedState;case 5:case 27:var ye=Vn,Ke=ye.type,vt=ye.pendingProps;if(te?Iy(te):ur(ye.stateNode,Ke,vt)){Mi=0,$r=null;var Pt=ye.sibling;if(Pt!==null)Vn=Pt;else{var Et=ye.return;Et!==null?(Vn=Et,Of(Et)):Vn=null}break t}}Mi=0,$r=null,Nl(f,d,k,5);break;case 6:Mi=0,$r=null,Nl(f,d,k,6);break;case 8:Mg(),dr=6;break e;default:throw Error(r(462))}}Pf();break}catch(Xt){Qi(f,Xt)}while(!0);return Xo=Vi=null,hn.H=w,hn.A=N,Qn=b,Vn!==null?0:(On=null,Yn=0,qr(),dr)}function Pf(){for(;Vn!==null&&!F_();)pu(Vn)}function pu(f){var d=kv(f.alternate,f,Wl);f.memoizedProps=f.pendingProps,d===null?Of(f):Vn=d}function Cg(f){var d=f,b=d.alternate;switch(d.tag){case 15:case 0:d=Lv(b,d,d.pendingProps,d.type,void 0,Yn);break;case 11:d=Lv(b,d,d.pendingProps,d.type.render,d.ref,Yn);break;case 5:Sn(d);default:Hx(b,d),d=Vn=Rg(d,Wl),d=kv(b,d,Wl)}f.memoizedProps=f.pendingProps,d===null?Of(f):Vn=d}function Nl(f,d,b,w){Xo=Vi=null,Sn(d),wu=null,Nh=0;var N=d.return;try{if(HC(f,N,d,b,Yn)){dr=1,mg(f,ue(b,f.current)),Vn=null;return}}catch(k){if(N!==null)throw Vn=N,k;dr=1,mg(f,ue(b,f.current)),Vn=null;return}d.flags&32768?(Xn||w===1?f=!0:Iu||(Yn&536870912)!==0?f=!1:(Ko=f=!0,(w===2||w===9||w===3||w===6)&&(w=Ia.current,w!==null&&w.tag===13&&(w.flags|=16384))),mu(d,f)):Of(d)}function Of(f){var d=f;do{if((d.flags&32768)!==0){mu(d,Ko);return}f=d.return;var b=Gx(d.alternate,d,Wl);if(b!==null){Vn=b;return}if(d=d.sibling,d!==null){Vn=d;return}Vn=d=f}while(d!==null);dr===0&&(dr=5)}function mu(f,d){do{var b=Hv(f.alternate,f);if(b!==null){b.flags&=32767,Vn=b;return}if(b=f.return,b!==null&&(b.flags|=32768,b.subtreeFlags=0,b.deletions=null),!d&&(f=f.sibling,f!==null)){Vn=f;return}Vn=f=b}while(f!==null);dr=6,Vn=null}function Ul(f,d,b,w,N,k,te,ye,Ke){f.cancelPendingCommit=null;do Pl();while(Jr!==0);if((Qn&6)!==0)throw Error(r(327));if(d!==null){if(d===f.current)throw Error(r(177));if(k=d.lanes|d.childLanes,k|=Uh,O(f,b,k,te,ye,Ke),f===On&&(Vn=On=null,Yn=0),zh=d,Lc=f,ql=b,td=k,oA=N,Oy=w,(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?(f.callbackNode=null,f.callbackPriority=0,Yr(Cp,function(){return mp(),null})):(f.callbackNode=null,f.callbackPriority=0),w=(d.flags&13878)!==0,(d.subtreeFlags&13878)!==0||w){w=hn.T,hn.T=null,N=bo(),qn(2),te=Qn,Qn|=4;try{QC(f,d,b)}finally{Qn=te,qn(N),hn.T=w}}Jr=1,xc(),Fl(),Tg()}}function xc(){if(Jr===1){Jr=0;var f=Lc,d=zh,b=(d.flags&13878)!==0;if((d.subtreeFlags&13878)!==0||b){b=hn.T,hn.T=null;var w=bo();qn(2);var N=Qn;Qn|=4;try{dp(d,f),Jx(f.containerInfo)}finally{Qn=N,qn(w),hn.T=b}}f.current=d,Jr=2}}function Fl(){if(Jr===2){Jr=0;var f=Lc,d=zh,b=(d.flags&8772)!==0;if((d.subtreeFlags&8772)!==0||b){b=hn.T,hn.T=null;var w=bo();qn(2);var N=Qn;Qn|=4;try{Vx(f,d.alternate,d)}finally{Qn=N,qn(w),hn.T=b}}Jr=3}}function Tg(){if(Jr===4||Jr===3){Jr=0,By();var f=Lc,d=zh,b=ql,w=Oy;(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?Jr=5:(Jr=0,zh=Lc=null,Ig(f,f.pendingLanes));var N=f.pendingLanes;if(N===0&&(Dc=null),j(b),d=d.stateNode,Ta&&typeof Ta.onCommitFiberRoot=="function")try{Ta.onCommitFiberRoot(Lh,d,void 0,(d.current.flags&128)===128)}catch{}if(w!==null){d=hn.T,N=bo(),qn(2),hn.T=null;try{for(var k=f.onRecoverableError,te=0;te<w.length;te++){var ye=w[te];k(ye.value,{componentStack:ye.stack})}}finally{hn.T=d,qn(N)}}(ql&3)!==0&&Pl(),st(f),N=f.pendingLanes,(b&261930)!==0&&(N&42)!==0?f===Pp?fi++:(fi=0,Pp=f):fi=0,nr&&Ep(),it(0)}}function Ig(f,d){(f.pooledCacheLanes&=d)===0&&(d=f.pooledCache,d!=null&&(f.pooledCache=null,Ie(d)))}function Pl(){return xc(),Fl(),Tg(),mp()}function mp(){if(Jr!==5)return!1;var f=Lc,d=td;td=0;var b=j(ql),w=32>b?32:b;b=hn.T;var N=bo();try{qn(w),hn.T=null,w=oA,oA=null;var k=Lc,te=ql;if(Jr=0,zh=Lc=null,ql=0,(Qn&6)!==0)throw Error(r(331));var ye=Qn;if(Qn|=4,Eg(k.current),_g(k,k.current,te,w),Qn=ye,it(0,!1),Ta&&typeof Ta.onPostCommitFiberRoot=="function")try{Ta.onPostCommitFiberRoot(Lh,k)}catch{}return!0}finally{qn(N),hn.T=b,Ig(f,d)}}function gu(f,d,b){d=ue(b,d),d=Bv(f.stateNode,d,2),f=Ue(f,d,2),f!==null&&(U(f,2),st(f))}function En(f,d,b){if(f.tag===3)gu(f,f,b);else for(;d!==null;){if(d.tag===3){gu(d,f,b);break}else if(d.tag===1){var w=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Dc===null||!Dc.has(w))){f=ue(b,f),b=Ix(2),w=Ue(d,b,2),w!==null&&(Rx(b,w,d,f),U(w,2),st(w));break}}d=d.return}}function kf(f,d,b){var w=f.pingCache;if(w===null){w=f.pingCache=new Ja;var N=new Set;w.set(d,N)}else N=w.get(d),N===void 0&&(N=new Set,w.set(d,N));N.has(b)||(Ru=!0,N.add(b),f=Xx.bind(null,f,d,b),d.then(f,f))}function Xx(f,d,b){var w=f.pingCache;w!==null&&w.delete(d),f.pingedLanes|=f.suspendedLanes&b,f.warmLanes&=~b,On===f&&(Yn&b)===b&&(dr===4||dr===3&&(Yn&62914560)===Yn&&300>js()-Up?(Qn&2)===0&&br(f,0):Zf|=b,ed===Yn&&(ed=0)),st(f)}function Yx(f,d){d===0&&(d=R()),f=en(f,d),f!==null&&(U(f,d),st(f))}function VC(f){var d=f.memoizedState,b=0;d!==null&&(b=d.retryLane),Yx(f,b)}function jC(f,d){var b=0;switch(f.tag){case 31:case 13:var w=f.stateNode,N=f.memoizedState;N!==null&&(b=N.retryLane);break;case 19:w=f.stateNode;break;case 22:w=f.stateNode._retryCache;break;default:throw Error(r(314))}w!==null&&w.delete(d),Yx(f,b)}function Yr(f,d){return Mp(f,d)}function qv(f,d,b,w){this.tag=f,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bh(f){return f=f.prototype,!(!f||!f.isReactComponent)}function Wa(f,d){var b=f.alternate;return b===null?(b=t(f.tag,d,f.key,f.mode),b.elementType=f.elementType,b.type=f.type,b.stateNode=f.stateNode,b.alternate=f,f.alternate=b):(b.pendingProps=d,b.type=f.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=f.flags&65011712,b.childLanes=f.childLanes,b.lanes=f.lanes,b.child=f.child,b.memoizedProps=f.memoizedProps,b.memoizedState=f.memoizedState,b.updateQueue=f.updateQueue,d=f.dependencies,b.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},b.sibling=f.sibling,b.index=f.index,b.ref=f.ref,b.refCleanup=f.refCleanup,b}function Rg(f,d){f.flags&=65011714;var b=f.alternate;return b===null?(f.childLanes=0,f.lanes=d,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=b.childLanes,f.lanes=b.lanes,f.child=b.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=b.memoizedProps,f.memoizedState=b.memoizedState,f.updateQueue=b.updateQueue,f.type=b.type,d=b.dependencies,f.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),f}function _c(f,d,b,w,N,k){var te=0;if(w=f,typeof f=="function")bh(f)&&(te=1);else if(typeof f=="string")te=xo&&rs?jg(f,b,vs.current)?26:Ry(f)?27:5:xo?jg(f,b,vs.current)?26:5:rs&&Ry(f)?27:5;else e:switch(f){case yp:return f=t(31,b,d,N),f.elementType=yp,f.lanes=k,f;case Eh:return vo(b.children,N,k,d);case wh:te=8,N|=24;break;case Mh:return f=t(12,b,d,N|2),f.elementType=Mh,f.lanes=k,f;case Ng:return f=t(13,b,d,N),f.elementType=Ng,f.lanes=k,f;case Sc:return f=t(19,b,d,N),f.elementType=Sc,f.lanes=k,f;default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case yo:te=10;break e;case vp:te=9;break e;case zf:te=11;break e;case Ug:te=14;break e;case ca:te=16,w=null;break e}te=29,b=Error(r(130,f===null?"null":typeof f,"")),w=null}return d=t(te,b,d,N),d.elementType=f,d.type=w,d.lanes=k,d}function vo(f,d,b,w){return f=t(7,f,w,d),f.lanes=b,f}function Xv(f,d,b){return f=t(6,f,null,d),f.lanes=b,f}function Yv(f){var d=t(18,null,null,0);return d.stateNode=f,d}function Kv(f,d,b){return d=t(4,f.children!==null?f.children:[],f.key,d),d.lanes=b,d.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},d}function Kx(f,d,b,w,N,k,te,ye,Ke){this.tag=1,this.containerInfo=f,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ma,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=B(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=B(0),this.hiddenUpdates=B(null),this.identifierPrefix=w,this.onUncaughtError=N,this.onCaughtError=k,this.onRecoverableError=te,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ke,this.incompleteTransitions=new Map}function Au(f,d,b,w,N,k,te,ye,Ke,vt,Pt,Et){return f=new Kx(f,d,b,te,Ke,vt,Pt,Et,ye),d=1,k===!0&&(d|=24),k=t(3,null,null,d),f.current=k,k.stateNode=f,d=De(),d.refCount++,f.pooledCache=d,d.refCount++,k.memoizedState={element:w,isDehydrated:b,cache:d},Y(k),f}function Bg(f){return f?(f=kl,f):kl}function gp(f){var d=f._reactInternals;if(d===void 0)throw typeof f.render=="function"?Error(r(188)):(f=Object.keys(f).join(","),Error(r(268,f)));return f=o(d),f=f!==null?c(f):null,f===null?null:Hf(f.stateNode)}function $v(f,d,b,w,N,k){N=Bg(N),w.context===null?w.context=N:w.pendingContext=N,w=ge(d),w.payload={element:b},k=k===void 0?null:k,k!==null&&(w.callback=k),b=Ue(f,w,d),b!==null&&(cr(b,f,d),je(b,f,d))}function xh(f,d){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var b=f.retryLane;f.retryLane=b!==0&&b<d?b:d}}function Ap(f,d){xh(f,d),(f=f.alternate)&&xh(f,d)}var Fn={},Dg=Gd,Ea=tse,Lg=Object.assign,_h=Symbol.for("react.element"),Ol=Symbol.for("react.transitional.element"),Sh=Symbol.for("react.portal"),Eh=Symbol.for("react.fragment"),wh=Symbol.for("react.strict_mode"),Mh=Symbol.for("react.profiler"),vp=Symbol.for("react.consumer"),yo=Symbol.for("react.context"),zf=Symbol.for("react.forward_ref"),Ng=Symbol.for("react.suspense"),Sc=Symbol.for("react.suspense_list"),Ug=Symbol.for("react.memo"),ca=Symbol.for("react.lazy"),yp=Symbol.for("react.activity"),Jv=Symbol.for("react.memo_cache_sentinel"),Ec=Symbol.iterator,vu=Symbol.for("react.client.reference"),yu=Array.isArray,hn=Dg.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Zv=e.rendererVersion,bp=e.rendererPackageName,Gf=e.extraDevToolsConfig,Hf=e.getPublicInstance,$x=e.getRootHostContext,Qf=e.getChildHostContext,Fg=e.prepareForCommit,Jx=e.resetAfterCommit,ey=e.createInstance;e.cloneMutableInstance;var xp=e.appendInitialChild,wa=e.finalizeInitialChildren,ua=e.shouldSetTextContent,wc=e.createTextInstance;e.cloneMutableTextInstance;var ty=e.scheduleTimeout,Zx=e.cancelTimeout,Ma=e.noTimeout,Lr=e.isPrimaryRenderer;e.warnsIfNotActing;var Zn=e.supportsMutation,qa=e.supportsPersistence,nr=e.supportsHydration,Dn=e.getInstanceFromNode;e.beforeActiveInstanceBlur;var Di=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var qn=e.setCurrentUpdatePriority,bo=e.getCurrentUpdatePriority,Vf=e.resolveUpdatePriority;e.trackSchedulerEvent,e.resolveEventType,e.resolveEventTimeStamp;var Ch=e.shouldAttemptEagerTransition,Pg=e.detachDeletedInstance;e.requestPostPaintCallback;var _p=e.maySuspendCommit,jf=e.maySuspendCommitOnUpdate,ny=e.maySuspendCommitInSyncRender,ur=e.preloadInstance,iy=e.startSuspendingCommit,Og=e.suspendInstance;e.suspendOnActiveViewTransition;var e_=e.waitForCommitToBeReady;e.getSuspendedCommitReason;var Th=e.NotPendingTransition,Ih=e.HostTransitionContext,ry=e.resetFormInstance;e.bindToConsole;var sy=e.supportsMicrotasks,ay=e.scheduleMicrotask,is=e.supportsTestSelectors,Nr=e.findFiberRoot,kg=e.getBoundingRect,Sp=e.getTextContent,bu=e.isHiddenSubtree,oy=e.matchAccessibilityRole,Mc=e.setFocusIfFocusable,zg=e.setupIntersectionObserver,ly=e.appendChild,cy=e.appendChildToContainer,t_=e.commitTextUpdate,n_=e.commitMount,i_=e.commitUpdate,r_=e.insertBefore,s_=e.insertInContainerBefore,a_=e.removeChild,uy=e.removeChildFromContainer,hy=e.resetTextContent,WC=e.hideInstance,o_=e.hideTextInstance,l_=e.unhideInstance,c_=e.unhideTextInstance;e.cancelViewTransitionName,e.cancelRootViewTransitionName,e.restoreRootViewTransitionName,e.cloneRootViewTransitionContainer,e.removeRootViewTransitionClone,e.measureClonedInstance,e.hasInstanceChanged,e.hasInstanceAffectedParent,e.startViewTransition,e.startGestureTransition,e.stopViewTransition,e.getCurrentGestureOffset,e.createViewTransitionInstance;var fy=e.clearContainer;e.createFragmentInstance,e.updateFragmentInstanceFiber,e.commitNewChildToFragmentInstance,e.deleteChildFromFragmentInstance;var u_=e.cloneInstance,dy=e.createContainerChildSet,py=e.appendChildToContainerChildSet,h_=e.finalizeContainerChildren,my=e.replaceContainerChildren,f_=e.cloneHiddenInstance,gy=e.cloneHiddenTextInstance,xu=e.isSuspenseInstancePending,Gg=e.isSuspenseInstanceFallback,Hg=e.getSuspenseInstanceFallbackErrorDetails,Qg=e.registerSuspenseInstanceRetry,d_=e.canHydrateFormStateMarker,Ay=e.isFormStateMarkerMatching,p_=e.getNextHydratableSibling,m_=e.getNextHydratableSiblingAfterSingleton,g_=e.getFirstHydratableChild,A_=e.getFirstHydratableChildWithinContainer,v_=e.getFirstHydratableChildWithinActivityInstance,y_=e.getFirstHydratableChildWithinSuspenseInstance,vy=e.getFirstHydratableChildWithinSingleton,b_=e.canHydrateInstance,x_=e.canHydrateTextInstance,yy=e.canHydrateActivityInstance,__=e.canHydrateSuspenseInstance,S_=e.hydrateInstance,qC=e.hydrateTextInstance,by=e.hydrateActivityInstance,E_=e.hydrateSuspenseInstance,w_=e.getNextHydratableInstanceAfterActivityInstance,xy=e.getNextHydratableInstanceAfterSuspenseInstance,M_=e.commitHydratedInstance,C_=e.commitHydratedContainer,XC=e.commitHydratedActivityInstance,YC=e.commitHydratedSuspenseInstance,T_=e.finalizeHydratedChildren,Ep=e.flushHydrationEvents;e.clearActivityBoundary;var _y=e.clearSuspenseBoundary;e.clearActivityBoundaryFromContainer;var Vg=e.clearSuspenseBoundaryFromContainer,I_=e.hideDehydratedBoundary,R_=e.unhideDehydratedBoundary,Wf=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var B_=e.validateHydratableInstance,Sy=e.validateHydratableTextInstance,xo=e.supportsResources,jg=e.isHostHoistableType,wp=e.getHoistableRoot,Ey=e.getResource,wy=e.acquireResource,_u=e.releaseResource,D_=e.hydrateHoistable,My=e.mountHoistable,Cy=e.unmountHoistable,Wg=e.createHoistableInstance,L_=e.prepareToCommitHoistables,Ty=e.mayResourceSuspendCommit,Iy=e.preloadResource,N_=e.suspendResource,rs=e.supportsSingletons,qg=e.resolveSingletonInstance,Kr=e.acquireSingletonInstance,As=e.releaseSingletonInstance,Ry=e.isHostSingletonType,Rh=e.isSingletonScope,Xg=[],Bh=-1,kl={},Ca=Math.clz32?Math.clz32:S,Yg=Math.log,U_=Math.LN2,Kg=256,Dh=262144,qf=4194304,Mp=Ea.unstable_scheduleCallback,$g=Ea.unstable_cancelCallback,F_=Ea.unstable_shouldYield,By=Ea.unstable_requestPaint,js=Ea.unstable_now,Jg=Ea.unstable_ImmediatePriority,P_=Ea.unstable_UserBlockingPriority,Cp=Ea.unstable_NormalPriority,Zg=Ea.unstable_IdlePriority,Dy=Ea.log,O_=Ea.unstable_setDisableYieldValue,Lh=null,Ta=null,Ur=typeof Object.is=="function"?Object.is:q,eA=typeof reportError=="function"?reportError:function(f){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof f=="object"&&f!==null&&typeof f.message=="string"?String(f.message):String(f),error:f});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",f);return}console.error(f)},KC=Object.prototype.hasOwnProperty,tA,zl,Tp=!1,Ly=new WeakMap,Cc=[],Gl=0,Li=null,Ip=0,_o=[],Xa=0,So=null,Ts=1,qo="",vs=A(null),Tc=A(null),Is=A(null),Rp=A(null),ss=null,ir=null,Xn=!1,Hl=null,ha=!1,nA=Error(r(519)),Eo=A(null),Vi=null,Xo=null,k_=typeof AbortController<"u"?AbortController:function(){var f=[],d=this.signal={aborted:!1,addEventListener:function(b,w){f.push(w)}};this.abort=function(){d.aborted=!0,f.forEach(function(b){return b()})}},ys=Ea.unstable_scheduleCallback,$C=Ea.unstable_NormalPriority,rr={$$typeof:yo,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Bp=null,Ei=null,Ws=!1,wo=!1,iA=!1,Su=0,Xf=null,Ny=0,Ic=0,as=null,Mo=hn.S;hn.S=function(f,d){kh=js(),typeof d=="object"&&d!==null&&typeof d.then=="function"&&Vt(f,d),Mo!==null&&Mo(f,d)};var Eu=A(null),os=Error(r(460)),rA=Error(r(474)),Co=Error(r(542)),Ql={then:function(){}},fa=null,wu=null,Nh=0,Rs=Ir(!0),Uy=Ir(!1),Bs=[],Vl=0,Uh=0,Ya=!1,sA=!1,Fh=A(null),Mu=A(0),Ia=A(null),Ra=null,xr=A(0),Rc=0,Ln=null,an=null,Cn=null,Pn=!1,Un=!1,ii=!1,qs=0,To=0,Yo=null,Fy=0,Ka={readContext:Z,use:ni,useCallback:ut,useContext:ut,useEffect:ut,useImperativeHandle:ut,useLayoutEffect:ut,useInsertionEffect:ut,useMemo:ut,useReducer:ut,useRef:ut,useState:ut,useDebugValue:ut,useDeferredValue:ut,useTransition:ut,useSyncExternalStore:ut,useId:ut,useHostTransitionStatus:ut,useFormState:ut,useActionState:ut,useOptimistic:ut,useMemoCache:ut,useCacheRefresh:ut};Ka.useEffectEvent=ut;var hr={readContext:Z,use:ni,useCallback:function(f,d){return zt().memoizedState=[f,d===void 0?null:d],f},useContext:Z,useEffect:iu,useImperativeHandle:function(f,d,b){b=b!=null?b.concat([f]):null,Qo(4194308,4,El.bind(null,d,f),b)},useLayoutEffect:function(f,d){return Qo(4194308,4,f,d)},useInsertionEffect:function(f,d){Qo(4,2,f,d)},useMemo:function(f,d){var b=zt();d=d===void 0?null:d;var w=f();if(ii){V(!0);try{f()}finally{V(!1)}}return b.memoizedState=[w,d],w},useReducer:function(f,d,b){var w=zt();if(b!==void 0){var N=b(d);if(ii){V(!0);try{b(d)}finally{V(!1)}}}else N=d;return w.memoizedState=w.baseState=N,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:N},w.queue=f,f=f.dispatch=Qs.bind(null,Ln,f),[w.memoizedState,f]},useRef:function(f){var d=zt();return f={current:f},d.memoizedState=f},useState:function(f){f=eu(f);var d=f.queue,b=jo.bind(null,Ln,d);return d.dispatch=b,[f.memoizedState,b]},useDebugValue:au,useDeferredValue:function(f,d){var b=zt();return Xr(b,f,d)},useTransition:function(){var f=eu(!1);return f=dh.bind(null,Ln,f.queue,!0,!1),zt().memoizedState=f,[!1,f]},useSyncExternalStore:function(f,d,b){var w=Ln,N=zt();if(Xn){if(b===void 0)throw Error(r(407));b=b()}else{if(b=d(),On===null)throw Error(r(349));(Yn&127)!==0||Br(w,d,b)}N.memoizedState=b;var k={value:b,getSnapshot:d};return N.queue=k,iu(Ho.bind(null,w,k,f),[f]),w.flags|=2048,Hs(9,{destroy:void 0},Dr.bind(null,w,k,b,d),null),b},useId:function(){var f=zt(),d=On.identifierPrefix;if(Xn){var b=qo,w=Ts;b=(w&~(1<<32-Ca(w)-1)).toString(32)+b,d="_"+d+"R_"+b,b=qs++,0<b&&(d+="H"+b.toString(32)),d+="_"}else b=Fy++,d="_"+d+"r_"+b.toString(32)+"_";return f.memoizedState=d},useHostTransitionStatus:Ef,useFormState:tu,useActionState:tu,useOptimistic:function(f){var d=zt();d.memoizedState=d.baseState=f;var b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=b,d=fg.bind(null,Ln,!0,b),b.dispatch=d,[f,d]},useMemoCache:$i,useCacheRefresh:function(){return zt().memoizedState=Qa.bind(null,Ln)},useEffectEvent:function(f){var d=zt(),b={impl:f};return d.memoizedState=b,function(){if((Qn&2)!==0)throw Error(r(440));return b.impl.apply(void 0,arguments)}}},jl={readContext:Z,use:ni,useCallback:wl,useContext:Z,useEffect:ho,useImperativeHandle:su,useInsertionEffect:Vo,useLayoutEffect:gc,useMemo:Ml,useReducer:Oi,useRef:fh,useState:function(){return Oi(In)},useDebugValue:au,useDeferredValue:function(f,d){var b=St();return rp(b,an.memoizedState,f,d)},useTransition:function(){var f=Oi(In)[0],d=St().memoizedState;return[typeof f=="boolean"?f:Lt(f),d]},useSyncExternalStore:Zi,useId:wf,useHostTransitionStatus:Ef,useFormState:_l,useActionState:_l,useOptimistic:function(f,d){var b=St();return co(b,an,f,d)},useMemoCache:$i,useCacheRefresh:Ms};jl.useEffectEvent=er;var Cu={readContext:Z,use:ni,useCallback:wl,useContext:Z,useEffect:ho,useImperativeHandle:su,useInsertionEffect:Vo,useLayoutEffect:gc,useMemo:Ml,useReducer:Ji,useRef:fh,useState:function(){return Ji(In)},useDebugValue:au,useDeferredValue:function(f,d){var b=St();return an===null?Xr(b,f,d):rp(b,an.memoizedState,f,d)},useTransition:function(){var f=Ji(In)[0],d=St().memoizedState;return[typeof f=="boolean"?f:Lt(f),d]},useSyncExternalStore:Zi,useId:wf,useHostTransitionStatus:Ef,useFormState:Sl,useActionState:Sl,useOptimistic:function(f,d){var b=St();return an!==null?co(b,an,f,d):(b.baseState=f,[f,b.queue.dispatch])},useMemoCache:$i,useCacheRefresh:Ms};Cu.useEffectEvent=er;var Dp={enqueueSetState:function(f,d,b){f=f._reactInternals;var w=tr(),N=ge(w);N.payload=d,b!=null&&(N.callback=b),d=Ue(f,N,w),d!==null&&(cr(d,f,w),je(d,f,w))},enqueueReplaceState:function(f,d,b){f=f._reactInternals;var w=tr(),N=ge(w);N.tag=1,N.payload=d,b!=null&&(N.callback=b),d=Ue(f,N,w),d!==null&&(cr(d,f,w),je(d,f,w))},enqueueForceUpdate:function(f,d){f=f._reactInternals;var b=tr(),w=ge(b);w.tag=2,d!=null&&(w.callback=d),d=Ue(f,w,b),d!==null&&(cr(d,f,b),je(d,f,b))}},da=Error(r(461)),Yi=!1,Ph={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},_r=!1,Sr=!1,Yf=!1,Py=typeof WeakSet=="function"?WeakSet:Set,Fr=null,fr=null,Pr=!1,wi=null,$a=8192,Kf={getCacheForType:function(f){var d=Z(rr),b=d.data.get(f);return b===void 0&&(b=f(),d.data.set(f,b)),b},cacheSignal:function(){return Z(rr).controller.signal}},Io=0,$f=1,Jf=2,Lp=3,Tu=4;if(typeof Symbol=="function"&&Symbol.for){var Oh=Symbol.for;Io=Oh("selector.component"),$f=Oh("selector.has_pseudo_class"),Jf=Oh("selector.role"),Lp=Oh("selector.test_id"),Tu=Oh("selector.text")}var Ja=typeof WeakMap=="function"?WeakMap:Map,Qn=0,On=null,Vn=null,Yn=0,Mi=0,$r=null,Ko=!1,Iu=!1,Ru=!1,Wl=0,dr=0,Bc=0,Bu=0,Zf=0,pa=0,ed=0,Np=null,Ba=null,aA=!1,Up=0,kh=0,Du=1/0,Fp=null,Dc=null,Jr=0,Lc=null,zh=null,ql=0,td=0,oA=null,Oy=null,fi=0,Pp=null;return Fn.attemptContinuousHydration=function(f){if(f.tag===13||f.tag===31){var d=en(f,67108864);d!==null&&cr(d,f,67108864),Ap(f,67108864)}},Fn.attemptHydrationAtCurrentPriority=function(f){if(f.tag===13||f.tag===31){var d=tr();d=W(d);var b=en(f,d);b!==null&&cr(b,f,d),Ap(f,d)}},Fn.attemptSynchronousHydration=function(f){switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var d=_(f.pendingLanes);if(d!==0){for(f.pendingLanes|=2,f.entangledLanes|=2;d;){var b=1<<31-Ca(d);f.entanglements[1]|=b,d&=~b}st(f),(Qn&6)===0&&(Du=js()+500,it(0))}}break;case 31:case 13:d=en(f,2),d!==null&&cr(d,f,2),wg(),Ap(f,2)}},Fn.batchedUpdates=function(f,d){return f(d)},Fn.createComponentSelector=function(f){return{$$typeof:Io,value:f}},Fn.createContainer=function(f,d,b,w,N,k,te,ye,Ke,vt){return Au(f,d,!1,null,b,w,k,null,te,ye,Ke,vt)},Fn.createHasPseudoClassSelector=function(f){return{$$typeof:$f,value:f}},Fn.createHydrationContainer=function(f,d,b,w,N,k,te,ye,Ke,vt,Pt,Et,Xt,Bn){var Or;return f=Au(b,w,!0,f,N,k,ye,Bn,Ke,vt,Pt,Et),f.context=Bg(null),b=f.current,w=tr(),w=W(w),N=ge(w),N.callback=(Or=d)!=null?Or:null,Ue(b,N,w),d=w,f.current.lanes=d,U(f,d),st(f),f},Fn.createPortal=function(f,d,b){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Sh,key:w==null?null:""+w,children:f,containerInfo:d,implementation:b}},Fn.createRoleSelector=function(f){return{$$typeof:Jf,value:f}},Fn.createTestNameSelector=function(f){return{$$typeof:Lp,value:f}},Fn.createTextSelector=function(f){return{$$typeof:Tu,value:f}},Fn.defaultOnCaughtError=function(f){console.error(f)},Fn.defaultOnRecoverableError=function(f){eA(f)},Fn.defaultOnUncaughtError=function(f){eA(f)},Fn.deferredUpdates=function(f){var d=hn.T,b=bo();try{return qn(32),hn.T=null,f()}finally{qn(b),hn.T=d}},Fn.discreteUpdates=function(f,d,b,w,N){var k=hn.T,te=bo();try{return qn(2),hn.T=null,f(d,b,w,N)}finally{qn(te),hn.T=k,Qn===0&&(Du=js()+500)}},Fn.findAllNodes=Sa,Fn.findBoundingRects=function(f,d){if(!is)throw Error(r(363));d=Sa(f,d),f=[];for(var b=0;b<d.length;b++)f.push(kg(d[b]));for(d=f.length-1;0<d;d--){b=f[d];for(var w=b.x,N=w+b.width,k=b.y,te=k+b.height,ye=d-1;0<=ye;ye--)if(d!==ye){var Ke=f[ye],vt=Ke.x,Pt=vt+Ke.width,Et=Ke.y,Xt=Et+Ke.height;if(w>=vt&&k>=Et&&N<=Pt&&te<=Xt){f.splice(d,1);break}else if(w!==vt||b.width!==Ke.width||Xt<k||Et>te){if(!(k!==Et||b.height!==Ke.height||Pt<w||vt>N)){vt>w&&(Ke.width+=vt-w,Ke.x=w),Pt<N&&(Ke.width=N-vt),f.splice(d,1);break}}else{Et>k&&(Ke.height+=Et-k,Ke.y=k),Xt<te&&(Ke.height=te-Et),f.splice(d,1);break}}}return f},Fn.findHostInstance=gp,Fn.findHostInstanceWithNoPortals=function(f){return f=o(f),f=f!==null?h(f):null,f===null?null:Hf(f.stateNode)},Fn.findHostInstanceWithWarning=function(f){return gp(f)},Fn.flushPassiveEffects=Pl,Fn.flushSyncFromReconciler=function(f){var d=Qn;Qn|=1;var b=hn.T,w=bo();try{if(qn(2),hn.T=null,f)return f()}finally{qn(w),hn.T=b,Qn=d,(Qn&6)===0&&it(0)}},Fn.flushSyncWork=wg,Fn.focusWithin=function(f,d){if(!is)throw Error(r(363));for(f=fu(f),d=Uf(f,d),d=Array.from(d),f=0;f<d.length;){var b=d[f++],w=b.tag;if(!bu(b)){if((w===5||w===26||w===27)&&Mc(b.stateNode))return!0;for(b=b.child;b!==null;)d.push(b),b=b.sibling}}return!1},Fn.getFindAllNodesFailureDescription=function(f,d){if(!is)throw Error(r(363));var b=0,w=[];f=[fu(f),0];for(var N=0;N<f.length;){var k=f[N++],te=k.tag,ye=f[N++],Ke=d[ye];if((te!==5&&te!==26&&te!==27||!bu(k))&&(du(k,Ke)&&(w.push(Nf(Ke)),ye++,ye>b&&(b=ye)),ye<d.length))for(k=k.child;k!==null;)f.push(k,ye),k=k.sibling}if(b<d.length){for(f=[];b<d.length;b++)f.push(Nf(d[b]));return`findAllNodes was able to match part of the selector:
  `+(w.join(" > ")+`

No matching component was found for:
  `)+f.join(" > ")}return null},Fn.getPublicRootInstance=function(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 27:case 5:return Hf(f.child.stateNode);default:return f.child.stateNode}},Fn.injectIntoDevTools=function(){var f={bundleType:0,version:Zv,rendererPackageName:bp,currentDispatcherRef:hn,reconcilerVersion:"19.2.0"};if(Gf!==null&&(f.rendererConfig=Gf),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")f=!1;else{var d=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(d.isDisabled||!d.supportsFiber)f=!0;else{try{Lh=d.inject(f),Ta=d}catch{}f=!!d.checkDCE}}return f},Fn.isAlreadyRendering=function(){return(Qn&6)!==0},Fn.observeVisibleRects=function(f,d,b,w){if(!is)throw Error(r(363));f=Sa(f,d);var N=zg(f,b,w).disconnect;return{disconnect:function(){N()}}},Fn.shouldError=function(){return null},Fn.shouldSuspend=function(){return!1},Fn.startHostTransition=function(f,d,b,w){if(f.tag!==5)throw Error(r(476));var N=ph(f).queue;dh(f,N,d,Th,b===null?i:function(){var k=ph(f);return k.next===null&&(k=f.alternate.memoizedState),ou(f,k.next.queue,{},tr()),b(w)})},Fn.updateContainer=function(f,d,b,w){var N=d.current,k=tr();return $v(N,k,f,d,b,w),k},Fn.updateContainerSync=function(f,d,b,w){return $v(d.current,2,f,d,b,w),2},Fn},n.exports.default=n.exports,Object.defineProperty(n.exports,"__esModule",{value:!0})})(qP)),qP.exports}var YP;function Ise(){return YP||(YP=1,WP.exports=Tse()),WP.exports}var Rse=Ise();const Bse=Cse(Rse);function Dse(n){const e=Bse(n);return e.injectIntoDevTools(),e}const Ez=0,z0={},Lse=/^three(?=[A-Z])/,sC=n=>`${n[0].toUpperCase()}${n.slice(1)}`;let Nse=0;const Use=n=>typeof n=="function";function wz(n){if(Use(n)){const e=`${Nse++}`;return z0[e]=n,e}else Object.assign(z0,n)}function Mz(n,e){const t=sC(n),i=z0[t];if(n!=="primitive"&&!i)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(n==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function Fse(n,e,t){var i;return n=sC(n)in z0?n:n.replace(Lse,""),Mz(n,e),n==="primitive"&&(i=e.object)!=null&&i.__r3f&&delete e.object.__r3f,qw(e.object,t,n,e)}function Pse(n){if(!n.isHidden){var e;n.props.attach&&(e=n.parent)!=null&&e.object?Yw(n.parent,n):so(n.object)&&(n.object.visible=!1),n.isHidden=!0,pv(n)}}function Cz(n){if(n.isHidden){var e;n.props.attach&&(e=n.parent)!=null&&e.object?Xw(n.parent,n):so(n.object)&&n.props.visible!==!1&&(n.object.visible=!0),n.isHidden=!1,pv(n)}}function K4(n,e,t){const i=e.root.getState();if(!(!n.parent&&n.object!==i.scene)){if(!e.object){var r,s;const a=z0[sC(e.type)];e.object=(r=e.props.object)!=null?r:new a(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(ju(e.object,e.props),e.props.attach)Xw(n,e);else if(so(e.object)&&so(n.object)){const a=n.object.children.indexOf(t?.object);if(t&&a!==-1){const o=n.object.children.indexOf(e.object);if(o!==-1){n.object.children.splice(o,1);const c=o<a?a-1:a;n.object.children.splice(c,0,e.object)}else e.object.parent=n.object,n.object.children.splice(a,0,e.object),e.object.dispatchEvent({type:"added"}),n.object.dispatchEvent({type:"childadded",child:e.object})}else n.object.add(e.object)}for(const a of e.children)K4(e,a);pv(e)}}function HI(n,e){e&&(e.parent=n,n.children.push(e),K4(n,e))}function KP(n,e,t){if(!e||!t)return;e.parent=n;const i=n.children.indexOf(t);i!==-1?n.children.splice(i,0,e):n.children.push(e),K4(n,e,t)}function Tz(n){if(typeof n.dispose=="function"){const e=()=>{try{n.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():u2.unstable_scheduleCallback(u2.unstable_IdlePriority,e)}}function f2(n,e,t){if(!e)return;e.parent=null;const i=n.children.indexOf(e);i!==-1&&n.children.splice(i,1),e.props.attach?Yw(n,e):so(e.object)&&so(n.object)&&(n.object.remove(e.object),vse(Az(e),e.object));const r=e.props.dispose!==null&&t!==!1;for(let s=e.children.length-1;s>=0;s--){const a=e.children[s];f2(e,a,r)}e.children.length=0,delete e.object.__r3f,r&&e.type!=="primitive"&&e.object.type!=="Scene"&&Tz(e.object),t===void 0&&pv(e)}function Ose(n,e){for(const t of[n,n.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const i=t.ref(e);typeof i=="function"&&(t.refCleanup=i)}else t.ref&&(t.ref.current=e)}const ew=[];function kse(){for(const[t]of ew){const i=t.parent;if(i){t.props.attach?Yw(i,t):so(t.object)&&so(i.object)&&i.object.remove(t.object);for(const r of t.children)r.props.attach?Yw(t,r):so(r.object)&&so(t.object)&&t.object.remove(r.object)}t.isHidden&&Cz(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&Tz(t.object)}for(const[t,i,r]of ew){t.props=i;const s=t.parent;if(s){var n,e;const a=z0[sC(t.type)];t.object=(n=t.props.object)!=null?n:new a(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,Ose(r,t.object),ju(t.object,t.props),t.props.attach?Xw(s,t):so(t.object)&&so(s.object)&&s.object.add(t.object);for(const o of t.children)o.props.attach?Xw(t,o):so(o.object)&&so(t.object)&&t.object.add(o.object);pv(t)}}ew.length=0}const QI=()=>{},$P={};let xE=Ez;const zse=0,Gse=4,G0=Dse({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:Fse,removeChild:f2,appendChild:HI,appendInitialChild:HI,insertBefore:KP,appendChildToContainer(n,e){const t=n.getState().scene.__r3f;!e||!t||HI(t,e)},removeChildFromContainer(n,e){const t=n.getState().scene.__r3f;!e||!t||f2(t,e)},insertInContainerBefore(n,e,t){const i=n.getState().scene.__r3f;!e||!t||!i||KP(i,e,t)},getRootHostContext:()=>$P,getChildHostContext:()=>$P,commitUpdate(n,e,t,i,r){var s,a,o;Mz(e,i);let c=!1;if((n.type==="primitive"&&t.object!==i.object||((s=i.args)==null?void 0:s.length)!==((a=t.args)==null?void 0:a.length)||(o=i.args)!=null&&o.some((p,g)=>{var A;return p!==((A=t.args)==null?void 0:A[g])}))&&(c=!0),c)ew.push([n,{...i},r]);else{const p=mse(n,i);Object.keys(p).length&&(Object.assign(n.props,p),ju(n.object,p))}(r.sibling===null||(r.flags&Gse)===zse)&&kse()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:n=>n?.object,prepareForCommit:()=>null,preparePortalMount:n=>qw(n.getState().scene,n,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:Pse,unhideInstance:Cz,createTextInstance:QI,hideTextInstance:QI,unhideTextInstance:QI,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:X.createContext(null),setCurrentUpdatePriority(n){xE=n},getCurrentUpdatePriority(){return xE},resolveUpdatePriority(){var n;if(xE!==Ez)return xE;switch(typeof window<"u"&&((n=window.event)==null?void 0:n.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return wse;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Sse;default:return Ese}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:Mse.version,applyViewTransitionName(n,e,t){},restoreViewTransitionName(n,e){},cancelViewTransitionName(n,e,t){},cancelRootViewTransitionName(n){},restoreRootViewTransitionName(n){},InstanceMeasurement:null,measureInstance:n=>null,wasInstanceInViewport:n=>!0,hasInstanceChanged:(n,e)=>!1,hasInstanceAffectedParent:(n,e)=>!1,suspendOnActiveViewTransition(n,e){},startGestureTransition:()=>null,startViewTransition:()=>null,stopViewTransition(n){},createViewTransitionInstance:n=>null,getCurrentGestureOffset(n){throw new Error("startGestureTransition is not yet supported in react-three-fiber.")},cloneMutableInstance(n,e){return n},cloneMutableTextInstance(n){return n},cloneRootViewTransitionContainer(n){throw new Error("Not implemented.")},removeRootViewTransitionClone(n,e){throw new Error("Not implemented.")},createFragmentInstance:n=>null,updateFragmentInstanceFiber(n,e){},commitNewChildToFragmentInstance(n,e){},deleteChildFromFragmentInstance(n,e){},measureClonedInstance:n=>null,maySuspendCommitOnUpdate:(n,e,t)=>!1,maySuspendCommitInSyncRender:(n,e)=>!1,startSuspendingCommit:()=>null,getSuspendedCommitReason:(n,e)=>null}),eg=new Map,ZA={objects:"shallow",strict:!1};function Hse(n,e){if(!e&&typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:t,height:i,top:r,left:s}=n.parentElement.getBoundingClientRect();return{width:t,height:i,top:r,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function Qse(n){const e=eg.get(n),t=e?.fiber,i=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||bse(m2,ZP),a=t||G0.createContainer(s,_se,null,!1,null,"",r,r,r,null);e||eg.set(n,{fiber:a,store:s});let o,c,h=!1,p=null;return{async configure(g={}){let A;p=new Promise(z=>A=z);let{gl:v,size:x,scene:S,events:_,onCreated:E,shadows:C=!1,linear:T=!1,flat:R=!1,legacy:B=!1,orthographic:U=!1,frameloop:O="always",dpr:F=[1,2],performance:L,raycaster:P,camera:W,onPointerMissed:j}=g,V=s.getState(),q=V.gl;if(!V.gl){const z={canvas:n,powerPreference:"high-performance",antialias:!0,alpha:!0},$=typeof v=="function"?await v(z):v;VP($)?q=$:q=new ZM({...z,...v}),V.set({gl:q})}let re=V.raycaster;re||V.set({raycaster:re=new ep});const{params:Q,...K}=P||{};if(wr.equ(K,re,ZA)||ju(re,{...K}),wr.equ(Q,re.params,ZA)||ju(re,{params:{...re.params,...Q}}),!V.camera||V.camera===c&&!wr.equ(c,W,ZA)){c=W;const z=W?.isCamera,$=z?W:U?new Yc(0,0,0,0,.1,1e3):new Gr(75,0,.1,1e3);z||($.position.z=5,W&&(ju($,W),$.manual||("aspect"in W||"left"in W||"right"in W||"bottom"in W||"top"in W)&&($.manual=!0,$.updateProjectionMatrix())),!V.camera&&!(W!=null&&W.rotation)&&$.lookAt(0,0,0)),V.set({camera:$}),re.camera=$}if(!V.scene){let z;S!=null&&S.isScene?(z=S,qw(z,s,"",{})):(z=new uc,qw(z,s,"",{}),S&&ju(z,S)),V.set({scene:z})}_&&!V.events.handlers&&V.set({events:_(s)});const ce=Hse(n,x);if(wr.equ(ce,V.size,ZA)||V.setSize(ce.width,ce.height,ce.top,ce.left),F&&V.viewport.dpr!==yz(F)&&V.setDpr(F),V.frameloop!==O&&V.setFrameloop(O),V.onPointerMissed||V.set({onPointerMissed:j}),L&&!wr.equ(L,V.performance,ZA)&&V.set(z=>({performance:{...z.performance,...L}})),!V.xr){var ue;const z=(he,me)=>{const le=s.getState();le.frameloop!=="never"&&ZP(he,!0,le,me)},$=()=>{const he=s.getState();he.gl.xr.enabled=he.gl.xr.isPresenting,he.gl.xr.setAnimationLoop(he.gl.xr.isPresenting?z:null),he.gl.xr.isPresenting||m2(he)},ae={connect(){const he=s.getState().gl;he.xr.addEventListener("sessionstart",$),he.xr.addEventListener("sessionend",$)},disconnect(){const he=s.getState().gl;he.xr.removeEventListener("sessionstart",$),he.xr.removeEventListener("sessionend",$)}};typeof((ue=q.xr)==null?void 0:ue.addEventListener)=="function"&&ae.connect(),V.set({xr:ae})}if(q.shadowMap){const z=q.shadowMap.enabled,$=q.shadowMap.type;if(q.shadowMap.enabled=!!C,wr.boo(C))q.shadowMap.type=J1;else if(wr.str(C)){var oe;const ae={basic:kk,percentage:h0,soft:J1,variance:mm};q.shadowMap.type=(oe=ae[C])!=null?oe:J1}else wr.obj(C)&&Object.assign(q.shadowMap,C);(z!==q.shadowMap.enabled||$!==q.shadowMap.type)&&(q.shadowMap.needsUpdate=!0)}return Wn.enabled=!B,h||(q.outputColorSpace=T?Xi:xi,q.toneMapping=R?ko:Kb),V.legacy!==B&&V.set(()=>({legacy:B})),V.linear!==T&&V.set(()=>({linear:T})),V.flat!==R&&V.set(()=>({flat:R})),v&&!wr.fun(v)&&!VP(v)&&!wr.equ(v,q,ZA)&&ju(q,v),o=E,h=!0,A(),this},render(g){return!h&&!p&&this.configure(),p.then(()=>{G0.updateContainer(D.jsx(Vse,{store:s,children:g,onCreated:o,rootElement:n}),a,null,()=>{})}),s},unmount(){Iz(n)}}}function Vse({store:n,children:e,onCreated:t,rootElement:i}){return cx(()=>{const r=n.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),n.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),D.jsx(ux.Provider,{value:n,children:e})}function Iz(n,e){const t=eg.get(n),i=t?.fiber;if(i){const r=t?.store.getState();r&&(r.internal.active=!1),G0.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,a,o,c;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(o=r.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(c=r.gl)!=null&&c.xr&&r.xr.disconnect(),fse(r.scene),eg.delete(n)}catch{}},500)})}}function aC(n,e,t){return D.jsx(jse,{children:n,container:e,state:t})}function jse({state:n={},children:e,container:t}){const{events:i,size:r,...s}=n,a=ih(),[o]=X.useState(()=>new ep),[c]=X.useState(()=>new Ze),h=Y4((g,A)=>{let v;if(A.camera&&r){const x=A.camera;v=g.viewport.getCurrentViewport(x,new ee,r),x!==g.camera&&xz(x,r)}return{...g,...A,scene:t,raycaster:o,pointer:c,mouse:c,previousRoot:a,events:{...g.events,...A.events,...i},size:{...g.size,...r},viewport:{...g.viewport,...v},setEvents:x=>A.set(S=>({...S,events:{...S.events,...x}}))}}),p=X.useMemo(()=>{const g=hz((v,x)=>({...s,set:v,get:x})),A=v=>g.setState(x=>h.current(v,x));return A(a.getState()),a.subscribe(A),g},[a,t]);return D.jsx(D.Fragment,{children:G0.createPortal(D.jsx(ux.Provider,{value:p,children:e}),p,null)})}function Wse(n,e){const t={callback:n};return e.add(t),()=>{e.delete(t)}}const Rz=new Set,qse=new Set,Xse=new Set,Yse=n=>Wse(n,Rz);function VI(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function rb(n,e){switch(n){case"before":return VI(Rz,e);case"after":return VI(qse,e);case"tail":return VI(Xse,e)}}let jI,WI;function d2(n,e,t){let i=e.clock.getDelta();e.frameloop==="never"&&typeof n=="number"&&(i=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),jI=e.internal.subscribers;for(let r=0;r<jI.length;r++)WI=jI[r],WI.ref.current(WI.store.getState(),i,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let Kw=!1,p2=!1,qI,JP,e0;function Bz(n){JP=requestAnimationFrame(Bz),Kw=!0,qI=0,rb("before",n),p2=!0;for(const t of eg.values()){var e;e0=t.store.getState(),e0.internal.active&&(e0.frameloop==="always"||e0.internal.frames>0)&&!((e=e0.gl.xr)!=null&&e.isPresenting)&&(qI+=d2(n,e0))}if(p2=!1,rb("after",n),qI===0)return rb("tail",n),Kw=!1,cancelAnimationFrame(JP)}function m2(n,e=1){var t;if(!n)return eg.forEach(i=>m2(i.store.getState(),e));(t=n.gl.xr)!=null&&t.isPresenting||!n.internal.active||n.frameloop==="never"||(e>1?n.internal.frames=Math.min(60,n.internal.frames+e):p2?n.internal.frames=2:n.internal.frames=1,Kw||(Kw=!0,requestAnimationFrame(Bz)))}function ZP(n,e=!0,t,i){if(e&&rb("before",n),t)d2(n,t,i);else for(const r of eg.values())d2(n,r.store.getState());e&&rb("after",n)}const XI={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Kse(n){const{handlePointer:e}=yse(n);return{priority:1,enabled:!0,compute(t,i,r){i.pointer.set(t.offsetX/i.size.width*2-1,-(t.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(XI).reduce((t,i)=>({...t,[i]:e(i)}),{}),update:()=>{var t;const{events:i,internal:r}=n.getState();(t=r.lastEvent)!=null&&t.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{const{set:i,events:r}=n.getState();if(r.disconnect==null||r.disconnect(),i(s=>({events:{...s.events,connected:t}})),r.handlers)for(const s in r.handlers){const a=r.handlers[s],[o,c]=XI[s];t.addEventListener(o,a,{passive:c})}},disconnect:()=>{const{set:t,events:i}=n.getState();if(i.connected){if(i.handlers)for(const r in i.handlers){const s=i.handlers[r],[a]=XI[r];i.connected.removeEventListener(a,s)}t(r=>({events:{...r.events,connected:void 0}}))}}}}function eO(n,e){let t;return(...i)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...i),e)}}function $se({debounce:n,scroll:e,polyfill:t,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=X.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=X.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),c=n?typeof n=="number"?n:n.scroll:null,h=n?typeof n=="number"?n:n.resize:null,p=X.useRef(!1);X.useEffect(()=>(p.current=!0,()=>{p.current=!1}));const[g,A,v]=X.useMemo(()=>{const E=()=>{if(!o.current.element)return;const{left:C,top:T,width:R,height:B,bottom:U,right:O,x:F,y:L}=o.current.element.getBoundingClientRect(),P={left:C,top:T,width:R,height:B,bottom:U,right:O,x:F,y:L};o.current.element instanceof HTMLElement&&i&&(P.height=o.current.element.offsetHeight,P.width=o.current.element.offsetWidth),Object.freeze(P),p.current&&!tae(o.current.lastBounds,P)&&a(o.current.lastBounds=P)};return[E,h?eO(E,h):E,c?eO(E,c):E]},[a,i,c,h]);function x(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(E=>E.removeEventListener("scroll",v,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function S(){o.current.element&&(o.current.resizeObserver=new r(v),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(E=>E.addEventListener("scroll",v,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{v()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const _=E=>{!E||E===o.current.element||(x(),o.current.element=E,o.current.scrollContainers=Dz(E),S())};return Zse(v,!!e),Jse(A),X.useEffect(()=>{x(),S()},[e,v,A]),X.useEffect(()=>x,[]),[_,s,g]}function Jse(n){X.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[n])}function Zse(n,e){X.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[n,e])}function Dz(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:i,overflowY:r}=window.getComputedStyle(n);return[t,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...Dz(n.parentElement)]}const eae=["x","y","top","bottom","left","right","width","height"],tae=(n,e)=>eae.every(t=>n[t]===e[t]);function nae({ref:n,children:e,fallback:t,resize:i,style:r,gl:s,events:a=Kse,eventSource:o,eventPrefix:c,shadows:h,linear:p,flat:g,legacy:A,orthographic:v,frameloop:x,dpr:S,performance:_,raycaster:E,camera:C,scene:T,onPointerMissed:R,onCreated:B,...U}){X.useMemo(()=>wz(HZ),[]);const O=lse(),[F,L]=$se({scroll:!0,debounce:{scroll:50,resize:0},...i}),P=X.useRef(null),W=X.useRef(null);X.useImperativeHandle(n,()=>P.current);const j=Y4(R),[V,q]=X.useState(!1),[re,Q]=X.useState(!1);if(V)throw V;if(re)throw re;const K=X.useRef(null);cx(()=>{const ue=P.current;if(L.width>0&&L.height>0&&ue){K.current||(K.current=Qse(ue));async function oe(){await K.current.configure({gl:s,scene:T,events:a,shadows:h,linear:p,flat:g,legacy:A,orthographic:v,frameloop:x,dpr:S,performance:_,raycaster:E,camera:C,size:L,onPointerMissed:(...z)=>j.current==null?void 0:j.current(...z),onCreated:z=>{z.events.connect==null||z.events.connect(o?ase(o)?o.current:o:W.current),c&&z.setEvents({compute:($,ae)=>{const he=$[c+"X"],me=$[c+"Y"];ae.pointer.set(he/ae.size.width*2-1,-(me/ae.size.height)*2+1),ae.raycaster.setFromCamera(ae.pointer,ae.camera)}}),B?.(z)}}),K.current.render(D.jsx(O,{children:D.jsx(use,{set:Q,children:D.jsx(X.Suspense,{fallback:D.jsx(cse,{set:q}),children:e??null})})}))}oe()}}),X.useEffect(()=>{const ue=P.current;if(ue)return()=>Iz(ue)},[]);const ce=o?"none":"auto";return D.jsx("div",{ref:W,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ce,...r},...U,children:D.jsx("div",{ref:F,style:{width:"100%",height:"100%"},children:D.jsx("canvas",{ref:P,style:{display:"block"},children:t})})})}function Lz(n){return D.jsx(mz,{children:D.jsx(nae,{...n})})}const iae=.05,tO=.1;function Nz(n,e,t){const i=e.gamepad;if(i==null)return;const r=t.components;for(const s in r){let a=n[s];a==null&&(n[s]=a={});const{gamepadIndices:o}=r[s];let c=!1,h=!1;if(o.button!=null&&o.button<i.buttons.length){const p=i.buttons[o.button];a.button=JE(p.value,0,1),c||=p.pressed||a.button===1,h||=p.touched||a.button>iae}o.xAxis!=null&&o.xAxis<i.axes.length&&(a.xAxis=JE(i.axes[o.xAxis],-1,1),h||=Math.abs(a.xAxis)>tO),o.yAxis!=null&&o.yAxis<i.axes.length&&(a.yAxis=JE(i.axes[o.yAxis],-1,1),h||=Math.abs(a.yAxis)>tO),a.state=c?"pressed":h?"touched":"default"}}function rae(n){return{data:new Float32Array(n.size*16)}}function sae(n,e,t,i,r){const s=i.getReferenceSpace();s==null||e==null||e.session.visibilityState==="visible-blurred"||e.session.visibilityState==="hidden"||aae(e,s,t,n.data)}const YI=new qt,KI=new qt;function aae(n,e,t,i){if(!n.fillPoses(t.values(),e,i))return!1;YI.fromArray(i,0),YI.invert();for(let s=0;s<i.length;s+=16)KI.fromArray(i,s),KI.premultiply(YI),KI.toArray(i,s);return!0}const oae="generic-hand";function lae(n,e){const t=e?.baseAssetPath??nG,i=e?.defaultXRHandProfileId??oae;return new URL(`${i}/${n}.glb`,t).href}function cae({scene:n}){const e=B9(n),t=e.getObjectByProperty("type","SkinnedMesh");if(t==null)throw new Error("missing SkinnedMesh in loaded XRHand model");return t.frustumCulled=!1,e}function uae(n,e){n.renderOrder=e?.renderOrder??0,n.traverse(t=>{t instanceof Wt&&t.material instanceof ts&&(t.material.colorWrite=e?.colorWrite??!0)})}function hae(n,e,t,i,r){return{id:n,isPrimary:r,type:"hand",inputSource:e,pose:rae(e.hand),assetPath:lae(e.handedness,t),events:i}}function fae({inputSource:n,pose:e},t,i){sae(e,t,n.hand,i,n.handedness)}const dae=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"];function pae(n,e,t){const i=new Float32Array(n.size*16),r=dae.map(s=>{const a=e.getObjectByName(s);if(a==null)throw new Error(`missing joint "${s}" in hand model`);return a.matrixAutoUpdate=!1,a});return s=>{const a=typeof t=="function"?t():t;if(s==null||a==null)return;s.fillPoses(n.values(),a,i);const o=r.length;for(let c=0;c<o;c++)r[c].matrix.fromArray(i,c*16)}}function mae(n){return n!=null&&typeof n=="object"&&"inputSource"in n}function gae(n,e){const t=i=>e.push(i);return n.addEventListener("selectstart",t),n.addEventListener("selectend",t),n.addEventListener("select",t),n.addEventListener("squeeze",t),n.addEventListener("squeezestart",t),n.addEventListener("squeezeend",t),()=>{n.removeEventListener("selectstart",t),n.removeEventListener("selectend",t),n.removeEventListener("select",t),n.removeEventListener("squeeze",t),n.removeEventListener("squeezestart",t),n.removeEventListener("squeezeend",t)}}let Aae=0;function vae(n,e){const t=new Map,i=new rle(e),r=new Map;return(s,a,o)=>{if(o==="remove-all"){for(const h of t.values())h();return a}const c=[...a];for(const{added:h,isPrimary:p,removed:g}of o){if(g!=null)for(const A of g){const v=c.findIndex(({inputSource:x,isPrimary:S})=>S===p&&x===A);v!==-1&&(c.splice(v,1),t.get(A)?.(),t.delete(A))}if(h!=null)for(const A of h){const v=[];let x=gae(s,v);const S=`${A.handedness}-${A.hand?"hand":"nohand"}-${A.targetRayMode}-${A.profiles.join(",")}`;let _;if((_=r.get(S))==null&&r.set(S,_=`${Aae++}`),A.hand!=null)c.push(hae(_,A,e,v,p));else switch(A.targetRayMode){case"gaze":c.push({id:_,isPrimary:p,type:"gaze",inputSource:A,events:v});break;case"screen":c.push({id:_,isPrimary:p,type:"screenInput",inputSource:A,events:v});break;case"transient-pointer":c.push({id:_,isPrimary:p,type:"transientPointer",inputSource:A,events:v});break;case"tracked-pointer":let E=!1;const C=x;x=()=>{C(),E=!0};const T=sle(_,A,i,v,p);T instanceof Promise?T.then(R=>!E&&n(R)).catch(console.error):c.push(T);break}t.set(A,x)}}return c}}function yae(n,e){const t=(i,r)=>{r!=null&&i.visibilityState===r.visibilityState||e(i.visibilityState==="visible")};return t(n.getState()),n.subscribe(t)}class bae extends ar{constructor(){super({transparent:!0,toneMapped:!1,depthWrite:!1})}onBeforeCompile(e,t){super.onBeforeCompile(e,t),e.vertexShader=`varying vec2 vLocalPosition;
`+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <color_vertex>",`#include <color_vertex>
        vLocalPosition = position.xy * 2.0;`),e.fragmentShader=`varying vec2 vLocalPosition;
`+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>",`#include <color_fragment>
          float value = max(0.0, 1.0 - sqrt(dot(vLocalPosition, vLocalPosition)));
          diffuseColor.a = diffuseColor.a * value * value;`)}}const xae=new ee(0,0,1),nO=new Bi,$I=new ee;function _ae(n,e,t,i,r){const s=i.getIntersection();if(s==null||!i.getEnabled()||s.object.isVoidObject===!0||!Uz(n)){e.visible=!1;return}e.visible=!0;const a=typeof r.color=="function"?r.color(i):r.color;Array.isArray(a)?t.color.set(...a):t.color.set(a??"white"),t.opacity=typeof r.opacity=="function"?r.opacity(i):r.opacity??.4,e.position.copy(s.pointOnFace),e.scale.setScalar(r.size??.1);const o=s.normal??s.face?.normal;o!=null&&(nO.setFromUnitVectors(xae,o),s.object.getWorldQuaternion(e.quaternion),e.quaternion.multiply(nO),$I.set(0,0,r.cursorOffset??.01),$I.applyQuaternion(e.quaternion),e.position.add($I)),e.updateMatrix()}function Uz({visible:n,parent:e}){return n?e==null?!0:Uz(e):!1}class Sae extends ar{constructor(){super({transparent:!0,toneMapped:!1})}onBeforeCompile(e,t){super.onBeforeCompile(e,t),e.vertexShader=`varying float vFade;
`+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <color_vertex>",`#include <color_vertex>
            vFade = position.z + 0.5;`),e.fragmentShader=`varying float vFade;
`+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>",`#include <color_fragment>
              diffuseColor.a *= vFade;`)}}function Eae(n,e,t,i){const r=t.getIntersection();if(!t.getEnabled()||r==null){n.visible=!1;return}n.visible=!0;const s=typeof i.color=="function"?i.color(t):i.color;Array.isArray(s)?e.color.set(...s):e.color.set(s??"white"),e.opacity=typeof i.opacity=="function"?i.opacity(t):i.opacity??.4;const a=Math.min(i.maxLength??1,r.distance);n.position.z=-a/2;const o=i.size??.005;n.scale.set(o,o,a),n.updateMatrix()}function wae(n,e,t,i,r,s={}){const a=g=>{g.inputSource===t&&n.down(Object.assign(g,{button:s.button??0}))},o=g=>{g.inputSource===t&&n.up(Object.assign(g,{button:s.button??0}))},c=`${i}start`,h=`${i}end`,p=r.length;for(let g=0;g<p;g++){const A=r[g];switch(A.type){case c:a(A);break;case h:o(A);break}}return e.addEventListener(c,a),e.addEventListener(h,o),()=>{e.removeEventListener(c,a),e.removeEventListener(h,o)}}function Mae(n){return n.getButtonsDown().size>0?.6:Fz(n.getIntersection()?.distance??1/0,.07,0,.2,.4)}function $w(n){return n.getButtonsDown().size>0?.6:.4}function Cae(n){return Fz(n.getIntersection()?.distance??1/0,.1,.03,.2,.6)}function Fz(n,e,t,i,r){return i+Math.max(0,Math.min(1,(n-e)/(t-e)))*(r-i)}function Tae(n,e){return(t,i)=>{if(n===e)return t.identity(),!0;const r=typeof e=="function"?e():e;if(r==null)return!1;const s=i?.getPose(n,r);return s==null?!1:(t.fromArray(s.transform.matrix),!0)}}function oC(n,e,t,i){n.updateWorldMatrix(!0,!1),i?.copy(n.matrix);const r=Pz(n.parent,n,i);return r??(i!=null&&Iae(n,e,i),t)}function Iae(n,e,t){if(n.updateWorldMatrix(!0,!1),e==null){t.copy(n.matrixWorld);return}e.updateWorldMatrix(!0,!1),t.copy(e.matrixWorld).invert().multiply(n.matrixWorld)}function Pz(n,e,t){if(n!=null)return n.xrSpace!=null?(t?.copy(n.matrixWorld).invert().multiply(e.matrixWorld),n.xrSpace):Pz(n.parent,e,t)}class Rae{nativeEvent;NONE=0;CAPTURING_PHASE=1;AT_TARGET=2;BUBBLING_PHASE=3;relatedTarget=null;get altKey(){return this.getFromNative("altKey",!1)}get button(){return this.getFromNative("button",0)}get buttons(){return this.getFromNative("buttons",0)}get clientX(){return this.getFromNative("clientX",0)}get clientY(){return this.getFromNative("clientY",0)}get ctrlKey(){return this.getFromNative("ctrlKey",!1)}get layerX(){return this.getFromNative("layerX",0)}get layerY(){return this.getFromNative("layerY",0)}get metaKey(){return this.getFromNative("metaKey",!1)}get movementX(){return this.getFromNative("movementX",0)}get movementY(){return this.getFromNative("movementY",0)}get offsetX(){return this.getFromNative("offsetX",0)}get offsetY(){return this.getFromNative("offsetY",0)}get pageX(){return this.getFromNative("pageX",0)}get pageY(){return this.getFromNative("pageY",0)}get screenX(){return this.getFromNative("screenX",0)}get screenY(){return this.getFromNative("screenY",0)}get shiftKey(){return this.getFromNative("shiftKey",!1)}get x(){return this.getFromNative("x",0)}get y(){return this.getFromNative("y",0)}get detail(){return this.getFromNative("detail",0)}get view(){return this.getFromNative("view",null)}get which(){return this.getFromNative("which",0)}get cancelBubble(){return this.getFromNative("cancelBubble",!1)}get composed(){return this.getFromNative("composed",!1)}get eventPhase(){return this.getFromNative("eventPhase",0)}get isTrusted(){return this.getFromNative("isTrusted",!1)}get returnValue(){return this.getFromNative("returnValue",!1)}get timeStamp(){return this.getFromNative("timeStamp",0)}get cancelable(){return this.getFromNative("cancelable",!1)}get defaultPrevented(){return this.getFromNative("defaultPrevented",!1)}constructor(e){this.nativeEvent=e}getFromNative(e,t){return e in this.nativeEvent?this.nativeEvent[e]:t}}const JI=new ee;let io=class Oz extends Rae{type;bubbles;internalPointer;intersection;camera;currentObject;object;propagationState;get pointerId(){return this.internalPointer.id}get pointerType(){return this.internalPointer.type}get pointerState(){return this.internalPointer.state}get distance(){return this.intersection.distance}get distanceToRay(){return this.intersection.distanceToRay}get point(){return this.intersection.point}get index(){return this.intersection.index}get face(){return this.intersection.face}get faceIndex(){return this.intersection.faceIndex}get uv(){return this.intersection.uv}get uv1(){return this.intersection.uv1}get normal(){return this.intersection.normal}get instanceId(){return this.intersection.instanceId}get pointOnLine(){return this.intersection.pointOnLine}get batchId(){return this.intersection.batchId}get pointerPosition(){return this.intersection.pointerPosition}get pointerQuaternion(){return this.intersection.pointerQuaternion}get pointOnFace(){return this.intersection.pointOnFace}get localPoint(){return this.intersection.localPoint}get details(){return this.intersection.details}get target(){return this.object}get currentTarget(){return this.currentObject}get eventObject(){return this.currentObject}get srcElement(){return this.currentObject}_pointer;get pointer(){return this._pointer==null&&(JI.copy(this.intersection.point).project(this.camera),this._pointer=new Ze(JI.x,JI.y)),this._pointer}_ray;get ray(){if(this._ray!=null)return this._ray;switch(this.intersection.details.type){case"screen-ray":case"ray":case"sphere":return this._ray=new gf(this.intersection.pointerPosition,new ee(0,0,-1).applyQuaternion(this.intersection.pointerQuaternion));case"lines":return this._ray=new gf(this.intersection.details.line.start,this.intersection.details.line.end.clone().sub(this.intersection.details.line.start).normalize())}}_intersections=[];get intersections(){return this._intersections==null&&(this._intersections=[{...this.intersection,eventObject:this.currentObject}]),this._intersections}_unprojectedPoint;get unprojectedPoint(){if(this._unprojectedPoint==null){const e=this.pointer;this._unprojectedPoint=new ee(e.x,e.y,0).unproject(this.camera)}return this._unprojectedPoint}get stopped(){return this.propagationState.stoppedImmediate||this.propagationState.stopped}get stoppedImmediate(){return this.propagationState.stoppedImmediate}get delta(){throw new Error("not supported")}constructor(e,t,i,r,s,a,o=s.object,c=o,h={stopped:!t,stoppedImmediate:!1}){super(i),this.type=e,this.bubbles=t,this.internalPointer=r,this.intersection=s,this.camera=a,this.currentObject=o,this.object=c,this.propagationState=h}stopPropagation(){this.propagationState.stopped=!0}stopImmediatePropagation(){this.propagationState.stoppedImmediate=!0}retarget(e){return new Oz(this.type,this.bubbles,this.nativeEvent,this.internalPointer,this.intersection,this.camera,e,this.target,this.propagationState)}},iO=class kz extends io{get deltaX(){return this.nativeEvent.deltaX}get deltaY(){return this.nativeEvent.deltaY}get deltaZ(){return this.nativeEvent.deltaZ}constructor(e,t,i,r,s,a){super("wheel",!0,e,t,i,r,s,a)}retarget(e){return new kz(this.nativeEvent,this.internalPointer,this.intersection,this.camera,e,this.target)}};function Lo(n){zz(n,n.currentObject)}function zz(n,e){if(e==null)return;const t=Dae(e,n.type);if(t!=null&&t.length>0){const i=n.retarget(e),r=t.length;for(let s=0;s<r&&!i.stoppedImmediate;s++)t[s](i)}n.stopped||zz(n,e.parent)}const Gz={click:"onClick",contextmenu:"onContextMenu",dblclick:"onDoubleClick",pointercancel:"onPointerCancel",pointerdown:"onPointerDown",pointerenter:"onPointerEnter",pointerleave:"onPointerLeave",pointermove:"onPointerMove",pointerout:"onPointerOut",pointerover:"onPointerOver",pointerup:"onPointerUp",wheel:"onWheel"},Bae=Object.keys(Gz);function Dae(n,e){if(n._listeners!=null&&e in n._listeners)return n._listeners[e];let t;if(n.isVoidObject&&e==="click"&&n.parent?.__r3f!=null&&(t=n.parent.__r3f.root.getState().onPointerMissed),n.__r3f!=null&&(t=n.__r3f.handlers[Gz[e]]),t!=null)return[t]}const Lae=1e10,Nae=new hc(Lae),rO=new Map;function Hz(n){let e=rO.get(n);return e==null&&(e=new Wt(Nae),e.isVoidObject=!0,e.parent=n,e.pointerEventsOrder=-1/0,rO.set(n,e)),e}function lC(n,e,t){const i=e.normal??e.face?.normal;return i==null?!1:(n.setFromNormalAndCoplanarPoint(i,e.localPoint),n.applyMatrix4(t),!0)}function Uae(n,e,t){if(e==="none"||e==="listener"&&!n)return!1;if(t==="all")return!0;if(typeof t=="function")return({id:s,type:a,state:o})=>t(s,a,o);let i,r;return"deny"in t?(r=!0,i=t.deny):(r=!1,i=t.allow),Array.isArray(i)?s=>sO(i.includes(s.type),r):s=>sO(i===s.type,r)}function sO(n,e){return e?!n:n}function $4(n,e,t,i=!1,r,s,a){const o=i||Fae(n,e),c=e.pointerEvents??r,h=c??e.defaultPointerEvents??"listener",p=e.pointerEventsType??s??"all",g=e.pointerEventsOrder??a??0,A=Uae(o,h,p),v=t.length;if(v===1)(A===!0||typeof A=="function"&&A(t[0]))&&ZI(t[0],e,h,p,g);else if(A===!0)for(let _=0;_<v;_++)ZI(t[_],e,h,p,g);else if(typeof A=="function")for(let _=0;_<v;_++){const E=t[_];A(E)&&ZI(E,e,h,p,g)}if(e.children.length===0||e.intersectChildren===!1)return;const x=e.interactableDescendants??e.children,S=x.length;for(let _=0;_<S;_++)$4(n,x[_],t,o,c,p,g)}function Fae(n,e){if(e.ancestorsHaveListeners||n==="pointer"&&e.ancestorsHavePointerListeners||n==="wheel"&&e.ancestorsHaveWheelListeners||e.__r3f!=null&&e.__r3f?.eventCount>0&&(n==="wheel"&&e.__r3f.handlers.onWheel!=null||n==="pointer"&&Object.keys(e.__r3f.handlers).some(r=>r!="onWheel")))return!0;if(e._listeners==null)return!1;if(n==="wheel"){const r=e._listeners.wheel;return r!=null&&r.length>0}const t=Object.entries(e._listeners),i=t.length;for(let r=0;r<i;r++){const s=t[r];if(s[0]!=="wheel"&&Bae.includes(s[0])&&s[1]!=null&&s[1].length>0)return!0}return!1}function ZI({intersector:n,options:e},t,i,r,s){e.filter?.(t,i,r,s)!==!1&&n.executeIntersection(t,s)}function cC(n,e,{customSort:t=Pae}={},i){let r,s,a;const o=n.length;for(let c=0;c<o;c++){const h=n[c];if(i?.(h)===!1)continue;const p=e?.[c];(r==null||t(h,p,r,s)<0)&&(a=c,r=h,s=p)}return a}function Pae(n,e=0,t,i=0){return e!=i?i-e:n.distance-t.distance}const aO=1e7;function J4(n,e,t,i,r,s=0){const a=e.direction.clone().multiplyScalar(aO),o=aO;return{distance:o+s,object:Hz(n),point:a,normal:e.origin.clone().sub(a).normalize(),details:t(a,o),pointerPosition:i,pointerQuaternion:r,pointOnFace:a,localPoint:a}}function Jw(n,e,t){for(;t>0;)n.push(e),--t}const eR=Symbol("buttonsDownTime"),Oae=Symbol("buttonsClickTime");globalThis.pointerEventspointerMap??=new Map;Gn.prototype.setPointerCapture=function(n){Z4(n)?.setCapture(this)};Gn.prototype.releasePointerCapture=function(n){const e=Z4(n);e==null||!e.hasCaptured(this)||e.setCapture(void 0)};Gn.prototype.hasPointerCapture=function(n){return Z4(n)?.hasCaptured(this)??!1};function Z4(n){return globalThis.pointerEventspointerMap?.get(n)}class mv{id;type;state;intersector;getCamera;onMoveCommited;parentSetPointerCapture;parentReleasePointerCapture;options;prevIntersection;intersection;prevEnabled=!0;enabled=!0;wheelIntersection;pointerEntered=[];pointerEnteredHelper=[];pointerCapture;buttonsDownTime=new Map;buttonsDown=new Set;wasMoved=!1;onFirstMove=[];constructor(e,t,i,r,s,a,o,c,h={}){this.id=e,this.type=t,this.state=i,this.intersector=r,this.getCamera=s,this.onMoveCommited=a,this.parentSetPointerCapture=o,this.parentReleasePointerCapture=c,this.options=h,globalThis.pointerEventspointerMap?.set(e,this)}getPointerCapture(){return this.pointerCapture}hasCaptured(e){return this.pointerCapture?.object===e}setCapture(e){this.pointerCapture?.object!==e&&(this.pointerCapture!=null&&(this.parentReleasePointerCapture?.(),this.pointerCapture=void 0),e!=null&&this.intersection!=null&&(this.pointerCapture={object:e,intersection:this.intersection},this.parentSetPointerCapture?.()))}getButtonsDown(){return this.buttonsDown}getIntersection(){return this.intersection}getEnabled(){return this.enabled}setEnabled(e,t,i=!0){this.enabled!==e&&(!e&&this.pointerCapture!=null&&(this.parentReleasePointerCapture?.(),this.pointerCapture=void 0),this.enabled=e,i&&this.commit(t,!1))}computeIntersection(e,t,i){return this.pointerCapture!=null?this.intersector.intersectPointerCapture(this.pointerCapture,i):(this.intersector.startIntersection(i),$4(e,t,[this]),this.intersector.finalizeIntersection(t))}setIntersection(e){this.intersection=e}commit(e,t){const i=this.getCamera(),r=this.prevEnabled?this.prevIntersection:void 0,s=this.enabled?this.intersection:void 0;r!=null&&r.object!=s?.object&&Lo(new io("pointerout",!0,e,this,r,i));const a=this.pointerEntered;this.pointerEntered=[],this.pointerEnteredHelper.length=0,Qz(s?.object,this.pointerEntered,a,this.pointerEnteredHelper);const o=a.length;for(let c=0;c<o;c++){const h=a[c];Lo(new io("pointerleave",!1,e,this,r,i,h))}s!=null&&r?.object!=s.object&&Lo(new io("pointerover",!0,e,this,s,i));for(let c=this.pointerEnteredHelper.length-1;c>=0;c--){const h=this.pointerEnteredHelper[c];Lo(new io("pointerenter",!1,e,this,s,i,h))}if(t&&s!=null&&Lo(new io("pointermove",!0,e,this,s,i)),this.prevIntersection=this.intersection,this.prevEnabled=this.enabled,!this.wasMoved&&this.intersector.isReady()){this.wasMoved=!0;const c=this.onFirstMove.length;for(let h=0;h<c;h++)this.onFirstMove[h](i);this.onFirstMove.length=0}this.onMoveCommited?.(this)}move(e,t){this.intersection=this.computeIntersection("pointer",e,t),this.commit(t,!0)}over(e,t){this.wasMoved||(this.intersection=this.computeIntersection("pointer",e,t),this.commit(t,!1))}emitMove(e){this.intersection!=null&&Lo(new io("pointermove",!0,e,this,this.intersection,this.getCamera()))}down(e){if(this.buttonsDown.add(e.button),!this.enabled)return;if(!this.wasMoved){this.onFirstMove.push(this.down.bind(this,e));return}if(this.intersection==null)return;Lo(new io("pointerdown",!0,e,this,this.intersection,this.getCamera()));const{object:t}=this.intersection;t[eR]??=new Map,t[eR].set(e.button,e.timeStamp),this.buttonsDownTime.set(e.button,e.timeStamp)}up(e){if(this.buttonsDown.delete(e.button),!this.enabled)return;if(!this.wasMoved){this.onFirstMove.push(this.up.bind(this,e));return}if(this.intersection==null)return;const{clickThesholdMs:t,contextMenuButton:i=2,dblClickThresholdMs:r=500,clickThresholdMs:s=t??300}=this.options;this.pointerCapture=void 0;const a=kae(this.buttonsDownTime,this.intersection.object[eR],e.button,e.timeStamp,s),o=this.getCamera();if(a&&e.button===i&&Lo(new io("contextmenu",!0,e,this,this.intersection,o)),Lo(new io("pointerup",!0,e,this,this.intersection,o)),!a||e.button===i)return;Lo(new io("click",!0,e,this,this.intersection,o));const{object:c}=this.intersection,h=c[Oae]??=new Map,p=h.get(e.button);if(p==null||e.timeStamp-p>r){h.set(e.button,e.timeStamp);return}Lo(new io("dblclick",!0,e,this,this.intersection,o)),h.delete(e.button)}cancel(e){if(this.enabled){if(!this.wasMoved){this.onFirstMove.push(this.cancel.bind(this,e));return}this.intersection!=null&&Lo(new io("pointercancel",!0,e,this,this.intersection,this.getCamera()))}}wheel(e,t,i=!1){if(!this.enabled)return;if(!this.wasMoved&&i){this.onFirstMove.push(this.wheel.bind(this,e,t,i));return}i||(this.wheelIntersection=this.computeIntersection("wheel",e,t));const r=i?this.intersection:this.wheelIntersection;r!=null&&Lo(new iO(t,this,r,this.getCamera()))}emitWheel(e,t=!1){if(!this.enabled)return;if(!this.wasMoved&&t){this.onFirstMove.push(this.emitWheel.bind(this,e,t));return}const i=t?this.intersection:this.wheelIntersection;i!=null&&Lo(new iO(e,this,i,this.getCamera()))}exit(e){this.wasMoved&&(this.pointerCapture!=null&&(this.parentReleasePointerCapture?.(),this.pointerCapture=void 0),this.intersection=void 0,this.commit(e,!1)),this.onFirstMove.length=0,this.wasMoved=!1}}function Qz(n,e,t,i){if(n==null)return;const r=t.indexOf(n);r!=-1?t.splice(r,1):i.push(n),e.push(n),Qz(n.parent,e,t,i)}function kae(n,e,t,i,r){if(e==null)return!1;const s=e.get(t);return!(s==null||i-s>r||s!=n.get(t))}function uC(n){return n.transformReady===!1?!1:n.parent==null?(n.matrixWorld.copy(n.matrix),!0):uC(n.parent)?(n.matrixWorld.multiplyMatrices(n.parent.matrixWorld,n.matrix),!0):!1}const I1=new ea,tR=new ea,oO=new Ze,lO=new Ze,cO=new Ze,nR=new ee,zae=new qt,_E=new ee;function hx(n,e,t){_E.copy(e).applyMatrix4(zae.copy(t.matrixWorld).invert());const i=t.geometry.attributes.uv;if(i==null||!(i instanceof An))return!1;let r;return Gae(t,(s,a,o)=>{t.getVertexPosition(s,I1.a),t.getVertexPosition(a,I1.b),t.getVertexPosition(o,I1.c);const c=I1.closestPointToPoint(_E,nR).distanceTo(_E);r!=null&&c>=r||(r=c,tR.copy(I1),oO.fromBufferAttribute(i,s),lO.fromBufferAttribute(i,a),cO.fromBufferAttribute(i,o))}),r==null?!1:(tR.closestPointToPoint(_E,nR),tR.getInterpolation(nR,oO,lO,cO,n),!0)}function Gae(n,e){const t=n.geometry.drawRange;if(n.geometry.index!=null){const a=n.geometry.index,o=Math.max(0,t.start),c=Math.min(a.count,t.start+t.count);for(let h=o;h<c;h+=3)e(a.getX(h),a.getX(h+1),a.getX(h+2));return}const i=n.geometry.attributes.position;if(i==null)return;const r=Math.max(0,t.start),s=Math.min(i.count,t.start+t.count);for(let a=r;a<s;a+=3)e(a,a+1,a+2)}const Hae=new qt,iR=new Fw,Qae=new ee,uO=new nc,Vae=new gf,hO=new Ze,fO=[new ee(0,0,0),new ee(0,0,1)];class jae{space;options;raycasters=[];fromMatrixWorld=new qt;ready;intersects=[];pointerEventsOrders=[];raycasterIndices=[];constructor(e,t){this.space=e,this.options=t}isReady(){return this.ready??this.prepareTransformation()}prepareTransformation(){const e=this.space.current;return e==null?this.ready=!1:(this.ready=uC(e),this.ready?(this.fromMatrixWorld.copy(e.matrixWorld),!0):!1)}intersectPointerCapture({intersection:e,object:t}){const i=e.details;if(i.type!="lines")throw new Error(`unable to process a pointer capture of type "${e.details.type}" with a lines intersector`);if(!this.prepareTransformation())return e;const r=this.options.linePoints??fO;iR.set(r[i.lineIndex],r[i.lineIndex+1]).applyMatrix4(this.fromMatrixWorld);const s=iR.at(i.distanceOnLine/iR.distance(),new ee);e.object.updateWorldMatrix(!0,!1),lC(uO,e,e.object.matrixWorld);const a=Vae.intersectPlane(uO,new ee)??s,o=new ee,c=new Bi;this.fromMatrixWorld.decompose(o,c,Qae);let h=e.uv;return e.object instanceof Wt&&hx(hO,s,e.object)&&(h=hO.clone()),{...e,object:t,uv:h,pointOnFace:a,point:s,pointerPosition:o,pointerQuaternion:c}}startIntersection(){if(!this.prepareTransformation())return;const e=this.options.linePoints??fO,t=e.length-1;for(let i=0;i<t;i++){const r=e[i],s=e[i+1],a=this.raycasters[i]??(this.raycasters[i]=new ep);a.ray.origin.copy(r).applyMatrix4(this.fromMatrixWorld),a.ray.direction.copy(s).applyMatrix4(this.fromMatrixWorld),a.ray.direction.sub(a.ray.origin);const o=a.ray.direction.length();a.ray.direction.divideScalar(o),a.far=o}this.raycasters.length=t}executeIntersection(e,t){if(!this.isReady())return;const i=this.intersects.length,r=this.raycasters.length;for(let s=0;s<r;s++){const a=this.raycasters[s],o=this.intersects.length;e.raycast(a,this.intersects),Jw(this.raycasterIndices,s,this.intersects.length-o)}Jw(this.pointerEventsOrders,t,this.intersects.length-i)}finalizeIntersection(e){const t=new ee().setFromMatrixPosition(this.fromMatrixWorld),i=new Bi().setFromRotationMatrix(this.fromMatrixWorld),r=cC(this.intersects,this.pointerEventsOrders,this.options),s=r==null?void 0:this.intersects[r],a=r==null?void 0:this.raycasterIndices[r];if(this.intersects.length=0,this.raycasterIndices.length=0,this.pointerEventsOrders.length=0,s==null||a==null){const h=this.raycasters.length-1,p=this.raycasters.reduce((A,v,x)=>x===h?A:A+v.far,0),g=this.raycasters[h];return J4(e,g.ray,(A,v)=>({line:new Fw(g.ray.origin.clone(),A),lineIndex:this.raycasters.length-1,distanceOnLine:v,type:"lines"}),t,i,p)}let o=s.distance;for(let h=0;h<a;h++)o+=this.raycasters[h].far;s.object.updateWorldMatrix(!0,!1);const c=this.raycasters[a];return Object.assign(s,{details:{lineIndex:a,distanceOnLine:s.distance,type:"lines",line:new Fw(c.ray.origin.clone(),c.ray.direction.clone().multiplyScalar(c.far).add(c.ray.origin))},distance:o,pointerPosition:t,pointerQuaternion:i,pointOnFace:s.point,localPoint:s.point.clone().applyMatrix4(Hae.copy(s.object.matrixWorld).invert())})}}const g2=new qt,A2=new ee,Wae=new ee(0,0,-1),dO=new nc,Zw=new Ze;class qae{space;options;raycaster=new ep;raycasterQuaternion=new Bi;worldScale=0;ready;intersects=[];pointerEventsOrders=[];constructor(e,t){this.space=e,this.options=t}isReady(){return this.ready??this.prepareTransformation()}prepareTransformation(){const e=this.space.current;return e==null?this.ready=!1:(this.ready=uC(e),this.ready?(e.matrixWorld.decompose(this.raycaster.ray.origin,this.raycasterQuaternion,A2),this.worldScale=A2.x,this.raycaster.ray.direction.copy(this.options?.direction??Wae).applyQuaternion(this.raycasterQuaternion),!0):!1)}intersectPointerCapture({intersection:e,object:t}){if(e.details.type!="ray")throw new Error(`unable to process a pointer capture of type "${e.details.type}" with a ray intersector`);if(!this.prepareTransformation())return e;e.object.updateWorldMatrix(!0,!1),lC(dO,e,e.object.matrixWorld);const{ray:i}=this.raycaster,r=i.intersectPlane(dO,new ee)??e.point,s=i.direction.clone().multiplyScalar(e.pointerPosition.distanceTo(e.point)).add(i.origin);let a=e.uv;return e.object instanceof Wt&&hx(Zw,s,e.object)&&(a=Zw.clone()),{...e,uv:a,object:t,pointOnFace:r,point:s,pointerPosition:i.origin.clone(),pointerQuaternion:this.raycasterQuaternion.clone()}}startIntersection(){this.prepareTransformation()}executeIntersection(e,t){if(!this.isReady())return;const i=this.intersects.length;e.raycast(this.raycaster,this.intersects),Jw(this.pointerEventsOrders,t,this.intersects.length-i)}finalizeIntersection(e){const t=this.raycaster.ray.origin.clone(),i=this.raycasterQuaternion.clone();let r;if(this.options.minDistance!=null){const o=this.options.minDistance/this.worldScale;r=c=>c.distance>=o}const s=cC(this.intersects,this.pointerEventsOrders,this.options,r),a=s==null?void 0:this.intersects[s];return this.intersects.length=0,this.pointerEventsOrders.length=0,a==null?J4(e,this.raycaster.ray,()=>({type:"ray"}),t,i):(a.object.updateWorldMatrix(!0,!1),Object.assign(a,{details:{type:"ray"},pointerPosition:t,pointerQuaternion:i,pointOnFace:a.point,localPoint:a.point.clone().applyMatrix4(g2.copy(a.object.matrixWorld).invert())}))}}const Xae=new ee;class Yae{prepareTransformation;options;raycaster=new ep;cameraQuaternion=new Bi;fromPosition=new ee;fromQuaternion=new Bi;coords=new Ze;viewPlane=new nc;intersects=[];pointerEventsOrders=[];constructor(e,t){this.prepareTransformation=e,this.options=t}isReady(){return!0}intersectPointerCapture({intersection:e,object:t},i){const r=e.details;if(r.type!="screen-ray")throw new Error(`unable to process a pointer capture of type "${e.details.type}" with a camera ray intersector`);if(!this.startIntersection(i))return e;this.viewPlane.constant-=r.distanceViewPlane;const s=this.raycaster.ray.intersectPlane(this.viewPlane,new ee);if(s==null)return e;e.object.updateWorldMatrix(!0,!1),lC(this.viewPlane,e,e.object.matrixWorld);let a=e.uv;return e.object instanceof Wt&&hx(Zw,s,e.object)&&(a=Zw.clone()),{...e,details:{...r,direction:this.raycaster.ray.direction.clone(),screenPoint:this.coords.clone()},uv:a,object:t,point:s,pointOnFace:s,pointerPosition:this.raycaster.ray.origin.clone(),pointerQuaternion:this.cameraQuaternion.clone()}}startIntersection(e){const t=this.prepareTransformation(e,this.coords);return t==null?!1:(t.updateWorldMatrix(!0,!1),t.matrixWorld.decompose(this.fromPosition,this.fromQuaternion,A2),this.raycaster.setFromCamera(this.coords,t),this.viewPlane.setFromNormalAndCoplanarPoint(t.getWorldDirection(Xae),this.raycaster.ray.origin),!0)}executeIntersection(e,t){const i=this.intersects.length;e.raycast(this.raycaster,this.intersects),Jw(this.pointerEventsOrders,t,this.intersects.length-i)}finalizeIntersection(e){const t=this.fromPosition.clone(),i=this.cameraQuaternion.clone(),r=this.raycaster.ray.direction.clone(),s=cC(this.intersects,this.pointerEventsOrders,this.options),a=s==null?void 0:this.intersects[s];return this.intersects.length=0,this.pointerEventsOrders.length=0,a==null?J4(e,this.raycaster.ray,(o,c)=>({type:"screen-ray",distanceViewPlane:c,screenPoint:this.coords.clone(),direction:r}),t,i):(a.object.updateWorldMatrix(!0,!1),g2.copy(a.object.matrixWorld).invert(),Object.assign(a,{details:{type:"screen-ray",distanceViewPlane:this.viewPlane.distanceToPoint(a.point),screenPoint:this.coords.clone(),direction:r},pointOnFace:a.point,pointerPosition:t,pointerQuaternion:i,localPoint:a.point.clone().applyMatrix4(g2)}))}}const Kae=new ee,eM=new Ze;class Vz{space;getSphereRadius;options;fromPosition=new ee;fromQuaternion=new Bi;collisionSphere=new jr;ready;intersects=[];constructor(e,t,i){this.space=e,this.getSphereRadius=t,this.options=i}isReady(){return this.ready??this.prepareTransformation()}prepareTransformation(){const e=this.space.current;return e==null?this.ready=!1:(this.ready=uC(e),this.ready?(e.matrixWorld.decompose(this.fromPosition,this.fromQuaternion,Kae),!0):!1)}intersectPointerCapture({intersection:e,object:t}){if(e.details.type!="sphere")throw new Error(`unable to process a pointer capture of type "${e.details.type}" with a sphere intersector`);if(!this.prepareTransformation())return e;pO.copy(e.point).sub(e.pointerPosition),mO.copy(e.pointerQuaternion).invert().multiply(this.fromQuaternion);const i=pO.clone().applyQuaternion(mO).add(this.fromPosition);e.object.updateWorldMatrix(!0,!1),lC(gO,e,e.object.matrixWorld);const r=gO.projectPoint(this.fromPosition,new ee);let s=e.uv;return e.object instanceof Wt&&hx(eM,i,e.object)&&(s=eM.clone()),{details:{type:"sphere"},uv:s,distance:i.distanceTo(r),pointerPosition:this.fromPosition.clone(),pointerQuaternion:this.fromQuaternion.clone(),object:t,point:i,pointOnFace:r,face:e.face,localPoint:e.localPoint}}startIntersection(){this.prepareTransformation()&&(this.collisionSphere.center.copy(this.fromPosition),this.collisionSphere.radius=this.getSphereRadius())}executeIntersection(e){this.isReady()&&$ae(this.collisionSphere,e,this.intersects)}finalizeIntersection(e){const t=this.fromPosition.clone(),i=this.fromQuaternion.clone(),r=cC(this.intersects,void 0,this.options),s=r==null?void 0:this.intersects[r];return this.intersects.length=0,s==null?{details:{type:"sphere"},distance:0,point:t,object:Hz(e),pointerPosition:t,pointerQuaternion:i,pointOnFace:t,localPoint:t}:(s.object.updateWorldMatrix(!0,!1),Object.assign(s,{details:{type:"sphere"},pointOnFace:s.point,pointerPosition:this.fromPosition.clone(),pointerQuaternion:this.fromQuaternion.clone(),localPoint:s.point.clone().applyMatrix4(tM.copy(s.object.matrixWorld).invert())}))}}const SE=new qt;function $ae(n,e,t){if(e.updateWorldMatrix(!0,!1),e.spherecast!=null){e.spherecast(n,t);return}if(e instanceof BM){e.geometry.boundingSphere==null&&e.geometry.computeBoundingSphere(),e.geometry.boundingBox==null&&e.geometry.computeBoundingBox();for(let r=0;r<e.count;r++){if(e.getMatrixAt(r,SE),SE.premultiply(e.matrixWorld),!AO(n,e,SE))continue;const s=yO(n,e,SE,r);s!=null&&t.push(s)}}if(!(e instanceof Wt)||!AO(n,e,e.matrixWorld))return;tM.copy(e.matrixWorld).invert();const i=yO(n,e,e.matrixWorld);i!=null&&t.push(i)}const pO=new ee,mO=new Bi,gO=new nc,A0=new jr;function AO(n,{geometry:e},t){return e.boundingSphere==null&&e.computeBoundingSphere(),A0.copy(e.boundingSphere).applyMatrix4(t),A0.center.distanceToSquared(n.center)<(n.radius+A0.radius)**2}const EE=new ee,rR=new ee,vO=new ee,Jae=new ee(1e-4,1e-4,1e-4),tM=new qt;function yO(n,e,t,i){tM.copy(t).invert(),A0.copy(n).applyMatrix4(tM);const{geometry:r}=e;r.boundingBox==null&&r.computeBoundingBox(),r.boundingBox.getSize(rR),r.boundingBox.getCenter(vO),r.boundingBox.clampPoint(A0.center,EE),EE.applyMatrix4(t);const s=EE.distanceToSquared(n.center);if(s>n.radius*n.radius)return;rR.max(Jae);const a=A0.center.clone().sub(vO);a.divide(rR),Zae(a);const o=EE.clone();let c;return hx(eM,o,e)&&(c=eM.clone()),{distance:Math.sqrt(s),face:{a:0,b:0,c:0,materialIndex:0,normal:a},uv:c,normal:a,point:o,instanceId:i,object:e}}function Zae(n){const e=Math.abs(n.x),t=Math.abs(n.y),i=Math.abs(n.z);if(e>=t&&e>=i){n.set(n.x<0?-1:1,0,0);return}if(t>=e&&t>=i){n.set(0,n.y<0?-1:1,0);return}n.set(0,0,n.z<0?-1:1)}function eoe(n,e,t,i={},r="grab"){return new mv(fx(),r,t,new Vz(e,()=>i.radius??.07,i),n,void 0,void 0,void 0,i)}function toe(n,e,t,i={},r="ray"){return new mv(fx(),r,t,new qae(e,i),n,void 0,void 0,void 0,i)}function noe(n,e,t,i={},r="lines"){return new mv(fx(),r,t,new jae(e,i),n,void 0,void 0,void 0,i)}function ioe(n,e,t,i={},r="touch"){return new mv(fx(),r,t,new Vz(e,()=>i.hoverRadius??.1,i),n,roe(i),void 0,void 0,i)}function roe(n){let e=!1;return t=>{if(!t.getEnabled())return;const i=t.getIntersection(),r=soe(i,n.downRadius??.03);if(r===e)return;const s={timeStamp:performance.now(),button:n.button??0};r?t.down(s):t.up(s),e=r}}function soe(n,e){return n==null?!1:n.distance<=e}let aoe=23412;function fx(){return aoe++}function ooe(n,e,t){if(!(e instanceof globalThis.MouseEvent))return t.set(0,0);const{width:i,height:r,top:s,left:a}=n.getBoundingClientRect(),o=e.clientX-a,c=e.clientY-s;return t.set(o/i*2-1,-(c/r)*2+1)}function gde(n,e,t,i){return jz(n,typeof e=="function"?e:()=>e,t,ooe.bind(null,n),n.setPointerCapture.bind(n),r=>{n.hasPointerCapture(r)&&n.releasePointerCapture(r)},{pointerTypePrefix:"screen-",...i})}function loe(n,e){return!(n instanceof io)||n.uv==null?e.set(0,0):e.copy(n.uv).multiplyScalar(2).addScalar(-1)}function coe(n,e,t,i){return jz(n,e,t,loe,n.setPointerCapture.bind(n),n.releasePointerCapture.bind(n),i)}function jz(n,e,t,i,r,s,a={}){const o=a?.forwardPointerCapture??!0,c=new Map,h=a.pointerTypePrefix??"forward-",p=(F,L)=>{let P=c.get(F.pointerId);return P!=null||(P=new mv(fx(),`${h}${F.pointerType}`,F.pointerState,new Yae((W,j)=>(i(W,j),e()),a),e,void 0,o?r.bind(null,F.pointerId):void 0,o?s.bind(null,F.pointerId):void 0,a),L!="move"&&L!="wheel"&&(P.setIntersection(P.computeIntersection("pointer",t,F)),P.commit(F,!1)),c.set(F.pointerId,P)),P},g=new Map,A=new Map,v=[],x=[],S=(F,L,P)=>{switch(F){case"move":P.move(t,L);return;case"over":P.move(t,L);return;case"wheel":P.wheel(t,L);return;case"cancel":P.cancel(L);return;case"down":if(!bO(L))return;P.down(L);return;case"up":if(!bO(L))return;P.up(L);return;case"exit":A.delete(P),g.delete(P),P.exit(L);return}},_=(F,L)=>{const P=p(L,F);F==="move"&&A.set(P,L),F==="wheel"&&g.set(P,L),a.batchEvents??!0?x.push({type:F,event:L}):S(F,L,P)},E=_.bind(null,"move"),C=_.bind(null,"over"),T=_.bind(null,"cancel"),R=_.bind(null,"down"),B=_.bind(null,"up"),U=_.bind(null,"wheel"),O=_.bind(null,"exit");return n.addEventListener("pointermove",E),n.addEventListener("pointerover",C),n.addEventListener("pointercancel",T),n.addEventListener("pointerdown",R),n.addEventListener("pointerup",B),n.addEventListener("wheel",U),n.addEventListener("pointerleave",O),{destroy(){n.removeEventListener("pointermove",E),n.removeEventListener("pointerover",C),n.removeEventListener("pointercancel",T),n.removeEventListener("pointerdown",R),n.removeEventListener("pointerup",B),n.removeEventListener("wheel",U),n.removeEventListener("pointerleave",O),A.clear(),g.clear()},update(){const F=x.length;for(let L=0;L<F;L++){const{type:P,event:W}=x[L],j=p(W,P);if(P==="move"&&(v.push(j),A.get(j)!=W)){j.emitMove(W);continue}if(P==="wheel"&&g.get(j)!=W){j.emitWheel(W);continue}S(P,W,j)}if(x.length=0,a.intersectEveryFrame??!1)for(const[L,P]of A.entries())v.includes(L)||L.move(t,P);v.length=0}}}function bO(n){return n.button!=null}let Wz=class v2{enableMultiplePointers;pointers=[];isDefaults=[];enabled=!0;activePointer;nonCapturedPointers=[];constructor(e){this.enableMultiplePointers=e}register(e,t=!1){return this.pointers.push(e),this.isDefaults.push(t),this.unregister.bind(this,e)}unregister(e){const t=this.pointers.indexOf(e);t!==-1&&(this.isDefaults.splice(t,1),this.pointers.splice(t,1))}startIntersection(e,t){const i=this.pointers.length;let r=!1;for(let s=0;s<i;s++){const a=this.pointers[s];if(a instanceof v2){a.startIntersection(e,t);continue}const o=a.getPointerCapture();if(o!=null){r=!0,a.setIntersection(a.intersector.intersectPointerCapture(o,t));continue}e.push(a),a.intersector.startIntersection(t)}return r}getIntersection(){return this.activePointer?.getIntersection()}getPointerCapture(){return this.activePointer?.getPointerCapture()}computeActivePointer(){let e;this.activePointer=void 0;const t=this.pointers.length;for(let i=0;i<t;i++){const r=this.pointers[i];r instanceof v2&&r.computeActivePointer();const s=r.getIntersection(),a=r.getPointerCapture()!=null?-1/0:s?.object.isVoidObject?1/0:s?.distance??1/0,o=this.isDefaults[i];(e==null||o&&a===e||a<e)&&(this.activePointer=r,e=a)}}commit(e,t,i=!0){if(this.enableMultiplePointers){const s=this.pointers.length;for(let a=0;a<s;a++)this.pointers[a].commit(e,t);return}i&&this.computeActivePointer();const r=this.pointers.length;for(let s=0;s<r;s++){const a=this.pointers[s];a.setEnabled(a===this.activePointer,e,!1),a.commit(e,t,!1)}}move(e,t){if(!this.enabled)return;if(this.nonCapturedPointers.length=0,!this.startIntersection(this.nonCapturedPointers,t)||this.enableMultiplePointers){$4("pointer",e,this.nonCapturedPointers);const r=this.nonCapturedPointers.length;for(let s=0;s<r;s++){const a=this.nonCapturedPointers[s];a.setIntersection(a.intersector.finalizeIntersection(e))}}this.commit(t,!0)}setEnabled(e,t){this.enabled=e;const i=this.pointers.length;for(let r=0;r<i;r++){const s=this.pointers[r];s.setEnabled(e&&(this.enableMultiplePointers||s==this.activePointer),t)}}};const uoe={},xO=n=>{let e;const t=new Set,i=(p,g)=>{const A=typeof p=="function"?p(e):p;if(!Object.is(A,e)){const v=e;e=g??(typeof A!="object"||A===null)?A:Object.assign({},e,A),t.forEach(x=>x(e,v))}},r=()=>e,c={setState:i,getState:r,getInitialState:()=>h,subscribe:p=>(t.add(p),()=>t.delete(p)),destroy:()=>{(uoe?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,c);return c},hoe=n=>n?xO(n):xO;new ee;new ee;new ee;function foe(){return navigator.userAgent.includes("Macintosh")&&navigator.xr!=null}function qz(n,e,{anchors:t=!0,handTracking:i=!foe(),layers:r=!0,meshDetection:s=!0,planeDetection:a=!0,customSessionInit:o,depthSensing:c=!1,hitTest:h=!0,domOverlay:p=!0,bodyTracking:g=!1,bounded:A}={}){if(o!=null)return o;const v=A==null?["local-floor"]:A?["bounded-floor"]:["unbounded","local-floor"],x=[];p instanceof Element&&(p=!0),tf(t,"anchors",v,x),tf(i,"hand-tracking",v,x),tf(r,"layers",v,x),tf(s,"mesh-detection",v,x),tf(a,"plane-detection",v,x),tf(c,"depth-sensing",v,x),tf(p,"dom-overlay",v,x),tf(h,"hit-test",v,x),tf(g,"body-tracking",v,x);const S={requiredFeatures:v,optionalFeatures:x};return e!=null&&(S.domOverlay={root:e}),c&&Object.assign(S,{depthSensing:{usagePreference:["gpu-optimized"],dataFormatPreference:[]}}),S}function tf(n,e,t,i){if(n!==!1){if(n===!0){i.push(e);return}t.push(e)}}function v0(n,e,t){return typeof n=="function"?n:(typeof n=="object"&&(e!=null&&doe(n,e)?n=n[e]:"default"in n&&(n=n.default)),n===!1?!1:n===!0?t:n??t)}function doe(n,e){return e in n}const Xz={session:void 0,mediaBinding:void 0,originReferenceSpace:void 0,visibilityState:void 0,mode:null,frameRate:void 0,inputSourceStates:[],detectedMeshes:[],detectedPlanes:[],layerEntries:[]};async function _O(n,e,t){if(typeof navigator>"u")return!1;const[i,r]=await Promise.all([navigator.xr?.isSessionSupported("immersive-vr").catch(a=>(console.error(a),!1)),navigator.xr?.isSessionSupported("immersive-ar").catch(a=>(console.error(a),!1))]);if(r||i)return!1;const{emulate:s}=await Uk(async()=>{const{emulate:a}=await import("./emulate-BLrJSa6f.js");return{emulate:a}},[]);return t&&window.alert("emulator started"),n.setState({emulator:s(e===!0?"metaQuest3":e)}),!0}const sR=new ee,wE=new ee;function poe(n){const e=typeof HTMLElement>"u"?void 0:n?.domOverlay instanceof HTMLElement?n.domOverlay:document.createElement("div"),t=hoe(()=>({...Xz,controller:n?.controller,hand:n?.hand,gaze:n?.gaze,screenInput:n?.screenInput,transientPointer:n?.transientPointer,domOverlayRoot:e})),i=t.subscribe(({session:v},{session:x})=>{x!=null&&v==null&&g!=null&&ME(g,n,e).catch(console.error)}),r=n?.emulate??"metaQuest3";let s;if(typeof window<"u"&&r!=!1){const v=(typeof r=="object"?r.inject:void 0)??{hostname:"localhost"};(v===!0||typeof v!="boolean"&&window.location.hostname===v.hostname)&&_O(t,r,!1).then(S=>{!S||g==null||ME(g,n,e)});const x=S=>{S.altKey&&S.metaKey&&S.code==="KeyE"&&_O(t,r,!0).then(_=>{!_||g==null||ME(g,n,e)})};window.addEventListener("keydown",x),s=()=>window.removeEventListener("keydown",x)}let a;if(e!=null){if(e.parentNode==null){const v=S=>{e.style.display=S.session!=null?"block":"none"},x=t.subscribe(v);v(t.getState()),document.body.appendChild(e),a=()=>{e.remove(),x()}}document.body.append(e)}const o=vae(v=>t.setState({inputSourceStates:[...t.getState().inputSourceStates,v]}),n),c=Aoe(t,o,n?.secondaryInputSources??!1),h=goe(n?.enterGrantedSession,v=>CE(e,v,n,g)),p=[];let g;const A=()=>{t.setState(c(g.getSession()))};return Object.assign(t,{addLayerEntry(v){t.getState().session!=null&&t.setState({layerEntries:[...t.getState().layerEntries,v]})},removeLayerEntry(v){t.getState().session!=null&&t.setState({layerEntries:t.getState().layerEntries.filter(x=>x!=v)})},requestFrame(){return new Promise(v=>p.push(v))},setWebXRManager(v){if(g===v)return;g?.removeEventListener("sessionstart",A),g=v,g.addEventListener("sessionstart",A);const{foveation:x,bounded:S}=n??{};g.setReferenceSpaceType(S?"bounded-floor":"local-floor"),x!=null&&g.setFoveation(x),ME(g,n,e).catch(console.error)},setFrameRate(v){const{session:x}=t.getState();x!=null&&Yz(x,v)},setHand(v,x){if(x==null){t.setState({hand:v});return}const S=t.getState().hand,_={};typeof S=="object"&&Object.assign(_,S),Object.assign(_,{default:v0(S,void 0,{}),[x]:v}),t.setState({hand:_})},setController(v,x){if(x==null){t.setState({controller:v});return}const S=t.getState().controller,_={};typeof S=="object"&&Object.assign(_,S),Object.assign(_,{default:v0(S,void 0,{}),[x]:v}),t.setState({controller:_})},setTransientPointer(v,x){if(x==null){t.setState({transientPointer:v});return}const S=t.getState().transientPointer,_={};typeof S=="object"&&Object.assign(_,S),Object.assign(_,{default:v0(S,void 0,{}),[x]:v}),t.setState({transientPointer:_})},setGaze(v){t.setState({gaze:v})},setScreenInput(v){t.setState({screenInput:v})},destroy(){g?.removeEventListener("sessionstart",A),s?.(),a?.(),h?.(),i(),c(void 0)},enterXR:v=>CE(e,v,n,g),enterAR:()=>CE(e,"immersive-ar",n,g),enterVR:()=>CE(e,"immersive-vr",n,g),onBeforeFrame(v,x,S){let _;const E=g?.getReferenceSpace()??void 0,C=t.getState(),T=x.parent??v;if(C.origin!=T&&(_??={},_.origin=T),E!=C.originReferenceSpace&&(_??={},_.originReferenceSpace=E),T.xrSpace=E,C.origin!=T&&C.origin!=null&&(C.origin.xrSpace=void 0),S!=null&&(g!=null&&voe(t,S,g),C.body!=S.body&&(_??={},_.body=S.body)),_!=null&&t.setState(_),S!=null){const R=p.length;for(let B=0;B<R;B++)p[B](S);p.length=0}},onBeforeRender(){const{session:v,layerEntries:x}=t.getState();if(v==null||g==null)return;const S=g.getCamera();S.aspect=S.projectionMatrix.elements[5]/S.projectionMatrix.elements[0];const _=v?.renderState.layers;if(_==null)return;S.getWorldPosition(sR),x.sort((T,R)=>{const B=T.renderOrder-R.renderOrder;if(B!==0)return B;T.object3D.getWorldPosition(wE);const U=wE.distanceToSquared(sR);return R.object3D.getWorldPosition(wE),wE.distanceToSquared(sR)-U});let E=!1;const C=x.map(({layer:T},R)=>(T!=_[R]&&(E=!0),T));E&&(C.push(g.getBaseLayer()),v.updateRenderState({layers:C}))}})}async function ME(n,e,t){const i=e?.offerSession??!0;if(navigator.xr?.offerSession==null||i===!1)return;let r;i===!0?r=await navigator.xr.isSessionSupported("immersive-ar")??!1?"immersive-ar":"immersive-vr":r=i;const s=await navigator.xr.offerSession(r,qz(r,t,e));Kz(s,n,e)}async function Yz(n,e){if(e===!1)return;const{supportedFrameRates:t}=n;if(t==null||t.length===0)return;if(typeof e=="function"){const r=e(t);if(r===!1)return;await n.updateTargetFrameRate(r);return}const i=e==="high"?1:e==="mid"?.5:0;await n.updateTargetFrameRate(t[Math.ceil((t.length-1)*i)])}async function CE(n,e,t,i){if(typeof navigator>"u"||navigator.xr==null)return Promise.reject(new Error("WebXR not supported"));if(i==null)return Promise.reject(new Error("not connected to three.js. You either might be missing the <XR> component or the canvas is not yet loaded?"));const r=await navigator.xr.requestSession(e,qz(e,n,t));return await Kz(r,i,t),r}async function Kz(n,e,t){await Promise.all([Yz(n,t?.frameRate??"high"),moe(e,n,t)])}async function moe(n,e,t){if(n==null)return;const i=XRWebGLLayer.getNativeFramebufferScaleFactor(e);let r=t?.frameBufferScaling;typeof r=="function"&&(r=r(i)),typeof r=="string"&&(r=r==="high"?i:r==="mid"?1:.5),r!=null&&n?.setFramebufferScaleFactor(r),await n?.setSession(e)}const SO=["immersive-ar","immersive-vr","inline"];function goe(n=SO,e){if(typeof navigator>"u"||n===!1)return;n===!0&&(n=SO);const t=async()=>{for(const i of n)await navigator.xr?.isSessionSupported(i)&&e(i)};return navigator.xr?.addEventListener("sessiongranted",t),()=>navigator.xr?.removeEventListener("sessiongranted",t)}function Aoe(n,e,t){let i;return r=>{if(i?.(),r==null)return{};const s=[];let a;const o=()=>{a=void 0,n.setState({inputSourceStates:e(r,n.getState().inputSourceStates,s)}),s.length=0},c=(S,_)=>{s.push({isPrimary:S,added:_.added,removed:_.removed}),a==null&&(t?a=setTimeout(o,100):o())},h=c.bind(null,!0);r.addEventListener("inputsourceschange",h);let p;if(t){const S=c.bind(null,!1);r.addEventListener("trackedsourceschange",S),p=()=>r.removeEventListener("trackedsourceschange",S)}const g=()=>n.setState({frameRate:r.frameRate,visibilityState:r.visibilityState});r.addEventListener("frameratechange",g),r.addEventListener("visibilitychange",g);const A=()=>{i?.(),i=void 0,n.setState({emulator:n.getState().emulator,...Xz})};r.addEventListener("end",A);const v=[{isPrimary:!0,added:r.inputSources}];t&&v.push({isPrimary:!1,added:r.trackedSources});const x=e(r,[],v);return i=()=>{p?.(),clearTimeout(a),e(r,n.getState().inputSourceStates,"remove-all"),r.removeEventListener("end",A),r.removeEventListener("frameratechange",g),r.removeEventListener("visibilitychange",g),r.removeEventListener("inputsourceschange",h)},{inputSourceStates:x,frameRate:r.frameRate,visibilityState:r.visibilityState,detectedMeshes:[],detectedPlanes:[],mode:r.environmentBlendMode==="opaque"?"immersive-vr":"immersive-ar",session:r,mediaBinding:typeof XRMediaBinding>"u"?void 0:new XRMediaBinding(r)}}}function voe(n,e,t){const i=t.getReferenceSpace(),{detectedMeshes:r,detectedPlanes:s,session:a,inputSourceStates:o}=n.getState();if(i==null||a==null)return;const c=EO(s,e.detectedPlanes),h=EO(r,e.detectedMeshes);(s!=c||r!=h)&&n.setState({detectedPlanes:c,detectedMeshes:h});const p=o.length;for(let g=0;g<p;g++){const A=o[g];switch(A.type){case"controller":ale(A);break;case"hand":fae(A,e,t);break}}}const yoe=[];function EO(n,e){return e==null?yoe:n!=null&&boe(e,n)?n:Array.from(e)}function boe(n,e){if(n.size!=e.length)return!1;for(const t of e)if(!n.has(t))return!1;return!0}new ba;new ra;async function xoe(n,e=nle){const{scene:t}=await e.loadAsync(n.assetPath);return t.clone(!0)}function _oe(n,e){n.renderOrder=e?.renderOrder??0,n.traverse(t=>{t instanceof Wt&&t.material instanceof ts&&(t.material.colorWrite=e?.colorWrite??!0)})}function Soe(n,e,t){const i=[];for(const r in e.components){const s=e.components[r];let a=t[r];a==null&&(t[r]=a={state:"default"}),i.push(...Object.values(s.visualResponses).map(o=>Eoe(n,a,o)))}return()=>{const r=i.length;for(let s=0;s<r;s++)i[s]()}}function Eoe(n,e,t){const i=n.getObjectByName(t.valueNodeName);if(e.object=i,i==null)return()=>{};if(t.valueNodeProperty==="visibility")return()=>i.visible=t.states.includes(e.state);const r=n.getObjectByName(t.minNodeName),s=n.getObjectByName(t.maxNodeName);return r==null||s==null?()=>{}:()=>{const a=woe(e,t);i.quaternion.slerpQuaternions(r.quaternion,s.quaternion,a),i.position.lerpVectors(r.position,s.position,a),i.updateMatrix()}}function woe(n,{componentProperty:e,states:t}){const i=t.includes(n.state);switch(e){case"xAxis":return i?wO(n).x:.5;case"yAxis":return i?wO(n).y:.5;case"button":return i?n.button??0:0;case"state":return i?1:0}}const R1=new Ze;function wO({xAxis:n=0,yAxis:e=0}){if(R1.lengthSq()>1){const i=Math.atan2(e,n);R1.set(Math.cos(i),Math.sin(i))}else R1.set(n,e);return R1.multiplyScalar(.5).addScalar(.5),R1}function MO(n,e){if(e!=null&&e.createdAt!=null&&e.createdAt>=n.lastChangedTime)return e;const t=new vn;return t.setIndex(new An(n.indices,1)),t.setAttribute("position",new An(n.vertices,3)),Object.assign(t,{creationTime:n.lastChangedTime})}function CO(n,e){return e!=null&&e.createdAt!=null&&e.createdAt>=n.lastChangedTime?e:Object.assign(Moe(n.polygon),{createdAt:n.lastChangedTime})}const B1=new l6,TE=new Ze;function Moe(n){if(n.length===0)return new vn;const e=new df,t=n.map(({x:r,z:s})=>new Ze(r,s));B1.setFromPoints(t),B1.getSize(TE);for(const r of t)r.sub(B1.min),r.divide(TE);e.setFromPoints(t);const i=new cv(e);return i.scale(TE.x,TE.y,1),i.translate(B1.min.x,B1.min.y,0),i.rotateX(Math.PI/2),i}function nM(n,e=1){if(n!=null)return{x:xm(n.x),y:xm(n.y),z:xm(n.z),w:"w"in n?xm(n.w,e):e}}function xm(n,e=0){return isNaN(n)?e:n}const eB=60/180*Math.PI,$z=60/180*Math.PI,Jz=-30/180*Math.PI,Zz=30/180*Math.PI;function Coe(n,e,t,i,r,s,a){return n instanceof HTMLVideoElement?Toe(n,e,t,r,s,a):Ioe(n,e.origin,t,i,r,s,a)}function Toe(n,e,t,i,{invertStereo:r,layout:s,shape:a="quad"},o={}){const c=oC(i,e.origin,t,H0),h=tB(H0,tg),p={invertStereo:r,layout:s,space:c,transform:h};iB(a,p,o.centralAngle,tg);const g=`create${eG(a)}Layer`,A=e.mediaBinding?.[g](n,p);if(A!=null)return nB(A,o),A}function Ioe(n,e,t,i,r,{shape:s="quad",...a},o={}){const c=oC(r,e,t,H0),h=tB(H0,tg),p={...a,isStatic:!(n instanceof Vr),textureType:"texture",viewPixelWidth:a.layout==="stereo-left-right"?n.width/2:n.width,viewPixelHeight:a.layout==="stereo-top-bottom"?n.height/2:n.height,space:c,transform:h};iB(s,p,o.centralAngle,tg);const g=`create${eG(s)}Layer`,A=i.getBinding()?.[g](p);if(A!=null)return nB(A,o),A}const H0=new qt,TO=new ee,IO=new Bi,tg=new ee;function tB(n,e=tg){return n.decompose(TO,IO,e),e.x=xm(e.x),e.y=xm(e.y),e.z=xm(e.z),new XRRigidTransform(nM(TO),nM(IO))}const Roe=64/Math.PI;function aR(n){return Math.ceil(n*Roe)}function Boe(n,e,t,i){if(t!=null&&i!=null){const r=n.xr.getBinding().getSubImage(t.layer,i);n.setRenderTargetTextures(e,r.colorTexture)}n.setRenderTarget(e)}function Doe(n,e){switch(n){case"cylinder":const t=e.centralAngle??eB;return new Wd(1,1,1,aR(t),1,!0,Math.PI-t/2,t).scale(-1,1,1);case"equirect":{const i=e.centralHorizontalAngle??$z,r=e.upperVerticalAngle??Zz,s=e.lowerVerticalAngle??Jz,a=r-s;return new hc(1,aR(i),aR(a),-Math.PI/2-i/2,i,Math.PI/2-r,a).scale(-1,1,1)}case"quad":return new ra}}function eG(n){return`${n[0].toUpperCase()}${n.slice(1)}`}function nB(n,e={}){if(n.chromaticAberrationCorrection=e.chromaticAberrationCorrection,n.quality=e.quality??"default",n.blendTextureSourceAlpha=e.blendTextureSourceAlpha??!1,n instanceof XRCylinderLayer){n.centralAngle=e?.centralAngle??eB;return}n instanceof XREquirectLayer&&(n.centralHorizontalAngle=e?.centralHorizontalAngle??$z,n.lowerVerticalAngle=e?.lowerVerticalAngle??Jz,n.upperVerticalAngle=e?.upperVerticalAngle??Zz)}function Loe(n,e,t,i){let r=!1;const s=async()=>{const a=await e.requestFrame();r||Foe(n,t,a,i)};return t.addEventListener("redraw",s),s(),()=>{r=!0,t.removeEventListener("redraw",s)}}async function Noe(n){if(n instanceof HTMLImageElement&&!n.complete&&await new Promise(e=>{const t=()=>{e(),n.removeEventListener("load",t)};n.addEventListener("load",t)}),n instanceof HTMLVideoElement&&n.readyState<1)return new Promise(e=>{const t=()=>{e(),n.removeEventListener("loadedmetadata",t)};n.addEventListener("loadedmetadata",t)})}function Uoe(n){if(n instanceof Vr)return n.texture;const e=n instanceof HTMLVideoElement?new NM(n):new Pi(n);return e.colorSpace=xi,e.needsUpdate=!0,e}function Foe(n,e,t,i){const r=n.getContext(),s=n.xr.getBinding().getSubImage(e,t);n.state.bindTexture(r.TEXTURE_2D,s.colorTexture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.texSubImage2D(r.TEXTURE_2D,0,0,0,i.width,i.height,r.RGBA,r.UNSIGNED_BYTE,i)}function Poe(n,e,t,i){n.originReferenceSpace!=null&&(e.space=oC(i,n.origin,n.originReferenceSpace,H0),e.transform=tB(H0,tg),iB(Ooe(e),e,t,tg))}function iB(n,e,t,i){if(n==="cylinder"){const s=(i.x+i.z)/2,a=s*(t??eB);e.radius=s,e.aspectRatio=i.y===0?1:a/i.y}else n==="quad"?(e.width=i.x/2,e.height=i.y/2):e.radius=(i.x+i.y+i.z)/3}function Ooe(n){return n instanceof XRCylinderLayer?"cylinder":n instanceof XREquirectLayer?"equirect":"quad"}function tG(n,e,t){return new Vr(n*t,e*t,{minFilter:mn,magFilter:mn,type:ci,depthTexture:new Qm(n,e)})}var koe=Object.defineProperty,zoe=(n,e,t)=>e in n?koe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ci=(n,e,t)=>(zoe(n,typeof e!="symbol"?e+"":e,t),t);function oR(n,e,t,i,r){let s;if(n=n.subarray||n.slice?n:n.buffer,t=t.subarray||t.slice?t:t.buffer,n=e?n.subarray?n.subarray(e,r&&e+r):n.slice(e,r&&e+r):n,t.set)t.set(n,i);else for(s=0;s<n.length;s++)t[s+i]=n[s];return t}function Goe(n){return n instanceof Float32Array?n:n instanceof vn?n.getAttribute("position").array:n.map(e=>{const t=Array.isArray(e);return e instanceof ee?[e.x,e.y,e.z]:e instanceof Ze?[e.x,e.y,0]:t&&e.length===3?[e[0],e[1],e[2]]:t&&e.length===2?[e[0],e[1],0]:e}).flat()}class Hoe extends vn{constructor(){super(),Ci(this,"type","MeshLine"),Ci(this,"isMeshLine",!0),Ci(this,"positions",[]),Ci(this,"previous",[]),Ci(this,"next",[]),Ci(this,"side",[]),Ci(this,"width",[]),Ci(this,"indices_array",[]),Ci(this,"uvs",[]),Ci(this,"counters",[]),Ci(this,"widthCallback",null),Ci(this,"_attributes"),Ci(this,"_points",[]),Ci(this,"points"),Ci(this,"matrixWorld",new qt),Object.defineProperties(this,{points:{enumerable:!0,get(){return this._points},set(e){this.setPoints(e,this.widthCallback)}}})}setMatrixWorld(e){this.matrixWorld=e}setPoints(e,t){if(e=Goe(e),this._points=e,this.widthCallback=t??null,this.positions=[],this.counters=[],e.length&&e[0]instanceof ee)for(let i=0;i<e.length;i++){const r=e[i],s=i/(e.length-1);this.positions.push(r.x,r.y,r.z),this.positions.push(r.x,r.y,r.z),this.counters.push(s),this.counters.push(s)}else for(let i=0;i<e.length;i+=3){const r=i/(e.length-1);this.positions.push(e[i],e[i+1],e[i+2]),this.positions.push(e[i],e[i+1],e[i+2]),this.counters.push(r),this.counters.push(r)}this.process()}compareV3(e,t){const i=e*6,r=t*6;return this.positions[i]===this.positions[r]&&this.positions[i+1]===this.positions[r+1]&&this.positions[i+2]===this.positions[r+2]}copyV3(e){const t=e*6;return[this.positions[t],this.positions[t+1],this.positions[t+2]]}process(){const e=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[];let t,i;this.compareV3(0,e-1)?i=this.copyV3(e-2):i=this.copyV3(0),this.previous.push(i[0],i[1],i[2]),this.previous.push(i[0],i[1],i[2]);for(let r=0;r<e;r++){if(this.side.push(1),this.side.push(-1),this.widthCallback?t=this.widthCallback(r/(e-1)):t=1,this.width.push(t),this.width.push(t),this.uvs.push(r/(e-1),0),this.uvs.push(r/(e-1),1),r<e-1){i=this.copyV3(r),this.previous.push(i[0],i[1],i[2]),this.previous.push(i[0],i[1],i[2]);const s=r*2;this.indices_array.push(s,s+1,s+2),this.indices_array.push(s+2,s+1,s+3)}r>0&&(i=this.copyV3(r),this.next.push(i[0],i[1],i[2]),this.next.push(i[0],i[1],i[2]))}this.compareV3(e-1,0)?i=this.copyV3(1):i=this.copyV3(e-1),this.next.push(i[0],i[1],i[2]),this.next.push(i[0],i[1],i[2]),!this._attributes||this._attributes.position.count!==this.counters.length?this._attributes={position:new An(new Float32Array(this.positions),3),previous:new An(new Float32Array(this.previous),3),next:new An(new Float32Array(this.next),3),side:new An(new Float32Array(this.side),1),width:new An(new Float32Array(this.width),1),uv:new An(new Float32Array(this.uvs),2),index:new An(new Uint16Array(this.indices_array),1),counters:new An(new Float32Array(this.counters),1)}:(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.width.copyArray(new Float32Array(this.width)),this._attributes.width.needsUpdate=!0,this._attributes.uv.copyArray(new Float32Array(this.uvs)),this._attributes.uv.needsUpdate=!0,this._attributes.index.copyArray(new Uint16Array(this.indices_array)),this._attributes.index.needsUpdate=!0),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()}advance({x:e,y:t,z:i}){const r=this._attributes.position.array,s=this._attributes.previous.array,a=this._attributes.next.array,o=r.length;oR(r,0,s,0,o),oR(r,6,r,0,o-6),r[o-6]=e,r[o-5]=t,r[o-4]=i,r[o-3]=e,r[o-2]=t,r[o-1]=i,oR(r,6,a,0,o-6),a[o-6]=e,a[o-5]=t,a[o-4]=i,a[o-3]=e,a[o-2]=t,a[o-1]=i,this._attributes.position.needsUpdate=!0,this._attributes.previous.needsUpdate=!0,this._attributes.next.needsUpdate=!0}}const Qoe=`
  #include <common>
  #include <logdepthbuf_pars_vertex>
  #include <fog_pars_vertex>
  #include <clipping_planes_pars_vertex>

  attribute vec3 previous;
  attribute vec3 next;
  attribute float side;
  attribute float width;
  attribute float counters;
  
  uniform vec2 resolution;
  uniform float lineWidth;
  uniform vec3 color;
  uniform float opacity;
  uniform float sizeAttenuation;
  
  varying vec2 vUV;
  varying vec4 vColor;
  varying float vCounters;
  
  vec2 fix(vec4 i, float aspect) {
    vec2 res = i.xy / i.w;
    res.x *= aspect;
    return res;
  }
  
  void main() {
    float aspect = resolution.x / resolution.y;
    vColor = vec4(color, opacity);
    vUV = uv;
    vCounters = counters;
  
    mat4 m = projectionMatrix * modelViewMatrix;
    vec4 finalPosition = m * vec4(position, 1.0) * aspect;
    vec4 prevPos = m * vec4(previous, 1.0);
    vec4 nextPos = m * vec4(next, 1.0);
  
    vec2 currentP = fix(finalPosition, aspect);
    vec2 prevP = fix(prevPos, aspect);
    vec2 nextP = fix(nextPos, aspect);
  
    float w = lineWidth * width;
  
    vec2 dir;
    if (nextP == currentP) dir = normalize(currentP - prevP);
    else if (prevP == currentP) dir = normalize(nextP - currentP);
    else {
      vec2 dir1 = normalize(currentP - prevP);
      vec2 dir2 = normalize(nextP - currentP);
      dir = normalize(dir1 + dir2);
  
      vec2 perp = vec2(-dir1.y, dir1.x);
      vec2 miter = vec2(-dir.y, dir.x);
      //w = clamp(w / dot(miter, perp), 0., 4. * lineWidth * width);
    }
  
    //vec2 normal = (cross(vec3(dir, 0.), vec3(0., 0., 1.))).xy;
    vec4 normal = vec4(-dir.y, dir.x, 0., 1.);
    normal.xy *= .5 * w;
    //normal *= projectionMatrix;
    if (sizeAttenuation == 0.) {
      normal.xy *= finalPosition.w;
      normal.xy /= (vec4(resolution, 0., 1.) * projectionMatrix).xy * aspect;
    }
  
    finalPosition.xy += normal.xy * side;
    gl_Position = finalPosition;
    #include <logdepthbuf_vertex>
    #include <fog_vertex>
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    #include <clipping_planes_vertex>
    #include <fog_vertex>
  }
`,Voe=parseInt(ag.replace(/\D+/g,"")),joe=Voe>=154?"colorspace_fragment":"encodings_fragment",Woe=`
  #include <fog_pars_fragment>
  #include <logdepthbuf_pars_fragment>
  #include <clipping_planes_pars_fragment>
  
  uniform sampler2D map;
  uniform sampler2D alphaMap;
  uniform float useGradient;
  uniform float useMap;
  uniform float useAlphaMap;
  uniform float useDash;
  uniform float dashArray;
  uniform float dashOffset;
  uniform float dashRatio;
  uniform float visibility;
  uniform float alphaTest;
  uniform vec2 repeat;
  uniform vec3 gradient[2];
  
  varying vec2 vUV;
  varying vec4 vColor;
  varying float vCounters;
  
  void main() {
    #include <logdepthbuf_fragment>
    vec4 diffuseColor = vColor;
    if (useGradient == 1.) diffuseColor = vec4(mix(gradient[0], gradient[1], vCounters), 1.0);
    if (useMap == 1.) diffuseColor *= texture2D(map, vUV * repeat);
    if (useAlphaMap == 1.) diffuseColor.a *= texture2D(alphaMap, vUV * repeat).a;
    if (diffuseColor.a < alphaTest) discard;
    if (useDash == 1.) diffuseColor.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));
    diffuseColor.a *= step(vCounters, visibility);
    #include <clipping_planes_fragment>
    gl_FragColor = diffuseColor;     
    #include <fog_fragment>
    #include <tonemapping_fragment>
    #include <${joe}>
  }
`;class qoe extends Fs{constructor(e){super({uniforms:{...Ht.fog,lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new Mt(16777215)},gradient:{value:[new Mt(16711680),new Mt(65280)]},opacity:{value:1},resolution:{value:new Ze(1,1)},sizeAttenuation:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},useGradient:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new Ze(1,1)}},vertexShader:Qoe,fragmentShader:Woe}),Ci(this,"lineWidth"),Ci(this,"map"),Ci(this,"useMap"),Ci(this,"alphaMap"),Ci(this,"useAlphaMap"),Ci(this,"color"),Ci(this,"gradient"),Ci(this,"resolution"),Ci(this,"sizeAttenuation"),Ci(this,"dashArray"),Ci(this,"dashOffset"),Ci(this,"dashRatio"),Ci(this,"useDash"),Ci(this,"useGradient"),Ci(this,"visibility"),Ci(this,"repeat"),this.type="MeshLineMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get(){return this.uniforms.lineWidth.value},set(t){this.uniforms.lineWidth.value=t}},map:{enumerable:!0,get(){return this.uniforms.map.value},set(t){this.uniforms.map.value=t}},useMap:{enumerable:!0,get(){return this.uniforms.useMap.value},set(t){this.uniforms.useMap.value=t}},alphaMap:{enumerable:!0,get(){return this.uniforms.alphaMap.value},set(t){this.uniforms.alphaMap.value=t}},useAlphaMap:{enumerable:!0,get(){return this.uniforms.useAlphaMap.value},set(t){this.uniforms.useAlphaMap.value=t}},color:{enumerable:!0,get(){return this.uniforms.color.value},set(t){this.uniforms.color.value=t}},gradient:{enumerable:!0,get(){return this.uniforms.gradient.value},set(t){this.uniforms.gradient.value=t}},opacity:{enumerable:!0,get(){return this.uniforms.opacity.value},set(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get(){return this.uniforms.resolution.value},set(t){this.uniforms.resolution.value.copy(t)}},sizeAttenuation:{enumerable:!0,get(){return this.uniforms.sizeAttenuation.value},set(t){this.uniforms.sizeAttenuation.value=t}},dashArray:{enumerable:!0,get(){return this.uniforms.dashArray.value},set(t){this.uniforms.dashArray.value=t,this.useDash=t!==0?1:0}},dashOffset:{enumerable:!0,get(){return this.uniforms.dashOffset.value},set(t){this.uniforms.dashOffset.value=t}},dashRatio:{enumerable:!0,get(){return this.uniforms.dashRatio.value},set(t){this.uniforms.dashRatio.value=t}},useDash:{enumerable:!0,get(){return this.uniforms.useDash.value},set(t){this.uniforms.useDash.value=t}},useGradient:{enumerable:!0,get(){return this.uniforms.useGradient.value},set(t){this.uniforms.useGradient.value=t}},visibility:{enumerable:!0,get(){return this.uniforms.visibility.value},set(t){this.uniforms.visibility.value=t}},alphaTest:{enumerable:!0,get(){return this.uniforms.alphaTest.value},set(t){this.uniforms.alphaTest.value=t}},repeat:{enumerable:!0,get(){return this.uniforms.repeat.value},set(t){this.uniforms.repeat.value.copy(t)}}}),this.setValues(e)}copy(e){return super.copy(e),this.lineWidth=e.lineWidth,this.map=e.map,this.useMap=e.useMap,this.alphaMap=e.alphaMap,this.useAlphaMap=e.useAlphaMap,this.color.copy(e.color),this.gradient=e.gradient,this.opacity=e.opacity,this.resolution.copy(e.resolution),this.sizeAttenuation=e.sizeAttenuation,this.dashArray=e.dashArray,this.dashOffset=e.dashOffset,this.dashRatio=e.dashRatio,this.useDash=e.useDash,this.useGradient=e.useGradient,this.visibility=e.visibility,this.alphaTest=e.alphaTest,this.repeat.copy(e.repeat),this}}const D1=new Us(0,0,0,"YXZ"),IE=new Bi;function Xoe(n,e,t){n.updateWorldMatrix(!0,!1),n.matrixWorld.decompose(e.position,IE,e.scale),D1.setFromQuaternion(IE),D1.z=0,D1.x=JE(D1.x-10*Math.PI/180,-Math.PI/2,1.1*Math.PI/4),IE.setFromEuler(D1),e.quaternion.slerp(IE,t/100)}function Yoe(n){return n.userData.teleportTarget===!0}function Koe(n={}){return(e,t,i,r)=>!(!Yoe(e)||n.filter!=null&&!n.filter(e,t,i,r))}function $oe(){return new OM(new ee(0,0,0),new ee(0,0,-8),new ee(0,-20,-15)).getPoints(20)}let Joe=class extends Wt{multiplier;lineLengths;options={};constructor(e){const t=new Hoe,i=new Float32Array(e.length*3);for(let a=0;a<e.length;a++)e[a].toArray(i,a*3);t.setPoints(i);const r=(e.length*3-3)/(e.length*3-1),s=new qoe({lineWidth:.1,resolution:void 0,visibility:r});super(t,s),this.material.transparent=!0,this.multiplier=r,this.material=s,this.lineLengths=e.slice(0,-1).map((a,o)=>a.distanceTo(e[o+1]))}update(e){const t=e.getEnabled(),i=e.getIntersection();if(!t||e.getButtonsDown().size===0||i==null){this.visible=!1;return}if(this.visible=!0,i.details.type!="lines"){this.material.visibility=this.multiplier;return}const{distanceOnLine:r,lineIndex:s}=i.details,a=this.lineLengths[s];this.material.visibility=this.multiplier*(s+r/a)/this.lineLengths.length;const{color:o="white",opacity:c=.4,size:h=.01}=this.options;this.material.lineWidth=h,this.material.opacity=typeof c=="function"?c(e):c;const p=typeof o=="function"?o(e):o;Array.isArray(p)?this.material.color.set(...p):this.material.color.set(p)}};const RO=new qt,RE=new ee,Zoe=new ee,BO=new Bi;async function ele(n,e,t,i=["point","plane","mesh"]){typeof t=="string"&&(t=await e.requestReferenceSpace(t));const r=Array.isArray(i)?i:[i];let s,a,o;const c=n.getState();if(t instanceof XRSpace)s={space:t,entityTypes:r},o=c.origin;else{const p=oC(t,c.origin,c.originReferenceSpace,RO);if(p==null)return;RO.decompose(RE,BO,Zoe);const g=nM(RE);RE.set(0,0,-1).applyQuaternion(BO);const A=new XRRay(g,nM(RE,0));o=t,s={space:p,offsetRay:A,entityTypes:r},a=p}const h=await e?.requestHitTestSource?.(s);if(h!=null)return{source:h,getWorldMatrix:tle.bind(null,n,a,o)}}function tle(n,e,t,i,r){if(e??=n.getState().originReferenceSpace,e==null)return!1;const s=r.getPose(e);return s==null?!1:(i.fromArray(s.transform.matrix),t!=null&&(t.updateWorldMatrix(!0,!1),i.premultiply(t.matrixWorld)),!0)}new ee(1,1,1);new ee(0,0,0);new qt;new qt;new ee;new ee;new ee;new Us;new ee;new ee;const nle=new ax,nG="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/";function y2(n,...e){let t=n();for(const i of e)t instanceof Promise?t=t.then(i):t=i(t);return t}const ile="generic-trigger";class rle{baseAssetPath;defaultProfileId;profilesListCache;profileCacheMap=new Map;constructor(e){this.baseAssetPath=e?.baseAssetPath??nG,this.defaultProfileId=e?.defaultControllerProfileId??ile}load(e,t){return y2(()=>this.loadProfile(e),i=>{for(const r in i.layouts)if(r.includes(t))return i.layouts[r];throw new Error(`No matching layout for "${t}", in profile ${i.profileId} with layouts ${Object.keys(i.layouts).join(", ")}.`)})}loadAsync=this.load;loadProfile(e){return y2(()=>this.profilesListCache??DO(new URL("profilesList.json",this.baseAssetPath).href).then(t=>this.profilesListCache=t),t=>{const i=e.length;let r;for(let s=0;s<i&&(r=t[e[s]],r==null);s++);if(r??=t[this.defaultProfileId],r==null)throw new Error(`no matching profile found for profiles "${e.join(", ")}" in profile list ${JSON.stringify(t)}`);return this.loadProfileFromPath(r.path)})}loadProfileFromPath(e){const t=this.profileCacheMap.get(e);if(t!=null)return t;const i=new URL(e,this.baseAssetPath).href;return DO(i).then(r=>{for(const s in r.layouts){const a=r.layouts[s];a!=null&&(a.assetPath=new URL(a.assetPath,i).href)}return this.profileCacheMap.set(e,r),r})}}async function DO(n){let e=await fetch(n);return e.ok?e.json():Promise.reject(new Error(e.statusText))}function sle(n,e,t,i,r){return y2(()=>t.load(e.profiles,e.handedness),s=>{const a={};return Nz(a,e,s),{id:n,isPrimary:r,events:i,type:"controller",inputSource:e,gamepad:a,layout:s}})}function ale({gamepad:n,inputSource:e,layout:t}){Nz(n,e,t)}const iG=X.createContext(void 0),tp=X.createContext(void 0),dx=X.createContext(void 0),rB=X.createContext(void 0),ole={},LO=n=>{let e;const t=new Set,i=(p,g)=>{const A=typeof p=="function"?p(e):p;if(!Object.is(A,e)){const v=e;e=g??(typeof A!="object"||A===null)?A:Object.assign({},e,A),t.forEach(x=>x(e,v))}},r=()=>e,c={setState:i,getState:r,getInitialState:()=>h,subscribe:p=>(t.add(p),()=>t.delete(p)),destroy:()=>{(ole?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,c);return c},lle=n=>n?LO(n):LO,rG={},{useDebugValue:cle}=Gd,{useSyncExternalStoreWithSelector:ule}=j4;let NO=!1;const hle=n=>n;function hC(n,e=hle,t){(rG?"production":void 0)!=="production"&&t&&!NO&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),NO=!0);const i=ule(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return cle(i),i}const UO=n=>{(rG?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?lle(n):n,t=(i,r)=>hC(e,i,r);return Object.assign(t,e),t},fle=n=>n?UO(n):UO;function px(n,e){if(Object.is(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;if(n instanceof Map&&e instanceof Map){if(n.size!==e.size)return!1;for(const[i,r]of n)if(!Object.is(r,e.get(i)))return!1;return!0}if(n instanceof Set&&e instanceof Set){if(n.size!==e.size)return!1;for(const i of n)if(!e.has(i))return!1;return!0}const t=Object.keys(n);if(t.length!==Object.keys(e).length)return!1;for(const i of t)if(!Object.prototype.hasOwnProperty.call(e,i)||!Object.is(n[i],e[i]))return!1;return!0}X.forwardRef(({id:n,children:e,onPress:t,onRelease:i},r)=>{const s=kd("controller"),[a,o]=X.useState(void 0);if(X.useImperativeHandle(r,()=>a,[a]),dle(s,n,c=>c==="pressed"?t?.():i?.()),Gi(()=>o(s.gamepad[n]?.object)),a!=null)return aC(e,a)});function dle(n,e,t){const i=X.useRef(void 0);Gi(()=>{const r=n?.gamepad[e]?.state;r!=null&&r!=i.current&&t(r),i.current=r})}const ple=Symbol("loadXRControllerModel"),mle=X.forwardRef((n,e)=>{const t=kd("controller"),i=W4(xoe,[t.layout,void 0,ple]);_oe(i,n),t.object=i,X.useImperativeHandle(e,()=>i,[i]);const r=X.useMemo(()=>Soe(i,t.layout,t.gamepad),[i,t.layout,t.gamepad]);return Gi(r),D.jsx(Kc,{space:"grip-space",children:D.jsx("primitive",{object:i})})}),gle=X.forwardRef((n,e)=>{const t=kd("hand"),i=Zm(ax,t.assetPath),r=X.useMemo(()=>cae(i),[i]);uae(r,n),t.object=r,X.useImperativeHandle(e,()=>r,[r]);const s=hG(),a=X.useMemo(()=>pae(t.inputSource.hand,r,s),[t.inputSource,r,s]);return Gi((o,c,h)=>a(h)),D.jsx("primitive",{object:r})});X.forwardRef(({joint:n,children:e},t)=>D.jsx(Kc,{ref:t,space:n,children:e}));function sG({children:n}){const e=X.useMemo(()=>new Wz(!1),[]);return mx(e),D.jsx(rB.Provider,{value:e,children:n})}function fC(n){for(const e of Object.keys(n))delete n[e]}function Ale(n,e,t,i){const r=X.useMemo(()=>({}),[]);fC(r),Object.assign(r,t);const s=ih(),a=X.useMemo(()=>eoe(()=>s.getState().camera,n,e,r,i),[s,n,e,r,i]);return mx(a,t?.makeDefault),a}function vle(n,e,t,i){const r=X.useMemo(()=>({}),[]);fC(r),Object.assign(r,t);const s=ih(),a=X.useMemo(()=>toe(()=>s.getState().camera,n,e,r,i),[s,n,e,r,i]);return mx(a,t?.makeDefault),a}function yle(n,e,t,i){const r=X.useMemo(()=>({}),[]);fC(r),Object.assign(r,t);const s=ih(),a=X.useMemo(()=>noe(()=>s.getState().camera,n,e,r,i),[s,n,e,r,i]);return mx(a,t?.makeDefault),a}function ble(n,e,t,i){const r=X.useMemo(()=>({}),[]);fC(r),Object.assign(r,t);const s=ih(),a=X.useMemo(()=>ioe(()=>s.getState().camera,n,e,r,i),[s,n,e,r,i]);return mx(a,t?.makeDefault),a}const xle=X.forwardRef((n,e)=>{const t=X.useMemo(()=>{const r=n.materialClass??Sae;return new r},[n.materialClass]),i=X.useRef(null);return X.useImperativeHandle(e,()=>i.current,[]),Gi(()=>i.current!=null&&Eae(i.current,t,n.pointer,n)),D.jsx("mesh",{matrixAutoUpdate:!1,renderOrder:n.renderOrder??2,ref:i,material:t,children:D.jsx("boxGeometry",{})})}),dC=X.forwardRef((n,e)=>{const t=X.useMemo(()=>{const a=n.materialClass??bae;return new a},[n.materialClass]),i=X.useRef(null),r=X.useRef(null);X.useImperativeHandle(e,()=>i.current,[]),Gi(()=>i.current!=null&&r.current!=null&&_ae(r.current,i.current,t,n.pointer,n));const s=dl(a=>a.scene);return D.jsxs(D.Fragment,{children:[D.jsx("group",{ref:r}),aC(D.jsx("mesh",{renderOrder:n.renderOrder??1,ref:i,matrixAutoUpdate:!1,material:t,children:D.jsx("planeGeometry",{})}),s)]})});function sB(n,e,t,i){const r=ds(s=>s.session);X.useEffect(()=>{if(r!=null)return wae(n,r,e,t,i)},[t,e,n,r,i])}function mx(n,e=!1){const t=X.useContext(rB);if(t==null)throw new Error("xr pointers can only be used inside the XR component");X.useEffect(()=>{const i=t.register(n,e);return()=>{i()}},[t,n,e]),X.useEffect(()=>{if(n instanceof mv)return()=>n.exit({timeStamp:performance.now()})},[n])}const _le=X.forwardRef(({pointer:n,linePoints:e,...t},i)=>{const r=X.useMemo(()=>new Joe(e),[e]);return X.useImperativeHandle(i,()=>r,[r]),r.options=t,Gi(()=>r.update(n)),D.jsx("primitive",{object:r})});function aG(n,e,t){const i=X.useContext(tp);if(i==null)throw new Error("DefaultXRInputSourceGrabPointer can only be used inside a XRInputSource");const r=X.useRef(null),s=Ale(r,i,t);sB(s,i.inputSource,n,i.events);const a=t.cursorModel;return D.jsx(Kc,{ref:r,space:e,children:a!==!1&&D.jsx(dC,{pointer:s,opacity:Mae,...va(a)})})}const Sle=aG.bind(null,"select","index-finger-tip"),Ele=aG.bind(null,"squeeze","grip-space");function gx(n){const e=kd(),t=X.useRef(null),i=vle(t,e,n);sB(i,e.inputSource,"select",e.events);const r=n.rayModel,s=n.cursorModel;return D.jsxs(Kc,{ref:t,space:"target-ray-space",children:[r!==!1&&D.jsx(xle,{pointer:i,opacity:$w,...va(r)}),s!==!1&&D.jsx(dC,{pointer:i,opacity:$w,...va(s)})]})}function wle(n){const e=kd("hand"),t=X.useRef(null),i=ble(t,e,n),r=n.cursorModel;return D.jsx(Kc,{ref:t,space:e.inputSource.hand.get("index-finger-tip"),children:r!==!1&&D.jsx(dC,{pointer:i,opacity:Cae,...va(r)})})}function Mle(n){const e=n.model,t=n.grabPointer,i=n.rayPointer,r=n.teleportPointer??!1;return D.jsxs(D.Fragment,{children:[e!==!1&&D.jsx(X.Suspense,{children:D.jsx(mle,{...va(e)})}),D.jsxs(sG,{children:[t!==!1&&D.jsx(Ele,{...va(t)}),i!==!1&&D.jsx(gx,{makeDefault:!0,minDistance:.2,...va(i)}),r!==!1&&D.jsx(oG,{...va(r)})]})]})}function Cle(n){const e=n.model,t=n.grabPointer,i=n.rayPointer,r=n.touchPointer,s=n.teleportPointer??!1,a=i===!1?!1:va(i)?.rayModel;return D.jsxs(D.Fragment,{children:[e!==!1&&D.jsx(X.Suspense,{children:D.jsx(gle,{...va(e)})}),D.jsxs(sG,{children:[t!==!1&&D.jsx(Sle,{...va(t)}),r!==!1&&D.jsx(wle,{...va(r)}),i!==!1&&D.jsx(gx,{makeDefault:!0,minDistance:.2,...va(i),rayModel:a===!1?!1:{maxLength:.2,...va(a)}}),s!==!1&&D.jsx(oG,{...va(s)})]})]})}function Tle(n){return D.jsx(gx,{...n,rayModel:!1})}function Ile(n){return D.jsx(gx,{...n,rayModel:!1})}function Rle(n){return D.jsx(gx,{...n,cursorModel:!1,rayModel:!1})}function oG(n){const e=X.useContext(tp);if(e==null)throw new Error("DefaultXRInputSourceRayPointer can only be used inside a XRInputSource");const t=X.useRef(null),i=X.useRef(null),r=X.useMemo(()=>$oe(),[]),s=yle(i,e,{...n,linePoints:r,filter:Koe(n)},"teleport");sB(s,e.inputSource,"select",e.events);const a=n.rayModel,o=n.cursorModel,c=dl(p=>p.scene),h=X.useRef(null);return Gi((p,g)=>{h.current!=null&&(h.current.visible=s.getEnabled()&&s.getButtonsDown().size>0);const A=i.current,v=t.current;A==null||v==null||Xoe(v,A,g*1e3)}),D.jsxs(D.Fragment,{children:[D.jsx(Kc,{ref:t,space:"target-ray-space"}),aC(D.jsxs("group",{ref:i,children:[a!==!1&&D.jsx(_le,{linePoints:r,pointer:s,opacity:$w,...va(a)}),o!==!1&&D.jsx(dC,{ref:h,pointer:s,opacity:$w,...va(o)})]}),c)]})}function va(n){if(n!==!0)return n}function Ble(){return ds(n=>n.visibilityState)}function Dle(n,e){const t=X.useRef(e);t.current=e;const[i,r]=X.useMemo(()=>{let s;return[a=>{let o=!1;return typeof navigator>"u"||navigator.xr==null?(s=!1,()=>{}):(navigator.xr.isSessionSupported(n).then(c=>{s=c,!o&&a()}).catch(c=>{o||t.current?.(c)}),()=>o=!0)},()=>s]},[n]);return X.useSyncExternalStore(i,r)}function Lle(n){return ds(({session:e})=>e?.enabledFeatures?.includes(n)??!1)}let Nle=0;const FO=new Map;function pC(n){let e=FO.get(n);return e==null&&FO.set(n,e=Nle++),e}function Ule({children:n}){const e=ds(a=>a.originReferenceSpace),t=ds(a=>a.origin),i=Ble()==="visible",r=ih(),s=X.useMemo(()=>Object.assign({},r,{getState(){return{...r.getState(),scene:t}}}),[t,r]);return t==null||e==null?null:D.jsx(D.Fragment,{children:G0.createPortal(D.jsx(ux.Provider,{value:r,children:D.jsxs(dx.Provider,{value:e,children:[D.jsxs("group",{matrixAutoUpdate:!1,visible:i,children:[D.jsx(Fle,{}),D.jsx(Ple,{}),D.jsx(Ole,{}),D.jsx(kle,{}),D.jsx(zle,{})]}),n]})}),s,null)})}function Fle(){const n=ds(t=>t.inputSourceStates.filter(i=>i.type==="controller"),px);let e=ds(t=>t.controller);return e===!1?null:D.jsx(D.Fragment,{children:n.map(t=>{const i=v0(e,t.inputSource.handedness,{});return i===!1?null:D.jsx(tp.Provider,{value:t,children:D.jsx(Kc,{space:"target-ray-space",children:D.jsx(X.Suspense,{children:typeof i=="function"?D.jsx(i,{}):D.jsx(Mle,{...i})})})},t.id)})})}function Ple(){const n=ds(t=>t.inputSourceStates.filter(i=>i.type==="hand"),px),e=ds(t=>t.hand);return e===!1?null:D.jsx(D.Fragment,{children:n.map(t=>{const i=v0(e,t.inputSource.handedness,{});return i===!1?null:D.jsx(tp.Provider,{value:t,children:D.jsx(Kc,{space:"target-ray-space",children:D.jsx(X.Suspense,{children:typeof i=="function"?D.jsx(i,{}):D.jsx(Cle,{...i})})})},pC(t))})})}function Ole(){const n=ds(t=>t.inputSourceStates.filter(i=>i.type==="transientPointer"),px),e=ds(t=>t.transientPointer);return e===!1?null:D.jsx(D.Fragment,{children:n.map(t=>{const i=v0(e,t.inputSource.handedness,{});return i===!1?null:D.jsx(tp.Provider,{value:t,children:D.jsx(Kc,{space:"target-ray-space",children:D.jsx(X.Suspense,{children:typeof i=="function"?D.jsx(i,{}):D.jsx(Tle,{...i})})})},pC(t))})})}function kle(){const n=ds(t=>t.inputSourceStates.filter(i=>i.type==="gaze"),px),e=ds(t=>t.gaze);return e===!1?null:D.jsx(D.Fragment,{children:n.map(t=>D.jsx(tp.Provider,{value:t,children:D.jsx(Kc,{space:"target-ray-space",children:D.jsx(X.Suspense,{children:typeof e=="function"?D.jsx(e,{}):D.jsx(Ile,{...lG(e)})})})},pC(t)))})}function zle(){const n=ds(t=>t.inputSourceStates.filter(i=>i.type==="screenInput"),px),e=ds(t=>t.screenInput);return e===!1?null:D.jsx(D.Fragment,{children:n.map(t=>D.jsx(tp.Provider,{value:t,children:D.jsx(Kc,{space:"target-ray-space",children:D.jsx(X.Suspense,{children:typeof e=="function"?D.jsx(e,{}):D.jsx(Rle,{...lG(e)})})})},pC(t)))})}function lG(n){if(n!==!0)return n}function cG(n){return poe(n)}function uG({children:n,store:e}){e.setWebXRManager(dl(i=>i.gl.xr));const t=ih();return X.useEffect(()=>{let i;return e.subscribe((r,s)=>{if(r.session!==s.session){if(r.session!=null){const{camera:a,gl:o}=t.getState();i=a,t.setState({camera:o.xr.getCamera()});return}i!=null&&t.setState({camera:i})}})},[t,e]),Gi((i,r,s)=>e.onBeforeFrame(i.scene,i.camera,s),-1e3),Gi(()=>e.onBeforeRender()),D.jsx(iG.Provider,{value:e,children:D.jsxs(Gle,{children:[D.jsx(Ule,{}),n]})})}function Gle({children:n}){const e=mC(),t=X.useMemo(()=>new Wz(!0),[]);return X.useEffect(()=>yae(e,i=>t.setEnabled(i,{timeStamp:performance.now()})),[e,t]),Gi(i=>t.move(i.scene,{timeStamp:performance.now()}),-50),D.jsx(rB.Provider,{value:t,children:n})}function mC(){const n=X.useContext(iG);if(n==null)throw new Error("XR features can only be used inside the <XR> component");return n}function ds(n=t=>t,e){return hC(mC(),n,e)}function kd(n){const e=X.useContext(tp);if(e==null)throw new Error("useXRInputSourceStateContext() can only be used inside the xr store config");if(n!=null&&e.type!=n)throw new Error(`useXRInputSourceStateContext(${n}) can not be used inside a component for input type "${e.type}"`);return e}const Kc=X.forwardRef(({space:n,children:e},t)=>{const i=X.useRef(null),r=typeof n=="string"?hG(n):n;X.useImperativeHandle(t,()=>i.current,[]),Qle(i,r);const s=X.useCallback(a=>{a!=null&&(a.transformReady=!1,a.visible=!1),i.current=a},[]);return D.jsx("group",{xrSpace:r,matrixAutoUpdate:!1,ref:s,children:r&&D.jsx(dx.Provider,{value:r,children:e})})});function hG(n){switch(n){case"grip-space":return kd().inputSource.gripSpace;case"target-ray-space":return kd().inputSource.targetRaySpace;case"wrist":case"thumb-metacarpal":case"thumb-phalanx-proximal":case"thumb-phalanx-distal":case"thumb-tip":case"index-finger-metacarpal":case"index-finger-phalanx-proximal":case"index-finger-phalanx-intermediate":case"index-finger-phalanx-distal":case"index-finger-tip":case"middle-finger-metacarpal":case"middle-finger-phalanx-proximal":case"middle-finger-phalanx-intermediate":case"middle-finger-phalanx-distal":case"middle-finger-tip":case"ring-finger-metacarpal":case"ring-finger-phalanx-proximal":case"ring-finger-phalanx-intermediate":case"ring-finger-phalanx-distal":case"ring-finger-tip":case"pinky-finger-metacarpal":case"pinky-finger-phalanx-proximal":case"pinky-finger-phalanx-intermediate":case"pinky-finger-phalanx-distal":case"pinky-finger-tip":return kd("hand").inputSource.hand.get(n);case"root":case"hips":case"spine-lower":case"spine-middle":case"spine-upper":case"chest":case"neck":case"head":case"left-shoulder":case"left-scapula":case"left-arm-upper":case"left-arm-lower":case"left-hand-wrist-twist":case"right-shoulder":case"right-scapula":case"right-arm-upper":case"right-arm-lower":case"right-hand-wrist-twist":case"left-hand-palm":case"left-hand-wrist":case"left-hand-thumb-metacarpal":case"left-hand-thumb-phalanx-proximal":case"left-hand-thumb-phalanx-distal":case"left-hand-thumb-tip":case"left-hand-index-metacarpal":case"left-hand-index-phalanx-proximal":case"left-hand-index-phalanx-intermediate":case"left-hand-index-phalanx-distal":case"left-hand-index-tip":case"left-hand-middle-metacarpal":case"left-hand-middle-phalanx-proximal":case"left-hand-middle-phalanx-intermediate":case"left-hand-middle-phalanx-distal":case"left-hand-middle-tip":case"left-hand-ring-metacarpal":case"left-hand-ring-phalanx-proximal":case"left-hand-ring-phalanx-intermediate":case"left-hand-ring-phalanx-distal":case"left-hand-ring-tip":case"left-hand-little-metacarpal":case"left-hand-little-phalanx-proximal":case"left-hand-little-phalanx-intermediate":case"left-hand-little-phalanx-distal":case"left-hand-little-tip":case"right-hand-palm":case"right-hand-wrist":case"right-hand-thumb-metacarpal":case"right-hand-thumb-phalanx-proximal":case"right-hand-thumb-phalanx-distal":case"right-hand-thumb-tip":case"right-hand-index-metacarpal":case"right-hand-index-phalanx-proximal":case"right-hand-index-phalanx-intermediate":case"right-hand-index-phalanx-distal":case"right-hand-index-tip":case"right-hand-middle-metacarpal":case"right-hand-middle-phalanx-proximal":case"right-hand-middle-phalanx-intermediate":case"right-hand-middle-phalanx-distal":case"right-hand-middle-tip":case"right-hand-ring-metacarpal":case"right-hand-ring-phalanx-proximal":case"right-hand-ring-phalanx-intermediate":case"right-hand-ring-phalanx-distal":case"right-hand-ring-tip":case"right-hand-little-metacarpal":case"right-hand-little-phalanx-proximal":case"right-hand-little-phalanx-intermediate":case"right-hand-little-phalanx-distal":case"right-hand-little-tip":case"left-upper-leg":case"left-lower-leg":case"left-foot-ankle-twist":case"left-foot-ankle":case"left-foot-subtalar":case"left-foot-transverse":case"left-foot-ball":case"right-upper-leg":case"right-lower-leg":case"right-foot-ankle-twist":case"right-foot-ankle":case"right-foot-subtalar":case"right-foot-transverse":case"right-foot-ball":return ds(r=>r.body)?.get(n)}if(n==null){const r=X.useContext(dx);if(r==null)throw new Error("XR objects must be placed inside the XROrigin");return r}const[e,t]=X.useState(void 0),i=ds(r=>r.session);return X.useEffect(()=>{if(i==null)return;let r=!1;return i.requestReferenceSpace(n).then(s=>{r||t(s)}),()=>{r=!0}},[i,n]),e}function Hle(n){const e=X.useContext(dx),t=ds(i=>e??i.originReferenceSpace);return X.useMemo(()=>n==null||t==null?void 0:Tae(n,t),[n,t])}function Qle(n,e,t){const i=Hle(e);Gi((r,s,a)=>{n.current!=null&&(n.current.visible=n.current.transformReady=i?.(n.current.matrix,a)??!1)},-100)}X.forwardRef(({mesh:n,...e},t)=>{const i=Vle(n);return D.jsx("mesh",{ref:t,geometry:i,...e})});function Vle(n,e=!0){const[t,i]=X.useState(MO(n,void 0));return Gi(()=>i(r=>MO(n,r))),X.useEffect(()=>{if(e)return()=>t.dispose()},[t]),t}X.forwardRef(({plane:n,...e},t)=>{const i=jle(n);return D.jsx("mesh",{ref:t,geometry:i,...e})});function jle(n,e=!0){const[t,i]=X.useState(CO(n,void 0));return Gi(()=>i(r=>CO(n,r))),X.useEffect(()=>{if(e)return()=>t.dispose()},[t]),t}const fG=X.forwardRef(({children:n,disabled:e,...t},i)=>{const r=dl(o=>o.gl.xr.getCamera()),s=X.useRef(null),a=ds(o=>o.originReferenceSpace);return X.useImperativeHandle(i,()=>s.current,[]),X.useEffect(()=>{const o=s.current;if(!(o==null||e))return o.add(r),()=>{o.remove(r)}},[e,r]),D.jsx("group",{ref:s,...t,children:D.jsx(dx.Provider,{value:a,children:n})})});function aB(n,e,t){const i=X.useRef(void 0);Wle(e,t,X.useCallback(r=>i.current=r,[])),Gi((r,s,a)=>{n==null||a==null||i.current==null||n(a.getHitTestResults(i.current.source),i.current.getWorldMatrix)})}function Wle(n,e,t){const i=mC(),r=hC(i,s=>s.session);X.useEffect(()=>{if(r==null)return;let s,a=!1;const o=n instanceof XRSpace||typeof n=="string"?n:n?.current;if(o!=null)return ele(i,r,o,e).then(c=>{a||(s=c,t(c))}),()=>{t(void 0),a=!0,s?.source.cancel()}},[r,i,n,e,t])}X.forwardRef(({trackableType:n,onResults:e,space:t,...i},r)=>{const s=X.useRef(null);return X.useImperativeHandle(r,()=>s.current),aB(e,t??s,n),D.jsx("group",{...i,ref:s})});const qle={},PO=n=>{let e;const t=new Set,i=(p,g)=>{const A=typeof p=="function"?p(e):p;if(!Object.is(A,e)){const v=e;e=g??(typeof A!="object"||A===null)?A:Object.assign({},e,A),t.forEach(x=>x(e,v))}},r=()=>e,c={setState:i,getState:r,getInitialState:()=>h,subscribe:p=>(t.add(p),()=>t.delete(p)),destroy:()=>{(qle?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,c);return c},Xle=n=>n?PO(n):PO,dG={},{useDebugValue:Yle}=Gd,{useSyncExternalStoreWithSelector:Kle}=j4;let OO=!1;const $le=n=>n;function Jle(n,e=$le,t){(dG?"production":void 0)!=="production"&&t&&!OO&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),OO=!0);const i=Kle(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return Yle(i),i}const kO=n=>{(dG?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?Xle(n):n,t=(i,r)=>Jle(e,i,r);return Object.assign(t,e),t},Zle=n=>n?kO(n):kO;var zO,GO;const HO=typeof window<"u"&&((zO=window.document)!=null&&zO.createElement||((GO=window.navigator)==null?void 0:GO.product)==="ReactNative")?Gd.useLayoutEffect:Gd.useEffect;function ece(){const n=Zle(e=>({current:new Array,version:0,set:e}));return{In:({children:e})=>{const t=n(r=>r.set),i=n(r=>r.version);return HO(()=>{t(r=>({version:r.version+1}))},[]),HO(()=>(t(({current:r})=>({current:[...r,e]})),()=>t(({current:r})=>({current:r.filter(s=>s!==e)}))),[e,i]),null},Out:()=>{const e=n(t=>t.current);return Gd.createElement(Gd.Fragment,null,e)}}}X.forwardRef((n,e)=>{const t=ds(s=>s.domOverlayRoot),{In:i,Out:r}=X.useMemo(ece,[]);return X.useEffect(()=>{if(t==null)return;const s=mk.createRoot(t);return s.render(D.jsx(r,{})),()=>s.unmount()},[t,r]),D.jsx(i,{children:D.jsx("div",{...n,ref:e})})});X.forwardRef(function({src:e,pixelWidth:t=1024,pixelHeight:i=1024,dpr:r=1,renderPriority:s=0,children:a,customRender:o,...c},h){const[p,g]=X.useState(!1),A=X.useRef(null),v=X.useRef(void 0),x=X.useRef(void 0);X.useEffect(()=>{g(!1);let C=!1;return Noe(e).then(()=>!C&&g(!0)),()=>{C=!0}},[e]);const S=Lle("layers"),_=X.useMemo(()=>Doe(c.shape??"quad",{centralAngle:c.centralAngle,centralHorizontalAngle:c.centralHorizontalAngle,lowerVerticalAngle:c.lowerVerticalAngle,upperVerticalAngle:c.upperVerticalAngle}),[c.centralAngle,c.centralHorizontalAngle,c.lowerVerticalAngle,c.shape,c.upperVerticalAngle]),E=sce(t,i,r);return ice(E,A,[p,S]),X.useImperativeHandle(h,()=>A.current,[p,S]),p?D.jsxs(D.Fragment,{children:[e==null&&D.jsx(ace,{customRender:o,store:E,renderPriority:s,renderTargetRef:v,layerEntryRef:S?x:void 0,children:a}),S?D.jsx(tce,{renderTargetRef:v,layerEntryRef:x,pixelWidth:t,pixelHeight:i,dpr:r,ref:A,...c,src:e,geometry:_}):D.jsx(nce,{renderTargetRef:v,ref:A,...c,src:e,pixelWidth:t,pixelHeight:i,dpr:r,geometry:_})]}):null});const tce=X.forwardRef(({src:n,shape:e,colorFormat:t,depthFormat:i,layout:r,mipLevels:s,renderOrder:a=0,blendTextureSourceAlpha:o,centralAngle:c,centralHorizontalAngle:h,chromaticAberrationCorrection:p,lowerVerticalAngle:g,quality:A,upperVerticalAngle:v,invertStereo:x,pixelWidth:S,pixelHeight:_,dpr:E,renderTargetRef:C,layerEntryRef:T,...R},B)=>{const U=X.useRef(null),O=dl(V=>V.gl),F=mC(),L={blendTextureSourceAlpha:o,centralAngle:c,centralHorizontalAngle:h,chromaticAberrationCorrection:p,lowerVerticalAngle:g,quality:A,upperVerticalAngle:v},P=X.useRef(L);P.current=L;const W=X.useRef(a);W.current=a;const j=ds(V=>V.originReferenceSpace);return X.useEffect(()=>{if(U.current==null||j==null)return;const V=n??(C.current=tG(S,_,E)),q=Coe(V,F.getState(),j,O.xr,U.current,{colorFormat:t,depthFormat:i,invertStereo:x,layout:r,mipLevels:s,shape:e},P.current);if(q==null)return;const re=T.current={layer:q,renderOrder:W.current,object3D:U.current};if(F.addLayerEntry(re),V instanceof HTMLVideoElement||V instanceof Vr)return()=>{F.removeLayerEntry(re),q.destroy()};const Q=Loe(O,F,q,V);return()=>{F.removeLayerEntry(re),Q(),q.destroy()}},[j,t,i,x,T,r,s,_,S,E,C,O,e,n,F]),T.current!=null&&(T.current.renderOrder=a),T.current!=null&&nB(T.current.layer,P.current),Gi(()=>{T.current==null||U.current==null||Poe(F.getState(),T.current.layer,P.current.centralAngle,U.current)}),X.useImperativeHandle(B,()=>U.current,[]),D.jsx("mesh",{...R,renderOrder:-1/0,ref:U,children:D.jsx("meshBasicMaterial",{colorWrite:!1})})}),nce=X.forwardRef(({src:n,renderTargetRef:e,dpr:t,renderOrder:i,pixelWidth:r,pixelHeight:s,...a},o)=>{const c=X.useRef(null);return X.useEffect(()=>{if(c.current==null)return;const h=n??(e.current=tG(r,s,t)),p=Uoe(h);return c.current.map=p,c.current.needsUpdate=!0,()=>{if(h instanceof Vr){h.dispose();return}p.dispose()}},[n,r,s,t,e]),D.jsx("mesh",{ref:o,...a,children:D.jsx("meshBasicMaterial",{ref:c,toneMapped:!1})})});function ice(n,e,t){X.useEffect(()=>{const{current:i}=e;if(i==null)return;let r;const s=(o,c)=>{if(o.camera===c?.camera&&o.scene===c.scene)return;r?.();const{destroy:h,update:p}=coe(i,()=>o.camera,o.scene),g=Yse(p);r=()=>{h(),g()}};s(n.getState());const a=n.subscribe(s);return()=>{a(),r?.()}},[n,e,...t])}const rce=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"];function sce(n,e,t){const i=ih(),r=X.useMemo(()=>{let s=i.getState();const a=new Gr(50,1,.1,1e3);a.position.set(0,0,5);const o=new Ze;let c={events:{enabled:!1,priority:0},size:{width:1,height:1,left:0,top:0},camera:a,scene:new uc,raycaster:new ep,pointer:o,mouse:o,previousRoot:i};const h=fle((p,g)=>{const A=()=>{const x={};for(const S in s)rce.includes(S)||(x[S]=s[S]);return Object.assign(x,c,{events:{...s.events,...c.events},viewport:Object.assign({},s.viewport,s.viewport.getCurrentViewport(a,new ee,c.size))})},v=()=>p(A());return{...s,set(x){typeof x=="function"&&(x=x(g())),Object.assign(c,x),v()},setPreviousState(x){s=x,v()},get:g,setEvents(){},...A()}});return Object.assign(h,{setState(p){h.getState().set(p)}})},[i]);return X.useEffect(()=>i.subscribe(r.getState().setPreviousState),[i,r]),X.useEffect(()=>{const s={factor:1,distance:0,dpr:t,initialDpr:t,left:0,top:0,getCurrentViewport:()=>s,width:n,height:e,aspect:n/e};r.setState({size:{width:n,height:e,top:0,left:0},viewport:s})},[n,e,t,r,i]),r}const L1=new Ii;function QO(n){return this.getViewport(L1),n.x=L1.z-L1.x,n.y=L1.w-L1.y,n}const VO=new Ii;function ace({renderPriority:n,children:e,layerEntryRef:t,renderTargetRef:i,store:r,customRender:s}){X.useEffect(()=>{const A=(v,x)=>{const{size:S,camera:_}=v;_ instanceof Yc?(_.left=S.width/-2,_.right=S.width/2,_.top=S.height/2,_.bottom=S.height/-2):_.aspect=S.width/S.height,(S!==x?.size||_!==x.camera)&&(_.updateProjectionMatrix(),_.updateMatrixWorld())};return A(r.getState()),r.subscribe(A)},[r]);let a,o,c,h,p,g;return Gi((A,v,x)=>{if(i.current==null||t!=null&&(t.current==null||x==null))return;const S=r.getState(),{gl:_,scene:E,camera:C}=S;a=_.autoClear,o=_.xr.enabled,c=_.xr.isPresenting,h=_.getRenderTarget(),g=_.getSize,p=_.getDrawingBufferSize,_.getViewport(VO),_.autoClear=!0,_.xr.enabled=!1,_.xr.isPresenting=!1;const T=i.current;_.setViewport(0,0,T.width,T.height),_.getSize=QO,_.getDrawingBufferSize=QO,Boe(_,T,t?.current,x),s!=null?s(T,S,v,x):_.render(E,C),_.setRenderTarget(h),_.setViewport(VO),_.autoClear=a,_.xr.enabled=o,_.xr.isPresenting=c,_.getSize=g,_.getDrawingBufferSize=p},n),D.jsx(D.Fragment,{children:G0.createPortal(D.jsx(ux.Provider,{value:r,children:e}),r,null)})}const pG=X.forwardRef(({store:n,mode:e,onError:t,children:i,...r},s)=>{const a=hC(n,c=>c.session),o=Dle(e,t);return D.jsx("button",{ref:s,...r,onClick:()=>a!=null?a.end():n.enterXR(e).catch(t),children:typeof i=="function"?i(o?a!=null?"entered":"exited":"unsupported"):i})});X.forwardRef((n,e)=>D.jsx(pG,{ref:e,mode:"immersive-ar",...n}));X.forwardRef((n,e)=>D.jsx(pG,{ref:e,mode:"immersive-vr",...n}));const oce={onBlur:"pointerleave",onHover:"pointerenter",onMove:"pointermove",onSelect:{type:"click",filter:n=>n.pointerType==="ray"},onSelectEnd:{type:"pointerup",filter:n=>n.pointerType==="ray"},onSelectStart:{type:"pointerdown",filter:n=>n.pointerType==="ray"},onSqueeze:{type:"click",filter:n=>n.pointerType==="grab"},onSqueezeEnd:{type:"pointerup",filter:n=>n.pointerType==="grab"},onSqueezeStart:{type:"pointerdown",filter:n=>n.pointerType==="grab"}};function nf(n,e,t){const i=X.useRef(t);i.current=t,X.useEffect(()=>{const{current:r}=n;if(r==null)return;const s=oce[e],a=typeof s=="string"?c=>i.current?.({intersection:c,intersections:[c],target:c.pointerState}):c=>{c instanceof io&&!s.filter(c)||i.current?.({intersection:c,intersections:[c],target:c.pointerState})},o=typeof s=="string"?s:s.type;return r.addEventListener(o,a),()=>r.removeEventListener(o,a)},[n,e])}const lce=X.forwardRef(({onHover:n,onBlur:e,onSelectStart:t,onSelectEnd:i,onSelect:r,onSqueezeStart:s,onSqueezeEnd:a,onSqueeze:o,onMove:c,children:h},p)=>{const g=X.useRef(null);return X.useImperativeHandle(p,()=>g.current),nf(g,"onHover",n),nf(g,"onBlur",e),nf(g,"onSelectStart",t),nf(g,"onSelectEnd",i),nf(g,"onSelect",r),nf(g,"onSqueezeStart",s),nf(g,"onSqueezeEnd",a),nf(g,"onSqueeze",o),nf(g,"onMove",c),D.jsx("group",{ref:g,children:h})});X.forwardRef(function({onSelectStart:e,onSelectEnd:t,children:i,...r},s){const a=X.useRef(void 0),o=X.useRef(null),c=X.useMemo(()=>new qt,[]);return X.useImperativeHandle(s,()=>o.current),Gi(()=>{const h=a.current,p=o.current;!p||!h||(p.applyMatrix4(c),h.updateWorldMatrix(!0,!1),p.applyMatrix4(h.matrixWorld),p.updateMatrixWorld(),c.copy(h.matrixWorld).invert())}),D.jsx(lce,{ref:o,onSelectStart:h=>{mae(h.target)&&(h.target.type==="controller"||h.target.type==="hand")&&h.target.object!=null&&(a.current=h.target.object,h.target.object.updateWorldMatrix(!0,!1),c.copy(h.target.object.matrixWorld).invert(),e?.(h))},onSelectEnd:h=>{h.target.controller===a.current&&(a.current=void 0),t?.(h)},...r,children:i})});function Ob(){return Ob=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Ob.apply(null,arguments)}const mG=parseInt(ag.replace(/\D+/g,""));var sc=Uint8Array,Nd=Uint16Array,b2=Uint32Array,gG=new sc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),AG=new sc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cce=new sc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vG=function(n,e){for(var t=new Nd(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];for(var r=new b2(t[30]),i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)r[s]=s-t[i]<<5|i;return[t,r]},yG=vG(gG,2),bG=yG[0],uce=yG[1];bG[28]=258,uce[258]=28;var hce=vG(AG,0),fce=hce[0],x2=new Nd(32768);for(var vr=0;vr<32768;++vr){var yd=(vr&43690)>>>1|(vr&21845)<<1;yd=(yd&52428)>>>2|(yd&13107)<<2,yd=(yd&61680)>>>4|(yd&3855)<<4,x2[vr]=((yd&65280)>>>8|(yd&255)<<8)>>>1}var sb=(function(n,e,t){for(var i=n.length,r=0,s=new Nd(e);r<i;++r)++s[n[r]-1];var a=new Nd(e);for(r=0;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;var o;if(t){o=new Nd(1<<e);var c=15-e;for(r=0;r<i;++r)if(n[r])for(var h=r<<4|n[r],p=e-n[r],g=a[n[r]-1]++<<p,A=g|(1<<p)-1;g<=A;++g)o[x2[g]>>>c]=h}else for(o=new Nd(i),r=0;r<i;++r)n[r]&&(o[r]=x2[a[n[r]-1]++]>>>15-n[r]);return o}),Ax=new sc(288);for(var vr=0;vr<144;++vr)Ax[vr]=8;for(var vr=144;vr<256;++vr)Ax[vr]=9;for(var vr=256;vr<280;++vr)Ax[vr]=7;for(var vr=280;vr<288;++vr)Ax[vr]=8;var xG=new sc(32);for(var vr=0;vr<32;++vr)xG[vr]=5;var dce=sb(Ax,9,1),pce=sb(xG,5,1),lR=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},Oc=function(n,e,t){var i=e/8|0;return(n[i]|n[i+1]<<8)>>(e&7)&t},cR=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},mce=function(n){return(n/8|0)+(n&7&&1)},gce=function(n,e,t){(t==null||t>n.length)&&(t=n.length);var i=new(n instanceof Nd?Nd:n instanceof b2?b2:sc)(t-e);return i.set(n.subarray(e,t)),i},Ace=function(n,e,t){var i=n.length;if(!i||t&&!t.l&&i<5)return e||new sc(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new sc(i*3));var a=function(le){var fe=e.length;if(le>fe){var _e=new sc(Math.max(fe*2,le));_e.set(e),e=_e}},o=t.f||0,c=t.p||0,h=t.b||0,p=t.l,g=t.d,A=t.m,v=t.n,x=i*8;do{if(!p){t.f=o=Oc(n,c,1);var S=Oc(n,c+1,3);if(c+=3,S)if(S==1)p=dce,g=pce,A=9,v=5;else if(S==2){var T=Oc(n,c,31)+257,R=Oc(n,c+10,15)+4,B=T+Oc(n,c+5,31)+1;c+=14;for(var U=new sc(B),O=new sc(19),F=0;F<R;++F)O[cce[F]]=Oc(n,c+F*3,7);c+=R*3;for(var L=lR(O),P=(1<<L)-1,W=sb(O,L,1),F=0;F<B;){var j=W[Oc(n,c,P)];c+=j&15;var _=j>>>4;if(_<16)U[F++]=_;else{var V=0,q=0;for(_==16?(q=3+Oc(n,c,3),c+=2,V=U[F-1]):_==17?(q=3+Oc(n,c,7),c+=3):_==18&&(q=11+Oc(n,c,127),c+=7);q--;)U[F++]=V}}var re=U.subarray(0,T),Q=U.subarray(T);A=lR(re),v=lR(Q),p=sb(re,A,1),g=sb(Q,v,1)}else throw"invalid block type";else{var _=mce(c)+4,E=n[_-4]|n[_-3]<<8,C=_+E;if(C>i){if(s)throw"unexpected EOF";break}r&&a(h+E),e.set(n.subarray(_,C),h),t.b=h+=E,t.p=c=C*8;continue}if(c>x){if(s)throw"unexpected EOF";break}}r&&a(h+131072);for(var K=(1<<A)-1,ce=(1<<v)-1,ue=c;;ue=c){var V=p[cR(n,c)&K],oe=V>>>4;if(c+=V&15,c>x){if(s)throw"unexpected EOF";break}if(!V)throw"invalid length/literal";if(oe<256)e[h++]=oe;else if(oe==256){ue=c,p=null;break}else{var z=oe-254;if(oe>264){var F=oe-257,$=gG[F];z=Oc(n,c,(1<<$)-1)+bG[F],c+=$}var ae=g[cR(n,c)&ce],he=ae>>>4;if(!ae)throw"invalid distance";c+=ae&15;var Q=fce[he];if(he>3){var $=AG[he];Q+=cR(n,c)&(1<<$)-1,c+=$}if(c>x){if(s)throw"unexpected EOF";break}r&&a(h+131072);for(var me=h+z;h<me;h+=4)e[h]=e[h-Q],e[h+1]=e[h+1-Q],e[h+2]=e[h+2-Q],e[h+3]=e[h+3-Q];h=me}}t.l=p,t.p=ue,t.b=h,p&&(o=1,t.m=A,t.d=g,t.n=v)}while(!o);return h==e.length?e:gce(e,0,h)},vce=new sc(0),yce=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function BE(n,e){return Ace((yce(n),n.subarray(2,-4)),e)}var bce=typeof TextDecoder<"u"&&new TextDecoder,xce=0;try{bce.decode(vce,{stream:!0}),xce=1}catch{}const _ce=n=>n&&n.isCubeTexture;class Sce extends Wt{constructor(e,t){var i,r;const s=_ce(e),o=((r=s?(i=e.image[0])==null?void 0:i.width:e.image.width)!=null?r:1024)/4,c=Math.floor(Math.log2(o)),h=Math.pow(2,c),p=3*Math.max(h,112),g=4*h,A=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/p}`,`#define CUBEUV_TEXEL_HEIGHT ${1/g}`,`#define CUBEUV_MAX_MIP ${c}.0`],v=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,x=A.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${mG>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,S={map:{value:e},height:{value:t?.height||15},radius:{value:t?.radius||100}},_=new rx(1,16),E=new Fs({uniforms:S,fragmentShader:x,vertexShader:v,side:gi});super(_,E)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}class Ece extends qM{constructor(e){super(e),this.type=ci}parse(e){const a=function(F,L){switch(F){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(L||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(L||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(L||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(L||""))}},g=function(F,L,P){L=L||1024;let j=F.pos,V=-1,q=0,re="",Q=String.fromCharCode.apply(null,new Uint16Array(F.subarray(j,j+128)));for(;0>(V=Q.indexOf(`
`))&&q<L&&j<F.byteLength;)re+=Q,q+=Q.length,j+=128,Q+=String.fromCharCode.apply(null,new Uint16Array(F.subarray(j,j+128)));return-1<V?(F.pos+=q+V+1,re+Q.slice(0,V)):!1},A=function(F){const L=/^#\?(\S+)/,P=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,W=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,j=/^\s*FORMAT=(\S+)\s*$/,V=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,q={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let re,Q;for((F.pos>=F.byteLength||!(re=g(F)))&&a(1,"no header found"),(Q=re.match(L))||a(3,"bad initial token"),q.valid|=1,q.programtype=Q[1],q.string+=re+`
`;re=g(F),re!==!1;){if(q.string+=re+`
`,re.charAt(0)==="#"){q.comments+=re+`
`;continue}if((Q=re.match(P))&&(q.gamma=parseFloat(Q[1])),(Q=re.match(W))&&(q.exposure=parseFloat(Q[1])),(Q=re.match(j))&&(q.valid|=2,q.format=Q[1]),(Q=re.match(V))&&(q.valid|=4,q.height=parseInt(Q[1],10),q.width=parseInt(Q[2],10)),q.valid&2&&q.valid&4)break}return q.valid&2||a(3,"missing format specifier"),q.valid&4||a(3,"missing image size specifier"),q},v=function(F,L,P){const W=L;if(W<8||W>32767||F[0]!==2||F[1]!==2||F[2]&128)return new Uint8Array(F);W!==(F[2]<<8|F[3])&&a(3,"wrong scanline width");const j=new Uint8Array(4*L*P);j.length||a(4,"unable to allocate buffer space");let V=0,q=0;const re=4*W,Q=new Uint8Array(4),K=new Uint8Array(re);let ce=P;for(;ce>0&&q<F.byteLength;){q+4>F.byteLength&&a(1),Q[0]=F[q++],Q[1]=F[q++],Q[2]=F[q++],Q[3]=F[q++],(Q[0]!=2||Q[1]!=2||(Q[2]<<8|Q[3])!=W)&&a(3,"bad rgbe scanline format");let ue=0,oe;for(;ue<re&&q<F.byteLength;){oe=F[q++];const $=oe>128;if($&&(oe-=128),(oe===0||ue+oe>re)&&a(3,"bad scanline data"),$){const ae=F[q++];for(let he=0;he<oe;he++)K[ue++]=ae}else K.set(F.subarray(q,q+oe),ue),ue+=oe,q+=oe}const z=W;for(let $=0;$<z;$++){let ae=0;j[V]=K[$+ae],ae+=W,j[V+1]=K[$+ae],ae+=W,j[V+2]=K[$+ae],ae+=W,j[V+3]=K[$+ae],V+=4}ce--}return j},x=function(F,L,P,W){const j=F[L+3],V=Math.pow(2,j-128)/255;P[W+0]=F[L+0]*V,P[W+1]=F[L+1]*V,P[W+2]=F[L+2]*V,P[W+3]=1},S=function(F,L,P,W){const j=F[L+3],V=Math.pow(2,j-128)/255;P[W+0]=Gc.toHalfFloat(Math.min(F[L+0]*V,65504)),P[W+1]=Gc.toHalfFloat(Math.min(F[L+1]*V,65504)),P[W+2]=Gc.toHalfFloat(Math.min(F[L+2]*V,65504)),P[W+3]=Gc.toHalfFloat(1)},_=new Uint8Array(e);_.pos=0;const E=A(_),C=E.width,T=E.height,R=v(_.subarray(_.pos),C,T);let B,U,O;switch(this.type){case Si:O=R.length/4;const F=new Float32Array(O*4);for(let P=0;P<O;P++)x(R,P*4,F,P*4);B=F,U=Si;break;case ci:O=R.length/4;const L=new Uint16Array(O*4);for(let P=0;P<O;P++)S(R,P*4,L,P*4);B=L,U=ci;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:C,height:T,data:B,header:E.string,gamma:E.gamma,exposure:E.exposure,type:U}}setDataType(e){return this.type=e,this}load(e,t,i,r){function s(a,o){switch(a.type){case Si:case ci:"colorSpace"in a?a.colorSpace="srgb-linear":a.encoding=3e3,a.minFilter=mn,a.magFilter=mn,a.generateMipmaps=!1,a.flipY=!0;break}t&&t(a,o)}return super.load(e,s,i,r)}}const N1=mG>=152;class wce extends qM{constructor(e){super(e),this.type=ci}parse(e){const L=Math.pow(2.7182818,2.2);function P(Y,se){for(var ge=0,Ue=0;Ue<65536;++Ue)(Ue==0||Y[Ue>>3]&1<<(Ue&7))&&(se[ge++]=Ue);for(var je=ge-1;ge<65536;)se[ge++]=0;return je}function W(Y){for(var se=0;se<16384;se++)Y[se]={},Y[se].len=0,Y[se].lit=0,Y[se].p=null}const j={l:0,c:0,lc:0};function V(Y,se,ge,Ue,je){for(;ge<Y;)se=se<<8|at(Ue,je),ge+=8;ge-=Y,j.l=se>>ge&(1<<Y)-1,j.c=se,j.lc=ge}const q=new Array(59);function re(Y){for(var se=0;se<=58;++se)q[se]=0;for(var se=0;se<65537;++se)q[Y[se]]+=1;for(var ge=0,se=58;se>0;--se){var Ue=ge+q[se]>>1;q[se]=ge,ge=Ue}for(var se=0;se<65537;++se){var je=Y[se];je>0&&(Y[se]=je|q[je]++<<6)}}function Q(Y,se,ge,Ue,je,Xe,xt){for(var At=ge,Ct=0,Tt=0;je<=Xe;je++){if(At.value-ge.value>Ue)return!1;V(6,Ct,Tt,Y,At);var Dt=j.l;if(Ct=j.c,Tt=j.lc,xt[je]=Dt,Dt==63){if(At.value-ge.value>Ue)throw"Something wrong with hufUnpackEncTable";V(8,Ct,Tt,Y,At);var He=j.l+6;if(Ct=j.c,Tt=j.lc,je+He>Xe+1)throw"Something wrong with hufUnpackEncTable";for(;He--;)xt[je++]=0;je--}else if(Dt>=59){var He=Dt-59+2;if(je+He>Xe+1)throw"Something wrong with hufUnpackEncTable";for(;He--;)xt[je++]=0;je--}}re(xt)}function K(Y){return Y&63}function ce(Y){return Y>>6}function ue(Y,se,ge,Ue){for(;se<=ge;se++){var je=ce(Y[se]),Xe=K(Y[se]);if(je>>Xe)throw"Invalid table entry";if(Xe>14){var xt=Ue[je>>Xe-14];if(xt.len)throw"Invalid table entry";if(xt.lit++,xt.p){var At=xt.p;xt.p=new Array(xt.lit);for(var Ct=0;Ct<xt.lit-1;++Ct)xt.p[Ct]=At[Ct]}else xt.p=new Array(1);xt.p[xt.lit-1]=se}else if(Xe)for(var Tt=0,Ct=1<<14-Xe;Ct>0;Ct--){var xt=Ue[(je<<14-Xe)+Tt];if(xt.len||xt.p)throw"Invalid table entry";xt.len=Xe,xt.lit=se,Tt++}}return!0}const oe={c:0,lc:0};function z(Y,se,ge,Ue){Y=Y<<8|at(ge,Ue),se+=8,oe.c=Y,oe.lc=se}const $={c:0,lc:0};function ae(Y,se,ge,Ue,je,Xe,xt,At,Ct,Tt){if(Y==se){Ue<8&&(z(ge,Ue,je,xt),ge=oe.c,Ue=oe.lc),Ue-=8;var Dt=ge>>Ue,Dt=new Uint8Array([Dt])[0];if(Ct.value+Dt>Tt)return!1;for(var He=At[Ct.value-1];Dt-- >0;)At[Ct.value++]=He}else if(Ct.value<Tt)At[Ct.value++]=Y;else return!1;$.c=ge,$.lc=Ue}function he(Y){return Y&65535}function me(Y){var se=he(Y);return se>32767?se-65536:se}const le={a:0,b:0};function fe(Y,se){var ge=me(Y),Ue=me(se),je=Ue,Xe=ge+(je&1)+(je>>1),xt=Xe,At=Xe-je;le.a=xt,le.b=At}function _e(Y,se){var ge=he(Y),Ue=he(se),je=ge-(Ue>>1)&65535,Xe=Ue+je-32768&65535;le.a=Xe,le.b=je}function Pe(Y,se,ge,Ue,je,Xe,xt){for(var At=xt<16384,Ct=ge>je?je:ge,Tt=1,Dt;Tt<=Ct;)Tt<<=1;for(Tt>>=1,Dt=Tt,Tt>>=1;Tt>=1;){for(var He=0,J=He+Xe*(je-Dt),pe=Xe*Tt,xe=Xe*Dt,Se=Ue*Tt,be=Ue*Dt,ct,yt,ut,Ft;He<=J;He+=xe){for(var wt=He,Yt=He+Ue*(ge-Dt);wt<=Yt;wt+=be){var Bt=wt+Se,jt=wt+pe,yn=jt+Se;At?(fe(Y[wt+se],Y[jt+se]),ct=le.a,ut=le.b,fe(Y[Bt+se],Y[yn+se]),yt=le.a,Ft=le.b,fe(ct,yt),Y[wt+se]=le.a,Y[Bt+se]=le.b,fe(ut,Ft),Y[jt+se]=le.a,Y[yn+se]=le.b):(_e(Y[wt+se],Y[jt+se]),ct=le.a,ut=le.b,_e(Y[Bt+se],Y[yn+se]),yt=le.a,Ft=le.b,_e(ct,yt),Y[wt+se]=le.a,Y[Bt+se]=le.b,_e(ut,Ft),Y[jt+se]=le.a,Y[yn+se]=le.b)}if(ge&Tt){var jt=wt+pe;At?fe(Y[wt+se],Y[jt+se]):_e(Y[wt+se],Y[jt+se]),ct=le.a,Y[jt+se]=le.b,Y[wt+se]=ct}}if(je&Tt)for(var wt=He,Yt=He+Ue*(ge-Dt);wt<=Yt;wt+=be){var Bt=wt+Se;At?fe(Y[wt+se],Y[Bt+se]):_e(Y[wt+se],Y[Bt+se]),ct=le.a,Y[Bt+se]=le.b,Y[wt+se]=ct}Dt=Tt,Tt>>=1}return He}function et(Y,se,ge,Ue,je,Xe,xt,At,Ct,Tt){for(var Dt=0,He=0,J=At,pe=Math.trunc(je.value+(Xe+7)/8);je.value<pe;)for(z(Dt,He,ge,je),Dt=oe.c,He=oe.lc;He>=14;){var xe=Dt>>He-14&16383,Se=se[xe];if(Se.len)He-=Se.len,ae(Se.lit,xt,Dt,He,ge,Ue,je,Ct,Tt,J),Dt=$.c,He=$.lc;else{if(!Se.p)throw"hufDecode issues";var be;for(be=0;be<Se.lit;be++){for(var ct=K(Y[Se.p[be]]);He<ct&&je.value<pe;)z(Dt,He,ge,je),Dt=oe.c,He=oe.lc;if(He>=ct&&ce(Y[Se.p[be]])==(Dt>>He-ct&(1<<ct)-1)){He-=ct,ae(Se.p[be],xt,Dt,He,ge,Ue,je,Ct,Tt,J),Dt=$.c,He=$.lc;break}}if(be==Se.lit)throw"hufDecode issues"}}var yt=8-Xe&7;for(Dt>>=yt,He-=yt;He>0;){var Se=se[Dt<<14-He&16383];if(Se.len)He-=Se.len,ae(Se.lit,xt,Dt,He,ge,Ue,je,Ct,Tt,J),Dt=$.c,He=$.lc;else throw"hufDecode issues"}return!0}function ot(Y,se,ge,Ue,je,Xe){var xt={value:0},At=ge.value,Ct=Ve(se,ge),Tt=Ve(se,ge);ge.value+=4;var Dt=Ve(se,ge);if(ge.value+=4,Ct<0||Ct>=65537||Tt<0||Tt>=65537)throw"Something wrong with HUF_ENCSIZE";var He=new Array(65537),J=new Array(16384);W(J);var pe=Ue-(ge.value-At);if(Q(Y,se,ge,pe,Ct,Tt,He),Dt>8*(Ue-(ge.value-At)))throw"Something wrong with hufUncompress";ue(He,Ct,Tt,J),et(He,J,Y,se,ge,Dt,Tt,Xe,je,xt)}function Je(Y,se,ge){for(var Ue=0;Ue<ge;++Ue)se[Ue]=Y[se[Ue]]}function _t(Y){for(var se=1;se<Y.length;se++){var ge=Y[se-1]+Y[se]-128;Y[se]=ge}}function Be(Y,se){for(var ge=0,Ue=Math.floor((Y.length+1)/2),je=0,Xe=Y.length-1;!(je>Xe||(se[je++]=Y[ge++],je>Xe));)se[je++]=Y[Ue++]}function Le(Y){for(var se=Y.byteLength,ge=new Array,Ue=0,je=new DataView(Y);se>0;){var Xe=je.getInt8(Ue++);if(Xe<0){var xt=-Xe;se-=xt+1;for(var At=0;At<xt;At++)ge.push(je.getUint8(Ue++))}else{var xt=Xe;se-=2;for(var Ct=je.getUint8(Ue++),At=0;At<xt+1;At++)ge.push(Ct)}}return ge}function Te(Y,se,ge,Ue,je,Xe){var Bt=new DataView(Xe.buffer),xt=ge[Y.idx[0]].width,At=ge[Y.idx[0]].height,Ct=3,Tt=Math.floor(xt/8),Dt=Math.ceil(xt/8),He=Math.ceil(At/8),J=xt-(Dt-1)*8,pe=At-(He-1)*8,xe={value:0},Se=new Array(Ct),be=new Array(Ct),ct=new Array(Ct),yt=new Array(Ct),ut=new Array(Ct);for(let zt=0;zt<Ct;++zt)ut[zt]=se[Y.idx[zt]],Se[zt]=zt<1?0:Se[zt-1]+Dt*He,be[zt]=new Float32Array(64),ct[zt]=new Uint16Array(64),yt[zt]=new Uint16Array(Dt*64);for(let zt=0;zt<He;++zt){var Ft=8;zt==He-1&&(Ft=pe);var wt=8;for(let $t=0;$t<Dt;++$t){$t==Dt-1&&(wt=J);for(let Lt=0;Lt<Ct;++Lt)ct[Lt].fill(0),ct[Lt][0]=je[Se[Lt]++],Ye(xe,Ue,ct[Lt]),ne(ct[Lt],be[Lt]),ft(be[Lt]);qe(be);for(let Lt=0;Lt<Ct;++Lt)Ne(be[Lt],yt[Lt],$t*64)}let St=0;for(let $t=0;$t<Ct;++$t){const Lt=ge[Y.idx[$t]].type;for(let ni=8*zt;ni<8*zt+Ft;++ni){St=ut[$t][ni];for(let $i=0;$i<Tt;++$i){const In=$i*64+(ni&7)*8;Bt.setUint16(St+0*Lt,yt[$t][In+0],!0),Bt.setUint16(St+2*Lt,yt[$t][In+1],!0),Bt.setUint16(St+4*Lt,yt[$t][In+2],!0),Bt.setUint16(St+6*Lt,yt[$t][In+3],!0),Bt.setUint16(St+8*Lt,yt[$t][In+4],!0),Bt.setUint16(St+10*Lt,yt[$t][In+5],!0),Bt.setUint16(St+12*Lt,yt[$t][In+6],!0),Bt.setUint16(St+14*Lt,yt[$t][In+7],!0),St+=16*Lt}}if(Tt!=Dt)for(let ni=8*zt;ni<8*zt+Ft;++ni){const $i=ut[$t][ni]+8*Tt*2*Lt,In=Tt*64+(ni&7)*8;for(let Oi=0;Oi<wt;++Oi)Bt.setUint16($i+Oi*2*Lt,yt[$t][In+Oi],!0)}}}for(var Yt=new Uint16Array(xt),Bt=new DataView(Xe.buffer),jt=0;jt<Ct;++jt){ge[Y.idx[jt]].decoded=!0;var yn=ge[Y.idx[jt]].type;if(ge[jt].type==2)for(var Kn=0;Kn<At;++Kn){const zt=ut[jt][Kn];for(var Sn=0;Sn<xt;++Sn)Yt[Sn]=Bt.getUint16(zt+Sn*2*yn,!0);for(var Sn=0;Sn<xt;++Sn)Bt.setFloat32(zt+Sn*2*yn,Me(Yt[Sn]),!0)}}}function Ye(Y,se,ge){for(var Ue,je=1;je<64;)Ue=se[Y.value],Ue==65280?je=64:Ue>>8==255?je+=Ue&255:(ge[je]=Ue,je++),Y.value++}function ne(Y,se){se[0]=Me(Y[0]),se[1]=Me(Y[1]),se[2]=Me(Y[5]),se[3]=Me(Y[6]),se[4]=Me(Y[14]),se[5]=Me(Y[15]),se[6]=Me(Y[27]),se[7]=Me(Y[28]),se[8]=Me(Y[2]),se[9]=Me(Y[4]),se[10]=Me(Y[7]),se[11]=Me(Y[13]),se[12]=Me(Y[16]),se[13]=Me(Y[26]),se[14]=Me(Y[29]),se[15]=Me(Y[42]),se[16]=Me(Y[3]),se[17]=Me(Y[8]),se[18]=Me(Y[12]),se[19]=Me(Y[17]),se[20]=Me(Y[25]),se[21]=Me(Y[30]),se[22]=Me(Y[41]),se[23]=Me(Y[43]),se[24]=Me(Y[9]),se[25]=Me(Y[11]),se[26]=Me(Y[18]),se[27]=Me(Y[24]),se[28]=Me(Y[31]),se[29]=Me(Y[40]),se[30]=Me(Y[44]),se[31]=Me(Y[53]),se[32]=Me(Y[10]),se[33]=Me(Y[19]),se[34]=Me(Y[23]),se[35]=Me(Y[32]),se[36]=Me(Y[39]),se[37]=Me(Y[45]),se[38]=Me(Y[52]),se[39]=Me(Y[54]),se[40]=Me(Y[20]),se[41]=Me(Y[22]),se[42]=Me(Y[33]),se[43]=Me(Y[38]),se[44]=Me(Y[46]),se[45]=Me(Y[51]),se[46]=Me(Y[55]),se[47]=Me(Y[60]),se[48]=Me(Y[21]),se[49]=Me(Y[34]),se[50]=Me(Y[37]),se[51]=Me(Y[47]),se[52]=Me(Y[50]),se[53]=Me(Y[56]),se[54]=Me(Y[59]),se[55]=Me(Y[61]),se[56]=Me(Y[35]),se[57]=Me(Y[36]),se[58]=Me(Y[48]),se[59]=Me(Y[49]),se[60]=Me(Y[57]),se[61]=Me(Y[58]),se[62]=Me(Y[62]),se[63]=Me(Y[63])}function ft(Y){const se=.5*Math.cos(.7853975),ge=.5*Math.cos(3.14159/16),Ue=.5*Math.cos(3.14159/8),je=.5*Math.cos(3*3.14159/16),Xe=.5*Math.cos(5*3.14159/16),xt=.5*Math.cos(3*3.14159/8),At=.5*Math.cos(7*3.14159/16);for(var Ct=new Array(4),Tt=new Array(4),Dt=new Array(4),He=new Array(4),J=0;J<8;++J){var pe=J*8;Ct[0]=Ue*Y[pe+2],Ct[1]=xt*Y[pe+2],Ct[2]=Ue*Y[pe+6],Ct[3]=xt*Y[pe+6],Tt[0]=ge*Y[pe+1]+je*Y[pe+3]+Xe*Y[pe+5]+At*Y[pe+7],Tt[1]=je*Y[pe+1]-At*Y[pe+3]-ge*Y[pe+5]-Xe*Y[pe+7],Tt[2]=Xe*Y[pe+1]-ge*Y[pe+3]+At*Y[pe+5]+je*Y[pe+7],Tt[3]=At*Y[pe+1]-Xe*Y[pe+3]+je*Y[pe+5]-ge*Y[pe+7],Dt[0]=se*(Y[pe+0]+Y[pe+4]),Dt[3]=se*(Y[pe+0]-Y[pe+4]),Dt[1]=Ct[0]+Ct[3],Dt[2]=Ct[1]-Ct[2],He[0]=Dt[0]+Dt[1],He[1]=Dt[3]+Dt[2],He[2]=Dt[3]-Dt[2],He[3]=Dt[0]-Dt[1],Y[pe+0]=He[0]+Tt[0],Y[pe+1]=He[1]+Tt[1],Y[pe+2]=He[2]+Tt[2],Y[pe+3]=He[3]+Tt[3],Y[pe+4]=He[3]-Tt[3],Y[pe+5]=He[2]-Tt[2],Y[pe+6]=He[1]-Tt[1],Y[pe+7]=He[0]-Tt[0]}for(var xe=0;xe<8;++xe)Ct[0]=Ue*Y[16+xe],Ct[1]=xt*Y[16+xe],Ct[2]=Ue*Y[48+xe],Ct[3]=xt*Y[48+xe],Tt[0]=ge*Y[8+xe]+je*Y[24+xe]+Xe*Y[40+xe]+At*Y[56+xe],Tt[1]=je*Y[8+xe]-At*Y[24+xe]-ge*Y[40+xe]-Xe*Y[56+xe],Tt[2]=Xe*Y[8+xe]-ge*Y[24+xe]+At*Y[40+xe]+je*Y[56+xe],Tt[3]=At*Y[8+xe]-Xe*Y[24+xe]+je*Y[40+xe]-ge*Y[56+xe],Dt[0]=se*(Y[xe]+Y[32+xe]),Dt[3]=se*(Y[xe]-Y[32+xe]),Dt[1]=Ct[0]+Ct[3],Dt[2]=Ct[1]-Ct[2],He[0]=Dt[0]+Dt[1],He[1]=Dt[3]+Dt[2],He[2]=Dt[3]-Dt[2],He[3]=Dt[0]-Dt[1],Y[0+xe]=He[0]+Tt[0],Y[8+xe]=He[1]+Tt[1],Y[16+xe]=He[2]+Tt[2],Y[24+xe]=He[3]+Tt[3],Y[32+xe]=He[3]-Tt[3],Y[40+xe]=He[2]-Tt[2],Y[48+xe]=He[1]-Tt[1],Y[56+xe]=He[0]-Tt[0]}function qe(Y){for(var se=0;se<64;++se){var ge=Y[0][se],Ue=Y[1][se],je=Y[2][se];Y[0][se]=ge+1.5747*je,Y[1][se]=ge-.1873*Ue-.4682*je,Y[2][se]=ge+1.8556*Ue}}function Ne(Y,se,ge){for(var Ue=0;Ue<64;++Ue)se[ge+Ue]=Gc.toHalfFloat(tt(Y[Ue]))}function tt(Y){return Y<=1?Math.sign(Y)*Math.pow(Math.abs(Y),2.2):Math.sign(Y)*Math.pow(L,Math.abs(Y)-1)}function Z(Y){return new DataView(Y.array.buffer,Y.offset.value,Y.size)}function H(Y){var se=Y.viewer.buffer.slice(Y.offset.value,Y.offset.value+Y.size),ge=new Uint8Array(Le(se)),Ue=new Uint8Array(ge.length);return _t(ge),Be(ge,Ue),new DataView(Ue.buffer)}function de(Y){var se=Y.array.slice(Y.offset.value,Y.offset.value+Y.size),ge=BE(se),Ue=new Uint8Array(ge.length);return _t(ge),Be(ge,Ue),new DataView(Ue.buffer)}function De(Y){for(var se=Y.viewer,ge={value:Y.offset.value},Ue=new Uint16Array(Y.width*Y.scanlineBlockSize*(Y.channels*Y.type)),je=new Uint8Array(8192),Xe=0,xt=new Array(Y.channels),At=0;At<Y.channels;At++)xt[At]={},xt[At].start=Xe,xt[At].end=xt[At].start,xt[At].nx=Y.width,xt[At].ny=Y.lines,xt[At].size=Y.type,Xe+=xt[At].nx*xt[At].ny*xt[At].size;var Ct=rt(se,ge),Tt=rt(se,ge);if(Tt>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Ct<=Tt)for(var At=0;At<Tt-Ct+1;At++)je[At+Ct]=bt(se,ge);var Dt=new Uint16Array(65536),He=P(je,Dt),J=Ve(se,ge);ot(Y.array,se,ge,J,Ue,Xe);for(var At=0;At<Y.channels;++At)for(var pe=xt[At],xe=0;xe<xt[At].size;++xe)Pe(Ue,pe.start+xe,pe.nx,pe.size,pe.ny,pe.nx*pe.size,He);Je(Dt,Ue,Xe);for(var Se=0,be=new Uint8Array(Ue.buffer.byteLength),ct=0;ct<Y.lines;ct++)for(var yt=0;yt<Y.channels;yt++){var pe=xt[yt],ut=pe.nx*pe.size,Ft=new Uint8Array(Ue.buffer,pe.end*2,ut*2);be.set(Ft,Se),Se+=ut*2,pe.end+=ut}return new DataView(be.buffer)}function Ie(Y){var se=Y.array.slice(Y.offset.value,Y.offset.value+Y.size),ge=BE(se);const Ue=Y.lines*Y.channels*Y.width,je=Y.type==1?new Uint16Array(Ue):new Uint32Array(Ue);let Xe=0,xt=0;const At=new Array(4);for(let Ct=0;Ct<Y.lines;Ct++)for(let Tt=0;Tt<Y.channels;Tt++){let Dt=0;switch(Y.type){case 1:At[0]=Xe,At[1]=At[0]+Y.width,Xe=At[1]+Y.width;for(let He=0;He<Y.width;++He){const J=ge[At[0]++]<<8|ge[At[1]++];Dt+=J,je[xt]=Dt,xt++}break;case 2:At[0]=Xe,At[1]=At[0]+Y.width,At[2]=At[1]+Y.width,Xe=At[2]+Y.width;for(let He=0;He<Y.width;++He){const J=ge[At[0]++]<<24|ge[At[1]++]<<16|ge[At[2]++]<<8;Dt+=J,je[xt]=Dt,xt++}break}}return new DataView(je.buffer)}function we(Y){var se=Y.viewer,ge={value:Y.offset.value},Ue=new Uint8Array(Y.width*Y.lines*(Y.channels*Y.type*2)),je={version:ht(se,ge),unknownUncompressedSize:ht(se,ge),unknownCompressedSize:ht(se,ge),acCompressedSize:ht(se,ge),dcCompressedSize:ht(se,ge),rleCompressedSize:ht(se,ge),rleUncompressedSize:ht(se,ge),rleRawSize:ht(se,ge),totalAcUncompressedCount:ht(se,ge),totalDcUncompressedCount:ht(se,ge),acCompression:ht(se,ge)};if(je.version<2)throw"EXRLoader.parse: "+Rr.compression+" version "+je.version+" is unsupported";for(var Xe=new Array,xt=rt(se,ge)-2;xt>0;){var At=st(se.buffer,ge),Ct=bt(se,ge),Tt=Ct>>2&3,Dt=(Ct>>4)-1,He=new Int8Array([Dt])[0],J=bt(se,ge);Xe.push({name:At,index:He,type:J,compression:Tt}),xt-=At.length+3}for(var pe=Rr.channels,xe=new Array(Y.channels),Se=0;Se<Y.channels;++Se){var be=xe[Se]={},ct=pe[Se];be.name=ct.name,be.compression=0,be.decoded=!1,be.type=ct.pixelType,be.pLinear=ct.pLinear,be.width=Y.width,be.height=Y.lines}for(var yt={idx:new Array(3)},ut=0;ut<Y.channels;++ut)for(var be=xe[ut],Se=0;Se<Xe.length;++Se){var Ft=Xe[Se];be.name==Ft.name&&(be.compression=Ft.compression,Ft.index>=0&&(yt.idx[Ft.index]=ut),be.offset=ut)}if(je.acCompressedSize>0)switch(je.acCompression){case 0:var Bt=new Uint16Array(je.totalAcUncompressedCount);ot(Y.array,se,ge,je.acCompressedSize,Bt,je.totalAcUncompressedCount);break;case 1:var wt=Y.array.slice(ge.value,ge.value+je.totalAcUncompressedCount),Yt=BE(wt),Bt=new Uint16Array(Yt.buffer);ge.value+=je.totalAcUncompressedCount;break}if(je.dcCompressedSize>0){var jt={array:Y.array,offset:ge,size:je.dcCompressedSize},yn=new Uint16Array(de(jt).buffer);ge.value+=je.dcCompressedSize}if(je.rleRawSize>0){var wt=Y.array.slice(ge.value,ge.value+je.rleCompressedSize),Yt=BE(wt),Kn=Le(Yt.buffer);ge.value+=je.rleCompressedSize}for(var Sn=0,zt=new Array(xe.length),Se=0;Se<zt.length;++Se)zt[Se]=new Array;for(var St=0;St<Y.lines;++St)for(var $t=0;$t<xe.length;++$t)zt[$t].push(Sn),Sn+=xe[$t].width*Y.type*2;Te(yt,zt,xe,Bt,yn,Ue);for(var Se=0;Se<xe.length;++Se){var be=xe[Se];if(!be.decoded)switch(be.compression){case 2:for(var Lt=0,ni=0,St=0;St<Y.lines;++St){for(var $i=zt[Se][Lt],In=0;In<be.width;++In){for(var Oi=0;Oi<2*be.type;++Oi)Ue[$i++]=Kn[ni+Oi*be.width*be.height];ni++}Lt++}break;default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(Ue.buffer)}function st(Y,se){for(var ge=new Uint8Array(Y),Ue=0;ge[se.value+Ue]!=0;)Ue+=1;var je=new TextDecoder().decode(ge.slice(se.value,se.value+Ue));return se.value=se.value+Ue+1,je}function it(Y,se,ge){var Ue=new TextDecoder().decode(new Uint8Array(Y).slice(se.value,se.value+ge));return se.value=se.value+ge,Ue}function It(Y,se){var ge=Qe(Y,se),Ue=Ve(Y,se);return[ge,Ue]}function Ot(Y,se){var ge=Ve(Y,se),Ue=Ve(Y,se);return[ge,Ue]}function Qe(Y,se){var ge=Y.getInt32(se.value,!0);return se.value=se.value+4,ge}function Ve(Y,se){var ge=Y.getUint32(se.value,!0);return se.value=se.value+4,ge}function at(Y,se){var ge=Y[se.value];return se.value=se.value+1,ge}function bt(Y,se){var ge=Y.getUint8(se.value);return se.value=se.value+1,ge}const ht=function(Y,se){let ge;return"getBigInt64"in DataView.prototype?ge=Number(Y.getBigInt64(se.value,!0)):ge=Y.getUint32(se.value+4,!0)+Number(Y.getUint32(se.value,!0)<<32),se.value+=8,ge};function Vt(Y,se){var ge=Y.getFloat32(se.value,!0);return se.value+=4,ge}function ve(Y,se){return Gc.toHalfFloat(Vt(Y,se))}function Me(Y){var se=(Y&31744)>>10,ge=Y&1023;return(Y>>15?-1:1)*(se?se===31?ge?NaN:1/0:Math.pow(2,se-15)*(1+ge/1024):6103515625e-14*(ge/1024))}function rt(Y,se){var ge=Y.getUint16(se.value,!0);return se.value+=2,ge}function Ut(Y,se){return Me(rt(Y,se))}function nt(Y,se,ge,Ue){for(var je=ge.value,Xe=[];ge.value<je+Ue-1;){var xt=st(se,ge),At=Qe(Y,ge),Ct=bt(Y,ge);ge.value+=3;var Tt=Qe(Y,ge),Dt=Qe(Y,ge);Xe.push({name:xt,pixelType:At,pLinear:Ct,xSampling:Tt,ySampling:Dt})}return ge.value+=1,Xe}function ke(Y,se){var ge=Vt(Y,se),Ue=Vt(Y,se),je=Vt(Y,se),Xe=Vt(Y,se),xt=Vt(Y,se),At=Vt(Y,se),Ct=Vt(Y,se),Tt=Vt(Y,se);return{redX:ge,redY:Ue,greenX:je,greenY:Xe,blueX:xt,blueY:At,whiteX:Ct,whiteY:Tt}}function gt(Y,se){var ge=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],Ue=bt(Y,se);return ge[Ue]}function Qt(Y,se){var ge=Ve(Y,se),Ue=Ve(Y,se),je=Ve(Y,se),Xe=Ve(Y,se);return{xMin:ge,yMin:Ue,xMax:je,yMax:Xe}}function kt(Y,se){var ge=["INCREASING_Y"],Ue=bt(Y,se);return ge[Ue]}function rn(Y,se){var ge=Vt(Y,se),Ue=Vt(Y,se);return[ge,Ue]}function ti(Y,se){var ge=Vt(Y,se),Ue=Vt(Y,se),je=Vt(Y,se);return[ge,Ue,je]}function ui(Y,se,ge,Ue,je){if(Ue==="string"||Ue==="stringvector"||Ue==="iccProfile")return it(se,ge,je);if(Ue==="chlist")return nt(Y,se,ge,je);if(Ue==="chromaticities")return ke(Y,ge);if(Ue==="compression")return gt(Y,ge);if(Ue==="box2i")return Qt(Y,ge);if(Ue==="lineOrder")return kt(Y,ge);if(Ue==="float")return Vt(Y,ge);if(Ue==="v2f")return rn(Y,ge);if(Ue==="v3f")return ti(Y,ge);if(Ue==="int")return Qe(Y,ge);if(Ue==="rational")return It(Y,ge);if(Ue==="timecode")return Ot(Y,ge);if(Ue==="preview")return ge.value+=je,"skipped";ge.value+=je}function vi(Y,se,ge){const Ue={};if(Y.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";Ue.version=Y.getUint8(4);const je=Y.getUint8(5);Ue.spec={singleTile:!!(je&2),longName:!!(je&4),deepFormat:!!(je&8),multiPart:!!(je&16)},ge.value=8;for(var Xe=!0;Xe;){var xt=st(se,ge);if(xt==0)Xe=!1;else{var At=st(se,ge),Ct=Ve(Y,ge),Tt=ui(Y,se,ge,At,Ct);Tt===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${At}'.`):Ue[xt]=Tt}}if((je&-5)!=0)throw console.error("EXRHeader:",Ue),"THREE.EXRLoader: provided file is currently unsupported.";return Ue}function yr(Y,se,ge,Ue,je){const Xe={size:0,viewer:se,array:ge,offset:Ue,width:Y.dataWindow.xMax-Y.dataWindow.xMin+1,height:Y.dataWindow.yMax-Y.dataWindow.yMin+1,channels:Y.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:Y.channels[0].pixelType,uncompress:null,getter:null,format:null,[N1?"colorSpace":"encoding"]:null};switch(Y.compression){case"NO_COMPRESSION":Xe.lines=1,Xe.uncompress=Z;break;case"RLE_COMPRESSION":Xe.lines=1,Xe.uncompress=H;break;case"ZIPS_COMPRESSION":Xe.lines=1,Xe.uncompress=de;break;case"ZIP_COMPRESSION":Xe.lines=16,Xe.uncompress=de;break;case"PIZ_COMPRESSION":Xe.lines=32,Xe.uncompress=De;break;case"PXR24_COMPRESSION":Xe.lines=16,Xe.uncompress=Ie;break;case"DWAA_COMPRESSION":Xe.lines=32,Xe.uncompress=we;break;case"DWAB_COMPRESSION":Xe.lines=256,Xe.uncompress=we;break;default:throw"EXRLoader.parse: "+Y.compression+" is unsupported"}if(Xe.scanlineBlockSize=Xe.lines,Xe.type==1)switch(je){case Si:Xe.getter=Ut,Xe.inputSize=2;break;case ci:Xe.getter=rt,Xe.inputSize=2;break}else if(Xe.type==2)switch(je){case Si:Xe.getter=Vt,Xe.inputSize=4;break;case ci:Xe.getter=ve,Xe.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+Xe.type+" for "+Y.compression+".";Xe.blockCount=(Y.dataWindow.yMax+1)/Xe.scanlineBlockSize;for(var xt=0;xt<Xe.blockCount;xt++)ht(se,Ue);Xe.outputChannels=Xe.channels==3?4:Xe.channels;const At=Xe.width*Xe.height*Xe.outputChannels;switch(je){case Si:Xe.byteArray=new Float32Array(At),Xe.channels<Xe.outputChannels&&Xe.byteArray.fill(1,0,At);break;case ci:Xe.byteArray=new Uint16Array(At),Xe.channels<Xe.outputChannels&&Xe.byteArray.fill(15360,0,At);break;default:console.error("THREE.EXRLoader: unsupported type: ",je);break}return Xe.bytesPerLine=Xe.width*Xe.inputSize*Xe.channels,Xe.outputChannels==4?Xe.format=Fi:Xe.format=qu,N1?Xe.colorSpace="srgb-linear":Xe.encoding=3e3,Xe}const Ir=new DataView(e),qr=new Uint8Array(e),Ki={value:0},Rr=vi(Ir,e,Ki),en=yr(Rr,Ir,qr,Ki,this.type),di={value:0},hi={R:0,G:1,B:2,A:3,Y:0};for(let Y=0;Y<en.height/en.scanlineBlockSize;Y++){const se=Ve(Ir,Ki);en.size=Ve(Ir,Ki),en.lines=se+en.scanlineBlockSize>en.height?en.height-se:en.scanlineBlockSize;const Ue=en.size<en.lines*en.bytesPerLine?en.uncompress(en):Z(en);Ki.value+=en.size;for(let je=0;je<en.scanlineBlockSize;je++){const Xe=je+Y*en.scanlineBlockSize;if(Xe>=en.height)break;for(let xt=0;xt<en.channels;xt++){const At=hi[Rr.channels[xt].name];for(let Ct=0;Ct<en.width;Ct++){di.value=(je*(en.channels*en.width)+xt*en.width+Ct)*en.inputSize;const Tt=(en.height-1-Xe)*(en.width*en.outputChannels)+Ct*en.outputChannels+At;en.byteArray[Tt]=en.getter(Ue,di)}}}}return{header:Rr,width:en.width,height:en.height,data:en.byteArray,format:en.format,[N1?"colorSpace":"encoding"]:en[N1?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,i,r){function s(a,o){N1?a.colorSpace=o.colorSpace:a.encoding=o.encoding,a.minFilter=mn,a.magFilter=mn,a.generateMipmaps=!1,a.flipY=!1,t&&t(a,o)}return super.load(e,s,i,r)}}function Mce(){var n=Object.create(null);function e(r,s){var a=r.id,o=r.name,c=r.dependencies;c===void 0&&(c=[]);var h=r.init;h===void 0&&(h=function(){});var p=r.getTransferables;if(p===void 0&&(p=null),!n[a])try{c=c.map(function(A){return A&&A.isWorkerModule&&(e(A,function(v){if(v instanceof Error)throw v}),A=n[A.id].value),A}),h=i("<"+o+">.init",h),p&&(p=i("<"+o+">.getTransferables",p));var g=null;typeof h=="function"?g=h.apply(void 0,c):console.error("worker module init function failed to rehydrate"),n[a]={id:a,value:g,getTransferables:p},s(g)}catch(A){A&&A.noLog||console.error(A),s(A)}}function t(r,s){var a,o=r.id,c=r.args;(!n[o]||typeof n[o].value!="function")&&s(new Error("Worker module "+o+": not found or its 'init' did not return a function"));try{var h=(a=n[o]).value.apply(a,c);h&&typeof h.then=="function"?h.then(p,function(g){return s(g instanceof Error?g:new Error(""+g))}):p(h)}catch(g){s(g)}function p(g){try{var A=n[o].getTransferables&&n[o].getTransferables(g);(!A||!Array.isArray(A)||!A.length)&&(A=void 0),s(g,A)}catch(v){console.error(v),s(v)}}}function i(r,s){var a=void 0;self.troikaDefine=function(c){return a=c};var o=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+s+`
)`],{type:"application/javascript"}));try{importScripts(o)}catch(c){console.error(c)}return URL.revokeObjectURL(o),delete self.troikaDefine,a}self.addEventListener("message",function(r){var s=r.data,a=s.messageId,o=s.action,c=s.data;try{o==="registerModule"&&e(c,function(h){h instanceof Error?postMessage({messageId:a,success:!1,error:h.message}):postMessage({messageId:a,success:!0,result:{isCallable:typeof h=="function"}})}),o==="callModule"&&t(c,function(h,p){h instanceof Error?postMessage({messageId:a,success:!1,error:h.message}):postMessage({messageId:a,success:!0,result:h},p||void 0)})}catch(h){postMessage({messageId:a,success:!1,error:h.stack})}})}function Cce(n){var e=function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return e._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var t=n.dependencies,i=n.init;t=Array.isArray(t)?t.map(function(s){return s&&(s=s.onMainThread||s,s._getInitResult&&(s=s._getInitResult())),s}):[];var r=Promise.all(t).then(function(s){return i.apply(null,s)});return e._getInitResult=function(){return r},r},e}var _G=function(){var n=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),n=!0}catch(t){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return _G=function(){return n},n},Tce=0,Ice=0,uR=!1,ab=Object.create(null),ob=Object.create(null),_2=Object.create(null);function gv(n){if((!n||typeof n.init!="function")&&!uR)throw new Error("requires `options.init` function");var e=n.dependencies,t=n.init,i=n.getTransferables,r=n.workerId,s=Cce(n);r==null&&(r="#default");var a="workerModule"+ ++Tce,o=n.name||a,c=null;e=e&&e.map(function(p){return typeof p=="function"&&!p.workerModuleData&&(uR=!0,p=gv({workerId:r,name:"<"+o+"> function dependency: "+p.name,init:`function(){return (
`+tw(p)+`
)}`}),uR=!1),p&&p.workerModuleData&&(p=p.workerModuleData),p});function h(){for(var p=[],g=arguments.length;g--;)p[g]=arguments[g];if(!_G())return s.apply(void 0,p);if(!c){c=jO(r,"registerModule",h.workerModuleData);var A=function(){c=null,ob[r].delete(A)};(ob[r]||(ob[r]=new Set)).add(A)}return c.then(function(v){var x=v.isCallable;if(x)return jO(r,"callModule",{id:a,args:p});throw new Error("Worker module function was called but `init` did not return a callable function")})}return h.workerModuleData={isWorkerModule:!0,id:a,name:o,dependencies:e,init:tw(t),getTransferables:i&&tw(i)},h.onMainThread=s,h}function Rce(n){ob[n]&&ob[n].forEach(function(e){e()}),ab[n]&&(ab[n].terminate(),delete ab[n])}function tw(n){var e=n.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function Bce(n){var e=ab[n];if(!e){var t=tw(Mce);e=ab[n]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+n.replace(/\*/g,"")+` **/

;(`+t+")()"],{type:"application/javascript"}))),e.onmessage=function(i){var r=i.data,s=r.messageId,a=_2[s];if(!a)throw new Error("WorkerModule response with empty or unknown messageId");delete _2[s],a(r)}}return e}function jO(n,e,t){return new Promise(function(i,r){var s=++Ice;_2[s]=function(a){a.success?i(a.result):r(new Error("Error in worker "+e+" call: "+a.error))},Bce(n).postMessage({messageId:s,action:e,data:t})})}function SG(){var n=(function(e){function t(ue,oe,z,$,ae,he,me,le){var fe=1-me;le.x=fe*fe*ue+2*fe*me*z+me*me*ae,le.y=fe*fe*oe+2*fe*me*$+me*me*he}function i(ue,oe,z,$,ae,he,me,le,fe,_e){var Pe=1-fe;_e.x=Pe*Pe*Pe*ue+3*Pe*Pe*fe*z+3*Pe*fe*fe*ae+fe*fe*fe*me,_e.y=Pe*Pe*Pe*oe+3*Pe*Pe*fe*$+3*Pe*fe*fe*he+fe*fe*fe*le}function r(ue,oe){for(var z=/([MLQCZ])([^MLQCZ]*)/g,$,ae,he,me,le;$=z.exec(ue);){var fe=$[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(_e){return parseFloat(_e)});switch($[1]){case"M":me=ae=fe[0],le=he=fe[1];break;case"L":(fe[0]!==me||fe[1]!==le)&&oe("L",me,le,me=fe[0],le=fe[1]);break;case"Q":{oe("Q",me,le,me=fe[2],le=fe[3],fe[0],fe[1]);break}case"C":{oe("C",me,le,me=fe[4],le=fe[5],fe[0],fe[1],fe[2],fe[3]);break}case"Z":(me!==ae||le!==he)&&oe("L",me,le,ae,he);break}}}function s(ue,oe,z){z===void 0&&(z=16);var $={x:0,y:0};r(ue,function(ae,he,me,le,fe,_e,Pe,et,ot){switch(ae){case"L":oe(he,me,le,fe);break;case"Q":{for(var Je=he,_t=me,Be=1;Be<z;Be++)t(he,me,_e,Pe,le,fe,Be/(z-1),$),oe(Je,_t,$.x,$.y),Je=$.x,_t=$.y;break}case"C":{for(var Le=he,Te=me,Ye=1;Ye<z;Ye++)i(he,me,_e,Pe,et,ot,le,fe,Ye/(z-1),$),oe(Le,Te,$.x,$.y),Le=$.x,Te=$.y;break}}})}var a="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",o="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",c=new WeakMap,h={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function p(ue,oe){var z=ue.getContext?ue.getContext("webgl",h):ue,$=c.get(z);if(!$){let Pe=function(Le){var Te=he[Le];if(!Te&&(Te=he[Le]=z.getExtension(Le),!Te))throw new Error(Le+" not supported");return Te},et=function(Le,Te){var Ye=z.createShader(Te);return z.shaderSource(Ye,Le),z.compileShader(Ye),Ye},ot=function(Le,Te,Ye,ne){if(!me[Le]){var ft={},qe={},Ne=z.createProgram();z.attachShader(Ne,et(Te,z.VERTEX_SHADER)),z.attachShader(Ne,et(Ye,z.FRAGMENT_SHADER)),z.linkProgram(Ne),me[Le]={program:Ne,transaction:function(Z){z.useProgram(Ne),Z({setUniform:function(de,De){for(var Ie=[],we=arguments.length-2;we-- >0;)Ie[we]=arguments[we+2];var st=qe[De]||(qe[De]=z.getUniformLocation(Ne,De));z["uniform"+de].apply(z,[st].concat(Ie))},setAttribute:function(de,De,Ie,we,st){var it=ft[de];it||(it=ft[de]={buf:z.createBuffer(),loc:z.getAttribLocation(Ne,de),data:null}),z.bindBuffer(z.ARRAY_BUFFER,it.buf),z.vertexAttribPointer(it.loc,De,z.FLOAT,!1,0,0),z.enableVertexAttribArray(it.loc),ae?z.vertexAttribDivisor(it.loc,we):Pe("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(it.loc,we),st!==it.data&&(z.bufferData(z.ARRAY_BUFFER,st,Ie),it.data=st)}})}}}me[Le].transaction(ne)},Je=function(Le,Te){fe++;try{z.activeTexture(z.TEXTURE0+fe);var Ye=le[Le];Ye||(Ye=le[Le]=z.createTexture(),z.bindTexture(z.TEXTURE_2D,Ye),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MIN_FILTER,z.NEAREST),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MAG_FILTER,z.NEAREST)),z.bindTexture(z.TEXTURE_2D,Ye),Te(Ye,fe)}finally{fe--}},_t=function(Le,Te,Ye){var ne=z.createFramebuffer();_e.push(ne),z.bindFramebuffer(z.FRAMEBUFFER,ne),z.activeTexture(z.TEXTURE0+Te),z.bindTexture(z.TEXTURE_2D,Le),z.framebufferTexture2D(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,z.TEXTURE_2D,Le,0);try{Ye(ne)}finally{z.deleteFramebuffer(ne),z.bindFramebuffer(z.FRAMEBUFFER,_e[--_e.length-1]||null)}},Be=function(){he={},me={},le={},fe=-1,_e.length=0};var ae=typeof WebGL2RenderingContext<"u"&&z instanceof WebGL2RenderingContext,he={},me={},le={},fe=-1,_e=[];z.canvas.addEventListener("webglcontextlost",function(Le){Be(),Le.preventDefault()},!1),c.set(z,$={gl:z,isWebGL2:ae,getExtension:Pe,withProgram:ot,withTexture:Je,withTextureFramebuffer:_t,handleContextLoss:Be})}oe($)}function g(ue,oe,z,$,ae,he,me,le){me===void 0&&(me=15),le===void 0&&(le=null),p(ue,function(fe){var _e=fe.gl,Pe=fe.withProgram,et=fe.withTexture;et("copy",function(ot,Je){_e.texImage2D(_e.TEXTURE_2D,0,_e.RGBA,ae,he,0,_e.RGBA,_e.UNSIGNED_BYTE,oe),Pe("copy",a,o,function(_t){var Be=_t.setUniform,Le=_t.setAttribute;Le("aUV",2,_e.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),Be("1i","image",Je),_e.bindFramebuffer(_e.FRAMEBUFFER,le||null),_e.disable(_e.BLEND),_e.colorMask(me&8,me&4,me&2,me&1),_e.viewport(z,$,ae,he),_e.scissor(z,$,ae,he),_e.drawArrays(_e.TRIANGLES,0,3)})})})}function A(ue,oe,z){var $=ue.width,ae=ue.height;p(ue,function(he){var me=he.gl,le=new Uint8Array($*ae*4);me.readPixels(0,0,$,ae,me.RGBA,me.UNSIGNED_BYTE,le),ue.width=oe,ue.height=z,g(me,le,0,0,$,ae)})}var v=Object.freeze({__proto__:null,withWebGLContext:p,renderImageData:g,resizeWebGLCanvasWithoutClearing:A});function x(ue,oe,z,$,ae,he){he===void 0&&(he=1);var me=new Uint8Array(ue*oe),le=$[2]-$[0],fe=$[3]-$[1],_e=[];s(z,function(Le,Te,Ye,ne){_e.push({x1:Le,y1:Te,x2:Ye,y2:ne,minX:Math.min(Le,Ye),minY:Math.min(Te,ne),maxX:Math.max(Le,Ye),maxY:Math.max(Te,ne)})}),_e.sort(function(Le,Te){return Le.maxX-Te.maxX});for(var Pe=0;Pe<ue;Pe++)for(var et=0;et<oe;et++){var ot=_t($[0]+le*(Pe+.5)/ue,$[1]+fe*(et+.5)/oe),Je=Math.pow(1-Math.abs(ot)/ae,he)/2;ot<0&&(Je=1-Je),Je=Math.max(0,Math.min(255,Math.round(Je*255))),me[et*ue+Pe]=Je}return me;function _t(Le,Te){for(var Ye=1/0,ne=1/0,ft=_e.length;ft--;){var qe=_e[ft];if(qe.maxX+ne<=Le)break;if(Le+ne>qe.minX&&Te-ne<qe.maxY&&Te+ne>qe.minY){var Ne=E(Le,Te,qe.x1,qe.y1,qe.x2,qe.y2);Ne<Ye&&(Ye=Ne,ne=Math.sqrt(Ye))}}return Be(Le,Te)&&(ne=-ne),ne}function Be(Le,Te){for(var Ye=0,ne=_e.length;ne--;){var ft=_e[ne];if(ft.maxX<=Le)break;var qe=ft.y1>Te!=ft.y2>Te&&Le<(ft.x2-ft.x1)*(Te-ft.y1)/(ft.y2-ft.y1)+ft.x1;qe&&(Ye+=ft.y1<ft.y2?1:-1)}return Ye!==0}}function S(ue,oe,z,$,ae,he,me,le,fe,_e){he===void 0&&(he=1),le===void 0&&(le=0),fe===void 0&&(fe=0),_e===void 0&&(_e=0),_(ue,oe,z,$,ae,he,me,null,le,fe,_e)}function _(ue,oe,z,$,ae,he,me,le,fe,_e,Pe){he===void 0&&(he=1),fe===void 0&&(fe=0),_e===void 0&&(_e=0),Pe===void 0&&(Pe=0);for(var et=x(ue,oe,z,$,ae,he),ot=new Uint8Array(et.length*4),Je=0;Je<et.length;Je++)ot[Je*4+Pe]=et[Je];g(me,ot,fe,_e,ue,oe,1<<3-Pe,le)}function E(ue,oe,z,$,ae,he){var me=ae-z,le=he-$,fe=me*me+le*le,_e=fe?Math.max(0,Math.min(1,((ue-z)*me+(oe-$)*le)/fe)):0,Pe=ue-(z+_e*me),et=oe-($+_e*le);return Pe*Pe+et*et}var C=Object.freeze({__proto__:null,generate:x,generateIntoCanvas:S,generateIntoFramebuffer:_}),T="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",R="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",B="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",U=new Float32Array([0,0,2,0,0,2]),O=null,F=!1,L={},P=new WeakMap;function W(ue){if(!F&&!re(ue))throw new Error("WebGL generation not supported")}function j(ue,oe,z,$,ae,he,me){if(he===void 0&&(he=1),me===void 0&&(me=null),!me&&(me=O,!me)){var le=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!le)throw new Error("OffscreenCanvas or DOM canvas not supported");me=O=le.getContext("webgl",{depth:!1})}W(me);var fe=new Uint8Array(ue*oe*4);p(me,function(ot){var Je=ot.gl,_t=ot.withTexture,Be=ot.withTextureFramebuffer;_t("readable",function(Le,Te){Je.texImage2D(Je.TEXTURE_2D,0,Je.RGBA,ue,oe,0,Je.RGBA,Je.UNSIGNED_BYTE,null),Be(Le,Te,function(Ye){q(ue,oe,z,$,ae,he,Je,Ye,0,0,0),Je.readPixels(0,0,ue,oe,Je.RGBA,Je.UNSIGNED_BYTE,fe)})})});for(var _e=new Uint8Array(ue*oe),Pe=0,et=0;Pe<fe.length;Pe+=4)_e[et++]=fe[Pe];return _e}function V(ue,oe,z,$,ae,he,me,le,fe,_e){he===void 0&&(he=1),le===void 0&&(le=0),fe===void 0&&(fe=0),_e===void 0&&(_e=0),q(ue,oe,z,$,ae,he,me,null,le,fe,_e)}function q(ue,oe,z,$,ae,he,me,le,fe,_e,Pe){he===void 0&&(he=1),fe===void 0&&(fe=0),_e===void 0&&(_e=0),Pe===void 0&&(Pe=0),W(me);var et=[];s(z,function(ot,Je,_t,Be){et.push(ot,Je,_t,Be)}),et=new Float32Array(et),p(me,function(ot){var Je=ot.gl,_t=ot.isWebGL2,Be=ot.getExtension,Le=ot.withProgram,Te=ot.withTexture,Ye=ot.withTextureFramebuffer,ne=ot.handleContextLoss;if(Te("rawDistances",function(ft,qe){(ue!==ft._lastWidth||oe!==ft._lastHeight)&&Je.texImage2D(Je.TEXTURE_2D,0,Je.RGBA,ft._lastWidth=ue,ft._lastHeight=oe,0,Je.RGBA,Je.UNSIGNED_BYTE,null),Le("main",T,R,function(Ne){var tt=Ne.setAttribute,Z=Ne.setUniform,H=!_t&&Be("ANGLE_instanced_arrays"),de=!_t&&Be("EXT_blend_minmax");tt("aUV",2,Je.STATIC_DRAW,0,U),tt("aLineSegment",4,Je.DYNAMIC_DRAW,1,et),Z.apply(void 0,["4f","uGlyphBounds"].concat($)),Z("1f","uMaxDistance",ae),Z("1f","uExponent",he),Ye(ft,qe,function(De){Je.enable(Je.BLEND),Je.colorMask(!0,!0,!0,!0),Je.viewport(0,0,ue,oe),Je.scissor(0,0,ue,oe),Je.blendFunc(Je.ONE,Je.ONE),Je.blendEquationSeparate(Je.FUNC_ADD,_t?Je.MAX:de.MAX_EXT),Je.clear(Je.COLOR_BUFFER_BIT),_t?Je.drawArraysInstanced(Je.TRIANGLES,0,3,et.length/4):H.drawArraysInstancedANGLE(Je.TRIANGLES,0,3,et.length/4)})}),Le("post",a,B,function(Ne){Ne.setAttribute("aUV",2,Je.STATIC_DRAW,0,U),Ne.setUniform("1i","tex",qe),Je.bindFramebuffer(Je.FRAMEBUFFER,le),Je.disable(Je.BLEND),Je.colorMask(Pe===0,Pe===1,Pe===2,Pe===3),Je.viewport(fe,_e,ue,oe),Je.scissor(fe,_e,ue,oe),Je.drawArrays(Je.TRIANGLES,0,3)})}),Je.isContextLost())throw ne(),new Error("webgl context lost")})}function re(ue){var oe=!ue||ue===O?L:ue.canvas||ue,z=P.get(oe);if(z===void 0){F=!0;var $=null;try{var ae=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],he=j(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,ue);z=he&&ae.length===he.length&&he.every(function(me,le){return me===ae[le]}),z||($="bad trial run results",console.info(ae,he))}catch(me){z=!1,$=me.message}$&&console.warn("WebGL SDF generation not supported:",$),F=!1,P.set(oe,z)}return z}var Q=Object.freeze({__proto__:null,generate:j,generateIntoCanvas:V,generateIntoFramebuffer:q,isSupported:re});function K(ue,oe,z,$,ae,he){ae===void 0&&(ae=Math.max($[2]-$[0],$[3]-$[1])/2),he===void 0&&(he=1);try{return j.apply(Q,arguments)}catch(me){return console.info("WebGL SDF generation failed, falling back to JS",me),x.apply(C,arguments)}}function ce(ue,oe,z,$,ae,he,me,le,fe,_e){ae===void 0&&(ae=Math.max($[2]-$[0],$[3]-$[1])/2),he===void 0&&(he=1),le===void 0&&(le=0),fe===void 0&&(fe=0),_e===void 0&&(_e=0);try{return V.apply(Q,arguments)}catch(Pe){return console.info("WebGL SDF generation failed, falling back to JS",Pe),S.apply(C,arguments)}}return e.forEachPathCommand=r,e.generate=K,e.generateIntoCanvas=ce,e.javascript=C,e.pathToLineSegments=s,e.webgl=Q,e.webglUtils=v,Object.defineProperty(e,"__esModule",{value:!0}),e})({});return n}function Dce(){var n=(function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},i={},r={};i.L=1,r[1]="L",Object.keys(t).forEach(function(ne,ft){i[ne]=1<<ft+1,r[i[ne]]=ne}),Object.freeze(i);var s=i.LRI|i.RLI|i.FSI,a=i.L|i.R|i.AL,o=i.B|i.S|i.WS|i.ON|i.FSI|i.LRI|i.RLI|i.PDI,c=i.BN|i.RLE|i.LRE|i.RLO|i.LRO|i.PDF,h=i.S|i.WS|i.B|s|i.PDI|c,p=null;function g(){if(!p){p=new Map;var ne=function(qe){if(t.hasOwnProperty(qe)){var Ne=0;t[qe].split(",").forEach(function(tt){var Z=tt.split("+"),H=Z[0],de=Z[1];H=parseInt(H,36),de=de?parseInt(de,36):0,p.set(Ne+=H,i[qe]);for(var De=0;De<de;De++)p.set(++Ne,i[qe])})}};for(var ft in t)ne(ft)}}function A(ne){return g(),p.get(ne.codePointAt(0))||i.L}function v(ne){return r[A(ne)]}var x={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function S(ne,ft){var qe=36,Ne=0,tt=new Map,Z=ft&&new Map,H;return ne.split(",").forEach(function de(De){if(De.indexOf("+")!==-1)for(var Ie=+De;Ie--;)de(H);else{H=De;var we=De.split(">"),st=we[0],it=we[1];st=String.fromCodePoint(Ne+=parseInt(st,qe)),it=String.fromCodePoint(Ne+=parseInt(it,qe)),tt.set(st,it),ft&&Z.set(it,st)}}),{map:tt,reverseMap:Z}}var _,E,C;function T(){if(!_){var ne=S(x.pairs,!0),ft=ne.map,qe=ne.reverseMap;_=ft,E=qe,C=S(x.canonical,!1).map}}function R(ne){return T(),_.get(ne)||null}function B(ne){return T(),E.get(ne)||null}function U(ne){return T(),C.get(ne)||null}var O=i.L,F=i.R,L=i.EN,P=i.ES,W=i.ET,j=i.AN,V=i.CS,q=i.B,re=i.S,Q=i.ON,K=i.BN,ce=i.NSM,ue=i.AL,oe=i.LRO,z=i.RLO,$=i.LRE,ae=i.RLE,he=i.PDF,me=i.LRI,le=i.RLI,fe=i.FSI,_e=i.PDI;function Pe(ne,ft){for(var qe=125,Ne=new Uint32Array(ne.length),tt=0;tt<ne.length;tt++)Ne[tt]=A(ne[tt]);var Z=new Map;function H(Ms,Qa){var Qs=Ne[Ms];Ne[Ms]=Qa,Z.set(Qs,Z.get(Qs)-1),Qs&o&&Z.set(o,Z.get(o)-1),Z.set(Qa,(Z.get(Qa)||0)+1),Qa&o&&Z.set(o,(Z.get(o)||0)+1)}for(var de=new Uint8Array(ne.length),De=new Map,Ie=[],we=null,st=0;st<ne.length;st++)we||Ie.push(we={start:st,end:ne.length-1,level:ft==="rtl"?1:ft==="ltr"?0:Ef(st,!1)}),Ne[st]&q&&(we.end=st,we=null);for(var it=ae|$|z|oe|s|_e|he|q,It=function(Ms){return Ms+(Ms&1?1:2)},Ot=function(Ms){return Ms+(Ms&1?2:1)},Qe=0;Qe<Ie.length;Qe++){we=Ie[Qe];var Ve=[{_level:we.level,_override:0,_isolate:0}],at=void 0,bt=0,ht=0,Vt=0;Z.clear();for(var ve=we.start;ve<=we.end;ve++){var Me=Ne[ve];if(at=Ve[Ve.length-1],Z.set(Me,(Z.get(Me)||0)+1),Me&o&&Z.set(o,(Z.get(o)||0)+1),Me&it)if(Me&(ae|$)){de[ve]=at._level;var rt=(Me===ae?Ot:It)(at._level);rt<=qe&&!bt&&!ht?Ve.push({_level:rt,_override:0,_isolate:0}):bt||ht++}else if(Me&(z|oe)){de[ve]=at._level;var Ut=(Me===z?Ot:It)(at._level);Ut<=qe&&!bt&&!ht?Ve.push({_level:Ut,_override:Me&z?F:O,_isolate:0}):bt||ht++}else if(Me&s){Me&fe&&(Me=Ef(ve+1,!0)===1?le:me),de[ve]=at._level,at._override&&H(ve,at._override);var nt=(Me===le?Ot:It)(at._level);nt<=qe&&bt===0&&ht===0?(Vt++,Ve.push({_level:nt,_override:0,_isolate:1,_isolInitIndex:ve})):bt++}else if(Me&_e){if(bt>0)bt--;else if(Vt>0){for(ht=0;!Ve[Ve.length-1]._isolate;)Ve.pop();var ke=Ve[Ve.length-1]._isolInitIndex;ke!=null&&(De.set(ke,ve),De.set(ve,ke)),Ve.pop(),Vt--}at=Ve[Ve.length-1],de[ve]=at._level,at._override&&H(ve,at._override)}else Me&he?(bt===0&&(ht>0?ht--:!at._isolate&&Ve.length>1&&(Ve.pop(),at=Ve[Ve.length-1])),de[ve]=at._level):Me&q&&(de[ve]=we.level);else de[ve]=at._level,at._override&&Me!==K&&H(ve,at._override)}for(var gt=[],Qt=null,kt=we.start;kt<=we.end;kt++){var rn=Ne[kt];if(!(rn&c)){var ti=de[kt],ui=rn&s,vi=rn===_e;Qt&&ti===Qt._level?(Qt._end=kt,Qt._endsWithIsolInit=ui):gt.push(Qt={_start:kt,_end:kt,_level:ti,_startsWithPDI:vi,_endsWithIsolInit:ui})}}for(var yr=[],Ir=0;Ir<gt.length;Ir++){var qr=gt[Ir];if(!qr._startsWithPDI||qr._startsWithPDI&&!De.has(qr._start)){for(var Ki=[Qt=qr],Rr=void 0;Qt&&Qt._endsWithIsolInit&&(Rr=De.get(Qt._end))!=null;)for(var en=Ir+1;en<gt.length;en++)if(gt[en]._start===Rr){Ki.push(Qt=gt[en]);break}for(var di=[],hi=0;hi<Ki.length;hi++)for(var Y=Ki[hi],se=Y._start;se<=Y._end;se++)di.push(se);for(var ge=de[di[0]],Ue=we.level,je=di[0]-1;je>=0;je--)if(!(Ne[je]&c)){Ue=de[je];break}var Xe=di[di.length-1],xt=de[Xe],At=we.level;if(!(Ne[Xe]&s)){for(var Ct=Xe+1;Ct<=we.end;Ct++)if(!(Ne[Ct]&c)){At=de[Ct];break}}yr.push({_seqIndices:di,_sosType:Math.max(Ue,ge)%2?F:O,_eosType:Math.max(At,xt)%2?F:O})}}for(var Tt=0;Tt<yr.length;Tt++){var Dt=yr[Tt],He=Dt._seqIndices,J=Dt._sosType,pe=Dt._eosType,xe=de[He[0]]&1?F:O;if(Z.get(ce))for(var Se=0;Se<He.length;Se++){var be=He[Se];if(Ne[be]&ce){for(var ct=J,yt=Se-1;yt>=0;yt--)if(!(Ne[He[yt]]&c)){ct=Ne[He[yt]];break}H(be,ct&(s|_e)?Q:ct)}}if(Z.get(L))for(var ut=0;ut<He.length;ut++){var Ft=He[ut];if(Ne[Ft]&L)for(var wt=ut-1;wt>=-1;wt--){var Yt=wt===-1?J:Ne[He[wt]];if(Yt&a){Yt===ue&&H(Ft,j);break}}}if(Z.get(ue))for(var Bt=0;Bt<He.length;Bt++){var jt=He[Bt];Ne[jt]&ue&&H(jt,F)}if(Z.get(P)||Z.get(V))for(var yn=1;yn<He.length-1;yn++){var Kn=He[yn];if(Ne[Kn]&(P|V)){for(var Sn=0,zt=0,St=yn-1;St>=0&&(Sn=Ne[He[St]],!!(Sn&c));St--);for(var $t=yn+1;$t<He.length&&(zt=Ne[He[$t]],!!(zt&c));$t++);Sn===zt&&(Ne[Kn]===P?Sn===L:Sn&(L|j))&&H(Kn,Sn)}}if(Z.get(L))for(var Lt=0;Lt<He.length;Lt++){var ni=He[Lt];if(Ne[ni]&L){for(var $i=Lt-1;$i>=0&&Ne[He[$i]]&(W|c);$i--)H(He[$i],L);for(Lt++;Lt<He.length&&Ne[He[Lt]]&(W|c|L);Lt++)Ne[He[Lt]]!==L&&H(He[Lt],L)}}if(Z.get(W)||Z.get(P)||Z.get(V))for(var In=0;In<He.length;In++){var Oi=He[In];if(Ne[Oi]&(W|P|V)){H(Oi,Q);for(var $n=In-1;$n>=0&&Ne[He[$n]]&c;$n--)H(He[$n],Q);for(var Ji=In+1;Ji<He.length&&Ne[He[Ji]]&c;Ji++)H(He[Ji],Q)}}if(Z.get(L))for(var Zi=0,Br=J;Zi<He.length;Zi++){var Dr=He[Zi],Ho=Ne[Dr];Ho&L?Br===O&&H(Dr,O):Ho&a&&(Br=Ho)}if(Z.get(o)){var ps=F|L|j,ip=ps|O,eu=[];{for(var co=[],Gs=0;Gs<He.length;Gs++)if(Ne[He[Gs]]&o){var xl=ne[He[Gs]],ch=void 0;if(R(xl)!==null)if(co.length<63)co.push({char:xl,seqIndex:Gs});else break;else if((ch=B(xl))!==null)for(var Ga=co.length-1;Ga>=0;Ga--){var uo=co[Ga].char;if(uo===ch||uo===B(U(xl))||R(U(uo))===xl){eu.push([co[Ga].seqIndex,Gs]),co.length=Ga;break}}}eu.sort(function(Ms,Qa){return Ms[0]-Qa[0]})}for(var uh=0;uh<eu.length;uh++){for(var hh=eu[uh],tu=hh[0],_l=hh[1],Ha=!1,aa=0,Sl=tu+1;Sl<_l;Sl++){var Hs=He[Sl];if(Ne[Hs]&ip){Ha=!0;var fh=Ne[Hs]&ps?F:O;if(fh===xe){aa=fh;break}}}if(Ha&&!aa){aa=J;for(var Qo=tu-1;Qo>=0;Qo--){var nu=He[Qo];if(Ne[nu]&ip){var iu=Ne[nu]&ps?F:O;iu!==xe?aa=iu:aa=xe;break}}}if(aa){if(Ne[He[tu]]=Ne[He[_l]]=aa,aa!==xe){for(var ho=tu+1;ho<He.length;ho++)if(!(Ne[He[ho]]&c)){A(ne[He[ho]])&ce&&(Ne[He[ho]]=aa);break}}if(aa!==xe){for(var ru=_l+1;ru<He.length;ru++)if(!(Ne[He[ru]]&c)){A(ne[He[ru]])&ce&&(Ne[He[ru]]=aa);break}}}}for(var er=0;er<He.length;er++)if(Ne[He[er]]&o){for(var Vo=er,gc=er,El=J,su=er-1;su>=0;su--)if(Ne[He[su]]&c)Vo=su;else{El=Ne[He[su]]&ps?F:O;break}for(var au=pe,wl=er+1;wl<He.length;wl++)if(Ne[He[wl]]&(o|c))gc=wl;else{au=Ne[He[wl]]&ps?F:O;break}for(var Ml=Vo;Ml<=gc;Ml++)Ne[He[Ml]]=El===au?El:xe;er=gc}}}for(var Xr=we.start;Xr<=we.end;Xr++){var rp=de[Xr],dh=Ne[Xr];if(rp&1?dh&(O|L|j)&&de[Xr]++:dh&F?de[Xr]++:dh&(j|L)&&(de[Xr]+=2),dh&c&&(de[Xr]=Xr===0?we.level:de[Xr-1]),Xr===we.end||A(ne[Xr])&(re|q))for(var ph=Xr;ph>=0&&A(ne[ph])&h;ph--)de[ph]=we.level}}return{levels:de,paragraphs:Ie};function Ef(Ms,Qa){for(var Qs=Ms;Qs<ne.length;Qs++){var jo=Ne[Qs];if(jo&(F|ue))return 1;if(jo&(q|O)||Qa&&jo===_e)return 0;if(jo&s){var ou=wf(Qs);Qs=ou===-1?ne.length:ou}}return 0}function wf(Ms){for(var Qa=1,Qs=Ms+1;Qs<ne.length;Qs++){var jo=Ne[Qs];if(jo&q)break;if(jo&_e){if(--Qa===0)return Qs}else jo&s&&Qa++}return-1}}var et="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",ot;function Je(){if(!ot){var ne=S(et,!0),ft=ne.map,qe=ne.reverseMap;qe.forEach(function(Ne,tt){ft.set(tt,Ne)}),ot=ft}}function _t(ne){return Je(),ot.get(ne)||null}function Be(ne,ft,qe,Ne){var tt=ne.length;qe=Math.max(0,qe==null?0:+qe),Ne=Math.min(tt-1,Ne==null?tt-1:+Ne);for(var Z=new Map,H=qe;H<=Ne;H++)if(ft[H]&1){var de=_t(ne[H]);de!==null&&Z.set(H,de)}return Z}function Le(ne,ft,qe,Ne){var tt=ne.length;qe=Math.max(0,qe==null?0:+qe),Ne=Math.min(tt-1,Ne==null?tt-1:+Ne);var Z=[];return ft.paragraphs.forEach(function(H){var de=Math.max(qe,H.start),De=Math.min(Ne,H.end);if(de<De){for(var Ie=ft.levels.slice(de,De+1),we=De;we>=de&&A(ne[we])&h;we--)Ie[we]=H.level;for(var st=H.level,it=1/0,It=0;It<Ie.length;It++){var Ot=Ie[It];Ot>st&&(st=Ot),Ot<it&&(it=Ot|1)}for(var Qe=st;Qe>=it;Qe--)for(var Ve=0;Ve<Ie.length;Ve++)if(Ie[Ve]>=Qe){for(var at=Ve;Ve+1<Ie.length&&Ie[Ve+1]>=Qe;)Ve++;Ve>at&&Z.push([at+de,Ve+de])}}}),Z}function Te(ne,ft,qe,Ne){var tt=Ye(ne,ft,qe,Ne),Z=[].concat(ne);return tt.forEach(function(H,de){Z[de]=(ft.levels[H]&1?_t(ne[H]):null)||ne[H]}),Z.join("")}function Ye(ne,ft,qe,Ne){for(var tt=Le(ne,ft,qe,Ne),Z=[],H=0;H<ne.length;H++)Z[H]=H;return tt.forEach(function(de){for(var De=de[0],Ie=de[1],we=Z.slice(De,Ie+1),st=we.length;st--;)Z[Ie-st]=we[st]}),Z}return e.closingToOpeningBracket=B,e.getBidiCharType=A,e.getBidiCharTypeName=v,e.getCanonicalBracket=U,e.getEmbeddingLevels=Pe,e.getMirroredCharacter=_t,e.getMirroredCharactersMap=Be,e.getReorderSegments=Le,e.getReorderedIndices=Ye,e.getReorderedString=Te,e.openingToClosingBracket=R,Object.defineProperty(e,"__esModule",{value:!0}),e})({});return n}const EG=/\bvoid\s+main\s*\(\s*\)\s*{/g;function S2(n){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function t(i,r){let s=kn[r];return s?S2(s):i}return n.replace(e,t)}const ga=[];for(let n=0;n<256;n++)ga[n]=(n<16?"0":"")+n.toString(16);function Lce(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(ga[n&255]+ga[n>>8&255]+ga[n>>16&255]+ga[n>>24&255]+"-"+ga[e&255]+ga[e>>8&255]+"-"+ga[e>>16&15|64]+ga[e>>24&255]+"-"+ga[t&63|128]+ga[t>>8&255]+"-"+ga[t>>16&255]+ga[t>>24&255]+ga[i&255]+ga[i>>8&255]+ga[i>>16&255]+ga[i>>24&255]).toUpperCase()}const sm=Object.assign||function(){let n=arguments[0];for(let e=1,t=arguments.length;e<t;e++){let i=arguments[e];if(i)for(let r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},Nce=Date.now(),WO=new WeakMap,qO=new Map;let Uce=1e10;function E2(n,e){const t=kce(e);let i=WO.get(n);if(i||WO.set(n,i=Object.create(null)),i[t])return new i[t];const r=`_onBeforeCompile${t}`,s=function(h,p){n.onBeforeCompile.call(this,h,p);const g=this.customProgramCacheKey()+"|"+h.vertexShader+"|"+h.fragmentShader;let A=qO[g];if(!A){const v=Fce(this,h,e,t);A=qO[g]=v}h.vertexShader=A.vertexShader,h.fragmentShader=A.fragmentShader,sm(h.uniforms,this.uniforms),e.timeUniform&&(h.uniforms[e.timeUniform]={get value(){return Date.now()-Nce}}),this[r]&&this[r](h)},a=function(){return o(e.chained?n:n.clone())},o=function(h){const p=Object.create(h,c);return Object.defineProperty(p,"baseMaterial",{value:n}),Object.defineProperty(p,"id",{value:Uce++}),p.uuid=Lce(),p.uniforms=sm({},h.uniforms,e.uniforms),p.defines=sm({},h.defines,e.defines),p.defines[`TROIKA_DERIVED_MATERIAL_${t}`]="",p.extensions=sm({},h.extensions,e.extensions),p._listeners=void 0,p},c={constructor:{value:a},isDerivedMaterial:{value:!0},type:{get:()=>n.type,set:h=>{n.type=h}},isDerivedFrom:{writable:!0,configurable:!0,value:function(h){const p=this.baseMaterial;return h===p||p.isDerivedMaterial&&p.isDerivedFrom(h)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return n.customProgramCacheKey()+"|"+t}},onBeforeCompile:{get(){return s},set(h){this[r]=h}},copy:{writable:!0,configurable:!0,value:function(h){return n.copy.call(this,h),!n.isShaderMaterial&&!n.isDerivedMaterial&&(sm(this.extensions,h.extensions),sm(this.defines,h.defines),sm(this.uniforms,l4.clone(h.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const h=new n.constructor;return o(h).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let h=this._depthMaterial;return h||(h=this._depthMaterial=E2(n.isDerivedMaterial?n.getDepthMaterial():new sx({depthPacking:c8}),e),h.defines.IS_DEPTH_MATERIAL="",h.uniforms=this.uniforms),h}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let h=this._distanceMaterial;return h||(h=this._distanceMaterial=E2(n.isDerivedMaterial?n.getDistanceMaterial():new jM,e),h.defines.IS_DISTANCE_MATERIAL="",h.uniforms=this.uniforms),h}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:h,_distanceMaterial:p}=this;h&&h.dispose(),p&&p.dispose(),n.dispose.call(this)}}};return i[t]=a,new a}function Fce(n,{vertexShader:e,fragmentShader:t},i,r){let{vertexDefs:s,vertexMainIntro:a,vertexMainOutro:o,vertexTransform:c,fragmentDefs:h,fragmentMainIntro:p,fragmentMainOutro:g,fragmentColorTransform:A,customRewriter:v,timeUniform:x}=i;if(s=s||"",a=a||"",o=o||"",h=h||"",p=p||"",g=g||"",(c||v)&&(e=S2(e)),(A||v)&&(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),t=S2(t)),v){let S=v({vertexShader:e,fragmentShader:t});e=S.vertexShader,t=S.fragmentShader}if(A){let S=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,_=>(S.push(_),"")),g=`${A}
${S.join(`
`)}
${g}`}if(x){const S=`
uniform float ${x};
`;s=S+s,h=S+h}return c&&(e=`vec3 troika_position_${r};
vec3 troika_normal_${r};
vec2 troika_uv_${r};
${e}
`,s=`${s}
void troikaVertexTransform${r}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${c}
}
`,a=`
troika_position_${r} = vec3(position);
troika_normal_${r} = vec3(normal);
troika_uv_${r} = vec2(uv);
troikaVertexTransform${r}(troika_position_${r}, troika_normal_${r}, troika_uv_${r});
${a}
`,e=e.replace(/\b(position|normal|uv)\b/g,(S,_,E,C)=>/\battribute\s+vec[23]\s+$/.test(C.substr(0,E))?_:`troika_${_}_${r}`),n.map&&n.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${r}`))),e=XO(e,r,s,a,o),t=XO(t,r,h,p,g),{vertexShader:e,fragmentShader:t}}function XO(n,e,t,i,r){return(i||r||t)&&(n=n.replace(EG,`
${t}
void troikaOrigMain${e}() {`),n+=`
void main() {
  ${i}
  troikaOrigMain${e}();
  ${r}
}`),n}function Pce(n,e){return n==="uniforms"?void 0:typeof e=="function"?e.toString():e}let Oce=0;const YO=new Map;function kce(n){const e=JSON.stringify(n,Pce);let t=YO.get(e);return t==null&&YO.set(e,t=++Oce),t}function zce(){return typeof window>"u"&&(self.window=self),(function(n){var e={parse:function(r){var s=e._bin,a=new Uint8Array(r);if(s.readASCII(a,0,4)=="ttcf"){var o=4;s.readUshort(a,o),o+=2,s.readUshort(a,o),o+=2;var c=s.readUint(a,o);o+=4;for(var h=[],p=0;p<c;p++){var g=s.readUint(a,o);o+=4,h.push(e._readFont(a,g))}return h}return[e._readFont(a,0)]},_readFont:function(r,s){var a=e._bin,o=s;a.readFixed(r,s),s+=4;var c=a.readUshort(r,s);s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2;for(var h=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],p={_data:r,_offset:o},g={},A=0;A<c;A++){var v=a.readASCII(r,s,4);s+=4,a.readUint(r,s),s+=4;var x=a.readUint(r,s);s+=4;var S=a.readUint(r,s);s+=4,g[v]={offset:x,length:S}}for(A=0;A<h.length;A++){var _=h[A];g[_]&&(p[_.trim()]=e[_.trim()].parse(r,g[_].offset,g[_].length,p))}return p},_tabOffset:function(r,s,a){for(var o=e._bin,c=o.readUshort(r,a+4),h=a+12,p=0;p<c;p++){var g=o.readASCII(r,h,4);h+=4,o.readUint(r,h),h+=4;var A=o.readUint(r,h);if(h+=4,o.readUint(r,h),h+=4,g==s)return A}return 0}};e._bin={readFixed:function(r,s){return(r[s]<<8|r[s+1])+(r[s+2]<<8|r[s+3])/65540},readF2dot14:function(r,s){return e._bin.readShort(r,s)/16384},readInt:function(r,s){return e._bin._view(r).getInt32(s)},readInt8:function(r,s){return e._bin._view(r).getInt8(s)},readShort:function(r,s){return e._bin._view(r).getInt16(s)},readUshort:function(r,s){return e._bin._view(r).getUint16(s)},readUshorts:function(r,s,a){for(var o=[],c=0;c<a;c++)o.push(e._bin.readUshort(r,s+2*c));return o},readUint:function(r,s){return e._bin._view(r).getUint32(s)},readUint64:function(r,s){return 4294967296*e._bin.readUint(r,s)+e._bin.readUint(r,s+4)},readASCII:function(r,s,a){for(var o="",c=0;c<a;c++)o+=String.fromCharCode(r[s+c]);return o},readUnicode:function(r,s,a){for(var o="",c=0;c<a;c++){var h=r[s++]<<8|r[s++];o+=String.fromCharCode(h)}return o},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,s,a){var o=e._bin._tdec;return o&&s==0&&a==r.length?o.decode(r):e._bin.readASCII(r,s,a)},readBytes:function(r,s,a){for(var o=[],c=0;c<a;c++)o.push(r[s+c]);return o},readASCIIArray:function(r,s,a){for(var o=[],c=0;c<a;c++)o.push(String.fromCharCode(r[s+c]));return o},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},e._lctf={},e._lctf.parse=function(r,s,a,o,c){var h=e._bin,p={},g=s;h.readFixed(r,s),s+=4;var A=h.readUshort(r,s);s+=2;var v=h.readUshort(r,s);s+=2;var x=h.readUshort(r,s);return s+=2,p.scriptList=e._lctf.readScriptList(r,g+A),p.featureList=e._lctf.readFeatureList(r,g+v),p.lookupList=e._lctf.readLookupList(r,g+x,c),p},e._lctf.readLookupList=function(r,s,a){var o=e._bin,c=s,h=[],p=o.readUshort(r,s);s+=2;for(var g=0;g<p;g++){var A=o.readUshort(r,s);s+=2;var v=e._lctf.readLookupTable(r,c+A,a);h.push(v)}return h},e._lctf.readLookupTable=function(r,s,a){var o=e._bin,c=s,h={tabs:[]};h.ltype=o.readUshort(r,s),s+=2,h.flag=o.readUshort(r,s),s+=2;var p=o.readUshort(r,s);s+=2;for(var g=h.ltype,A=0;A<p;A++){var v=o.readUshort(r,s);s+=2;var x=a(r,g,c+v,h);h.tabs.push(x)}return h},e._lctf.numOfOnes=function(r){for(var s=0,a=0;a<32;a++)(r>>>a&1)!=0&&s++;return s},e._lctf.readClassDef=function(r,s){var a=e._bin,o=[],c=a.readUshort(r,s);if(s+=2,c==1){var h=a.readUshort(r,s);s+=2;var p=a.readUshort(r,s);s+=2;for(var g=0;g<p;g++)o.push(h+g),o.push(h+g),o.push(a.readUshort(r,s)),s+=2}if(c==2){var A=a.readUshort(r,s);for(s+=2,g=0;g<A;g++)o.push(a.readUshort(r,s)),s+=2,o.push(a.readUshort(r,s)),s+=2,o.push(a.readUshort(r,s)),s+=2}return o},e._lctf.getInterval=function(r,s){for(var a=0;a<r.length;a+=3){var o=r[a],c=r[a+1];if(r[a+2],o<=s&&s<=c)return a}return-1},e._lctf.readCoverage=function(r,s){var a=e._bin,o={};o.fmt=a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);return s+=2,o.fmt==1&&(o.tab=a.readUshorts(r,s,c)),o.fmt==2&&(o.tab=a.readUshorts(r,s,3*c)),o},e._lctf.coverageIndex=function(r,s){var a=r.tab;if(r.fmt==1)return a.indexOf(s);if(r.fmt==2){var o=e._lctf.getInterval(a,s);if(o!=-1)return a[o+2]+(s-a[o])}return-1},e._lctf.readFeatureList=function(r,s){var a=e._bin,o=s,c=[],h=a.readUshort(r,s);s+=2;for(var p=0;p<h;p++){var g=a.readASCII(r,s,4);s+=4;var A=a.readUshort(r,s);s+=2;var v=e._lctf.readFeatureTable(r,o+A);v.tag=g.trim(),c.push(v)}return c},e._lctf.readFeatureTable=function(r,s){var a=e._bin,o=s,c={},h=a.readUshort(r,s);s+=2,h>0&&(c.featureParams=o+h);var p=a.readUshort(r,s);s+=2,c.tab=[];for(var g=0;g<p;g++)c.tab.push(a.readUshort(r,s+2*g));return c},e._lctf.readScriptList=function(r,s){var a=e._bin,o=s,c={},h=a.readUshort(r,s);s+=2;for(var p=0;p<h;p++){var g=a.readASCII(r,s,4);s+=4;var A=a.readUshort(r,s);s+=2,c[g.trim()]=e._lctf.readScriptTable(r,o+A)}return c},e._lctf.readScriptTable=function(r,s){var a=e._bin,o=s,c={},h=a.readUshort(r,s);s+=2,h>0&&(c.default=e._lctf.readLangSysTable(r,o+h));var p=a.readUshort(r,s);s+=2;for(var g=0;g<p;g++){var A=a.readASCII(r,s,4);s+=4;var v=a.readUshort(r,s);s+=2,c[A.trim()]=e._lctf.readLangSysTable(r,o+v)}return c},e._lctf.readLangSysTable=function(r,s){var a=e._bin,o={};a.readUshort(r,s),s+=2,o.reqFeature=a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);return s+=2,o.features=a.readUshorts(r,s,c),o},e.CFF={},e.CFF.parse=function(r,s,a){var o=e._bin;(r=new Uint8Array(r.buffer,s,a))[s=0],r[++s],r[++s],r[++s],s++;var c=[];s=e.CFF.readIndex(r,s,c);for(var h=[],p=0;p<c.length-1;p++)h.push(o.readASCII(r,s+c[p],c[p+1]-c[p]));s+=c[c.length-1];var g=[];s=e.CFF.readIndex(r,s,g);var A=[];for(p=0;p<g.length-1;p++)A.push(e.CFF.readDict(r,s+g[p],s+g[p+1]));s+=g[g.length-1];var v=A[0],x=[];s=e.CFF.readIndex(r,s,x);var S=[];for(p=0;p<x.length-1;p++)S.push(o.readASCII(r,s+x[p],x[p+1]-x[p]));if(s+=x[x.length-1],e.CFF.readSubrs(r,s,v),v.CharStrings){s=v.CharStrings,x=[],s=e.CFF.readIndex(r,s,x);var _=[];for(p=0;p<x.length-1;p++)_.push(o.readBytes(r,s+x[p],x[p+1]-x[p]));v.CharStrings=_}if(v.ROS){s=v.FDArray;var E=[];for(s=e.CFF.readIndex(r,s,E),v.FDArray=[],p=0;p<E.length-1;p++){var C=e.CFF.readDict(r,s+E[p],s+E[p+1]);e.CFF._readFDict(r,C,S),v.FDArray.push(C)}s+=E[E.length-1],s=v.FDSelect,v.FDSelect=[];var T=r[s];if(s++,T!=3)throw T;var R=o.readUshort(r,s);for(s+=2,p=0;p<R+1;p++)v.FDSelect.push(o.readUshort(r,s),r[s+2]),s+=3}return v.Encoding&&(v.Encoding=e.CFF.readEncoding(r,v.Encoding,v.CharStrings.length)),v.charset&&(v.charset=e.CFF.readCharset(r,v.charset,v.CharStrings.length)),e.CFF._readFDict(r,v,S),v},e.CFF._readFDict=function(r,s,a){var o;for(var c in s.Private&&(o=s.Private[1],s.Private=e.CFF.readDict(r,o,o+s.Private[0]),s.Private.Subrs&&e.CFF.readSubrs(r,o+s.Private.Subrs,s.Private)),s)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(c)!=-1&&(s[c]=a[s[c]-426+35])},e.CFF.readSubrs=function(r,s,a){var o=e._bin,c=[];s=e.CFF.readIndex(r,s,c);var h,p=c.length;h=p<1240?107:p<33900?1131:32768,a.Bias=h,a.Subrs=[];for(var g=0;g<c.length-1;g++)a.Subrs.push(o.readBytes(r,s+c[g],c[g+1]-c[g]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(r,s){for(var a=0;a<r.charset.length;a++)if(r.charset[a]==s)return a;return-1},e.CFF.glyphBySE=function(r,s){return s<0||s>255?-1:e.CFF.glyphByUnicode(r,e.CFF.tableSE[s])},e.CFF.readEncoding=function(r,s,a){e._bin;var o=[".notdef"],c=r[s];if(s++,c!=0)throw"error: unknown encoding format: "+c;var h=r[s];s++;for(var p=0;p<h;p++)o.push(r[s+p]);return o},e.CFF.readCharset=function(r,s,a){var o=e._bin,c=[".notdef"],h=r[s];if(s++,h==0)for(var p=0;p<a;p++){var g=o.readUshort(r,s);s+=2,c.push(g)}else{if(h!=1&&h!=2)throw"error: format: "+h;for(;c.length<a;){g=o.readUshort(r,s),s+=2;var A=0;for(h==1?(A=r[s],s++):(A=o.readUshort(r,s),s+=2),p=0;p<=A;p++)c.push(g),g++}}return c},e.CFF.readIndex=function(r,s,a){var o=e._bin,c=o.readUshort(r,s)+1,h=r[s+=2];if(s++,h==1)for(var p=0;p<c;p++)a.push(r[s+p]);else if(h==2)for(p=0;p<c;p++)a.push(o.readUshort(r,s+2*p));else if(h==3)for(p=0;p<c;p++)a.push(16777215&o.readUint(r,s+3*p-1));else if(c!=1)throw"unsupported offset size: "+h+", count: "+c;return(s+=c*h)-1},e.CFF.getCharString=function(r,s,a){var o=e._bin,c=r[s],h=r[s+1];r[s+2],r[s+3],r[s+4];var p=1,g=null,A=null;c<=20&&(g=c,p=1),c==12&&(g=100*c+h,p=2),21<=c&&c<=27&&(g=c,p=1),c==28&&(A=o.readShort(r,s+1),p=3),29<=c&&c<=31&&(g=c,p=1),32<=c&&c<=246&&(A=c-139,p=1),247<=c&&c<=250&&(A=256*(c-247)+h+108,p=2),251<=c&&c<=254&&(A=256*-(c-251)-h-108,p=2),c==255&&(A=o.readInt(r,s+1)/65535,p=5),a.val=A??"o"+g,a.size=p},e.CFF.readCharString=function(r,s,a){for(var o=s+a,c=e._bin,h=[];s<o;){var p=r[s],g=r[s+1];r[s+2],r[s+3],r[s+4];var A=1,v=null,x=null;p<=20&&(v=p,A=1),p==12&&(v=100*p+g,A=2),p!=19&&p!=20||(v=p,A=2),21<=p&&p<=27&&(v=p,A=1),p==28&&(x=c.readShort(r,s+1),A=3),29<=p&&p<=31&&(v=p,A=1),32<=p&&p<=246&&(x=p-139,A=1),247<=p&&p<=250&&(x=256*(p-247)+g+108,A=2),251<=p&&p<=254&&(x=256*-(p-251)-g-108,A=2),p==255&&(x=c.readInt(r,s+1)/65535,A=5),h.push(x??"o"+v),s+=A}return h},e.CFF.readDict=function(r,s,a){for(var o=e._bin,c={},h=[];s<a;){var p=r[s],g=r[s+1];r[s+2],r[s+3],r[s+4];var A=1,v=null,x=null;if(p==28&&(x=o.readShort(r,s+1),A=3),p==29&&(x=o.readInt(r,s+1),A=5),32<=p&&p<=246&&(x=p-139,A=1),247<=p&&p<=250&&(x=256*(p-247)+g+108,A=2),251<=p&&p<=254&&(x=256*-(p-251)-g-108,A=2),p==255)throw x=o.readInt(r,s+1)/65535,A=5,"unknown number";if(p==30){var S=[];for(A=1;;){var _=r[s+A];A++;var E=_>>4,C=15&_;if(E!=15&&S.push(E),C!=15&&S.push(C),C==15)break}for(var T="",R=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],B=0;B<S.length;B++)T+=R[S[B]];x=parseFloat(T)}p<=21&&(v=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][p],A=1,p==12&&(v=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][g],A=2)),v!=null?(c[v]=h.length==1?h[0]:h,h=[]):h.push(x),s+=A}return c},e.cmap={},e.cmap.parse=function(r,s,a){r=new Uint8Array(r.buffer,s,a),s=0;var o=e._bin,c={};o.readUshort(r,s),s+=2;var h=o.readUshort(r,s);s+=2;var p=[];c.tables=[];for(var g=0;g<h;g++){var A=o.readUshort(r,s);s+=2;var v=o.readUshort(r,s);s+=2;var x=o.readUint(r,s);s+=4;var S="p"+A+"e"+v,_=p.indexOf(x);if(_==-1){var E;_=c.tables.length,p.push(x);var C=o.readUshort(r,x);C==0?E=e.cmap.parse0(r,x):C==4?E=e.cmap.parse4(r,x):C==6?E=e.cmap.parse6(r,x):C==12?E=e.cmap.parse12(r,x):console.debug("unknown format: "+C,A,v,x),c.tables.push(E)}if(c[S]!=null)throw"multiple tables for one platform+encoding";c[S]=_}return c},e.cmap.parse0=function(r,s){var a=e._bin,o={};o.format=a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);s+=2,a.readUshort(r,s),s+=2,o.map=[];for(var h=0;h<c-6;h++)o.map.push(r[s+h]);return o},e.cmap.parse4=function(r,s){var a=e._bin,o=s,c={};c.format=a.readUshort(r,s),s+=2;var h=a.readUshort(r,s);s+=2,a.readUshort(r,s),s+=2;var p=a.readUshort(r,s);s+=2;var g=p/2;c.searchRange=a.readUshort(r,s),s+=2,c.entrySelector=a.readUshort(r,s),s+=2,c.rangeShift=a.readUshort(r,s),s+=2,c.endCount=a.readUshorts(r,s,g),s+=2*g,s+=2,c.startCount=a.readUshorts(r,s,g),s+=2*g,c.idDelta=[];for(var A=0;A<g;A++)c.idDelta.push(a.readShort(r,s)),s+=2;for(c.idRangeOffset=a.readUshorts(r,s,g),s+=2*g,c.glyphIdArray=[];s<o+h;)c.glyphIdArray.push(a.readUshort(r,s)),s+=2;return c},e.cmap.parse6=function(r,s){var a=e._bin,o={};o.format=a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2,o.firstCode=a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);s+=2,o.glyphIdArray=[];for(var h=0;h<c;h++)o.glyphIdArray.push(a.readUshort(r,s)),s+=2;return o},e.cmap.parse12=function(r,s){var a=e._bin,o={};o.format=a.readUshort(r,s),s+=2,s+=2,a.readUint(r,s),s+=4,a.readUint(r,s),s+=4;var c=a.readUint(r,s);s+=4,o.groups=[];for(var h=0;h<c;h++){var p=s+12*h,g=a.readUint(r,p+0),A=a.readUint(r,p+4),v=a.readUint(r,p+8);o.groups.push([g,A,v])}return o},e.glyf={},e.glyf.parse=function(r,s,a,o){for(var c=[],h=0;h<o.maxp.numGlyphs;h++)c.push(null);return c},e.glyf._parseGlyf=function(r,s){var a=e._bin,o=r._data,c=e._tabOffset(o,"glyf",r._offset)+r.loca[s];if(r.loca[s]==r.loca[s+1])return null;var h={};if(h.noc=a.readShort(o,c),c+=2,h.xMin=a.readShort(o,c),c+=2,h.yMin=a.readShort(o,c),c+=2,h.xMax=a.readShort(o,c),c+=2,h.yMax=a.readShort(o,c),c+=2,h.xMin>=h.xMax||h.yMin>=h.yMax)return null;if(h.noc>0){h.endPts=[];for(var p=0;p<h.noc;p++)h.endPts.push(a.readUshort(o,c)),c+=2;var g=a.readUshort(o,c);if(c+=2,o.length-c<g)return null;h.instructions=a.readBytes(o,c,g),c+=g;var A=h.endPts[h.noc-1]+1;for(h.flags=[],p=0;p<A;p++){var v=o[c];if(c++,h.flags.push(v),(8&v)!=0){var x=o[c];c++;for(var S=0;S<x;S++)h.flags.push(v),p++}}for(h.xs=[],p=0;p<A;p++){var _=(2&h.flags[p])!=0,E=(16&h.flags[p])!=0;_?(h.xs.push(E?o[c]:-o[c]),c++):E?h.xs.push(0):(h.xs.push(a.readShort(o,c)),c+=2)}for(h.ys=[],p=0;p<A;p++)_=(4&h.flags[p])!=0,E=(32&h.flags[p])!=0,_?(h.ys.push(E?o[c]:-o[c]),c++):E?h.ys.push(0):(h.ys.push(a.readShort(o,c)),c+=2);var C=0,T=0;for(p=0;p<A;p++)C+=h.xs[p],T+=h.ys[p],h.xs[p]=C,h.ys[p]=T}else{var R;h.parts=[];do{R=a.readUshort(o,c),c+=2;var B={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(h.parts.push(B),B.glyphIndex=a.readUshort(o,c),c+=2,1&R){var U=a.readShort(o,c);c+=2;var O=a.readShort(o,c);c+=2}else U=a.readInt8(o,c),c++,O=a.readInt8(o,c),c++;2&R?(B.m.tx=U,B.m.ty=O):(B.p1=U,B.p2=O),8&R?(B.m.a=B.m.d=a.readF2dot14(o,c),c+=2):64&R?(B.m.a=a.readF2dot14(o,c),c+=2,B.m.d=a.readF2dot14(o,c),c+=2):128&R&&(B.m.a=a.readF2dot14(o,c),c+=2,B.m.b=a.readF2dot14(o,c),c+=2,B.m.c=a.readF2dot14(o,c),c+=2,B.m.d=a.readF2dot14(o,c),c+=2)}while(32&R);if(256&R){var F=a.readUshort(o,c);for(c+=2,h.instr=[],p=0;p<F;p++)h.instr.push(o[c]),c++}}return h},e.GDEF={},e.GDEF.parse=function(r,s,a,o){var c=s;s+=4;var h=e._bin.readUshort(r,s);return{glyphClassDef:h===0?null:e._lctf.readClassDef(r,c+h)}},e.GPOS={},e.GPOS.parse=function(r,s,a,o){return e._lctf.parse(r,s,a,o,e.GPOS.subt)},e.GPOS.subt=function(r,s,a,o){var c=e._bin,h=a,p={};if(p.fmt=c.readUshort(r,a),a+=2,s==1||s==2||s==3||s==7||s==8&&p.fmt<=2){var g=c.readUshort(r,a);a+=2,p.coverage=e._lctf.readCoverage(r,g+h)}if(s==1&&p.fmt==1){var A=c.readUshort(r,a);a+=2,A!=0&&(p.pos=e.GPOS.readValueRecord(r,a,A))}else if(s==2&&p.fmt>=1&&p.fmt<=2){A=c.readUshort(r,a),a+=2;var v=c.readUshort(r,a);a+=2;var x=e._lctf.numOfOnes(A),S=e._lctf.numOfOnes(v);if(p.fmt==1){p.pairsets=[];var _=c.readUshort(r,a);a+=2;for(var E=0;E<_;E++){var C=h+c.readUshort(r,a);a+=2;var T=c.readUshort(r,C);C+=2;for(var R=[],B=0;B<T;B++){var U=c.readUshort(r,C);C+=2,A!=0&&(j=e.GPOS.readValueRecord(r,C,A),C+=2*x),v!=0&&(V=e.GPOS.readValueRecord(r,C,v),C+=2*S),R.push({gid2:U,val1:j,val2:V})}p.pairsets.push(R)}}if(p.fmt==2){var O=c.readUshort(r,a);a+=2;var F=c.readUshort(r,a);a+=2;var L=c.readUshort(r,a);a+=2;var P=c.readUshort(r,a);for(a+=2,p.classDef1=e._lctf.readClassDef(r,h+O),p.classDef2=e._lctf.readClassDef(r,h+F),p.matrix=[],E=0;E<L;E++){var W=[];for(B=0;B<P;B++){var j=null,V=null;A!=0&&(j=e.GPOS.readValueRecord(r,a,A),a+=2*x),v!=0&&(V=e.GPOS.readValueRecord(r,a,v),a+=2*S),W.push({val1:j,val2:V})}p.matrix.push(W)}}}else if(s==4&&p.fmt==1)p.markCoverage=e._lctf.readCoverage(r,c.readUshort(r,a)+h),p.baseCoverage=e._lctf.readCoverage(r,c.readUshort(r,a+2)+h),p.markClassCount=c.readUshort(r,a+4),p.markArray=e.GPOS.readMarkArray(r,c.readUshort(r,a+6)+h),p.baseArray=e.GPOS.readBaseArray(r,c.readUshort(r,a+8)+h,p.markClassCount);else if(s==6&&p.fmt==1)p.mark1Coverage=e._lctf.readCoverage(r,c.readUshort(r,a)+h),p.mark2Coverage=e._lctf.readCoverage(r,c.readUshort(r,a+2)+h),p.markClassCount=c.readUshort(r,a+4),p.mark1Array=e.GPOS.readMarkArray(r,c.readUshort(r,a+6)+h),p.mark2Array=e.GPOS.readBaseArray(r,c.readUshort(r,a+8)+h,p.markClassCount);else{if(s==9&&p.fmt==1){var q=c.readUshort(r,a);a+=2;var re=c.readUint(r,a);if(a+=4,o.ltype==9)o.ltype=q;else if(o.ltype!=q)throw"invalid extension substitution";return e.GPOS.subt(r,o.ltype,h+re)}console.debug("unsupported GPOS table LookupType",s,"format",p.fmt)}return p},e.GPOS.readValueRecord=function(r,s,a){var o=e._bin,c=[];return c.push(1&a?o.readShort(r,s):0),s+=1&a?2:0,c.push(2&a?o.readShort(r,s):0),s+=2&a?2:0,c.push(4&a?o.readShort(r,s):0),s+=4&a?2:0,c.push(8&a?o.readShort(r,s):0),s+=8&a?2:0,c},e.GPOS.readBaseArray=function(r,s,a){var o=e._bin,c=[],h=s,p=o.readUshort(r,s);s+=2;for(var g=0;g<p;g++){for(var A=[],v=0;v<a;v++)A.push(e.GPOS.readAnchorRecord(r,h+o.readUshort(r,s))),s+=2;c.push(A)}return c},e.GPOS.readMarkArray=function(r,s){var a=e._bin,o=[],c=s,h=a.readUshort(r,s);s+=2;for(var p=0;p<h;p++){var g=e.GPOS.readAnchorRecord(r,a.readUshort(r,s+2)+c);g.markClass=a.readUshort(r,s),o.push(g),s+=4}return o},e.GPOS.readAnchorRecord=function(r,s){var a=e._bin,o={};return o.fmt=a.readUshort(r,s),o.x=a.readShort(r,s+2),o.y=a.readShort(r,s+4),o},e.GSUB={},e.GSUB.parse=function(r,s,a,o){return e._lctf.parse(r,s,a,o,e.GSUB.subt)},e.GSUB.subt=function(r,s,a,o){var c=e._bin,h=a,p={};if(p.fmt=c.readUshort(r,a),a+=2,s!=1&&s!=2&&s!=4&&s!=5&&s!=6)return null;if(s==1||s==2||s==4||s==5&&p.fmt<=2||s==6&&p.fmt<=2){var g=c.readUshort(r,a);a+=2,p.coverage=e._lctf.readCoverage(r,h+g)}if(s==1&&p.fmt>=1&&p.fmt<=2){if(p.fmt==1)p.delta=c.readShort(r,a),a+=2;else if(p.fmt==2){var A=c.readUshort(r,a);a+=2,p.newg=c.readUshorts(r,a,A),a+=2*p.newg.length}}else if(s==2&&p.fmt==1){A=c.readUshort(r,a),a+=2,p.seqs=[];for(var v=0;v<A;v++){var x=c.readUshort(r,a)+h;a+=2;var S=c.readUshort(r,x);p.seqs.push(c.readUshorts(r,x+2,S))}}else if(s==4)for(p.vals=[],A=c.readUshort(r,a),a+=2,v=0;v<A;v++){var _=c.readUshort(r,a);a+=2,p.vals.push(e.GSUB.readLigatureSet(r,h+_))}else if(s==5&&p.fmt==2){if(p.fmt==2){var E=c.readUshort(r,a);a+=2,p.cDef=e._lctf.readClassDef(r,h+E),p.scset=[];var C=c.readUshort(r,a);for(a+=2,v=0;v<C;v++){var T=c.readUshort(r,a);a+=2,p.scset.push(T==0?null:e.GSUB.readSubClassSet(r,h+T))}}}else if(s==6&&p.fmt==3){if(p.fmt==3){for(v=0;v<3;v++){A=c.readUshort(r,a),a+=2;for(var R=[],B=0;B<A;B++)R.push(e._lctf.readCoverage(r,h+c.readUshort(r,a+2*B)));a+=2*A,v==0&&(p.backCvg=R),v==1&&(p.inptCvg=R),v==2&&(p.ahedCvg=R)}A=c.readUshort(r,a),a+=2,p.lookupRec=e.GSUB.readSubstLookupRecords(r,a,A)}}else{if(s==7&&p.fmt==1){var U=c.readUshort(r,a);a+=2;var O=c.readUint(r,a);if(a+=4,o.ltype==9)o.ltype=U;else if(o.ltype!=U)throw"invalid extension substitution";return e.GSUB.subt(r,o.ltype,h+O)}console.debug("unsupported GSUB table LookupType",s,"format",p.fmt)}return p},e.GSUB.readSubClassSet=function(r,s){var a=e._bin.readUshort,o=s,c=[],h=a(r,s);s+=2;for(var p=0;p<h;p++){var g=a(r,s);s+=2,c.push(e.GSUB.readSubClassRule(r,o+g))}return c},e.GSUB.readSubClassRule=function(r,s){var a=e._bin.readUshort,o={},c=a(r,s),h=a(r,s+=2);s+=2,o.input=[];for(var p=0;p<c-1;p++)o.input.push(a(r,s)),s+=2;return o.substLookupRecords=e.GSUB.readSubstLookupRecords(r,s,h),o},e.GSUB.readSubstLookupRecords=function(r,s,a){for(var o=e._bin.readUshort,c=[],h=0;h<a;h++)c.push(o(r,s),o(r,s+2)),s+=4;return c},e.GSUB.readChainSubClassSet=function(r,s){var a=e._bin,o=s,c=[],h=a.readUshort(r,s);s+=2;for(var p=0;p<h;p++){var g=a.readUshort(r,s);s+=2,c.push(e.GSUB.readChainSubClassRule(r,o+g))}return c},e.GSUB.readChainSubClassRule=function(r,s){for(var a=e._bin,o={},c=["backtrack","input","lookahead"],h=0;h<c.length;h++){var p=a.readUshort(r,s);s+=2,h==1&&p--,o[c[h]]=a.readUshorts(r,s,p),s+=2*o[c[h]].length}return p=a.readUshort(r,s),s+=2,o.subst=a.readUshorts(r,s,2*p),s+=2*o.subst.length,o},e.GSUB.readLigatureSet=function(r,s){var a=e._bin,o=s,c=[],h=a.readUshort(r,s);s+=2;for(var p=0;p<h;p++){var g=a.readUshort(r,s);s+=2,c.push(e.GSUB.readLigature(r,o+g))}return c},e.GSUB.readLigature=function(r,s){var a=e._bin,o={chain:[]};o.nglyph=a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);s+=2;for(var h=0;h<c-1;h++)o.chain.push(a.readUshort(r,s)),s+=2;return o},e.head={},e.head.parse=function(r,s,a){var o=e._bin,c={};return o.readFixed(r,s),s+=4,c.fontRevision=o.readFixed(r,s),s+=4,o.readUint(r,s),s+=4,o.readUint(r,s),s+=4,c.flags=o.readUshort(r,s),s+=2,c.unitsPerEm=o.readUshort(r,s),s+=2,c.created=o.readUint64(r,s),s+=8,c.modified=o.readUint64(r,s),s+=8,c.xMin=o.readShort(r,s),s+=2,c.yMin=o.readShort(r,s),s+=2,c.xMax=o.readShort(r,s),s+=2,c.yMax=o.readShort(r,s),s+=2,c.macStyle=o.readUshort(r,s),s+=2,c.lowestRecPPEM=o.readUshort(r,s),s+=2,c.fontDirectionHint=o.readShort(r,s),s+=2,c.indexToLocFormat=o.readShort(r,s),s+=2,c.glyphDataFormat=o.readShort(r,s),s+=2,c},e.hhea={},e.hhea.parse=function(r,s,a){var o=e._bin,c={};return o.readFixed(r,s),s+=4,c.ascender=o.readShort(r,s),s+=2,c.descender=o.readShort(r,s),s+=2,c.lineGap=o.readShort(r,s),s+=2,c.advanceWidthMax=o.readUshort(r,s),s+=2,c.minLeftSideBearing=o.readShort(r,s),s+=2,c.minRightSideBearing=o.readShort(r,s),s+=2,c.xMaxExtent=o.readShort(r,s),s+=2,c.caretSlopeRise=o.readShort(r,s),s+=2,c.caretSlopeRun=o.readShort(r,s),s+=2,c.caretOffset=o.readShort(r,s),s+=2,s+=8,c.metricDataFormat=o.readShort(r,s),s+=2,c.numberOfHMetrics=o.readUshort(r,s),s+=2,c},e.hmtx={},e.hmtx.parse=function(r,s,a,o){for(var c=e._bin,h={aWidth:[],lsBearing:[]},p=0,g=0,A=0;A<o.maxp.numGlyphs;A++)A<o.hhea.numberOfHMetrics&&(p=c.readUshort(r,s),s+=2,g=c.readShort(r,s),s+=2),h.aWidth.push(p),h.lsBearing.push(g);return h},e.kern={},e.kern.parse=function(r,s,a,o){var c=e._bin,h=c.readUshort(r,s);if(s+=2,h==1)return e.kern.parseV1(r,s-2,a,o);var p=c.readUshort(r,s);s+=2;for(var g={glyph1:[],rval:[]},A=0;A<p;A++){s+=2,a=c.readUshort(r,s),s+=2;var v=c.readUshort(r,s);s+=2;var x=v>>>8;if((x&=15)!=0)throw"unknown kern table format: "+x;s=e.kern.readFormat0(r,s,g)}return g},e.kern.parseV1=function(r,s,a,o){var c=e._bin;c.readFixed(r,s),s+=4;var h=c.readUint(r,s);s+=4;for(var p={glyph1:[],rval:[]},g=0;g<h;g++){c.readUint(r,s),s+=4;var A=c.readUshort(r,s);s+=2,c.readUshort(r,s),s+=2;var v=A>>>8;if((v&=15)!=0)throw"unknown kern table format: "+v;s=e.kern.readFormat0(r,s,p)}return p},e.kern.readFormat0=function(r,s,a){var o=e._bin,c=-1,h=o.readUshort(r,s);s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2;for(var p=0;p<h;p++){var g=o.readUshort(r,s);s+=2;var A=o.readUshort(r,s);s+=2;var v=o.readShort(r,s);s+=2,g!=c&&(a.glyph1.push(g),a.rval.push({glyph2:[],vals:[]}));var x=a.rval[a.rval.length-1];x.glyph2.push(A),x.vals.push(v),c=g}return s},e.loca={},e.loca.parse=function(r,s,a,o){var c=e._bin,h=[],p=o.head.indexToLocFormat,g=o.maxp.numGlyphs+1;if(p==0)for(var A=0;A<g;A++)h.push(c.readUshort(r,s+(A<<1))<<1);if(p==1)for(A=0;A<g;A++)h.push(c.readUint(r,s+(A<<2)));return h},e.maxp={},e.maxp.parse=function(r,s,a){var o=e._bin,c={},h=o.readUint(r,s);return s+=4,c.numGlyphs=o.readUshort(r,s),s+=2,h==65536&&(c.maxPoints=o.readUshort(r,s),s+=2,c.maxContours=o.readUshort(r,s),s+=2,c.maxCompositePoints=o.readUshort(r,s),s+=2,c.maxCompositeContours=o.readUshort(r,s),s+=2,c.maxZones=o.readUshort(r,s),s+=2,c.maxTwilightPoints=o.readUshort(r,s),s+=2,c.maxStorage=o.readUshort(r,s),s+=2,c.maxFunctionDefs=o.readUshort(r,s),s+=2,c.maxInstructionDefs=o.readUshort(r,s),s+=2,c.maxStackElements=o.readUshort(r,s),s+=2,c.maxSizeOfInstructions=o.readUshort(r,s),s+=2,c.maxComponentElements=o.readUshort(r,s),s+=2,c.maxComponentDepth=o.readUshort(r,s),s+=2),c},e.name={},e.name.parse=function(r,s,a){var o=e._bin,c={};o.readUshort(r,s),s+=2;var h=o.readUshort(r,s);s+=2,o.readUshort(r,s);for(var p,g=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],A=s+=2,v=0;v<h;v++){var x=o.readUshort(r,s);s+=2;var S=o.readUshort(r,s);s+=2;var _=o.readUshort(r,s);s+=2;var E=o.readUshort(r,s);s+=2;var C=o.readUshort(r,s);s+=2;var T=o.readUshort(r,s);s+=2;var R,B=g[E],U=A+12*h+T;if(x==0)R=o.readUnicode(r,U,C/2);else if(x==3&&S==0)R=o.readUnicode(r,U,C/2);else if(S==0)R=o.readASCII(r,U,C);else if(S==1)R=o.readUnicode(r,U,C/2);else if(S==3)R=o.readUnicode(r,U,C/2);else{if(x!=1)throw"unknown encoding "+S+", platformID: "+x;R=o.readASCII(r,U,C),console.debug("reading unknown MAC encoding "+S+" as ASCII")}var O="p"+x+","+_.toString(16);c[O]==null&&(c[O]={}),c[O][B!==void 0?B:E]=R,c[O]._lang=_}for(var F in c)if(c[F].postScriptName!=null&&c[F]._lang==1033)return c[F];for(var F in c)if(c[F].postScriptName!=null&&c[F]._lang==0)return c[F];for(var F in c)if(c[F].postScriptName!=null&&c[F]._lang==3084)return c[F];for(var F in c)if(c[F].postScriptName!=null)return c[F];for(var F in c){p=F;break}return console.debug("returning name table with languageID "+c[p]._lang),c[p]},e["OS/2"]={},e["OS/2"].parse=function(r,s,a){var o=e._bin.readUshort(r,s);s+=2;var c={};if(o==0)e["OS/2"].version0(r,s,c);else if(o==1)e["OS/2"].version1(r,s,c);else if(o==2||o==3||o==4)e["OS/2"].version2(r,s,c);else{if(o!=5)throw"unknown OS/2 table version: "+o;e["OS/2"].version5(r,s,c)}return c},e["OS/2"].version0=function(r,s,a){var o=e._bin;return a.xAvgCharWidth=o.readShort(r,s),s+=2,a.usWeightClass=o.readUshort(r,s),s+=2,a.usWidthClass=o.readUshort(r,s),s+=2,a.fsType=o.readUshort(r,s),s+=2,a.ySubscriptXSize=o.readShort(r,s),s+=2,a.ySubscriptYSize=o.readShort(r,s),s+=2,a.ySubscriptXOffset=o.readShort(r,s),s+=2,a.ySubscriptYOffset=o.readShort(r,s),s+=2,a.ySuperscriptXSize=o.readShort(r,s),s+=2,a.ySuperscriptYSize=o.readShort(r,s),s+=2,a.ySuperscriptXOffset=o.readShort(r,s),s+=2,a.ySuperscriptYOffset=o.readShort(r,s),s+=2,a.yStrikeoutSize=o.readShort(r,s),s+=2,a.yStrikeoutPosition=o.readShort(r,s),s+=2,a.sFamilyClass=o.readShort(r,s),s+=2,a.panose=o.readBytes(r,s,10),s+=10,a.ulUnicodeRange1=o.readUint(r,s),s+=4,a.ulUnicodeRange2=o.readUint(r,s),s+=4,a.ulUnicodeRange3=o.readUint(r,s),s+=4,a.ulUnicodeRange4=o.readUint(r,s),s+=4,a.achVendID=[o.readInt8(r,s),o.readInt8(r,s+1),o.readInt8(r,s+2),o.readInt8(r,s+3)],s+=4,a.fsSelection=o.readUshort(r,s),s+=2,a.usFirstCharIndex=o.readUshort(r,s),s+=2,a.usLastCharIndex=o.readUshort(r,s),s+=2,a.sTypoAscender=o.readShort(r,s),s+=2,a.sTypoDescender=o.readShort(r,s),s+=2,a.sTypoLineGap=o.readShort(r,s),s+=2,a.usWinAscent=o.readUshort(r,s),s+=2,a.usWinDescent=o.readUshort(r,s),s+=2},e["OS/2"].version1=function(r,s,a){var o=e._bin;return s=e["OS/2"].version0(r,s,a),a.ulCodePageRange1=o.readUint(r,s),s+=4,a.ulCodePageRange2=o.readUint(r,s),s+=4},e["OS/2"].version2=function(r,s,a){var o=e._bin;return s=e["OS/2"].version1(r,s,a),a.sxHeight=o.readShort(r,s),s+=2,a.sCapHeight=o.readShort(r,s),s+=2,a.usDefault=o.readUshort(r,s),s+=2,a.usBreak=o.readUshort(r,s),s+=2,a.usMaxContext=o.readUshort(r,s),s+=2},e["OS/2"].version5=function(r,s,a){var o=e._bin;return s=e["OS/2"].version2(r,s,a),a.usLowerOpticalPointSize=o.readUshort(r,s),s+=2,a.usUpperOpticalPointSize=o.readUshort(r,s),s+=2},e.post={},e.post.parse=function(r,s,a){var o=e._bin,c={};return c.version=o.readFixed(r,s),s+=4,c.italicAngle=o.readFixed(r,s),s+=4,c.underlinePosition=o.readShort(r,s),s+=2,c.underlineThickness=o.readShort(r,s),s+=2,c},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(r,s){var a=r.cmap,o=-1;if(a.p0e4!=null?o=a.p0e4:a.p3e1!=null?o=a.p3e1:a.p1e0!=null?o=a.p1e0:a.p0e3!=null&&(o=a.p0e3),o==-1)throw"no familiar platform and encoding!";var c=a.tables[o];if(c.format==0)return s>=c.map.length?0:c.map[s];if(c.format==4){for(var h=-1,p=0;p<c.endCount.length;p++)if(s<=c.endCount[p]){h=p;break}return h==-1||c.startCount[h]>s?0:65535&(c.idRangeOffset[h]!=0?c.glyphIdArray[s-c.startCount[h]+(c.idRangeOffset[h]>>1)-(c.idRangeOffset.length-h)]:s+c.idDelta[h])}if(c.format==12){if(s>c.groups[c.groups.length-1][1])return 0;for(p=0;p<c.groups.length;p++){var g=c.groups[p];if(g[0]<=s&&s<=g[1])return g[2]+(s-g[0])}return 0}throw"unknown cmap table format "+c.format},e.U.glyphToPath=function(r,s){var a={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[s]){var o=r.SVG.entries[s];return o==null?a:(typeof o=="string"&&(o=e.SVG.toPath(o),r.SVG.entries[s]=o),o)}if(r.CFF){var c={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},h=r.CFF,p=r.CFF.Private;if(h.ROS){for(var g=0;h.FDSelect[g+2]<=s;)g+=2;p=h.FDArray[h.FDSelect[g+1]].Private}e.U._drawCFF(r.CFF.CharStrings[s],c,h,p,a)}else r.glyf&&e.U._drawGlyf(s,r,a);return a},e.U._drawGlyf=function(r,s,a){var o=s.glyf[r];o==null&&(o=s.glyf[r]=e.glyf._parseGlyf(s,r)),o!=null&&(o.noc>-1?e.U._simpleGlyph(o,a):e.U._compoGlyph(o,s,a))},e.U._simpleGlyph=function(r,s){for(var a=0;a<r.noc;a++){for(var o=a==0?0:r.endPts[a-1]+1,c=r.endPts[a],h=o;h<=c;h++){var p=h==o?c:h-1,g=h==c?o:h+1,A=1&r.flags[h],v=1&r.flags[p],x=1&r.flags[g],S=r.xs[h],_=r.ys[h];if(h==o)if(A){if(!v){e.U.P.moveTo(s,S,_);continue}e.U.P.moveTo(s,r.xs[p],r.ys[p])}else v?e.U.P.moveTo(s,r.xs[p],r.ys[p]):e.U.P.moveTo(s,(r.xs[p]+S)/2,(r.ys[p]+_)/2);A?v&&e.U.P.lineTo(s,S,_):x?e.U.P.qcurveTo(s,S,_,r.xs[g],r.ys[g]):e.U.P.qcurveTo(s,S,_,(S+r.xs[g])/2,(_+r.ys[g])/2)}e.U.P.closePath(s)}},e.U._compoGlyph=function(r,s,a){for(var o=0;o<r.parts.length;o++){var c={cmds:[],crds:[]},h=r.parts[o];e.U._drawGlyf(h.glyphIndex,s,c);for(var p=h.m,g=0;g<c.crds.length;g+=2){var A=c.crds[g],v=c.crds[g+1];a.crds.push(A*p.a+v*p.b+p.tx),a.crds.push(A*p.c+v*p.d+p.ty)}for(g=0;g<c.cmds.length;g++)a.cmds.push(c.cmds[g])}},e.U._getGlyphClass=function(r,s){var a=e._lctf.getInterval(s,r);return a==-1?0:s[a+2]},e.U._applySubs=function(r,s,a,o){for(var c=r.length-s-1,h=0;h<a.tabs.length;h++)if(a.tabs[h]!=null){var p,g=a.tabs[h];if(!g.coverage||(p=e._lctf.coverageIndex(g.coverage,r[s]))!=-1){if(a.ltype==1)r[s],g.fmt==1?r[s]=r[s]+g.delta:r[s]=g.newg[p];else if(a.ltype==4)for(var A=g.vals[p],v=0;v<A.length;v++){var x=A[v],S=x.chain.length;if(!(S>c)){for(var _=!0,E=0,C=0;C<S;C++){for(;r[s+E+(1+C)]==-1;)E++;x.chain[C]!=r[s+E+(1+C)]&&(_=!1)}if(_){for(r[s]=x.nglyph,C=0;C<S+E;C++)r[s+C+1]=-1;break}}}else if(a.ltype==5&&g.fmt==2)for(var T=e._lctf.getInterval(g.cDef,r[s]),R=g.cDef[T+2],B=g.scset[R],U=0;U<B.length;U++){var O=B[U],F=O.input;if(!(F.length>c)){for(_=!0,C=0;C<F.length;C++){var L=e._lctf.getInterval(g.cDef,r[s+1+C]);if(T==-1&&g.cDef[L+2]!=F[C]){_=!1;break}}if(_){var P=O.substLookupRecords;for(v=0;v<P.length;v+=2)P[v],P[v+1]}}}else if(a.ltype==6&&g.fmt==3){if(!e.U._glsCovered(r,g.backCvg,s-g.backCvg.length)||!e.U._glsCovered(r,g.inptCvg,s)||!e.U._glsCovered(r,g.ahedCvg,s+g.inptCvg.length))continue;var W=g.lookupRec;for(U=0;U<W.length;U+=2){T=W[U];var j=o[W[U+1]];e.U._applySubs(r,s+T,j,o)}}}}},e.U._glsCovered=function(r,s,a){for(var o=0;o<s.length;o++)if(e._lctf.coverageIndex(s[o],r[a+o])==-1)return!1;return!0},e.U.glyphsToPath=function(r,s,a){for(var o={cmds:[],crds:[]},c=0,h=0;h<s.length;h++){var p=s[h];if(p!=-1){for(var g=h<s.length-1&&s[h+1]!=-1?s[h+1]:0,A=e.U.glyphToPath(r,p),v=0;v<A.crds.length;v+=2)o.crds.push(A.crds[v]+c),o.crds.push(A.crds[v+1]);for(a&&o.cmds.push(a),v=0;v<A.cmds.length;v++)o.cmds.push(A.cmds[v]);a&&o.cmds.push("X"),c+=r.hmtx.aWidth[p],h<s.length-1&&(c+=e.U.getPairAdjustment(r,p,g))}}return o},e.U.P={},e.U.P.moveTo=function(r,s,a){r.cmds.push("M"),r.crds.push(s,a)},e.U.P.lineTo=function(r,s,a){r.cmds.push("L"),r.crds.push(s,a)},e.U.P.curveTo=function(r,s,a,o,c,h,p){r.cmds.push("C"),r.crds.push(s,a,o,c,h,p)},e.U.P.qcurveTo=function(r,s,a,o,c){r.cmds.push("Q"),r.crds.push(s,a,o,c)},e.U.P.closePath=function(r){r.cmds.push("Z")},e.U._drawCFF=function(r,s,a,o,c){for(var h=s.stack,p=s.nStems,g=s.haveWidth,A=s.width,v=s.open,x=0,S=s.x,_=s.y,E=0,C=0,T=0,R=0,B=0,U=0,O=0,F=0,L=0,P=0,W={val:0,size:0};x<r.length;){e.CFF.getCharString(r,x,W);var j=W.val;if(x+=W.size,j=="o1"||j=="o18")h.length%2!=0&&!g&&(A=h.shift()+o.nominalWidthX),p+=h.length>>1,h.length=0,g=!0;else if(j=="o3"||j=="o23")h.length%2!=0&&!g&&(A=h.shift()+o.nominalWidthX),p+=h.length>>1,h.length=0,g=!0;else if(j=="o4")h.length>1&&!g&&(A=h.shift()+o.nominalWidthX,g=!0),v&&e.U.P.closePath(c),_+=h.pop(),e.U.P.moveTo(c,S,_),v=!0;else if(j=="o5")for(;h.length>0;)S+=h.shift(),_+=h.shift(),e.U.P.lineTo(c,S,_);else if(j=="o6"||j=="o7")for(var V=h.length,q=j=="o6",re=0;re<V;re++){var Q=h.shift();q?S+=Q:_+=Q,q=!q,e.U.P.lineTo(c,S,_)}else if(j=="o8"||j=="o24"){V=h.length;for(var K=0;K+6<=V;)E=S+h.shift(),C=_+h.shift(),T=E+h.shift(),R=C+h.shift(),S=T+h.shift(),_=R+h.shift(),e.U.P.curveTo(c,E,C,T,R,S,_),K+=6;j=="o24"&&(S+=h.shift(),_+=h.shift(),e.U.P.lineTo(c,S,_))}else{if(j=="o11")break;if(j=="o1234"||j=="o1235"||j=="o1236"||j=="o1237")j=="o1234"&&(C=_,T=(E=S+h.shift())+h.shift(),P=R=C+h.shift(),U=R,F=_,S=(O=(B=(L=T+h.shift())+h.shift())+h.shift())+h.shift(),e.U.P.curveTo(c,E,C,T,R,L,P),e.U.P.curveTo(c,B,U,O,F,S,_)),j=="o1235"&&(E=S+h.shift(),C=_+h.shift(),T=E+h.shift(),R=C+h.shift(),L=T+h.shift(),P=R+h.shift(),B=L+h.shift(),U=P+h.shift(),O=B+h.shift(),F=U+h.shift(),S=O+h.shift(),_=F+h.shift(),h.shift(),e.U.P.curveTo(c,E,C,T,R,L,P),e.U.P.curveTo(c,B,U,O,F,S,_)),j=="o1236"&&(E=S+h.shift(),C=_+h.shift(),T=E+h.shift(),P=R=C+h.shift(),U=R,O=(B=(L=T+h.shift())+h.shift())+h.shift(),F=U+h.shift(),S=O+h.shift(),e.U.P.curveTo(c,E,C,T,R,L,P),e.U.P.curveTo(c,B,U,O,F,S,_)),j=="o1237"&&(E=S+h.shift(),C=_+h.shift(),T=E+h.shift(),R=C+h.shift(),L=T+h.shift(),P=R+h.shift(),B=L+h.shift(),U=P+h.shift(),O=B+h.shift(),F=U+h.shift(),Math.abs(O-S)>Math.abs(F-_)?S=O+h.shift():_=F+h.shift(),e.U.P.curveTo(c,E,C,T,R,L,P),e.U.P.curveTo(c,B,U,O,F,S,_));else if(j=="o14"){if(h.length>0&&!g&&(A=h.shift()+a.nominalWidthX,g=!0),h.length==4){var ce=h.shift(),ue=h.shift(),oe=h.shift(),z=h.shift(),$=e.CFF.glyphBySE(a,oe),ae=e.CFF.glyphBySE(a,z);e.U._drawCFF(a.CharStrings[$],s,a,o,c),s.x=ce,s.y=ue,e.U._drawCFF(a.CharStrings[ae],s,a,o,c)}v&&(e.U.P.closePath(c),v=!1)}else if(j=="o19"||j=="o20")h.length%2!=0&&!g&&(A=h.shift()+o.nominalWidthX),p+=h.length>>1,h.length=0,g=!0,x+=p+7>>3;else if(j=="o21")h.length>2&&!g&&(A=h.shift()+o.nominalWidthX,g=!0),_+=h.pop(),S+=h.pop(),v&&e.U.P.closePath(c),e.U.P.moveTo(c,S,_),v=!0;else if(j=="o22")h.length>1&&!g&&(A=h.shift()+o.nominalWidthX,g=!0),S+=h.pop(),v&&e.U.P.closePath(c),e.U.P.moveTo(c,S,_),v=!0;else if(j=="o25"){for(;h.length>6;)S+=h.shift(),_+=h.shift(),e.U.P.lineTo(c,S,_);E=S+h.shift(),C=_+h.shift(),T=E+h.shift(),R=C+h.shift(),S=T+h.shift(),_=R+h.shift(),e.U.P.curveTo(c,E,C,T,R,S,_)}else if(j=="o26")for(h.length%2&&(S+=h.shift());h.length>0;)E=S,C=_+h.shift(),S=T=E+h.shift(),_=(R=C+h.shift())+h.shift(),e.U.P.curveTo(c,E,C,T,R,S,_);else if(j=="o27")for(h.length%2&&(_+=h.shift());h.length>0;)C=_,T=(E=S+h.shift())+h.shift(),R=C+h.shift(),S=T+h.shift(),_=R,e.U.P.curveTo(c,E,C,T,R,S,_);else if(j=="o10"||j=="o29"){var he=j=="o10"?o:a;if(h.length==0)console.debug("error: empty stack");else{var me=h.pop(),le=he.Subrs[me+he.Bias];s.x=S,s.y=_,s.nStems=p,s.haveWidth=g,s.width=A,s.open=v,e.U._drawCFF(le,s,a,o,c),S=s.x,_=s.y,p=s.nStems,g=s.haveWidth,A=s.width,v=s.open}}else if(j=="o30"||j=="o31"){var fe=h.length,_e=(K=0,j=="o31");for(K+=fe-(V=-3&fe);K<V;)_e?(C=_,T=(E=S+h.shift())+h.shift(),_=(R=C+h.shift())+h.shift(),V-K==5?(S=T+h.shift(),K++):S=T,_e=!1):(E=S,C=_+h.shift(),T=E+h.shift(),R=C+h.shift(),S=T+h.shift(),V-K==5?(_=R+h.shift(),K++):_=R,_e=!0),e.U.P.curveTo(c,E,C,T,R,S,_),K+=4}else{if((j+"").charAt(0)=="o")throw console.debug("Unknown operation: "+j,r),j;h.push(j)}}}s.x=S,s.y=_,s.nStems=p,s.haveWidth=g,s.width=A,s.open=v};var t=e,i={Typr:t};return n.Typr=t,n.default=i,Object.defineProperty(n,"__esModule",{value:!0}),n})({}).Typr}function Gce(){return(function(n){var e=Uint8Array,t=Uint16Array,i=Uint32Array,r=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=function(j,V){for(var q=new t(31),re=0;re<31;++re)q[re]=V+=1<<j[re-1];var Q=new i(q[30]);for(re=1;re<30;++re)for(var K=q[re];K<q[re+1];++K)Q[K]=K-q[re]<<5|re;return[q,Q]},c=o(r,2),h=c[0],p=c[1];h[28]=258,p[258]=28;for(var g=o(s,0)[0],A=new t(32768),v=0;v<32768;++v){var x=(43690&v)>>>1|(21845&v)<<1;x=(61680&(x=(52428&x)>>>2|(13107&x)<<2))>>>4|(3855&x)<<4,A[v]=((65280&x)>>>8|(255&x)<<8)>>>1}var S=function(j,V,q){for(var re=j.length,Q=0,K=new t(V);Q<re;++Q)++K[j[Q]-1];var ce,ue=new t(V);for(Q=0;Q<V;++Q)ue[Q]=ue[Q-1]+K[Q-1]<<1;{ce=new t(1<<V);var oe=15-V;for(Q=0;Q<re;++Q)if(j[Q])for(var z=Q<<4|j[Q],$=V-j[Q],ae=ue[j[Q]-1]++<<$,he=ae|(1<<$)-1;ae<=he;++ae)ce[A[ae]>>>oe]=z}return ce},_=new e(288);for(v=0;v<144;++v)_[v]=8;for(v=144;v<256;++v)_[v]=9;for(v=256;v<280;++v)_[v]=7;for(v=280;v<288;++v)_[v]=8;var E=new e(32);for(v=0;v<32;++v)E[v]=5;var C=S(_,9),T=S(E,5),R=function(j){for(var V=j[0],q=1;q<j.length;++q)j[q]>V&&(V=j[q]);return V},B=function(j,V,q){var re=V/8|0;return(j[re]|j[re+1]<<8)>>(7&V)&q},U=function(j,V){var q=V/8|0;return(j[q]|j[q+1]<<8|j[q+2]<<16)>>(7&V)},O=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],F=function(j,V,q){var re=new Error(V||O[j]);if(re.code=j,Error.captureStackTrace&&Error.captureStackTrace(re,F),!q)throw re;return re},L=function(j,V,q){var re=j.length;if(!re||q&&!q.l&&re<5)return V||new e(0);var Q=!V||q,K=!q||q.i;q||(q={}),V||(V=new e(3*re));var ce,ue=function(at){var bt=V.length;if(at>bt){var ht=new e(Math.max(2*bt,at));ht.set(V),V=ht}},oe=q.f||0,z=q.p||0,$=q.b||0,ae=q.l,he=q.d,me=q.m,le=q.n,fe=8*re;do{if(!ae){q.f=oe=B(j,z,1);var _e=B(j,z+1,3);if(z+=3,!_e){var Pe=j[(qe=((ce=z)/8|0)+(7&ce&&1)+4)-4]|j[qe-3]<<8,et=qe+Pe;if(et>re){K&&F(0);break}Q&&ue($+Pe),V.set(j.subarray(qe,et),$),q.b=$+=Pe,q.p=z=8*et;continue}if(_e==1)ae=C,he=T,me=9,le=5;else if(_e==2){var ot=B(j,z,31)+257,Je=B(j,z+10,15)+4,_t=ot+B(j,z+5,31)+1;z+=14;for(var Be=new e(_t),Le=new e(19),Te=0;Te<Je;++Te)Le[a[Te]]=B(j,z+3*Te,7);z+=3*Je;var Ye=R(Le),ne=(1<<Ye)-1,ft=S(Le,Ye);for(Te=0;Te<_t;){var qe,Ne=ft[B(j,z,ne)];if(z+=15&Ne,(qe=Ne>>>4)<16)Be[Te++]=qe;else{var tt=0,Z=0;for(qe==16?(Z=3+B(j,z,3),z+=2,tt=Be[Te-1]):qe==17?(Z=3+B(j,z,7),z+=3):qe==18&&(Z=11+B(j,z,127),z+=7);Z--;)Be[Te++]=tt}}var H=Be.subarray(0,ot),de=Be.subarray(ot);me=R(H),le=R(de),ae=S(H,me),he=S(de,le)}else F(1);if(z>fe){K&&F(0);break}}Q&&ue($+131072);for(var De=(1<<me)-1,Ie=(1<<le)-1,we=z;;we=z){var st=(tt=ae[U(j,z)&De])>>>4;if((z+=15&tt)>fe){K&&F(0);break}if(tt||F(2),st<256)V[$++]=st;else{if(st==256){we=z,ae=null;break}var it=st-254;if(st>264){var It=r[Te=st-257];it=B(j,z,(1<<It)-1)+h[Te],z+=It}var Ot=he[U(j,z)&Ie],Qe=Ot>>>4;if(Ot||F(3),z+=15&Ot,de=g[Qe],Qe>3&&(It=s[Qe],de+=U(j,z)&(1<<It)-1,z+=It),z>fe){K&&F(0);break}Q&&ue($+131072);for(var Ve=$+it;$<Ve;$+=4)V[$]=V[$-de],V[$+1]=V[$+1-de],V[$+2]=V[$+2-de],V[$+3]=V[$+3-de];$=Ve}}q.l=ae,q.p=we,q.b=$,ae&&(oe=1,q.m=me,q.d=he,q.n=le)}while(!oe);return $==V.length?V:(function(at,bt,ht){(ht==null||ht>at.length)&&(ht=at.length);var Vt=new(at instanceof t?t:at instanceof i?i:e)(ht-bt);return Vt.set(at.subarray(bt,ht)),Vt})(V,0,$)},P=new e(0),W=typeof TextDecoder<"u"&&new TextDecoder;try{W.decode(P,{stream:!0})}catch{}return n.convert_streams=function(j){var V=new DataView(j),q=0;function re(){var ot=V.getUint16(q);return q+=2,ot}function Q(){var ot=V.getUint32(q);return q+=4,ot}function K(ot){Pe.setUint16(et,ot),et+=2}function ce(ot){Pe.setUint32(et,ot),et+=4}for(var ue={signature:Q(),flavor:Q(),length:Q(),numTables:re(),reserved:re(),totalSfntSize:Q(),majorVersion:re(),minorVersion:re(),metaOffset:Q(),metaLength:Q(),metaOrigLength:Q(),privOffset:Q(),privLength:Q()},oe=0;Math.pow(2,oe)<=ue.numTables;)oe++;oe--;for(var z=16*Math.pow(2,oe),$=16*ue.numTables-z,ae=12,he=[],me=0;me<ue.numTables;me++)he.push({tag:Q(),offset:Q(),compLength:Q(),origLength:Q(),origChecksum:Q()}),ae+=16;var le,fe=new Uint8Array(12+16*he.length+he.reduce((function(ot,Je){return ot+Je.origLength+4}),0)),_e=fe.buffer,Pe=new DataView(_e),et=0;return ce(ue.flavor),K(ue.numTables),K(z),K(oe),K($),he.forEach((function(ot){ce(ot.tag),ce(ot.origChecksum),ce(ae),ce(ot.origLength),ot.outOffset=ae,(ae+=ot.origLength)%4!=0&&(ae+=4-ae%4)})),he.forEach((function(ot){var Je,_t=j.slice(ot.offset,ot.offset+ot.compLength);if(ot.compLength!=ot.origLength){var Be=new Uint8Array(ot.origLength);Je=new Uint8Array(_t,2),L(Je,Be)}else Be=new Uint8Array(_t);fe.set(Be,ot.outOffset);var Le=0;(ae=ot.outOffset+ot.origLength)%4!=0&&(Le=4-ae%4),fe.set(new Uint8Array(Le).buffer,ot.outOffset+ot.origLength),le=ae+Le})),_e.slice(0,le)},Object.defineProperty(n,"__esModule",{value:!0}),n})({}).convert_streams}function Hce(n,e){const t={M:2,L:2,Q:4,C:6,Z:0},i={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,s=2,a=4,o=8,c=16,h=32;let p;function g(O){if(!p){const F={R:s,L:r,D:a,C:c,U:h,T:o};p=new Map;for(let L in i){let P=0;i[L].split(",").forEach(W=>{let[j,V]=W.split("+");j=parseInt(j,36),V=V?parseInt(V,36):0,p.set(P+=j,F[L]);for(let q=V;q--;)p.set(++P,F[L])})}}return p.get(O)||h}const A=1,v=2,x=3,S=4,_=[null,"isol","init","fina","medi"];function E(O){const F=new Uint8Array(O.length);let L=h,P=A,W=-1;for(let j=0;j<O.length;j++){const V=O.codePointAt(j);let q=g(V)|0,re=A;q&o||(L&(r|a|c)?q&(s|a|c)?(re=x,(P===A||P===x)&&F[W]++):q&(r|h)&&(P===v||P===S)&&F[W]--:L&(s|h)&&(P===v||P===S)&&F[W]--,P=F[j]=re,L=q,W=j,V>65535&&j++)}return F}function C(O,F){const L=[];for(let W=0;W<F.length;W++){const j=F.codePointAt(W);j>65535&&W++,L.push(n.U.codeToGlyph(O,j))}const P=O.GSUB;if(P){const{lookupList:W,featureList:j}=P;let V;const q=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,re=[];j.forEach(Q=>{if(q.test(Q.tag))for(let K=0;K<Q.tab.length;K++){if(re[Q.tab[K]])continue;re[Q.tab[K]]=!0;const ce=W[Q.tab[K]],ue=/^(isol|init|fina|medi)$/.test(Q.tag);ue&&!V&&(V=E(F));for(let oe=0;oe<L.length;oe++)(!V||!ue||_[V[oe]]===Q.tag)&&n.U._applySubs(L,oe,ce,W)}})}return L}function T(O,F){const L=new Int16Array(F.length*3);let P=0;for(;P<F.length;P++){const q=F[P];if(q===-1)continue;L[P*3+2]=O.hmtx.aWidth[q];const re=O.GPOS;if(re){const Q=re.lookupList;for(let K=0;K<Q.length;K++){const ce=Q[K];for(let ue=0;ue<ce.tabs.length;ue++){const oe=ce.tabs[ue];if(ce.ltype===1){if(n._lctf.coverageIndex(oe.coverage,q)!==-1&&oe.pos){V(oe.pos,P);break}}else if(ce.ltype===2){let z=null,$=W();if($!==-1){const ae=n._lctf.coverageIndex(oe.coverage,F[$]);if(ae!==-1){if(oe.fmt===1){const he=oe.pairsets[ae];for(let me=0;me<he.length;me++)he[me].gid2===q&&(z=he[me])}else if(oe.fmt===2){const he=n.U._getGlyphClass(F[$],oe.classDef1),me=n.U._getGlyphClass(q,oe.classDef2);z=oe.matrix[he][me]}if(z){z.val1&&V(z.val1,$),z.val2&&V(z.val2,P);break}}}}else if(ce.ltype===4){const z=n._lctf.coverageIndex(oe.markCoverage,q);if(z!==-1){const $=W(j),ae=$===-1?-1:n._lctf.coverageIndex(oe.baseCoverage,F[$]);if(ae!==-1){const he=oe.markArray[z],me=oe.baseArray[ae][he.markClass];L[P*3]=me.x-he.x+L[$*3]-L[$*3+2],L[P*3+1]=me.y-he.y+L[$*3+1];break}}}else if(ce.ltype===6){const z=n._lctf.coverageIndex(oe.mark1Coverage,q);if(z!==-1){const $=W();if($!==-1){const ae=F[$];if(R(O,ae)===3){const he=n._lctf.coverageIndex(oe.mark2Coverage,ae);if(he!==-1){const me=oe.mark1Array[z],le=oe.mark2Array[he][me.markClass];L[P*3]=le.x-me.x+L[$*3]-L[$*3+2],L[P*3+1]=le.y-me.y+L[$*3+1];break}}}}}}}}else if(O.kern&&!O.cff){const Q=W();if(Q!==-1){const K=O.kern.glyph1.indexOf(F[Q]);if(K!==-1){const ce=O.kern.rval[K].glyph2.indexOf(q);ce!==-1&&(L[Q*3+2]+=O.kern.rval[K].vals[ce])}}}}return L;function W(q){for(let re=P-1;re>=0;re--)if(F[re]!==-1&&(!q||q(F[re])))return re;return-1}function j(q){return R(O,q)===1}function V(q,re){for(let Q=0;Q<3;Q++)L[re*3+Q]+=q[Q]||0}}function R(O,F){const L=O.GDEF&&O.GDEF.glyphClassDef;return L?n.U._getGlyphClass(F,L):0}function B(...O){for(let F=0;F<O.length;F++)if(typeof O[F]=="number")return O[F]}function U(O){const F=Object.create(null),L=O["OS/2"],P=O.hhea,W=O.head.unitsPerEm,j=B(L&&L.sTypoAscender,P&&P.ascender,W),V={unitsPerEm:W,ascender:j,descender:B(L&&L.sTypoDescender,P&&P.descender,0),capHeight:B(L&&L.sCapHeight,j),xHeight:B(L&&L.sxHeight,j),lineGap:B(L&&L.sTypoLineGap,P&&P.lineGap),supportsCodePoint(q){return n.U.codeToGlyph(O,q)>0},forEachGlyph(q,re,Q,K){let ce=0;const ue=1/V.unitsPerEm*re,oe=C(O,q);let z=0;const $=T(O,oe);return oe.forEach((ae,he)=>{if(ae!==-1){let me=F[ae];if(!me){const{cmds:le,crds:fe}=n.U.glyphToPath(O,ae);let _e="",Pe=0;for(let Be=0,Le=le.length;Be<Le;Be++){const Te=t[le[Be]];_e+=le[Be];for(let Ye=1;Ye<=Te;Ye++)_e+=(Ye>1?",":"")+fe[Pe++]}let et,ot,Je,_t;if(fe.length){et=ot=1/0,Je=_t=-1/0;for(let Be=0,Le=fe.length;Be<Le;Be+=2){let Te=fe[Be],Ye=fe[Be+1];Te<et&&(et=Te),Ye<ot&&(ot=Ye),Te>Je&&(Je=Te),Ye>_t&&(_t=Ye)}}else et=Je=ot=_t=0;me=F[ae]={index:ae,advanceWidth:O.hmtx.aWidth[ae],xMin:et,yMin:ot,xMax:Je,yMax:_t,path:_e}}K.call(null,me,ce+$[he*3]*ue,$[he*3+1]*ue,z),ce+=$[he*3+2]*ue,Q&&(ce+=Q*re)}z+=q.codePointAt(z)>65535?2:1}),ce}};return V}return function(F){const L=new Uint8Array(F,0,4),P=n._bin.readASCII(L,0,4);if(P==="wOFF")F=e(F);else if(P==="wOF2")throw new Error("woff2 fonts not supported");return U(n.parse(F)[0])}}const Qce=gv({name:"Typr Font Parser",dependencies:[zce,Gce,Hce],init(n,e,t){const i=n(),r=e();return t(i,r)}});function Vce(){return(function(n){var e=function(){this.buckets=new Map};e.prototype.add=function(T){var R=T>>5;this.buckets.set(R,(this.buckets.get(R)||0)|1<<(31&T))},e.prototype.has=function(T){var R=this.buckets.get(T>>5);return R!==void 0&&(R&1<<(31&T))!=0},e.prototype.serialize=function(){var T=[];return this.buckets.forEach((function(R,B){T.push((+B).toString(36)+":"+R.toString(36))})),T.join(",")},e.prototype.deserialize=function(T){var R=this;this.buckets.clear(),T.split(",").forEach((function(B){var U=B.split(":");R.buckets.set(parseInt(U[0],36),parseInt(U[1],36))}))};var t=Math.pow(2,8),i=t-1,r=~i;function s(T){var R=(function(U){return U&r})(T).toString(16),B=(function(U){return(U&r)+t-1})(T).toString(16);return"codepoint-index/plane"+(T>>16)+"/"+R+"-"+B+".json"}function a(T,R){var B=T&i,U=R.codePointAt(B/6|0);return((U=(U||48)-48)&1<<B%6)!=0}function o(T,R){var B;(B=T,B.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map((function(U){return U.split("-").map((function(O){return parseInt(O.trim(),16)}))}))).forEach((function(U){var O=U[0],F=U[1];F===void 0&&(F=O),R(O,F)}))}function c(T,R){o(T,(function(B,U){for(var O=B;O<=U;O++)R(O)}))}var h={},p={},g=new WeakMap,A="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function v(T){var R=g.get(T);return R||(R=new e,c(T.ranges,(function(B){return R.add(B)})),g.set(T,R)),R}var x,S=new Map;function _(T,R,B){return T[R]?R:T[B]?B:(function(U){for(var O in U)return O})(T)}function E(T,R){var B=R;if(!T.includes(B)){B=1/0;for(var U=0;U<T.length;U++)Math.abs(T[U]-R)<Math.abs(B-R)&&(B=T[U])}return B}function C(T){return x||(x=new Set,c("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",(function(R){x.add(R)}))),x.has(T)}return n.CodePointSet=e,n.clearCache=function(){h={},p={}},n.getFontsForString=function(T,R){R===void 0&&(R={});var B,U=R.lang;U===void 0&&(U=new RegExp("\\p{Script=Hangul}","u").test(B=T)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(B)?"ja":"en");var O=R.category;O===void 0&&(O="sans-serif");var F=R.style;F===void 0&&(F="normal");var L=R.weight;L===void 0&&(L=400);var P=(R.dataUrl||A).replace(/\/$/g,""),W=new Map,j=new Uint8Array(T.length),V={},q={},re=new Array(T.length),Q=new Map,K=!1;function ce(z){var $=S.get(z);return $||($=fetch(P+"/"+z).then((function(ae){if(!ae.ok)throw new Error(ae.statusText);return ae.json().then((function(he){if(!Array.isArray(he)||he[0]!==1)throw new Error("Incorrect schema version; need 1, got "+he[0]);return he[1]}))})).catch((function(ae){if(P!==A)return K||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+P+'", trying default CDN. '+ae.message),K=!0),P=A,S.delete(z),ce(z);throw ae})),S.set(z,$)),$}for(var ue=function(z){var $=T.codePointAt(z),ae=s($);re[z]=ae,h[ae]||Q.has(ae)||Q.set(ae,ce(ae).then((function(he){h[ae]=he}))),$>65535&&(z++,oe=z)},oe=0;oe<T.length;oe++)ue(oe);return Promise.all(Q.values()).then((function(){Q.clear();for(var z=function(ae){var he=T.codePointAt(ae),me=null,le=h[re[ae]],fe=void 0;for(var _e in le){var Pe=q[_e];if(Pe===void 0&&(Pe=q[_e]=new RegExp(_e).test(U||"en")),Pe){for(var et in fe=_e,le[_e])if(a(he,le[_e][et])){me=et;break}break}}if(!me){e:for(var ot in le)if(ot!==fe){for(var Je in le[ot])if(a(he,le[ot][Je])){me=Je;break e}}}me||(console.debug("No font coverage for U+"+he.toString(16)),me="latin"),re[ae]=me,p[me]||Q.has(me)||Q.set(me,ce("font-meta/"+me+".json").then((function(_t){p[me]=_t}))),he>65535&&(ae++,$=ae)},$=0;$<T.length;$++)z($);return Promise.all(Q.values())})).then((function(){for(var z,$=null,ae=0;ae<T.length;ae++){var he=T.codePointAt(ae);if($&&(C(he)||v($).has(he)))j[ae]=j[ae-1];else{$=p[re[ae]];var me=V[$.id];if(!me){var le=$.typeforms,fe=_(le,O,"sans-serif"),_e=_(le[fe],F,"normal"),Pe=E((z=le[fe])===null||z===void 0?void 0:z[_e],L);me=V[$.id]=P+"/font-files/"+$.id+"/"+fe+"."+_e+"."+Pe+".woff"}var et=W.get(me);et==null&&(et=W.size,W.set(me,et)),j[ae]=et}he>65535&&(ae++,j[ae]=j[ae-1])}return{fontUrls:Array.from(W.keys()),chars:j}}))},Object.defineProperty(n,"__esModule",{value:!0}),n})({})}function jce(n,e){const t=Object.create(null),i=Object.create(null);function r(a,o){const c=h=>{console.error(`Failure loading font ${a}`,h)};try{const h=new XMLHttpRequest;h.open("get",a,!0),h.responseType="arraybuffer",h.onload=function(){if(h.status>=400)c(new Error(h.statusText));else if(h.status>0)try{const p=n(h.response);p.src=a,o(p)}catch(p){c(p)}},h.onerror=c,h.send()}catch(h){c(h)}}function s(a,o){let c=t[a];c?o(c):i[a]?i[a].push(o):(i[a]=[o],r(a,h=>{h.src=a,t[a]=h,i[a].forEach(p=>p(h)),delete i[a]}))}return function(a,o,{lang:c,fonts:h=[],style:p="normal",weight:g="normal",unicodeFontsURL:A}={}){const v=new Uint8Array(a.length),x=[];a.length||C();const S=new Map,_=[];if(p!=="italic"&&(p="normal"),typeof g!="number"&&(g=g==="bold"?700:400),h&&!Array.isArray(h)&&(h=[h]),h=h.slice().filter(R=>!R.lang||R.lang.test(c)).reverse(),h.length){let O=0;(function F(L=0){for(let P=L,W=a.length;P<W;P++){const j=a.codePointAt(P);if(O===1&&x[v[P-1]].supportsCodePoint(j)||P>0&&/\s/.test(a[P]))v[P]=v[P-1],O===2&&(_[_.length-1][1]=P);else for(let V=v[P],q=h.length;V<=q;V++)if(V===q){const re=O===2?_[_.length-1]:_[_.length]=[P,P];re[1]=P,O=2}else{v[P]=V;const{src:re,unicodeRange:Q}=h[V];if(!Q||T(j,Q)){const K=t[re];if(!K){s(re,()=>{F(P)});return}if(K.supportsCodePoint(j)){let ce=S.get(K);typeof ce!="number"&&(ce=x.length,x.push(K),S.set(K,ce)),v[P]=ce,O=1;break}}}j>65535&&P+1<W&&(v[P+1]=v[P],P++,O===2&&(_[_.length-1][1]=P))}E()})()}else _.push([0,a.length-1]),E();function E(){if(_.length){const R=_.map(B=>a.substring(B[0],B[1]+1)).join(`
`);e.getFontsForString(R,{lang:c||void 0,style:p,weight:g,dataUrl:A}).then(({fontUrls:B,chars:U})=>{const O=x.length;let F=0;_.forEach(P=>{for(let W=0,j=P[1]-P[0];W<=j;W++)v[P[0]+W]=U[F++]+O;F++});let L=0;B.forEach((P,W)=>{s(P,j=>{x[W+O]=j,++L===B.length&&C()})})})}else C()}function C(){o({chars:v,fonts:x})}function T(R,B){for(let U=0;U<B.length;U++){const[O,F=O]=B[U];if(O<=R&&R<=F)return!0}return!1}}}const Wce=gv({name:"FontResolver",dependencies:[jce,Qce,Vce],init(n,e,t){return n(e,t())}});function qce(n,e){const i=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,r="[^\\S\\u00A0]",s=new RegExp(`${r}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function a({text:x,lang:S,fonts:_,style:E,weight:C,preResolvedFonts:T,unicodeFontsURL:R},B){const U=({chars:O,fonts:F})=>{let L,P;const W=[];for(let j=0;j<O.length;j++)O[j]!==P?(P=O[j],W.push(L={start:j,end:j,fontObj:F[O[j]]})):L.end=j;B(W)};T?U(T):n(x,U,{lang:S,fonts:_,style:E,weight:C,unicodeFontsURL:R})}function o({text:x="",font:S,lang:_,sdfGlyphSize:E=64,fontSize:C=400,fontWeight:T=1,fontStyle:R="normal",letterSpacing:B=0,lineHeight:U="normal",maxWidth:O=1/0,direction:F,textAlign:L="left",textIndent:P=0,whiteSpace:W="normal",overflowWrap:j="normal",anchorX:V=0,anchorY:q=0,metricsOnly:re=!1,unicodeFontsURL:Q,preResolvedFonts:K=null,includeCaretPositions:ce=!1,chunkedBoundsSize:ue=8192,colorRanges:oe=null},z){const $=g(),ae={fontLoad:0,typesetting:0};x.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),x=x.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),C=+C,B=+B,O=+O,U=U||"normal",P=+P,a({text:x,lang:_,style:R,weight:T,fonts:typeof S=="string"?[{src:S}]:S,unicodeFontsURL:Q,preResolvedFonts:K},he=>{ae.fontLoad=g()-$;const me=isFinite(O);let le=null,fe=null,_e=null,Pe=null,et=null,ot=null,Je=null,_t=null,Be=0,Le=0,Te=W!=="nowrap";const Ye=new Map,ne=g();let ft=P,qe=0,Ne=new A;const tt=[Ne];he.forEach(Ie=>{const{fontObj:we}=Ie,{ascender:st,descender:it,unitsPerEm:It,lineGap:Ot,capHeight:Qe,xHeight:Ve}=we;let at=Ye.get(we);if(!at){const Me=C/It,rt=U==="normal"?(st-it+Ot)*Me:U*C,Ut=(rt-(st-it)*Me)/2,nt=Math.min(rt,(st-it)*Me),ke=(st+it)/2*Me+nt/2;at={index:Ye.size,src:we.src,fontObj:we,fontSizeMult:Me,unitsPerEm:It,ascender:st*Me,descender:it*Me,capHeight:Qe*Me,xHeight:Ve*Me,lineHeight:rt,baseline:-Ut-st*Me,caretTop:ke,caretBottom:ke-nt},Ye.set(we,at)}const{fontSizeMult:bt}=at,ht=x.slice(Ie.start,Ie.end+1);let Vt,ve;we.forEachGlyph(ht,C,B,(Me,rt,Ut,nt)=>{rt+=qe,nt+=Ie.start,Vt=rt,ve=Me;const ke=x.charAt(nt),gt=Me.advanceWidth*bt,Qt=Ne.count;let kt;if("isEmpty"in Me||(Me.isWhitespace=!!ke&&new RegExp(r).test(ke),Me.canBreakAfter=!!ke&&s.test(ke),Me.isEmpty=Me.xMin===Me.xMax||Me.yMin===Me.yMax||i.test(ke)),!Me.isWhitespace&&!Me.isEmpty&&Le++,Te&&me&&!Me.isWhitespace&&rt+gt+ft>O&&Qt){if(Ne.glyphAt(Qt-1).glyphObj.canBreakAfter)kt=new A,ft=-rt;else for(let ti=Qt;ti--;)if(ti===0&&j==="break-word"){kt=new A,ft=-rt;break}else if(Ne.glyphAt(ti).glyphObj.canBreakAfter){kt=Ne.splitAt(ti+1);const ui=kt.glyphAt(0).x;ft-=ui;for(let vi=kt.count;vi--;)kt.glyphAt(vi).x-=ui;break}kt&&(Ne.isSoftWrapped=!0,Ne=kt,tt.push(Ne),Be=O)}let rn=Ne.glyphAt(Ne.count);rn.glyphObj=Me,rn.x=rt+ft,rn.y=Ut,rn.width=gt,rn.charIndex=nt,rn.fontData=at,ke===`
`&&(Ne=new A,tt.push(Ne),ft=-(rt+gt+B*C)+P)}),qe=Vt+ve.advanceWidth*bt+B*C});let Z=0;tt.forEach(Ie=>{let we=!0;for(let st=Ie.count;st--;){const it=Ie.glyphAt(st);we&&!it.glyphObj.isWhitespace&&(Ie.width=it.x+it.width,Ie.width>Be&&(Be=Ie.width),we=!1);let{lineHeight:It,capHeight:Ot,xHeight:Qe,baseline:Ve}=it.fontData;It>Ie.lineHeight&&(Ie.lineHeight=It);const at=Ve-Ie.baseline;at<0&&(Ie.baseline+=at,Ie.cap+=at,Ie.ex+=at),Ie.cap=Math.max(Ie.cap,Ie.baseline+Ot),Ie.ex=Math.max(Ie.ex,Ie.baseline+Qe)}Ie.baseline-=Z,Ie.cap-=Z,Ie.ex-=Z,Z+=Ie.lineHeight});let H=0,de=0;if(V&&(typeof V=="number"?H=-V:typeof V=="string"&&(H=-Be*(V==="left"?0:V==="center"?.5:V==="right"?1:h(V)))),q&&(typeof q=="number"?de=-q:typeof q=="string"&&(de=q==="top"?0:q==="top-baseline"?-tt[0].baseline:q==="top-cap"?-tt[0].cap:q==="top-ex"?-tt[0].ex:q==="middle"?Z/2:q==="bottom"?Z:q==="bottom-baseline"?-tt[tt.length-1].baseline:h(q)*Z)),!re){const Ie=e.getEmbeddingLevels(x,F);le=new Uint16Array(Le),fe=new Uint8Array(Le),_e=new Float32Array(Le*2),Pe={},Je=[1/0,1/0,-1/0,-1/0],_t=[],ce&&(ot=new Float32Array(x.length*4)),oe&&(et=new Uint8Array(Le*3));let we=0,st=-1,it=-1,It,Ot;if(tt.forEach((Qe,Ve)=>{let{count:at,width:bt}=Qe;if(at>0){let ht=0;for(let nt=at;nt--&&Qe.glyphAt(nt).glyphObj.isWhitespace;)ht++;let Vt=0,ve=0;if(L==="center")Vt=(Be-bt)/2;else if(L==="right")Vt=Be-bt;else if(L==="justify"&&Qe.isSoftWrapped){let nt=0;for(let ke=at-ht;ke--;)Qe.glyphAt(ke).glyphObj.isWhitespace&&nt++;ve=(Be-bt)/nt}if(ve||Vt){let nt=0;for(let ke=0;ke<at;ke++){let gt=Qe.glyphAt(ke);const Qt=gt.glyphObj;gt.x+=Vt+nt,ve!==0&&Qt.isWhitespace&&ke<at-ht&&(nt+=ve,gt.width+=ve)}}const Me=e.getReorderSegments(x,Ie,Qe.glyphAt(0).charIndex,Qe.glyphAt(Qe.count-1).charIndex);for(let nt=0;nt<Me.length;nt++){const[ke,gt]=Me[nt];let Qt=1/0,kt=-1/0;for(let rn=0;rn<at;rn++)if(Qe.glyphAt(rn).charIndex>=ke){let ti=rn,ui=rn;for(;ui<at;ui++){let vi=Qe.glyphAt(ui);if(vi.charIndex>gt)break;ui<at-ht&&(Qt=Math.min(Qt,vi.x),kt=Math.max(kt,vi.x+vi.width))}for(let vi=ti;vi<ui;vi++){const yr=Qe.glyphAt(vi);yr.x=kt-(yr.x+yr.width-Qt)}break}}let rt;const Ut=nt=>rt=nt;for(let nt=0;nt<at;nt++){const ke=Qe.glyphAt(nt);rt=ke.glyphObj;const gt=rt.index,Qt=Ie.levels[ke.charIndex]&1;if(Qt){const kt=e.getMirroredCharacter(x[ke.charIndex]);kt&&ke.fontData.fontObj.forEachGlyph(kt,0,0,Ut)}if(ce){const{charIndex:kt,fontData:rn}=ke,ti=ke.x+H,ui=ke.x+ke.width+H;ot[kt*4]=Qt?ui:ti,ot[kt*4+1]=Qt?ti:ui,ot[kt*4+2]=Qe.baseline+rn.caretBottom+de,ot[kt*4+3]=Qe.baseline+rn.caretTop+de;const vi=kt-st;vi>1&&p(ot,st,vi),st=kt}if(oe){const{charIndex:kt}=ke;for(;kt>it;)it++,oe.hasOwnProperty(it)&&(Ot=oe[it])}if(!rt.isWhitespace&&!rt.isEmpty){const kt=we++,{fontSizeMult:rn,src:ti,index:ui}=ke.fontData,vi=Pe[ti]||(Pe[ti]={});vi[gt]||(vi[gt]={path:rt.path,pathBounds:[rt.xMin,rt.yMin,rt.xMax,rt.yMax]});const yr=ke.x+H,Ir=ke.y+Qe.baseline+de;_e[kt*2]=yr,_e[kt*2+1]=Ir;const qr=yr+rt.xMin*rn,Ki=Ir+rt.yMin*rn,Rr=yr+rt.xMax*rn,en=Ir+rt.yMax*rn;qr<Je[0]&&(Je[0]=qr),Ki<Je[1]&&(Je[1]=Ki),Rr>Je[2]&&(Je[2]=Rr),en>Je[3]&&(Je[3]=en),kt%ue===0&&(It={start:kt,end:kt,rect:[1/0,1/0,-1/0,-1/0]},_t.push(It)),It.end++;const di=It.rect;if(qr<di[0]&&(di[0]=qr),Ki<di[1]&&(di[1]=Ki),Rr>di[2]&&(di[2]=Rr),en>di[3]&&(di[3]=en),le[kt]=gt,fe[kt]=ui,oe){const hi=kt*3;et[hi]=Ot>>16&255,et[hi+1]=Ot>>8&255,et[hi+2]=Ot&255}}}}}),ot){const Qe=x.length-st;Qe>1&&p(ot,st,Qe)}}const De=[];Ye.forEach(({index:Ie,src:we,unitsPerEm:st,ascender:it,descender:It,lineHeight:Ot,capHeight:Qe,xHeight:Ve})=>{De[Ie]={src:we,unitsPerEm:st,ascender:it,descender:It,lineHeight:Ot,capHeight:Qe,xHeight:Ve}}),ae.typesetting=g()-ne,z({glyphIds:le,glyphFontIndices:fe,glyphPositions:_e,glyphData:Pe,fontData:De,caretPositions:ot,glyphColors:et,chunkedBounds:_t,fontSize:C,topBaseline:de+tt[0].baseline,blockBounds:[H,de-Z,H+Be,de],visibleBounds:Je,timings:ae})})}function c(x,S){o({...x,metricsOnly:!0},_=>{const[E,C,T,R]=_.blockBounds;S({width:T-E,height:R-C})})}function h(x){let S=x.match(/^([\d.]+)%$/),_=S?parseFloat(S[1]):NaN;return isNaN(_)?0:_/100}function p(x,S,_){const E=x[S*4],C=x[S*4+1],T=x[S*4+2],R=x[S*4+3],B=(C-E)/_;for(let U=0;U<_;U++){const O=(S+U)*4;x[O]=E+B*U,x[O+1]=E+B*(U+1),x[O+2]=T,x[O+3]=R}}function g(){return(self.performance||Date).now()}function A(){this.data=[]}const v=["glyphObj","x","y","width","charIndex","fontData"];return A.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/v.length)},glyphAt(x){let S=A.flyweight;return S.data=this.data,S.index=x,S},splitAt(x){let S=new A;return S.data=this.data.splice(x*v.length),S}},A.flyweight=v.reduce((x,S,_,E)=>(Object.defineProperty(x,S,{get(){return this.data[this.index*v.length+_]},set(C){this.data[this.index*v.length+_]=C}}),x),{data:null,index:0}),{typeset:o,measure:c}}const Rm=()=>(self.performance||Date).now(),gC=SG();let KO;function Xce(n,e,t,i,r,s,a,o,c,h,p=!0){return p?Kce(n,e,t,i,r,s,a,o,c,h).then(null,g=>(KO||(console.warn("WebGL SDF generation failed, falling back to JS",g),KO=!0),JO(n,e,t,i,r,s,a,o,c,h))):JO(n,e,t,i,r,s,a,o,c,h)}const nw=[],Yce=5;let w2=0;function wG(){const n=Rm();for(;nw.length&&Rm()-n<Yce;)nw.shift()();w2=nw.length?setTimeout(wG,0):0}const Kce=(...n)=>new Promise((e,t)=>{nw.push(()=>{const i=Rm();try{gC.webgl.generateIntoCanvas(...n),e({timing:Rm()-i})}catch(r){t(r)}}),w2||(w2=setTimeout(wG,0))}),$ce=4,Jce=2e3,$O={};let Zce=0;function JO(n,e,t,i,r,s,a,o,c,h){const p="TroikaTextSDFGenerator_JS_"+Zce++%$ce;let g=$O[p];return g||(g=$O[p]={workerModule:gv({name:p,workerId:p,dependencies:[SG,Rm],init(A,v){const x=A().javascript.generate;return function(...S){const _=v();return{textureData:x(...S),timing:v()-_}}},getTransferables(A){return[A.textureData.buffer]}}),requests:0,idleTimer:null}),g.requests++,clearTimeout(g.idleTimer),g.workerModule(n,e,t,i,r,s).then(({textureData:A,timing:v})=>{const x=Rm(),S=new Uint8Array(A.length*4);for(let _=0;_<A.length;_++)S[_*4+h]=A[_];return gC.webglUtils.renderImageData(a,S,o,c,n,e,1<<3-h),v+=Rm()-x,--g.requests===0&&(g.idleTimer=setTimeout(()=>{Rce(p)},Jce)),{timing:v}})}function eue(n){n._warm||(gC.webgl.isSupported(n),n._warm=!0)}const tue=gC.webglUtils.resizeWebGLCanvasWithoutClearing,X1={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},nue=new Mt;function t0(){return(self.performance||Date).now()}const ZO=Object.create(null);function MG(n,e){n=sue({},n);const t=t0(),i=[];if(n.font&&i.push({label:"user",src:aue(n.font)}),n.font=i,n.text=""+n.text,n.sdfGlyphSize=n.sdfGlyphSize||X1.sdfGlyphSize,n.unicodeFontsURL=n.unicodeFontsURL||X1.unicodeFontsURL,n.colorRanges!=null){let A={};for(let v in n.colorRanges)if(n.colorRanges.hasOwnProperty(v)){let x=n.colorRanges[v];typeof x!="number"&&(x=nue.set(x).getHex()),A[v]=x}n.colorRanges=A}Object.freeze(n);const{textureWidth:r,sdfExponent:s}=X1,{sdfGlyphSize:a}=n,o=r/a*4;let c=ZO[a];if(!c){const A=document.createElement("canvas");A.width=r,A.height=a*256/o,c=ZO[a]={glyphCount:0,sdfGlyphSize:a,sdfCanvas:A,sdfTexture:new Pi(A,void 0,void 0,void 0,mn,mn),contextLost:!1,glyphsByFont:new Map},c.sdfTexture.generateMipmaps=!1,iue(c)}const{sdfTexture:h,sdfCanvas:p}=c;IG(n).then(A=>{const{glyphIds:v,glyphFontIndices:x,fontData:S,glyphPositions:_,fontSize:E,timings:C}=A,T=[],R=new Float32Array(v.length*4);let B=0,U=0;const O=t0(),F=S.map(V=>{let q=c.glyphsByFont.get(V.src);return q||c.glyphsByFont.set(V.src,q=new Map),q});v.forEach((V,q)=>{const re=x[q],{src:Q,unitsPerEm:K}=S[re];let ce=F[re].get(V);if(!ce){const{path:ae,pathBounds:he}=A.glyphData[Q][V],me=Math.max(he[2]-he[0],he[3]-he[1])/a*(X1.sdfMargin*a+.5),le=c.glyphCount++,fe=[he[0]-me,he[1]-me,he[2]+me,he[3]+me];F[re].set(V,ce={path:ae,atlasIndex:le,sdfViewBox:fe}),T.push(ce)}const{sdfViewBox:ue}=ce,oe=_[U++],z=_[U++],$=E/K;R[B++]=oe+ue[0]*$,R[B++]=z+ue[1]*$,R[B++]=oe+ue[2]*$,R[B++]=z+ue[3]*$,v[q]=ce.atlasIndex}),C.quads=(C.quads||0)+(t0()-O);const L=t0();C.sdf={};const P=p.height,W=Math.ceil(c.glyphCount/o),j=Math.pow(2,Math.ceil(Math.log2(W*a)));j>P&&(console.info(`Increasing SDF texture size ${P}->${j}`),tue(p,r,j),h.dispose()),Promise.all(T.map(V=>CG(V,c,n.gpuAccelerateSDF).then(({timing:q})=>{C.sdf[V.atlasIndex]=q}))).then(()=>{T.length&&!c.contextLost&&(TG(c),h.needsUpdate=!0),C.sdfTotal=t0()-L,C.total=t0()-t,e(Object.freeze({parameters:n,sdfTexture:h,sdfGlyphSize:a,sdfExponent:s,glyphBounds:R,glyphAtlasIndices:v,glyphColors:A.glyphColors,caretPositions:A.caretPositions,chunkedBounds:A.chunkedBounds,ascender:A.ascender,descender:A.descender,lineHeight:A.lineHeight,capHeight:A.capHeight,xHeight:A.xHeight,topBaseline:A.topBaseline,blockBounds:A.blockBounds,visibleBounds:A.visibleBounds,timings:A.timings}))})}),Promise.resolve().then(()=>{c.contextLost||eue(p)})}function CG({path:n,atlasIndex:e,sdfViewBox:t},{sdfGlyphSize:i,sdfCanvas:r,contextLost:s},a){if(s)return Promise.resolve({timing:-1});const{textureWidth:o,sdfExponent:c}=X1,h=Math.max(t[2]-t[0],t[3]-t[1]),p=Math.floor(e/4),g=p%(o/i)*i,A=Math.floor(p/(o/i))*i,v=e%4;return Xce(i,i,n,t,h,c,r,g,A,v,a)}function iue(n){const e=n.sdfCanvas;e.addEventListener("webglcontextlost",t=>{console.log("Context Lost",t),t.preventDefault(),n.contextLost=!0}),e.addEventListener("webglcontextrestored",t=>{console.log("Context Restored",t),n.contextLost=!1;const i=[];n.glyphsByFont.forEach(r=>{r.forEach(s=>{i.push(CG(s,n,!0))})}),Promise.all(i).then(()=>{TG(n),n.sdfTexture.needsUpdate=!0})})}function rue({font:n,characters:e,sdfGlyphSize:t},i){let r=Array.isArray(e)?e.join(`
`):""+e;MG({font:n,sdfGlyphSize:t,text:r},i)}function sue(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}let DE;function aue(n){return DE||(DE=typeof document>"u"?{}:document.createElement("a")),DE.href=n,DE.href}function TG(n){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:t}=n,{width:i,height:r}=e,s=n.sdfCanvas.getContext("webgl");let a=t.image.data;(!a||a.length!==i*r*4)&&(a=new Uint8Array(i*r*4),t.image={width:i,height:r,data:a},t.flipY=!1,t.isDataTexture=!0),s.readPixels(0,0,i,r,s.RGBA,s.UNSIGNED_BYTE,a)}}const oue=gv({name:"Typesetter",dependencies:[qce,Wce,Dce],init(n,e,t){return n(e,t())}}),IG=gv({name:"Typesetter",dependencies:[oue],init(n){return function(e){return new Promise(t=>{n.typeset(e,t)})}},getTransferables(n){const e=[];for(let t in n)n[t]&&n[t].buffer&&e.push(n[t].buffer);return e}});IG.onMainThread;const e5={};function lue(n){let e=e5[n];return e||(e=e5[n]=new ra(1,1,n,n).translate(.5,.5,0)),e}const cue="aTroikaGlyphBounds",t5="aTroikaGlyphIndex",uue="aTroikaGlyphColor";class hue extends I4{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new jr,this.boundingBox=new gr}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let t=lue(e);["position","normal","uv"].forEach(i=>{this.attributes[i]=t.attributes[i].clone()}),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,i,r,s){this.updateAttributeData(cue,e,4),this.updateAttributeData(t5,t,1),this.updateAttributeData(uue,s,3),this._blockBounds=i,this._chunkedBounds=r,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:i}=this;if(t){const{PI:r,floor:s,min:a,max:o,sin:c,cos:h}=Math,p=r/2,g=r*2,A=Math.abs(t),v=e[0]/A,x=e[2]/A,S=s((v+p)/g)!==s((x+p)/g)?-A:a(c(v)*A,c(x)*A),_=s((v-p)/g)!==s((x-p)/g)?A:o(c(v)*A,c(x)*A),E=s((v+r)/g)!==s((x+r)/g)?A*2:o(A-h(v)*A,A-h(x)*A);i.min.set(S,e[1],t<0?-E:0),i.max.set(_,e[3],t<0?0:E)}else i.min.set(e[0],e[1],0),i.max.set(e[2],e[3],0);i.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(t5).count,i=this._chunkedBounds;if(i)for(let r=i.length;r--;){t=i[r].end;let s=i[r].rect;if(s[1]<e.w&&s[3]>e.y&&s[0]<e.z&&s[2]>e.x)break}this.instanceCount=t}updateAttributeData(e,t,i){const r=this.getAttribute(e);t?r&&r.array.length===t.length?(r.array.set(t),r.needsUpdate=!0):(this.setAttribute(e,new jd(t,i)),delete this._maxInstanceCount,this.dispose()):r&&this.deleteAttribute(e)}}const fue=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,due=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,pue=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,mue=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function gue(n){const e=E2(n,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Ze},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Ii(0,0,0,0)},uTroikaClipRect:{value:new Ii(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Ze},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Mt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Rn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:fue,vertexTransform:due,fragmentDefs:pue,fragmentColorTransform:mue,customRewriter({vertexShader:t,fragmentShader:i}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(i)&&(i=i.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(t)||(t=t.replace(EG,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:t,fragmentShader:i}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const oB=new ar({color:16777215,side:gi,transparent:!0}),n5=8421504,i5=new qt,LE=new ee,hR=new ee,U1=[],Aue=new ee,fR="+x+y";function r5(n){return Array.isArray(n)?n[0]:n}let RG=()=>{const n=new Wt(new ra(1,1),oB);return RG=()=>n,n},BG=()=>{const n=new Wt(new ra(1,1,32,1),oB);return BG=()=>n,n};const vue={type:"syncstart"},yue={type:"synccomplete"},DG=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],bue=DG.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let LG=class extends Wt{constructor(){const e=new hue;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=n5,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=fR,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(vue),MG({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const i=this._queuedSyncs;i&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{i.forEach(r=>r&&r())})),this.dispatchEvent(yue),e&&e()})))}onBeforeRender(e,t,i,r,s,a){this.sync(),s.isTroikaTextMaterial&&this._prepareForRender(s)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return gue(e)}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=oB.clone());if((!e||!e.isDerivedFrom(t))&&(e=this._derivedMaterial=this.createDerivedMaterial(t),t.addEventListener("dispose",function i(){t.removeEventListener("dispose",i),e.dispose()})),this.hasOutline()){let i=e._outlineMtl;return i||(i=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),i.isTextOutlineMaterial=!0,i.depthWrite=!1,i.map=null,e.addEventListener("dispose",function r(){e.removeEventListener("dispose",r),i.dispose()})),[i,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return r5(this.material).getDepthMaterial()}set customDepthMaterial(e){}get customDistanceMaterial(){return r5(this.material).getDistanceMaterial()}set customDistanceMaterial(e){}_prepareForRender(e){const t=e.isTextOutlineMaterial,i=e.uniforms,r=this.textRenderInfo;if(r){const{sdfTexture:o,blockBounds:c}=r;i.uTroikaSDFTexture.value=o,i.uTroikaSDFTextureSize.value.set(o.image.width,o.image.height),i.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,i.uTroikaSDFExponent.value=r.sdfExponent,i.uTroikaTotalBounds.value.fromArray(c),i.uTroikaUseGlyphColors.value=!t&&!!r.glyphColors;let h=0,p=0,g=0,A,v,x,S=0,_=0;if(t){let{outlineWidth:C,outlineOffsetX:T,outlineOffsetY:R,outlineBlur:B,outlineOpacity:U}=this;h=this._parsePercent(C)||0,p=Math.max(0,this._parsePercent(B)||0),A=U,S=this._parsePercent(T)||0,_=this._parsePercent(R)||0}else g=Math.max(0,this._parsePercent(this.strokeWidth)||0),g&&(x=this.strokeColor,i.uTroikaStrokeColor.value.set(x??n5),v=this.strokeOpacity,v==null&&(v=1)),A=this.fillOpacity;i.uTroikaEdgeOffset.value=h,i.uTroikaPositionOffset.value.set(S,_),i.uTroikaBlurRadius.value=p,i.uTroikaStrokeWidth.value=g,i.uTroikaStrokeOpacity.value=v,i.uTroikaFillOpacity.value=A??1,i.uTroikaCurveRadius.value=this.curveRadius||0;let E=this.clipRect;if(E&&Array.isArray(E)&&E.length===4)i.uTroikaClipRect.value.fromArray(E);else{const C=(this.fontSize||.1)*100;i.uTroikaClipRect.value.set(c[0]-C,c[1]-C,c[2]+C,c[3]+C)}this.geometry.applyClipRect(i.uTroikaClipRect.value)}i.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const s=t?this.outlineColor||0:this.color;if(s==null)delete e.color;else{const o=e.hasOwnProperty("color")?e.color:e.color=new Mt;(s!==o._input||typeof s=="object")&&o.set(o._input=s)}let a=this.orientation||fR;if(a!==e._orientation){let o=i.uTroikaOrient.value;a=a.replace(/[^-+xyz]/g,"");let c=a!==fR&&a.match(/^([-+])([xyz])([-+])([xyz])$/);if(c){let[,h,p,g,A]=c;LE.set(0,0,0)[p]=h==="-"?1:-1,hR.set(0,0,0)[A]=g==="-"?-1:1,i5.lookAt(Aue,LE.cross(hR),hR),o.setFromMatrix4(i5)}else o.identity();e._orientation=a}}_parsePercent(e){if(typeof e=="string"){let t=e.match(/^(-?[\d.]+)%$/),i=t?parseFloat(t[1]):NaN;e=(isNaN(i)?0:i/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new Ze){t.copy(e);const i=this.curveRadius;return i&&(t.x=Math.atan2(e.x,Math.abs(i)-Math.abs(e.z))*Math.abs(i)),t}worldPositionToTextCoords(e,t=new Ze){return LE.copy(e),this.localPositionToTextCoords(this.worldToLocal(LE),t)}raycast(e,t){const{textRenderInfo:i,curveRadius:r}=this;if(i){const s=i.blockBounds,a=r?BG():RG(),o=a.geometry,{position:c,uv:h}=o.attributes;for(let p=0;p<h.count;p++){let g=s[0]+h.getX(p)*(s[2]-s[0]);const A=s[1]+h.getY(p)*(s[3]-s[1]);let v=0;r&&(v=r-Math.cos(g/r)*r,g=Math.sin(g/r)*r),c.setXYZ(p,g,A,v)}o.boundingSphere=this.geometry.boundingSphere,o.boundingBox=this.geometry.boundingBox,a.matrixWorld=this.matrixWorld,a.material.side=this.material.side,U1.length=0,a.raycast(e,U1);for(let p=0;p<U1.length;p++)U1[p].object=this,t.push(U1[p])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,bue.forEach(i=>{this[i]=e[i]}),this}clone(){return new this.constructor().copy(this)}};DG.forEach(n=>{const e="_private_"+n;Object.defineProperty(LG.prototype,n,{get(){return this[e]},set(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})});new gr;new Mt;const NG=X.forwardRef(({sdfGlyphSize:n=64,anchorX:e="center",anchorY:t="middle",font:i,fontSize:r=1,children:s,characters:a,onSync:o,...c},h)=>{const p=dl(({invalidate:x})=>x),[g]=X.useState(()=>new LG),[A,v]=X.useMemo(()=>{const x=[];let S="";return X.Children.forEach(s,_=>{typeof _=="string"||typeof _=="number"?S+=_:x.push(_)}),[x,S]},[s]);return W4(()=>new Promise(x=>rue({font:i,characters:a},x)),["troika-text",i,a]),X.useLayoutEffect(()=>{g.sync(()=>{p(),o&&o(g)})}),X.useEffect(()=>()=>g.dispose(),[g]),X.createElement("primitive",Ob({object:g,ref:h,font:i,text:v,anchorX:e,anchorY:t,fontSize:r,sdfGlyphSize:n},c),A)});var xue=`#define GLSLIFY 1
vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}`;class _ue extends vl{constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._distort={value:.4},this._radius={value:1}}onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.radius=this._radius,e.uniforms.distort=this._distort,e.vertexShader=`
      uniform float time;
      uniform float radius;
      uniform float distort;
      ${xue}
      ${e.vertexShader}
    `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>",`
        float updateTime = time / 50.0;
        float noise = snoise(vec3(position / 2.0 + updateTime * 5.0));
        vec3 transformed = vec3(position * (noise * pow(distort, 2.0) + radius));
        `)}get time(){return this._time.value}set time(e){this._time.value=e}get distort(){return this._distort.value}set distort(e){this._distort.value=e}get radius(){return this._radius.value}set radius(e){this._radius.value=e}}const Sue=X.forwardRef(({speed:n=1,...e},t)=>{const[i]=X.useState(()=>new _ue);return Gi(r=>i&&(i.time=r.clock.elapsedTime*n)),X.createElement("primitive",Ob({object:i,ref:t,attach:"material"},e))}),UG=X.forwardRef(({children:n,enabled:e=!0,speed:t=1,rotationIntensity:i=1,floatIntensity:r=1,floatingRange:s=[-.1,.1],autoInvalidate:a=!1,...o},c)=>{const h=X.useRef(null);X.useImperativeHandle(c,()=>h.current,[]);const p=X.useRef(Math.random()*1e4);return Gi(g=>{var A,v;if(!e||t===0)return;a&&g.invalidate();const x=p.current+g.clock.elapsedTime;h.current.rotation.x=Math.cos(x/4*t)/8*i,h.current.rotation.y=Math.sin(x/4*t)/8*i,h.current.rotation.z=Math.sin(x/4*t)/20*i;let S=Math.sin(x/4*t)/10;S=D0.mapLinear(S,-.1,.1,(A=s?.[0])!==null&&A!==void 0?A:-.1,(v=s?.[1])!==null&&v!==void 0?v:.1),h.current.position.y=S*r,h.current.updateMatrix()}),X.createElement("group",o,X.createElement("group",{ref:h,matrixAutoUpdate:!1},n))}),kb={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},FG="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",y0=n=>Array.isArray(n),lB=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function AC({files:n=lB,path:e="",preset:t=void 0,colorSpace:i=void 0,extensions:r}={}){t&&(cB(t),n=kb[t],e=FG);const s=y0(n),{extension:a,isCubemap:o}=uB(n),c=hB(a);if(!c)throw new Error("useEnvironment: Unrecognized file extension: "+n);const h=dl(v=>v.gl);X.useLayoutEffect(()=>{if(a!=="webp"&&a!=="jpg"&&a!=="jpeg")return;function v(){Zm.clear(c,s?[n]:n)}h.domElement.addEventListener("webglcontextlost",v,{once:!0})},[n,h.domElement]);const p=Zm(c,s?[n]:n,v=>{(a==="webp"||a==="jpg"||a==="jpeg")&&v.setRenderer(h),v.setPath==null||v.setPath(e),r&&r(v)});let g=s?p[0]:p;if(a==="jpg"||a==="jpeg"||a==="webp"){var A;g=(A=g.renderTarget)==null?void 0:A.texture}return g.mapping=o?jc:Om,g.colorSpace=i??(o?"srgb":"srgb-linear"),g}const Eue={files:lB,path:"",preset:void 0,extensions:void 0};AC.preload=n=>{const e={...Eue,...n};let{files:t,path:i=""}=e;const{preset:r,extensions:s}=e;r&&(cB(r),t=kb[r],i=FG);const{extension:a}=uB(t);if(a==="webp"||a==="jpg"||a==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const o=hB(a);if(!o)throw new Error("useEnvironment: Unrecognized file extension: "+t);Zm.preload(o,y0(t)?[t]:t,c=>{c.setPath==null||c.setPath(i),s&&s(c)})};const wue={files:lB,preset:void 0};AC.clear=n=>{const e={...wue,...n};let{files:t}=e;const{preset:i}=e;i&&(cB(i),t=kb[i]);const{extension:r}=uB(t),s=hB(r);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);Zm.clear(s,y0(t)?[t]:t)};function cB(n){if(!(n in kb))throw new Error("Preset must be one of: "+Object.keys(kb).join(", "))}function uB(n){var e;const t=y0(n)&&n.length===6,i=y0(n)&&n.length===3&&n.some(a=>a.endsWith("json")),r=y0(n)?n[0]:n;return{extension:t?"cube":i?"webp":r.startsWith("data:application/exr")?"exr":r.startsWith("data:application/hdr")?"hdr":r.startsWith("data:image/jpeg")?"jpg":(e=r.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:i}}function hB(n){return n==="cube"?J8:n==="hdr"?Ece:n==="exr"?wce:n==="jpg"||n==="jpeg"?O9:n==="webp"?sie:null}const Mue=n=>n.current&&n.current.isScene,Cue=n=>Mue(n)?n.current:n;function fB(n,e,t,i,r={}){var s,a,o,c;r={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const h=Cue(e||t),p=h.background,g=h.environment,A={backgroundBlurriness:h.backgroundBlurriness,backgroundIntensity:h.backgroundIntensity,backgroundRotation:(s=(a=h.backgroundRotation)==null||a.clone==null?void 0:a.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:h.environmentIntensity,environmentRotation:(o=(c=h.environmentRotation)==null||c.clone==null?void 0:c.clone())!==null&&o!==void 0?o:[0,0,0]};return n!=="only"&&(h.environment=i),n&&(h.background=i),ju(h,r),()=>{n!=="only"&&(h.environment=g),n&&(h.background=p),ju(h,A)}}function dB({scene:n,background:e=!1,map:t,...i}){const r=dl(s=>s.scene);return X.useLayoutEffect(()=>{if(t)return fB(e,n,r,t,i)}),null}function PG({background:n=!1,scene:e,blur:t,backgroundBlurriness:i,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:a,environmentRotation:o,...c}){const h=AC(c),p=dl(g=>g.scene);return X.useLayoutEffect(()=>fB(n,e,p,h,{backgroundBlurriness:t??i,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:a,environmentRotation:o})),X.useEffect(()=>()=>{h.dispose()},[h]),null}function Tue({children:n,near:e=.1,far:t=1e3,resolution:i=256,frames:r=1,map:s,background:a=!1,blur:o,backgroundBlurriness:c,backgroundIntensity:h,backgroundRotation:p,environmentIntensity:g,environmentRotation:A,scene:v,files:x,path:S,preset:_=void 0,extensions:E}){const C=dl(F=>F.gl),T=dl(F=>F.scene),R=X.useRef(null),[B]=X.useState(()=>new uc),U=X.useMemo(()=>{const F=new rv(i);return F.texture.type=ci,F},[i]);X.useEffect(()=>()=>{U.dispose()},[U]),X.useLayoutEffect(()=>{if(r===1){const F=C.autoClear;C.autoClear=!0,R.current.update(C,B),C.autoClear=F}return fB(a,v,T,U.texture,{backgroundBlurriness:o??c,backgroundIntensity:h,backgroundRotation:p,environmentIntensity:g,environmentRotation:A})},[n,B,U.texture,v,T,a,r,C]);let O=1;return Gi(()=>{if(r===1/0||O<r){const F=C.autoClear;C.autoClear=!0,R.current.update(C,B),C.autoClear=F,O++}}),X.createElement(X.Fragment,null,aC(X.createElement(X.Fragment,null,n,X.createElement("cubeCamera",{ref:R,args:[e,t,U]}),x||_?X.createElement(PG,{background:!0,files:x,preset:_,path:S,extensions:E}):s?X.createElement(dB,{background:!0,map:s,extensions:E}):null),B))}function Iue(n){var e,t,i,r;const s=AC(n),a=n.map||s;X.useMemo(()=>wz({GroundProjectedEnvImpl:Sce}),[]),X.useEffect(()=>()=>{s.dispose()},[s]);const o=X.useMemo(()=>[a],[a]),c=(e=n.ground)==null?void 0:e.height,h=(t=n.ground)==null?void 0:t.radius,p=(i=(r=n.ground)==null?void 0:r.scale)!==null&&i!==void 0?i:1e3;return X.createElement(X.Fragment,null,X.createElement(dB,Ob({},n,{map:a})),X.createElement("groundProjectedEnvImpl",{args:o,scale:p,height:c,radius:h}))}function vC(n){return n.ground?X.createElement(Iue,n):n.map?X.createElement(dB,n):n.children?X.createElement(Tue,n):X.createElement(PG,n)}const s5=cG({depthSensing:!0,hitTest:!0}),Rue=[{id:"cube",name:"Cube",emoji:""},{id:"sphere",name:"Sphere",emoji:""},{id:"cylinder",name:"Cylinder",emoji:""},{id:"cone",name:"Cone",emoji:""},{id:"torus",name:"Donut",emoji:""},{id:"tree",name:"Tree",emoji:""}];function Bue({onPlace:n}){const e=X.useRef(null),t=X.useRef(new ee),i=X.useRef(new Us);aB((a,o)=>{if(!e.current||a.length===0)return;const c=new qt;o(c,a[0])&&(e.current.visible=!0,e.current.matrix.copy(c),e.current.matrix.decompose(e.current.position,e.current.quaternion,e.current.scale),t.current.copy(e.current.position),i.current.setFromQuaternion(e.current.quaternion))},"viewer"),Gi(a=>{if(!e.current||!e.current.visible)return;const o=a.clock.elapsedTime,c=.15+Math.sin(o*3)*.02;e.current.scale.set(c,c,c)});const r=X.useCallback(()=>{e.current?.visible&&n(t.current.clone(),i.current.clone())},[n]),{gl:s}=dl();return Gi(()=>{const a=s.xr.getSession();if(a)return a.addEventListener("select",r),()=>a.removeEventListener("select",r)}),D.jsxs("mesh",{ref:e,"rotation-x":-Math.PI/2,visible:!1,matrixAutoUpdate:!1,children:[D.jsx("ringGeometry",{args:[.1,.12,32]}),D.jsx("meshBasicMaterial",{color:"#06b6d4",transparent:!0,opacity:.8,side:gi}),D.jsxs("mesh",{"rotation-x":0,children:[D.jsx("circleGeometry",{args:[.08,32]}),D.jsx("meshBasicMaterial",{color:"#06b6d4",transparent:!0,opacity:.3,side:gi})]})]})}function OG({object:n}){const e=X.useRef(null);Gi(r=>{if(!e.current)return;const s=r.clock.elapsedTime;e.current.position.y=n.position[1]+Math.sin(s*2+n.position[0])*.02,e.current.rotation.y=s*.3});const t=()=>{switch(n.type){case"sphere":return D.jsx("sphereGeometry",{args:[.08*n.scale,32,32]});case"cylinder":return D.jsx("cylinderGeometry",{args:[.05*n.scale,.05*n.scale,.15*n.scale,32]});case"cone":return D.jsx("coneGeometry",{args:[.07*n.scale,.15*n.scale,32]});case"torus":return D.jsx("torusGeometry",{args:[.06*n.scale,.025*n.scale,16,32]});case"tree":return D.jsx("coneGeometry",{args:[.08*n.scale,.2*n.scale,8]});default:return D.jsx("boxGeometry",{args:[.1*n.scale,.1*n.scale,.1*n.scale]})}},i=()=>{switch(n.type){case"sphere":return"#3b82f6";case"cylinder":return"#f59e0b";case"cone":return"#ef4444";case"torus":return"#ec4899";case"tree":return"#22c55e";default:return"#667eea"}};return D.jsxs("mesh",{ref:e,position:n.position,rotation:n.rotation,castShadow:!0,receiveShadow:!0,children:[t(),D.jsx("meshStandardMaterial",{color:i(),metalness:.3,roughness:.4,envMapIntensity:.5})]})}function Due({placedObjects:n,onPlace:e}){return D.jsxs(D.Fragment,{children:[D.jsx(fG,{}),D.jsx("ambientLight",{intensity:.6}),D.jsx("directionalLight",{position:[5,5,5],intensity:.8,castShadow:!0,"shadow-mapSize":[1024,1024]}),D.jsx(vC,{preset:"city"}),D.jsx(Bue,{onPlace:e}),n.map(t=>D.jsx(OG,{object:t},t.id))]})}function Lue({placedObjects:n}){return D.jsxs(D.Fragment,{children:[D.jsx("ambientLight",{intensity:.5}),D.jsx("directionalLight",{position:[5,5,5],intensity:.8}),D.jsx(vC,{preset:"city"}),D.jsxs("mesh",{"rotation-x":-Math.PI/2,"position-y":0,receiveShadow:!0,children:[D.jsx("planeGeometry",{args:[10,10]}),D.jsx("meshStandardMaterial",{color:"#1a1a2e"})]}),D.jsx("gridHelper",{args:[10,20,"#333","#222"]}),n.map(e=>D.jsx(OG,{object:e},e.id))]})}function Nue(){const[n,e]=X.useState(null),[t,i]=X.useState(!1),[r,s]=X.useState("cube"),[a,o]=X.useState([]),c=X.useCallback(async()=>{if(!navigator.xr){e(!1);return}try{const A=await navigator.xr.isSessionSupported("immersive-ar");e(A)}catch{e(!1)}},[]);X.useState(()=>{c()});const h=X.useCallback((A,v)=>{const x={id:`obj-${Date.now()}`,position:[A.x,A.y+.05,A.z],rotation:[v.x,v.y,v.z],type:r,scale:1};o(S=>[...S,x])},[r]),p=X.useCallback(()=>{o([])},[]),g=X.useCallback(async()=>{try{await s5.enterAR(),i(!0)}catch(A){console.error("Failed to enter AR:",A)}},[]);return D.jsxs("div",{className:"experiment-page surface-detection-page",children:[D.jsxs("header",{className:"experiment-header",children:[D.jsx(nh,{to:"/",className:"back-link",children:" Back"}),D.jsxs("div",{children:[D.jsx("h1",{children:"Surface Detection"}),D.jsx("p",{children:"Place objects on real-world surfaces"})]})]}),D.jsxs("div",{className:"ar-container-wrapper",children:[D.jsxs("div",{className:"ar-container",children:[D.jsx(Lz,{shadows:!0,camera:{position:[0,1.5,3],fov:50},gl:{alpha:!0},children:D.jsx(uG,{store:s5,children:t?D.jsx(Due,{placedObjects:a,onPlace:h}):D.jsx(Lue,{placedObjects:a})})}),n===!1&&D.jsxs("div",{className:"unsupported-overlay",children:[D.jsx("span",{className:"unsupported-icon",children:""}),D.jsx("h3",{children:"WebXR AR Not Available"}),D.jsx("p",{children:"Surface detection requires WebXR AR support."}),D.jsxs("ul",{className:"requirements-list",children:[D.jsx("li",{children:"Chrome on Android (ARCore devices)"}),D.jsx("li",{children:"Safari on iOS 15+ (with WebXR flag)"}),D.jsx("li",{children:"Meta Quest Browser"})]}),D.jsx("p",{className:"fallback-note",children:"Preview mode is shown below."})]}),!t&&n!==!1&&D.jsxs("div",{className:"ar-start-overlay",children:[D.jsx("button",{onClick:g,className:"start-ar-button",children:" Enter AR Mode"}),D.jsx("p",{className:"ar-note",children:n===null?"Checking WebXR support...":"Tap to place objects on surfaces"})]})]}),t&&D.jsxs("div",{className:"ar-controls",children:[D.jsx("button",{onClick:p,className:"clear-button",children:" Clear All"}),D.jsxs("span",{className:"object-count",children:[a.length," objects placed"]})]})]}),D.jsxs("div",{className:"objects-section",children:[D.jsx("h2",{children:"Select Object"}),D.jsx("p",{className:"section-desc",children:"Choose what to place when you tap:"}),D.jsx("div",{className:"objects-grid",children:Rue.map(A=>D.jsxs("button",{className:`object-button ${r===A.id?"active":""}`,onClick:()=>s(A.id),children:[D.jsx("span",{className:"object-emoji",children:A.emoji}),D.jsx("span",{className:"object-name",children:A.name})]},A.id))})]}),D.jsxs("section",{className:"info-section",children:[D.jsx("h2",{children:"How It Works"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"WebXR Hit Test"}),"  Casts rays to find surfaces"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"ARCore/ARKit"}),"  Native platform AR engines"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Plane Detection"}),"  Identifies horizontal/vertical planes"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"@react-three/xr"}),"  React bindings for WebXR"]})]}),D.jsx("h2",{children:"Surface Types"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"Horizontal"}),"  Floors, tables, counters"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Vertical"}),"  Walls (limited support)"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Ceiling"}),"  Overhead surfaces (rare)"]})]}),D.jsx("h2",{children:"Browser Requirements"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"Android"}),"  Chrome 79+ with ARCore device"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"iOS"}),"  Safari 15+ (WebXR flag required)"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Quest"}),"  Meta Quest Browser"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Desktop"}),"  Preview only (no AR)"]})]}),D.jsx("h2",{children:"Use Cases"}),D.jsxs("ul",{children:[D.jsx("li",{children:"Furniture placement and room planning"}),D.jsx("li",{children:"Product visualization at scale"}),D.jsx("li",{children:"AR games with physics"}),D.jsx("li",{children:"Interior design and decoration"}),D.jsx("li",{children:"Educational 3D models in context"})]})]})]})}const a5=cG({depthSensing:!0,hitTest:!0,anchors:!0,domOverlay:!0}),Uue=[{id:"markers",name:"Spatial Markers",emoji:"",description:"Place markers to remember locations"},{id:"portals",name:"AR Portals",emoji:"",description:"Create floating portal effects"},{id:"notes",name:"Sticky Notes",emoji:"",description:"Leave notes in physical space"},{id:"lights",name:"Light Orbs",emoji:"",description:"Place glowing light sources"}],o5=["#ef4444","#f59e0b","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function l5({anchor:n}){const e=X.useRef(null);return Gi(t=>{if(!e.current)return;const i=t.clock.elapsedTime;e.current.rotation.y=i*.5}),D.jsxs("group",{ref:e,position:n.position,rotation:n.rotation,children:[D.jsxs("mesh",{position:[0,.15,0],children:[D.jsx("sphereGeometry",{args:[.04,16,16]}),D.jsx("meshStandardMaterial",{color:n.color,metalness:.7,roughness:.3,emissive:n.color,emissiveIntensity:.2})]}),D.jsxs("mesh",{position:[0,.06,0],children:[D.jsx("cylinderGeometry",{args:[.01,.015,.12,16]}),D.jsx("meshStandardMaterial",{color:"#333",metalness:.8,roughness:.2})]}),D.jsxs("mesh",{"rotation-x":-Math.PI/2,children:[D.jsx("ringGeometry",{args:[.05,.07,32]}),D.jsx("meshBasicMaterial",{color:n.color,transparent:!0,opacity:.5,side:gi})]})]})}function Fue({anchor:n}){const e=X.useRef(null);return Gi(t=>{if(!e.current)return;const i=t.clock.elapsedTime;e.current.rotation.y=i*.3,e.current.children.forEach((r,s)=>{r.type==="Mesh"&&s>1&&(r.rotation.z=i*(1+s*.2))})}),D.jsxs("group",{ref:e,position:n.position,children:[D.jsxs("mesh",{children:[D.jsx("torusGeometry",{args:[.15,.015,16,64]}),D.jsx("meshStandardMaterial",{color:n.color,metalness:.9,roughness:.1,emissive:n.color,emissiveIntensity:.3})]}),D.jsxs("mesh",{"position-z":.01,children:[D.jsx("circleGeometry",{args:[.13,64]}),D.jsx("meshBasicMaterial",{color:"#000022",transparent:!0,opacity:.8,side:gi})]}),[...Array(12)].map((t,i)=>D.jsxs("mesh",{position:[Math.cos(i/12*Math.PI*2)*.12,Math.sin(i/12*Math.PI*2)*.12,.02],children:[D.jsx("sphereGeometry",{args:[.008,8,8]}),D.jsx("meshBasicMaterial",{color:n.color})]},i))]})}function Pue({anchor:n}){const e=X.useRef(null);return Gi(t=>{if(!e.current)return;const i=t.camera;e.current.lookAt(i.position)}),D.jsx(UG,{speed:2,rotationIntensity:.1,floatIntensity:.2,children:D.jsxs("group",{ref:e,position:n.position,children:[D.jsxs("mesh",{children:[D.jsx("planeGeometry",{args:[.15,.12]}),D.jsx("meshBasicMaterial",{color:n.color,side:gi})]}),D.jsx(NG,{position:[0,0,.001],fontSize:.02,color:"#000",anchorX:"center",anchorY:"middle",maxWidth:.13,children:n.label||"Note"}),D.jsxs("mesh",{position:[.005,-.005,-.001],children:[D.jsx("planeGeometry",{args:[.15,.12]}),D.jsx("meshBasicMaterial",{color:"#000",transparent:!0,opacity:.2,side:gi})]})]})})}function Oue({anchor:n}){const e=X.useRef(null);return Gi(t=>{if(!e.current)return;const i=t.clock.elapsedTime;e.current.position.y=n.position[1]+.1+Math.sin(i*2)*.03}),D.jsxs("group",{position:n.position,children:[D.jsxs("mesh",{ref:e,children:[D.jsx("sphereGeometry",{args:[.06,32,32]}),D.jsx(Sue,{color:n.color,emissive:n.color,emissiveIntensity:.8,transparent:!0,opacity:.9,distort:.2,speed:2})]}),D.jsx("pointLight",{color:n.color,intensity:.5,distance:1,position:[0,.1,0]}),D.jsxs("mesh",{"rotation-x":-Math.PI/2,"position-y":.01,children:[D.jsx("circleGeometry",{args:[.1,32]}),D.jsx("meshBasicMaterial",{color:n.color,transparent:!0,opacity:.3,side:gi})]})]})}function kG({anchor:n}){switch(n.type){case"markers":return D.jsx(l5,{anchor:n});case"portals":return D.jsx(Fue,{anchor:n});case"notes":return D.jsx(Pue,{anchor:n});case"lights":return D.jsx(Oue,{anchor:n});default:return D.jsx(l5,{anchor:n})}}function kue({onPlace:n,anchorColor:e}){const t=X.useRef(null),i=X.useRef(new ee),r=X.useRef(new Us),{gl:s}=dl();return aB((a,o)=>{if(!t.current||a.length===0)return;const c=new qt;o(c,a[0])&&(t.current.visible=!0,t.current.matrix.copy(c),t.current.matrix.decompose(t.current.position,t.current.quaternion,t.current.scale),i.current.copy(t.current.position),r.current.setFromQuaternion(t.current.quaternion))},"viewer"),Gi(a=>{if(!t.current?.visible)return;const o=a.clock.elapsedTime,c=.12+Math.sin(o*4)*.01;t.current.scale.set(c,c,c)}),X.useEffect(()=>{const a=s.xr.getSession();if(!a)return;const o=()=>{t.current?.visible&&n(i.current.clone(),r.current.clone())};return a.addEventListener("select",o),()=>a.removeEventListener("select",o)},[s,n]),D.jsxs("mesh",{ref:t,"rotation-x":-Math.PI/2,visible:!1,matrixAutoUpdate:!1,children:[D.jsx("ringGeometry",{args:[.08,.1,32]}),D.jsx("meshBasicMaterial",{color:e,transparent:!0,opacity:.8,side:gi}),D.jsxs("mesh",{children:[D.jsx("ringGeometry",{args:[.04,.06,32]}),D.jsx("meshBasicMaterial",{color:e,transparent:!0,opacity:.4,side:gi})]})]})}function zue({anchors:n,onPlace:e,anchorColor:t}){return D.jsxs(D.Fragment,{children:[D.jsx(fG,{}),D.jsx("ambientLight",{intensity:.6}),D.jsx("directionalLight",{position:[5,5,5],intensity:.5}),D.jsx(vC,{preset:"city"}),D.jsx(kue,{onPlace:e,anchorColor:t}),n.map(i=>D.jsx(kG,{anchor:i},i.id))]})}function Gue({anchors:n}){return D.jsxs(D.Fragment,{children:[D.jsx("ambientLight",{intensity:.5}),D.jsx("directionalLight",{position:[5,5,5],intensity:.6}),D.jsx(vC,{preset:"city"}),D.jsxs("mesh",{"rotation-x":-Math.PI/2,"position-y":0,children:[D.jsx("planeGeometry",{args:[10,10]}),D.jsx("meshStandardMaterial",{color:"#1a1a2e"})]}),D.jsx("gridHelper",{args:[10,20,"#333","#222"]}),n.length===0&&D.jsx(UG,{speed:1,rotationIntensity:.5,floatIntensity:.3,children:D.jsx(NG,{position:[0,.5,0],fontSize:.1,color:"#666",anchorX:"center",anchorY:"middle",children:"Enter AR to place anchors"})}),n.map(e=>D.jsx(kG,{anchor:e},e.id))]})}function Hue(){const[n,e]=X.useState(null),[t,i]=X.useState(!1),[r,s]=X.useState("markers"),[a,o]=X.useState(o5[4]),[c,h]=X.useState("Hello!"),[p,g]=X.useState([]);X.useEffect(()=>{(async()=>{if(!navigator.xr){e(!1);return}try{const E=await navigator.xr.isSessionSupported("immersive-ar");e(E)}catch{e(!1)}})()},[]);const A=X.useCallback((_,E)=>{const C={id:`anchor-${Date.now()}`,position:[_.x,_.y,_.z],rotation:[E.x,E.y,E.z],type:r,label:r==="notes"?c:void 0,color:a,createdAt:Date.now()};g(T=>[...T,C])},[r,a,c]),v=X.useCallback(()=>{g([])},[]),x=X.useCallback(()=>{g(_=>_.slice(0,-1))},[]),S=X.useCallback(async()=>{try{await a5.enterAR(),i(!0)}catch(_){console.error("Failed to enter AR:",_)}},[]);return D.jsxs("div",{className:"experiment-page world-tracking-page",children:[D.jsxs("header",{className:"experiment-header",children:[D.jsx(nh,{to:"/",className:"back-link",children:" Back"}),D.jsxs("div",{children:[D.jsx("h1",{children:"World Tracking"}),D.jsx("p",{children:"Persistent anchors in 3D space"})]})]}),D.jsxs("div",{className:"ar-container-wrapper",children:[D.jsxs("div",{className:"ar-container",children:[D.jsx(Lz,{shadows:!0,camera:{position:[0,1.5,3],fov:50},gl:{alpha:!0},children:D.jsx(uG,{store:a5,children:t?D.jsx(zue,{anchors:p,onPlace:A,anchorColor:a}):D.jsx(Gue,{anchors:p})})}),n===!1&&D.jsxs("div",{className:"unsupported-overlay",children:[D.jsx("span",{className:"unsupported-icon",children:""}),D.jsx("h3",{children:"WebXR AR Not Available"}),D.jsx("p",{children:"World tracking requires WebXR AR with anchor support."}),D.jsxs("ul",{className:"requirements-list",children:[D.jsx("li",{children:"Chrome on Android (ARCore)"}),D.jsx("li",{children:"Meta Quest Browser"})]})]}),!t&&n!==!1&&D.jsxs("div",{className:"ar-start-overlay",children:[D.jsx("button",{onClick:S,className:"start-ar-button",children:" Enter World AR"}),D.jsx("p",{className:"ar-note",children:"6DOF tracking with persistent anchors"})]})]}),t&&D.jsxs("div",{className:"ar-controls",children:[D.jsx("button",{onClick:x,className:"control-btn",disabled:p.length===0,children:" Undo"}),D.jsxs("span",{className:"anchor-count",children:[p.length," anchors"]}),D.jsx("button",{onClick:v,className:"control-btn",disabled:p.length===0,children:" Clear"})]})]}),D.jsxs("div",{className:"options-section",children:[D.jsxs("div",{className:"option-group",children:[D.jsx("h2",{children:"Anchor Type"}),D.jsx("div",{className:"type-grid",children:Uue.map(_=>D.jsxs("button",{className:`type-button ${r===_.id?"active":""}`,onClick:()=>s(_.id),children:[D.jsx("span",{className:"type-emoji",children:_.emoji}),D.jsx("span",{className:"type-name",children:_.name})]},_.id))})]}),D.jsxs("div",{className:"option-group",children:[D.jsx("h2",{children:"Color"}),D.jsx("div",{className:"color-grid",children:o5.map(_=>D.jsx("button",{className:`color-button ${a===_?"active":""}`,style:{backgroundColor:_},onClick:()=>o(_)},_))})]}),r==="notes"&&D.jsxs("div",{className:"option-group",children:[D.jsx("h2",{children:"Note Text"}),D.jsx("input",{type:"text",value:c,onChange:_=>h(_.target.value),placeholder:"Enter note text...",className:"note-input",maxLength:30})]})]}),D.jsxs("section",{className:"info-section",children:[D.jsx("h2",{children:"How It Works"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"6DOF Tracking"}),"  Full position and rotation tracking"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"WebXR Anchors"}),"  Persistent spatial references"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"SLAM"}),"  Simultaneous Localization and Mapping"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Feature Points"}),"  Environment understanding"]})]}),D.jsx("h2",{children:"Anchor Types"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"Spatial Markers"}),"  Pin locations in space"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"AR Portals"}),"  Floating dimensional effects"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Sticky Notes"}),"  Leave messages anywhere"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Light Orbs"}),"  Place dynamic lighting"]})]}),D.jsx("h2",{children:"Persistence"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"Session persistence"}),"  Anchors survive camera movement"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Re-localization"}),"  AR system tracks position continuously"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Cloud anchors"}),"  Share across devices (future)"]})]}),D.jsx("h2",{children:"Use Cases"}),D.jsxs("ul",{children:[D.jsx("li",{children:"Indoor navigation and wayfinding"}),D.jsx("li",{children:"Spatial note-taking and collaboration"}),D.jsx("li",{children:"AR scene building and design"}),D.jsx("li",{children:"Location-based gaming"}),D.jsx("li",{children:"Multi-user shared experiences"})]})]})]})}var Q0=typeof self<"u"?self:{};function zb(n,e){e:{for(var t=["CLOSURE_FLAGS"],i=Q0,r=0;r<t.length;r++)if((i=i[t[r]])==null){t=null;break e}t=i}return(n=t&&t[n])!=null?n:e}function am(){throw Error("Invalid UTF8")}function c5(n,e){return e=String.fromCharCode.apply(null,e),n==null?e:n+e}let NE,dR;const Que=typeof TextDecoder<"u";let Vue;const jue=typeof TextEncoder<"u";function zG(n){if(jue)n=(Vue||=new TextEncoder).encode(n);else{let t=0;const i=new Uint8Array(3*n.length);for(let r=0;r<n.length;r++){var e=n.charCodeAt(r);if(e<128)i[t++]=e;else{if(e<2048)i[t++]=e>>6|192;else{if(e>=55296&&e<=57343){if(e<=56319&&r<n.length){const s=n.charCodeAt(++r);if(s>=56320&&s<=57343){e=1024*(e-55296)+s-56320+65536,i[t++]=e>>18|240,i[t++]=e>>12&63|128,i[t++]=e>>6&63|128,i[t++]=63&e|128;continue}r--}e=65533}i[t++]=e>>12|224,i[t++]=e>>6&63|128}i[t++]=63&e|128}}n=t===i.length?i:i.subarray(0,t)}return n}function GG(n){Q0.setTimeout((()=>{throw n}),0)}var M2,Wue=zb(610401301,!1),u5=zb(748402147,!0),pB=zb(824648567,!0),mB=zb(824656860,zb(1,!0));function h5(){var n=Q0.navigator;return n&&(n=n.userAgent)?n:""}const f5=Q0.navigator;function yC(n){return yC[" "](n),n}M2=f5&&f5.userAgentData||null,yC[" "]=function(){};const HG={};let Y1=null;function que(n){const e=n.length;let t=3*e/4;t%3?t=Math.floor(t):"=.".indexOf(n[e-1])!=-1&&(t="=.".indexOf(n[e-2])!=-1?t-2:t-1);const i=new Uint8Array(t);let r=0;return(function(s,a){function o(h){for(;c<s.length;){const p=s.charAt(c++),g=Y1[p];if(g!=null)return g;if(!/^[\s\xa0]*$/.test(p))throw Error("Unknown base64 encoding at char: "+p)}return h}QG();let c=0;for(;;){const h=o(-1),p=o(0),g=o(64),A=o(64);if(A===64&&h===-1)break;a(h<<2|p>>4),g!=64&&(a(p<<4&240|g>>2),A!=64&&a(g<<6&192|A))}})(n,(function(s){i[r++]=s})),r!==t?i.subarray(0,r):i}function QG(){if(!Y1){Y1={};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"];for(let t=0;t<5;t++){const i=n.concat(e[t].split(""));HG[t]=i;for(let r=0;r<i.length;r++){const s=i[r];Y1[s]===void 0&&(Y1[s]=r)}}}}var Xue=typeof Uint8Array<"u",VG=!(!(Wue&&M2&&M2.brands.length>0)&&(h5().indexOf("Trident")!=-1||h5().indexOf("MSIE")!=-1))&&typeof btoa=="function";const d5=/[-_.]/g,Yue={"-":"+",_:"/",".":"="};function Kue(n){return Yue[n]||""}function jG(n){if(!VG)return que(n);n=d5.test(n)?n.replace(d5,Kue):n,n=atob(n);const e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}function gB(n){return Xue&&n!=null&&n instanceof Uint8Array}var V0={};function ng(){return $ue||=new $u(null,V0)}function AB(n){WG(V0);var e=n.g;return(e=e==null||gB(e)?e:typeof e=="string"?jG(e):null)==null?e:n.g=e}var $u=class{h(){return new Uint8Array(AB(this)||0)}constructor(n,e){if(WG(e),this.g=n,n!=null&&n.length===0)throw Error("ByteString should be constructed with non-empty values")}};let $ue,Jue;function WG(n){if(n!==V0)throw Error("illegal external caller")}function qG(n,e){n.__closure__error__context__984382||(n.__closure__error__context__984382={}),n.__closure__error__context__984382.severity=e}function C2(n){return qG(n=Error(n),"warning"),n}function j0(n,e){if(n!=null){var t=Jue??={},i=t[n]||0;i>=e||(t[n]=i+1,qG(n=Error(),"incident"),GG(n))}}function Av(){return typeof BigInt=="function"}var vv=typeof Symbol=="function"&&typeof Symbol()=="symbol";function rh(n,e,t=!1){return typeof Symbol=="function"&&typeof Symbol()=="symbol"?t&&Symbol.for&&n?Symbol.for(n):n!=null?Symbol(n):Symbol():e}var Zue=rh("jas",void 0,!0),p5=rh(void 0,"0di"),F1=rh(void 0,"1oa"),cl=rh(void 0,Symbol()),ehe=rh(void 0,"0ub"),the=rh(void 0,"0ubs"),T2=rh(void 0,"0ubsb"),nhe=rh(void 0,"0actk"),W0=rh("m_m","Pa",!0),m5=rh();const XG={Ga:{value:0,configurable:!0,writable:!0,enumerable:!1}},YG=Object.defineProperties,ln=vv?Zue:"Ga";var cg;const g5=[];function vx(n,e){vv||ln in n||YG(n,XG),n[ln]|=e}function ks(n,e){vv||ln in n||YG(n,XG),n[ln]=e}function yx(n){return vx(n,34),n}function Gb(n){return vx(n,8192),n}ks(g5,7),cg=Object.freeze(g5);var q0={};function pl(n,e){return e===void 0?n.h!==ig&&!!(2&(0|n.v[ln])):!!(2&e)&&n.h!==ig}const ig={};function vB(n,e){if(n!=null){if(typeof n=="string")n=n?new $u(n,V0):ng();else if(n.constructor!==$u)if(gB(n))n=n.length?new $u(new Uint8Array(n),V0):ng();else{if(!e)throw Error();n=void 0}}return n}class A5{constructor(e,t,i){this.g=e,this.h=t,this.l=i}next(){const e=this.g.next();return e.done||(e.value=this.h.call(this.l,e.value)),e}[Symbol.iterator](){return this}}var ihe=Object.freeze({});function KG(n,e,t){const i=128&e?0:-1,r=n.length;var s;(s=!!r)&&(s=(s=n[r-1])!=null&&typeof s=="object"&&s.constructor===Object);const a=r+(s?-1:0);for(e=128&e?1:0;e<a;e++)t(e-i,n[e]);if(s){n=n[r-1];for(const o in n)!isNaN(o)&&t(+o,n[o])}}var $G={};function yv(n){return 128&n?$G:void 0}function bC(n){return n.Na=!0,n}var rhe=bC((n=>typeof n=="number")),v5=bC((n=>typeof n=="string")),she=bC((n=>typeof n=="boolean")),xC=typeof Q0.BigInt=="function"&&typeof Q0.BigInt(0)=="bigint";function ul(n){var e=n;if(v5(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(rhe(e)&&!Number.isSafeInteger(e))throw Error(String(e));return xC?BigInt(n):n=she(n)?n?"1":"0":v5(n)?n.trim()||"0":String(n)}var I2=bC((n=>xC?n>=ohe&&n<=che:n[0]==="-"?y5(n,ahe):y5(n,lhe)));const ahe=Number.MIN_SAFE_INTEGER.toString(),ohe=xC?BigInt(Number.MIN_SAFE_INTEGER):void 0,lhe=Number.MAX_SAFE_INTEGER.toString(),che=xC?BigInt(Number.MAX_SAFE_INTEGER):void 0;function y5(n,e){if(n.length>e.length)return!1;if(n.length<e.length||n===e)return!0;for(let t=0;t<n.length;t++){const i=n[t],r=e[t];if(i>r)return!1;if(i<r)return!0}}const uhe=typeof Uint8Array.prototype.slice=="function";let hhe,zr=0,Ss=0;function b5(n){const e=n>>>0;zr=e,Ss=(n-e)/4294967296>>>0}function X0(n){if(n<0){b5(-n);const[e,t]=_B(zr,Ss);zr=e>>>0,Ss=t>>>0}else b5(n)}function yB(n){const e=hhe||=new DataView(new ArrayBuffer(8));e.setFloat32(0,+n,!0),Ss=0,zr=e.getUint32(0,!0)}function R2(n,e){const t=4294967296*e+(n>>>0);return Number.isSafeInteger(t)?t:Hb(n,e)}function fhe(n,e){return ul(Av()?BigInt.asUintN(64,(BigInt(e>>>0)<<BigInt(32))+BigInt(n>>>0)):Hb(n,e))}function bB(n,e){const t=2147483648&e;return t&&(e=~e>>>0,(n=1+~n>>>0)==0&&(e=e+1>>>0)),typeof(n=R2(n,e))=="number"?t?-n:n:t?"-"+n:n}function JG(n,e){return Av()?ul(BigInt.asIntN(64,(BigInt.asUintN(32,BigInt(e))<<BigInt(32))+BigInt.asUintN(32,BigInt(n)))):ul(xB(n,e))}function Hb(n,e){if(n>>>=0,(e>>>=0)<=2097151)var t=""+(4294967296*e+n);else Av()?t=""+(BigInt(e)<<BigInt(32)|BigInt(n)):(n=(16777215&n)+6777216*(t=16777215&(n>>>24|e<<8))+6710656*(e=e>>16&65535),t+=8147497*e,e*=2,n>=1e7&&(t+=n/1e7>>>0,n%=1e7),t>=1e7&&(e+=t/1e7>>>0,t%=1e7),t=e+x5(t)+x5(n));return t}function x5(n){return n=String(n),"0000000".slice(n.length)+n}function xB(n,e){if(2147483648&e)if(Av())n=""+(BigInt(0|e)<<BigInt(32)|BigInt(n>>>0));else{const[t,i]=_B(n,e);n="-"+Hb(t,i)}else n=Hb(n,e);return n}function _C(n){if(n.length<16)X0(Number(n));else if(Av())n=BigInt(n),zr=Number(n&BigInt(4294967295))>>>0,Ss=Number(n>>BigInt(32)&BigInt(4294967295));else{const e=+(n[0]==="-");Ss=zr=0;const t=n.length;for(let i=e,r=(t-e)%6+e;r<=t;i=r,r+=6){const s=Number(n.slice(i,r));Ss*=1e6,zr=1e6*zr+s,zr>=4294967296&&(Ss+=Math.trunc(zr/4294967296),Ss>>>=0,zr>>>=0)}if(e){const[i,r]=_B(zr,Ss);zr=i,Ss=r}}}function _B(n,e){return e=~e,n?n=1+~n:e+=1,[n,e]}function Vc(n){return Array.prototype.slice.call(n)}const bx=typeof BigInt=="function"?BigInt.asIntN:void 0,dhe=typeof BigInt=="function"?BigInt.asUintN:void 0,rg=Number.isSafeInteger,SC=Number.isFinite,Y0=Math.trunc,phe=ul(0);function K1(n){if(n!=null&&typeof n!="number")throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);return n}function Ku(n){return n==null||typeof n=="number"?n:n==="NaN"||n==="Infinity"||n==="-Infinity"?Number(n):void 0}function Qb(n){if(n!=null&&typeof n!="boolean"){var e=typeof n;throw Error(`Expected boolean but got ${e!="object"?e:n?Array.isArray(n)?"array":e:"null"}: ${n}`)}return n}function ZG(n){return n==null||typeof n=="boolean"?n:typeof n=="number"?!!n:void 0}const mhe=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function xx(n){switch(typeof n){case"bigint":return!0;case"number":return SC(n);case"string":return mhe.test(n);default:return!1}}function bv(n){if(n==null)return n;if(typeof n=="string"&&n)n=+n;else if(typeof n!="number")return;return SC(n)?0|n:void 0}function e7(n){if(n==null)return n;if(typeof n=="string"&&n)n=+n;else if(typeof n!="number")return;return SC(n)?n>>>0:void 0}function t7(n){const e=n.length;return(n[0]==="-"?e<20||e===20&&n<="-9223372036854775808":e<19||e===19&&n<="9223372036854775807")?n:(_C(n),xB(zr,Ss))}function SB(n){return n=Y0(n),rg(n)||(X0(n),n=bB(zr,Ss)),n}function n7(n){var e=Y0(Number(n));return rg(e)?String(e):((e=n.indexOf("."))!==-1&&(n=n.substring(0,e)),t7(n))}function i7(n){var e=Y0(Number(n));return rg(e)?ul(e):((e=n.indexOf("."))!==-1&&(n=n.substring(0,e)),Av()?ul(bx(64,BigInt(n))):ul(t7(n)))}function r7(n){return rg(n)?n=ul(SB(n)):(n=Y0(n),rg(n)?n=String(n):(X0(n),n=xB(zr,Ss)),n=ul(n)),n}function ghe(n){return n==null?n:typeof n=="bigint"?(I2(n)?n=Number(n):(n=bx(64,n),n=I2(n)?Number(n):String(n)),n):xx(n)?typeof n=="number"?SB(n):n7(n):void 0}function iM(n){const e=typeof n;return n==null?n:e==="bigint"?ul(bx(64,n)):xx(n)?e==="string"?i7(n):r7(n):void 0}function s7(n){if(typeof n!="string")throw Error();return n}function _x(n){if(n!=null&&typeof n!="string")throw Error();return n}function xa(n){return n==null||typeof n=="string"?n:void 0}function EB(n,e,t,i){return n!=null&&n[W0]===q0?n:Array.isArray(n)?((i=(t=0|n[ln])|32&i|2&i)!==t&&ks(n,i),new e(n)):(t?2&i?((n=e[p5])||(yx((n=new e).v),n=e[p5]=n),e=n):e=new e:e=void 0,e)}function Ahe(n,e,t){if(e)e:{if(!xx(e=n))throw C2("int64");switch(typeof e){case"string":e=i7(e);break e;case"bigint":e=ul(bx(64,e));break e;default:e=r7(e)}}else e=iM(n);return(n=e)==null?t?phe:void 0:n}const vhe={};let yhe=(function(){try{return yC(new class extends Map{constructor(){super()}}),!1}catch{return!0}})();class pR{constructor(){this.g=new Map}get(e){return this.g.get(e)}set(e,t){return this.g.set(e,t),this.size=this.g.size,this}delete(e){return e=this.g.delete(e),this.size=this.g.size,e}clear(){this.g.clear(),this.size=this.g.size}has(e){return this.g.has(e)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(e,t){return this.g.forEach(e,t)}[Symbol.iterator](){return this.entries()}}const bhe=yhe?(Object.setPrototypeOf(pR.prototype,Map.prototype),Object.defineProperties(pR.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),pR):class extends Map{constructor(){super()}};function _5(n){return n}function mR(n){if(2&n.J)throw Error("Cannot mutate an immutable Map")}var vf=class extends bhe{constructor(n,e,t=_5,i=_5){super(),this.J=0|n[ln],this.K=e,this.S=t,this.fa=this.K?xhe:i;for(let r=0;r<n.length;r++){const s=n[r],a=t(s[0],!1,!0);let o=s[1];e?o===void 0&&(o=null):o=i(s[1],!1,!0,void 0,void 0,this.J),super.set(a,o)}}V(n){return Gb(Array.from(super.entries(),n))}clear(){mR(this),super.clear()}delete(n){return mR(this),super.delete(this.S(n,!0,!1))}entries(){if(this.K){var n=super.keys();n=new A5(n,_he,this)}else n=super.entries();return n}values(){if(this.K){var n=super.keys();n=new A5(n,vf.prototype.get,this)}else n=super.values();return n}forEach(n,e){this.K?super.forEach(((t,i,r)=>{n.call(e,r.get(i),i,r)})):super.forEach(n,e)}set(n,e){return mR(this),(n=this.S(n,!0,!1))==null?this:e==null?(super.delete(n),this):super.set(n,this.fa(e,!0,!0,this.K,!1,this.J))}Ma(n){const e=this.S(n[0],!1,!0);n=n[1],n=this.K?n===void 0?null:n:this.fa(n,!1,!0,void 0,!1,this.J),super.set(e,n)}has(n){return super.has(this.S(n,!1,!1))}get(n){n=this.S(n,!1,!1);const e=super.get(n);if(e!==void 0){var t=this.K;return t?((t=this.fa(e,!1,!0,t,this.ra,this.J))!==e&&super.set(n,t),t):e}}[Symbol.iterator](){return this.entries()}};function xhe(n,e,t,i,r,s){return n=EB(n,i,t,s),r&&(n=MB(n)),n}function _he(n){return[n,this.get(n)]}let She;function S5(){return She||=new vf(yx([]),void 0,void 0,void 0,vhe)}function EC(n){return cl?n[cl]:void 0}function rM(n,e){for(const t in n)!isNaN(t)&&e(n,+t,n[t])}vf.prototype.toJSON=void 0;var B2=class{};const Ehe={Ka:!0};function whe(n,e){e<100||j0(the,1)}function wC(n,e,t,i){const r=i!==void 0;i=!!i;var s,a=cl;!r&&vv&&a&&(s=n[a])&&rM(s,whe),a=[];var o=n.length;let c;s=4294967295;let h=!1;const p=!!(64&e),g=p?128&e?0:-1:void 0;1&e||(c=o&&n[o-1],c!=null&&typeof c=="object"&&c.constructor===Object?s=--o:c=void 0,!p||128&e||r||(h=!0,s=s-g+g)),e=void 0;for(var A=0;A<o;A++){let v=n[A];if(v!=null&&(v=t(v,i))!=null)if(p&&A>=s){const x=A-g;(e??={})[x]=v}else a[A]=v}if(c)for(let v in c){if((o=c[v])==null||(o=t(o,i))==null)continue;let x;A=+v,p&&!Number.isNaN(A)&&(x=A+g)<s?a[x]=o:(e??={})[v]=o}return e&&(h?a.push(e):a[s]=e),r&&cl&&(n=EC(n))&&n instanceof B2&&(a[cl]=(function(v){const x=new B2;return rM(v,((S,_,E)=>{x[_]=Vc(E)})),x.da=v.da,x})(n)),a}function Mhe(n){return n[0]=Vb(n[0]),n[1]=Vb(n[1]),n}function Vb(n){switch(typeof n){case"number":return Number.isFinite(n)?n:""+n;case"bigint":return I2(n)?Number(n):""+n;case"boolean":return n?1:0;case"object":if(Array.isArray(n)){var e=0|n[ln];return n.length===0&&1&e?void 0:wC(n,e,Vb)}if(n!=null&&n[W0]===q0)return a7(n);if(n instanceof $u){if((e=n.g)==null)n="";else if(typeof e=="string")n=e;else{if(VG){for(var t="",i=0,r=e.length-10240;i<r;)t+=String.fromCharCode.apply(null,e.subarray(i,i+=10240));t+=String.fromCharCode.apply(null,i?e.subarray(i):e),e=btoa(t)}else{t===void 0&&(t=0),QG(),t=HG[t],i=Array(Math.floor(e.length/3)),r=t[64]||"";let h=0,p=0;for(;h<e.length-2;h+=3){var s=e[h],a=e[h+1],o=e[h+2],c=t[s>>2];s=t[(3&s)<<4|a>>4],a=t[(15&a)<<2|o>>6],o=t[63&o],i[p++]=c+s+a+o}switch(c=0,o=r,e.length-h){case 2:o=t[(15&(c=e[h+1]))<<2]||r;case 1:e=e[h],i[p]=t[e>>2]+t[(3&e)<<4|c>>4]+o+r}e=i.join("")}n=n.g=e}return n}return n instanceof vf?n=n.size!==0?n.V(Mhe):void 0:void 0}return n}function a7(n){return wC(n=n.v,0|n[ln],Vb)}let Che,The;function Bm(n,e){return o7(n,e[0],e[1])}function o7(n,e,t,i=0){if(n==null){var r=32;t?(n=[t],r|=128):n=[],e&&(r=-16760833&r|(1023&e)<<14)}else{if(!Array.isArray(n))throw Error("narr");if(r=0|n[ln],u5&&1&r)throw Error("rfarr");if(2048&r&&!(2&r)&&(function(){if(u5)throw Error("carr");j0(nhe,5)})(),256&r)throw Error("farr");if(64&r)return(r|i)!==r&&ks(n,r|i),n;if(t&&(r|=128,t!==n[0]))throw Error("mid");e:{r|=64;var s=(t=n).length;if(s){var a=s-1;const c=t[a];if(c!=null&&typeof c=="object"&&c.constructor===Object){if((a-=e=128&r?0:-1)>=1024)throw Error("pvtlmt");for(var o in c)(s=+o)<a&&(t[s+e]=c[o],delete c[o]);r=-16760833&r|(1023&a)<<14;break e}}if(e){if((o=Math.max(e,s-(128&r?0:-1)))>1024)throw Error("spvt");r=-16760833&r|(1023&o)<<14}}}return ks(n,64|r|i),n}function Ihe(n,e){if(typeof n!="object")return n;if(Array.isArray(n)){var t=0|n[ln];return n.length===0&&1&t?void 0:E5(n,t,e)}if(n!=null&&n[W0]===q0)return w5(n);if(n instanceof vf){if(2&(e=n.J))return n;if(!n.size)return;if(t=yx(n.V()),n.K)for(n=0;n<t.length;n++){const i=t[n];let r=i[1];r=r==null||typeof r!="object"?void 0:r!=null&&r[W0]===q0?w5(r):Array.isArray(r)?E5(r,0|r[ln],!!(32&e)):void 0,i[1]=r}return t}return n instanceof $u?n:void 0}function E5(n,e,t){return 2&e||(!t||4096&e||16&e?n=xv(n,e,!1,t&&!(16&e)):(vx(n,34),4&e&&Object.freeze(n))),n}function wB(n,e,t){return n=new n.constructor(e),t&&(n.h=ig),n.m=ig,n}function w5(n){const e=n.v,t=0|e[ln];return pl(n,t)?n:CB(n,e,t)?wB(n,e):xv(e,t)}function xv(n,e,t,i){return i??=!!(34&e),n=wC(n,e,Ihe,i),i=32,t&&(i|=2),ks(n,e=16769217&e|i),n}function MB(n){const e=n.v,t=0|e[ln];return pl(n,t)?CB(n,e,t)?wB(n,e,!0):new n.constructor(xv(e,t,!1)):n}function _v(n){if(n.h!==ig)return!1;var e=n.v;return vx(e=xv(e,0|e[ln]),2048),n.v=e,n.h=void 0,n.m=void 0,!0}function Sv(n){if(!_v(n)&&pl(n,0|n.v[ln]))throw Error()}function ug(n,e){e===void 0&&(e=0|n[ln]),32&e&&!(4096&e)&&ks(n,4096|e)}function CB(n,e,t){return!!(2&t)||!(!(32&t)||4096&t)&&(ks(e,2|t),n.h=ig,!0)}const Rhe=ul(0),bd={};function Cr(n,e,t,i,r){if((e=yf(n.v,e,t,r))!==null||i&&n.m!==ig)return e}function yf(n,e,t,i){if(e===-1)return null;const r=e+(t?0:-1),s=n.length-1;let a,o;if(!(s<1+(t?0:-1))){if(r>=s)if(a=n[s],a!=null&&typeof a=="object"&&a.constructor===Object)t=a[e],o=!0;else{if(r!==s)return;t=a}else t=n[r];if(i&&t!=null){if((i=i(t))==null)return i;if(!Object.is(i,t))return o?a[e]=i:n[r]=i,i}return t}}function qi(n,e,t,i){Sv(n),Ls(n=n.v,0|n[ln],e,t,i)}function Ls(n,e,t,i,r){const s=t+(r?0:-1);var a=n.length-1;if(a>=1+(r?0:-1)&&s>=a){const o=n[a];if(o!=null&&typeof o=="object"&&o.constructor===Object)return o[t]=i,e}return s<=a?(n[s]=i,e):(i!==void 0&&(t>=(a=(e??=0|n[ln])>>14&1023||536870912)?i!=null&&(n[a+(r?0:-1)]={[t]:i}):n[s]=i),e)}function _m(){return ihe===void 0?2:4}function Sm(n,e,t,i,r){let s=n.v,a=0|s[ln];i=pl(n,a)?1:i,r=!!r||i===3,i===2&&_v(n)&&(s=n.v,a=0|s[ln]);let o=(n=TB(s,e))===cg?7:0|n[ln],c=IB(o,a);var h=!(4&c);if(h){4&c&&(n=Vc(n),o=0,c=Lm(c,a),a=Ls(s,a,e,n));let p=0,g=0;for(;p<n.length;p++){const A=t(n[p]);A!=null&&(n[g++]=A)}g<p&&(n.length=g),t=-513&(4|c),c=t&=-1025,c&=-4097}return c!==o&&(ks(n,c),2&c&&Object.freeze(n)),l7(n,c,s,a,e,i,h,r)}function l7(n,e,t,i,r,s,a,o){let c=e;return s===1||s===4&&(2&e||!(16&e)&&32&i)?Dm(e)||((e|=!n.length||a&&!(4096&e)||32&i&&!(4096&e||16&e)?2:256)!==c&&ks(n,e),Object.freeze(n)):(s===2&&Dm(e)&&(n=Vc(n),c=0,e=Lm(e,i),i=Ls(t,i,r,n)),Dm(e)||(o||(e|=16),e!==c&&ks(n,e))),2&e||!(4096&e||16&e)||ug(t,i),n}function TB(n,e,t){return n=yf(n,e,t),Array.isArray(n)?n:cg}function IB(n,e){return 2&e&&(n|=2),1|n}function Dm(n){return!!(2&n)&&!!(4&n)||!!(256&n)}function c7(n){return vB(n,!0)}function u7(n){n=Vc(n);for(let e=0;e<n.length;e++){const t=n[e]=Vc(n[e]);Array.isArray(t[1])&&(t[1]=yx(t[1]))}return Gb(n)}function Ed(n,e,t,i){Sv(n),Ls(n=n.v,0|n[ln],e,(i==="0"?Number(t)===0:t===i)?void 0:t)}function Ev(n,e,t){if(2&e)throw Error();const i=yv(e);let r=TB(n,t,i),s=r===cg?7:0|r[ln],a=IB(s,e);return(2&a||Dm(a)||16&a)&&(a===s||Dm(a)||ks(r,a),r=Vc(r),s=0,a=Lm(a,e),Ls(n,e,t,r,i)),a&=-13,a!==s&&ks(r,a),r}function gR(n,e){var t=nH;return BB(RB(n=n.v),n,void 0,t)===e?e:-1}function RB(n){if(vv)return n[F1]??(n[F1]=new Map);if(F1 in n)return n[F1];const e=new Map;return Object.defineProperty(n,F1,{value:e}),e}function h7(n,e,t,i,r){const s=RB(n),a=BB(s,n,e,t,r);return a!==i&&(a&&(e=Ls(n,e,a,void 0,r)),s.set(t,i)),e}function BB(n,e,t,i,r){let s=n.get(i);if(s!=null)return s;s=0;for(let a=0;a<i.length;a++){const o=i[a];yf(e,o,r)!=null&&(s!==0&&(t=Ls(e,t,s,void 0,r)),s=o)}return n.set(i,s),s}function DB(n,e,t){let i=0|n[ln];const r=yv(i),s=yf(n,t,r);let a;if(s!=null&&s[W0]===q0){if(!pl(s))return _v(s),s.v;a=s.v}else Array.isArray(s)&&(a=s);if(a){const o=0|a[ln];2&o&&(a=xv(a,o))}return a=Bm(a,e),a!==s&&Ls(n,i,t,a,r),a}function f7(n,e,t,i,r){let s=!1;if((i=yf(n,i,r,(a=>{const o=EB(a,t,!1,e);return s=o!==a&&o!=null,o})))!=null)return s&&!pl(i)&&ug(n,e),i}function _i(n,e,t,i){let r=n.v,s=0|r[ln];if((e=f7(r,s,e,t,i))==null)return e;if(s=0|r[ln],!pl(n,s)){const a=MB(e);a!==e&&(_v(n)&&(r=n.v,s=0|r[ln]),s=Ls(r,s,t,e=a,i),ug(r,s))}return e}function d7(n,e,t,i,r,s,a,o){var c=pl(n,t);s=c?1:s,a=!!a||s===3,c=o&&!c,(s===2||c)&&_v(n)&&(t=0|(e=n.v)[ln]);var h=(n=TB(e,r))===cg?7:0|n[ln],p=IB(h,t);if(o=!(4&p)){var g=n,A=t;const v=!!(2&p);v&&(A|=2);let x=!v,S=!0,_=0,E=0;for(;_<g.length;_++){const C=EB(g[_],i,!1,A);if(C instanceof i){if(!v){const T=pl(C);x&&=!T,S&&=T}g[E++]=C}}E<_&&(g.length=E),p|=4,p=S?-4097&p:4096|p,p=x?8|p:-9&p}if(p!==h&&(ks(n,p),2&p&&Object.freeze(n)),c&&!(8&p||!n.length&&(s===1||s===4&&(2&p||!(16&p)&&32&t)))){for(Dm(p)&&(n=Vc(n),p=Lm(p,t),t=Ls(e,t,r,n)),i=n,c=p,h=0;h<i.length;h++)(g=i[h])!==(p=MB(g))&&(i[h]=p);c|=8,ks(n,p=c=i.length?4096|c:-4097&c)}return l7(n,p,e,t,r,s,o,a)}function bf(n,e,t){const i=n.v;return d7(n,i,0|i[ln],e,t,_m(),!1,!0)}function p7(n){return n==null&&(n=void 0),n}function _n(n,e,t,i,r){return qi(n,t,i=p7(i),r),i&&!pl(i)&&ug(n.v),n}function lb(n,e,t,i){e:{var r=i=p7(i);Sv(n);const s=n.v;let a=0|s[ln];if(r==null){const o=RB(s);if(BB(o,s,a,t)!==e)break e;o.set(t,0)}else a=h7(s,a,t,e);Ls(s,a,e,r)}i&&!pl(i)&&ug(n.v)}function Lm(n,e){return-273&(2&e?2|n:-3&n)}function LB(n,e,t,i){var r=i;Sv(n),n=d7(n,i=n.v,0|i[ln],t,e,2,!0),r=r??new t,n.push(r),e=t=n===cg?7:0|n[ln],(r=pl(r))?(t&=-9,n.length===1&&(t&=-4097)):t|=4096,t!==e&&ks(n,t),r||ug(i)}function oc(n,e,t){return bv(Cr(n,e,void 0,t))}function m7(n){return(mB?Cr(n,2,void 0,void 0,iM):iM(Cr(n,2)))??Rhe}function us(n,e){return Cr(n,e,void 0,void 0,Ku)??0}function xf(n,e,t){if(t!=null){if(typeof t!="number"||!SC(t))throw C2("int32");t|=0}qi(n,e,t)}function dn(n,e,t){qi(n,e,K1(t))}function ml(n,e,t){Ed(n,e,_x(t),"")}function sM(n,e,t){{Sv(n);const a=n.v;let o=0|a[ln];if(t==null)Ls(a,o,e);else{var i=n=t===cg?7:0|t[ln],r=Dm(n),s=r||Object.isFrozen(t);for(r||(n=0),s||(t=Vc(t),i=0,n=Lm(n,o),s=!1),n|=5,n|=(4&n?512&n?512:1024&n?1024:0:void 0)??(mB?1024:0),r=0;r<t.length;r++){const c=t[r],h=s7(c);Object.is(c,h)||(s&&(t=Vc(t),i=0,n=Lm(n,o),s=!1),t[r]=h)}n!==i&&(s&&(t=Vc(t),n=Lm(n,o)),ks(t,n)),Ls(a,o,e,t)}}}function MC(n,e,t){Sv(n),Sm(n,e,xa,2,!0).push(s7(t))}var n0=class{constructor(n,e,t){if(this.buffer=n,t&&!e)throw Error();this.g=e}};function NB(n,e){if(typeof n=="string")return new n0(jG(n),e);if(Array.isArray(n))return new n0(new Uint8Array(n),e);if(n.constructor===Uint8Array)return new n0(n,!1);if(n.constructor===ArrayBuffer)return n=new Uint8Array(n),new n0(n,!1);if(n.constructor===$u)return e=AB(n)||new Uint8Array(0),new n0(e,!0,n);if(n instanceof Uint8Array)return n=n.constructor===Uint8Array?n:new Uint8Array(n.buffer,n.byteOffset,n.byteLength),new n0(n,!1);throw Error()}function K0(n,e){let t,i=0,r=0,s=0;const a=n.h;let o=n.g;do t=a[o++],i|=(127&t)<<s,s+=7;while(s<32&&128&t);if(s>32)for(r|=(127&t)>>4,s=3;s<32&&128&t;s+=7)t=a[o++],r|=(127&t)<<s;if(Nm(n,o),!(128&t))return e(i>>>0,r>>>0);throw Error()}function UB(n){let e=0,t=n.g;const i=t+10,r=n.h;for(;t<i;){const s=r[t++];if(e|=s,(128&s)==0)return Nm(n,t),!!(127&e)}throw Error()}function Xd(n){const e=n.h;let t=n.g,i=e[t++],r=127&i;if(128&i&&(i=e[t++],r|=(127&i)<<7,128&i&&(i=e[t++],r|=(127&i)<<14,128&i&&(i=e[t++],r|=(127&i)<<21,128&i&&(i=e[t++],r|=i<<28,128&i&&128&e[t++]&&128&e[t++]&&128&e[t++]&&128&e[t++]&&128&e[t++])))))throw Error();return Nm(n,t),r}function _f(n){return Xd(n)>>>0}function aM(n){var e=n.h;const t=n.g;var i=e[t],r=e[t+1];const s=e[t+2];return e=e[t+3],Nm(n,n.g+4),n=2*((r=(i<<0|r<<8|s<<16|e<<24)>>>0)>>31)+1,i=r>>>23&255,r&=8388607,i==255?r?NaN:n*(1/0):i==0?1401298464324817e-60*n*r:n*Math.pow(2,i-150)*(r+8388608)}function Bhe(n){return Xd(n)}function Nm(n,e){if(n.g=e,e>n.l)throw Error()}function g7(n,e){if(e<0)throw Error();const t=n.g;if((e=t+e)>n.l)throw Error();return n.g=e,t}function A7(n,e){if(e==0)return ng();var t=g7(n,e);return n.Y&&n.j?t=n.h.subarray(t,t+e):(n=n.h,t=t===(e=t+e)?new Uint8Array(0):uhe?n.slice(t,e):new Uint8Array(n.subarray(t,e))),t.length==0?ng():new $u(t,V0)}var M5=[];function v7(n,e,t,i){if(oM.length){const r=oM.pop();return r.o(i),r.g.init(n,e,t,i),r}return new Dhe(n,e,t,i)}function y7(n){n.g.clear(),n.l=-1,n.h=-1,oM.length<100&&oM.push(n)}function b7(n){var e=n.g;if(e.g==e.l)return!1;n.m=n.g.g;var t=_f(n.g);if(e=t>>>3,!((t&=7)>=0&&t<=5)||e<1)throw Error();return n.l=e,n.h=t,!0}function iw(n){switch(n.h){case 0:n.h!=0?iw(n):UB(n.g);break;case 1:Nm(n=n.g,n.g+8);break;case 2:if(n.h!=2)iw(n);else{var e=_f(n.g);Nm(n=n.g,n.g+e)}break;case 5:Nm(n=n.g,n.g+4);break;case 3:for(e=n.l;;){if(!b7(n))throw Error();if(n.h==4){if(n.l!=e)throw Error();break}iw(n)}break;default:throw Error()}}function Sx(n,e,t){const i=n.g.l;var r=_f(n.g);let s=(r=n.g.g+r)-i;if(s<=0&&(n.g.l=r,t(e,n,void 0,void 0,void 0),s=r-n.g.g),s)throw Error();return n.g.g=r,n.g.l=i,e}function FB(n){var e=_f(n.g),t=g7(n=n.g,e);if(n=n.h,Que){var i,r=n;(i=dR)||(i=dR=new TextDecoder("utf-8",{fatal:!0})),e=t+e,r=t===0&&e===r.length?r:r.subarray(t,e);try{var s=i.decode(r)}catch(o){if(NE===void 0){try{i.decode(new Uint8Array([128]))}catch{}try{i.decode(new Uint8Array([97])),NE=!0}catch{NE=!1}}throw!NE&&(dR=void 0),o}}else{e=(s=t)+e,t=[];let o,c=null;for(;s<e;){var a=n[s++];a<128?t.push(a):a<224?s>=e?am():(o=n[s++],a<194||(192&o)!=128?(s--,am()):t.push((31&a)<<6|63&o)):a<240?s>=e-1?am():(o=n[s++],(192&o)!=128||a===224&&o<160||a===237&&o>=160||(192&(i=n[s++]))!=128?(s--,am()):t.push((15&a)<<12|(63&o)<<6|63&i)):a<=244?s>=e-2?am():(o=n[s++],(192&o)!=128||o-144+(a<<28)>>30!=0||(192&(i=n[s++]))!=128||(192&(r=n[s++]))!=128?(s--,am()):(a=(7&a)<<18|(63&o)<<12|(63&i)<<6|63&r,a-=65536,t.push(55296+(a>>10&1023),56320+(1023&a)))):am(),t.length>=8192&&(c=c5(c,t),t.length=0)}s=c5(c,t)}return s}function x7(n){const e=_f(n.g);return A7(n.g,e)}function CC(n,e,t){var i=_f(n.g);for(i=n.g.g+i;n.g.g<i;)t.push(e(n.g))}var Dhe=class{constructor(n,e,t,i){if(M5.length){const r=M5.pop();r.init(n,e,t,i),n=r}else n=new class{constructor(r,s,a,o){this.h=null,this.j=!1,this.g=this.l=this.m=0,this.init(r,s,a,o)}init(r,s,a,{Y:o=!1,ea:c=!1}={}){this.Y=o,this.ea=c,r&&(r=NB(r,this.ea),this.h=r.buffer,this.j=r.g,this.m=s||0,this.l=a!==void 0?this.m+a:this.h.length,this.g=this.m)}clear(){this.h=null,this.j=!1,this.g=this.l=this.m=0,this.Y=!1}}(n,e,t,i);this.g=n,this.m=this.g.g,this.h=this.l=-1,this.o(i)}o({ha:n=!1}={}){this.ha=n}},oM=[];function C5(n){return n?/^\d+$/.test(n)?(_C(n),new D2(zr,Ss)):null:Lhe||=new D2(0,0)}var D2=class{constructor(n,e){this.h=n>>>0,this.g=e>>>0}};let Lhe;function T5(n){return n?/^-?\d+$/.test(n)?(_C(n),new L2(zr,Ss)):null:Nhe||=new L2(0,0)}var L2=class{constructor(n,e){this.h=n>>>0,this.g=e>>>0}};let Nhe;function b0(n,e,t){for(;t>0||e>127;)n.g.push(127&e|128),e=(e>>>7|t<<25)>>>0,t>>>=7;n.g.push(e)}function wv(n,e){for(;e>127;)n.g.push(127&e|128),e>>>=7;n.g.push(e)}function TC(n,e){if(e>=0)wv(n,e);else{for(let t=0;t<9;t++)n.g.push(127&e|128),e>>=7;n.g.push(1)}}function PB(n){var e=zr;n.g.push(e>>>0&255),n.g.push(e>>>8&255),n.g.push(e>>>16&255),n.g.push(e>>>24&255)}function $0(n,e){e.length!==0&&(n.l.push(e),n.h+=e.length)}function pc(n,e,t){wv(n.g,8*e+t)}function OB(n,e){return pc(n,e,2),e=n.g.end(),$0(n,e),e.push(n.h),e}function kB(n,e){var t=e.pop();for(t=n.h+n.g.length()-t;t>127;)e.push(127&t|128),t>>>=7,n.h++;e.push(t),n.h++}function IC(n,e,t){pc(n,e,2),wv(n.g,t.length),$0(n,n.g.end()),$0(n,t)}function lM(n,e,t,i){t!=null&&(e=OB(n,e),i(t,n),kB(n,e))}function sh(){const n=class{constructor(){throw Error()}};return Object.setPrototypeOf(n,n.prototype),n}var zB=sh(),_7=sh(),GB=sh(),HB=sh(),S7=sh(),E7=sh(),Uhe=sh(),RC=sh(),w7=sh(),M7=sh();function ah(n,e,t){var i=n.v;cl&&cl in i&&(i=i[cl])&&delete i[e.g],e.h?e.j(n,e.h,e.g,t,e.l):e.j(n,e.g,t,e.l)}var cn=class{constructor(n,e){this.v=o7(n,e,void 0,2048)}toJSON(){return a7(this)}j(){var n=Afe,e=this.v,t=n.g,i=cl;if(vv&&i&&e[i]?.[t]!=null&&j0(ehe,3),e=n.g,m5&&cl&&m5===void 0&&(i=(t=this.v)[cl])&&(i=i.da))try{i(t,e,Ehe)}catch(r){GG(r)}return n.h?n.m(this,n.h,n.g,n.l):n.m(this,n.g,n.defaultValue,n.l)}clone(){const n=this.v,e=0|n[ln];return CB(this,n,e)?wB(this,n,!0):new this.constructor(xv(n,e,!1))}};cn.prototype[W0]=q0,cn.prototype.toString=function(){return this.v.toString()};var Mv=class{constructor(n,e,t){this.g=n,this.h=e,n=zB,this.l=!!n&&t===n||!1}};function BC(n,e){return new Mv(n,e,zB)}function C7(n,e,t,i,r){lM(n,t,B7(e,i),r)}const Fhe=BC((function(n,e,t,i,r){return n.h===2&&(Sx(n,DB(e,i,t),r),!0)}),C7),Phe=BC((function(n,e,t,i,r){return n.h===2&&(Sx(n,DB(e,i,t),r),!0)}),C7);var DC=Symbol(),LC=Symbol(),N2=Symbol(),I5=Symbol(),R5=Symbol();let T7,I7;function hg(n,e,t,i){var r=i[n];if(r)return r;(r={}).qa=i,r.T=(function(g){switch(typeof g){case"boolean":return Che||=[0,void 0,!0];case"number":return g>0?void 0:g===0?The||=[0,void 0]:[-g,void 0];case"string":return[0,g];case"object":return g}})(i[0]);var s=i[1];let a=1;s&&s.constructor===Object&&(r.ba=s,typeof(s=i[++a])=="function"&&(r.ma=!0,T7??=s,I7??=i[a+1],s=i[a+=2]));const o={};for(;s&&Array.isArray(s)&&s.length&&typeof s[0]=="number"&&s[0]>0;){for(var c=0;c<s.length;c++)o[s[c]]=s;s=i[++a]}for(c=1;s!==void 0;){let g;typeof s=="number"&&(c+=s,s=i[++a]);var h=void 0;if(s instanceof Mv?g=s:(g=Fhe,a--),g?.l){s=i[++a],h=i;var p=a;typeof s=="function"&&(s=s(),h[p]=s),h=s}for(p=c+1,typeof(s=i[++a])=="number"&&s<0&&(p-=s,s=i[++a]);c<p;c++){const A=o[c];h?t(r,c,g,h,A):e(r,c,g,A)}}return i[n]=r}function R7(n){return Array.isArray(n)?n[0]instanceof Mv?n:[Phe,n]:[n,void 0]}function B7(n,e){return n instanceof cn?n.v:Array.isArray(n)?Bm(n,e):void 0}function QB(n,e,t,i){const r=t.g;n[e]=i?(s,a,o)=>r(s,a,o,i):r}function VB(n,e,t,i,r){const s=t.g;let a,o;n[e]=(c,h,p)=>s(c,h,p,o||=hg(LC,QB,VB,i).T,a||=jB(i),r)}function jB(n){let e=n[N2];if(e!=null)return e;const t=hg(LC,QB,VB,n);return e=t.ma?(i,r)=>T7(i,r,t):(i,r)=>{for(;b7(r)&&r.h!=4;){var s=r.l,a=t[s];if(a==null){var o=t.ba;o&&(o=o[s])&&(o=khe(o))!=null&&(a=t[s]=o)}if(a==null||!a(r,i,s)){if(a=(o=r).m,iw(o),o.ha)var c=void 0;else c=o.g.g-a,o.g.g=a,c=A7(o.g,c);a=void 0,o=i,c&&((a=o[cl]??(o[cl]=new B2))[s]??(a[s]=[])).push(c)}}return(i=EC(i))&&(i.da=t.qa[R5]),!0},n[N2]=e,n[R5]=Ohe.bind(n),e}function Ohe(n,e,t,i){var r=this[LC];const s=this[N2],a=Bm(void 0,r.T),o=EC(n);if(o){var c=!1,h=r.ba;if(h){if(r=(p,g,A)=>{if(A.length!==0)if(h[g])for(const v of A){p=v7(v);try{c=!0,s(a,p)}finally{y7(p)}}else i?.(n,g,A)},e==null)rM(o,r);else if(o!=null){const p=o[e];p&&r(o,e,p)}if(c){let p=0|n[ln];if(2&p&&2048&p&&!t?.Ka)throw Error();const g=yv(p),A=(v,x)=>{if(yf(n,v,g)!=null){if(t?.Qa===1)return;throw Error()}x!=null&&(p=Ls(n,p,v,x,g)),delete o[v]};e==null?KG(a,0|a[ln],((v,x)=>{A(v,x)})):A(e,yf(a,e,g))}}}}function khe(n){const e=(n=R7(n))[0].g;if(n=n[1]){const t=jB(n),i=hg(LC,QB,VB,n).T;return(r,s,a)=>e(r,s,a,i,t)}return e}function NC(n,e,t){n[e]=t.h}function UC(n,e,t,i){let r,s;const a=t.h;n[e]=(o,c,h)=>a(o,c,h,s||=hg(DC,NC,UC,i).T,r||=D7(i))}function D7(n){let e=n[I5];if(!e){const t=hg(DC,NC,UC,n);e=(i,r)=>L7(i,r,t),n[I5]=e}return e}function L7(n,e,t){KG(n,0|n[ln],((i,r)=>{if(r!=null){var s=(function(a,o){var c=a[o];if(c)return c;if((c=a.ba)&&(c=c[o])){var h=(c=R7(c))[0].h;if(c=c[1]){const p=D7(c),g=hg(DC,NC,UC,c).T;c=a.ma?I7(g,p):(A,v,x)=>h(A,v,x,g,p)}else c=h;return a[o]=c}})(t,i);s?s(e,r,i):i<500||j0(T2,3)}})),(n=EC(n))&&rM(n,((i,r,s)=>{for($0(e,e.g.end()),i=0;i<s.length;i++)$0(e,AB(s[i])||new Uint8Array(0))}))}const zhe=ul(0);function Cv(n,e){if(Array.isArray(e)){var t=0|e[ln];if(4&t)return e;for(var i=0,r=0;i<e.length;i++){const s=n(e[i]);s!=null&&(e[r++]=s)}return r<i&&(e.length=r),(n=-1537&(5|t))!==t&&ks(e,n),2&n&&Object.freeze(e),e}}function lo(n,e,t){return new Mv(n,e,t)}function Tv(n,e,t){return new Mv(n,e,t)}function sa(n,e,t){Ls(n,0|n[ln],e,t,yv(0|n[ln]))}var Ghe=BC((function(n,e,t,i,r){if(n.h!==2)return!1;if(n=Vc(n=Sx(n,Bm([void 0,void 0],i),r)),r=yv(i=0|e[ln]),2&i)throw Error();let s=yf(e,t,r);if(s instanceof vf)(2&s.J)!=0?(s=s.V(),s.push(n),Ls(e,i,t,s,r)):s.Ma(n);else if(Array.isArray(s)){var a=0|s[ln];8192&a||ks(s,a|=8192),2&a&&(s=u7(s),Ls(e,i,t,s,r)),s.push(n)}else Ls(e,i,t,Gb([n]),r);return!0}),(function(n,e,t,i,r){if(e instanceof vf)e.forEach(((s,a)=>{lM(n,t,Bm([a,s],i),r)}));else if(Array.isArray(e)){for(let s=0;s<e.length;s++){const a=e[s];Array.isArray(a)&&lM(n,t,Bm(a,i),r)}Gb(e)}}));function N7(n,e,t){(e=Ku(e))!=null&&(pc(n,t,5),n=n.g,yB(e),PB(n))}function U7(n,e,t){if(e=(function(i){if(i==null)return i;const r=typeof i;if(r==="bigint")return String(bx(64,i));if(xx(i)){if(r==="string")return n7(i);if(r==="number")return SB(i)}})(e),e!=null&&(typeof e=="string"&&T5(e),e!=null))switch(pc(n,t,0),typeof e){case"number":n=n.g,X0(e),b0(n,zr,Ss);break;case"bigint":t=BigInt.asUintN(64,e),t=new L2(Number(t&BigInt(4294967295)),Number(t>>BigInt(32))),b0(n.g,t.h,t.g);break;default:t=T5(e),b0(n.g,t.h,t.g)}}function F7(n,e,t){(e=bv(e))!=null&&e!=null&&(pc(n,t,0),TC(n.g,e))}function P7(n,e,t){(e=ZG(e))!=null&&(pc(n,t,0),n.g.g.push(e?1:0))}function O7(n,e,t){(e=xa(e))!=null&&IC(n,t,zG(e))}function k7(n,e,t,i,r){lM(n,t,B7(e,i),r)}function z7(n,e,t){(e=e==null||typeof e=="string"||e instanceof $u?e:void 0)!=null&&IC(n,t,NB(e,!0).buffer)}function G7(n,e,t){return(n.h===5||n.h===2)&&(e=Ev(e,0|e[ln],t),n.h==2?CC(n,aM,e):e.push(aM(n.g)),!0)}var Es=lo((function(n,e,t){return n.h===5&&(sa(e,t,aM(n.g)),!0)}),N7,RC),Hhe=Tv(G7,(function(n,e,t){if((e=Cv(Ku,e))!=null)for(let a=0;a<e.length;a++){var i=n,r=t,s=e[a];s!=null&&(pc(i,r,5),i=i.g,yB(s),PB(i))}}),RC),WB=Tv(G7,(function(n,e,t){if((e=Cv(Ku,e))!=null&&e.length){pc(n,t,2),wv(n.g,4*e.length);for(let i=0;i<e.length;i++)t=n.g,yB(e[i]),PB(t)}}),RC),Qhe=lo((function(n,e,t){return n.h===5&&(sa(e,t,(n=aM(n.g))===0?void 0:n),!0)}),N7,RC),Yd=lo((function(n,e,t){return pB?(n.h!==0?n=!1:(sa(e,t,K0(n.g,JG)),n=!0),n):n.h===0&&(sa(e,t,K0(n.g,bB)),!0)}),U7,E7),AR=lo((function(n,e,t){return pB?(n.h!==0?e=!1:(sa(e,t,(n=K0(n.g,JG))===zhe?void 0:n),e=!0),e):n.h===0&&(sa(e,t,(n=K0(n.g,bB))===0?void 0:n),!0)}),U7,E7),Vhe=lo((function(n,e,t){return pB?(n.h!==0?n=!1:(sa(e,t,K0(n.g,fhe)),n=!0),n):n.h===0&&(sa(e,t,K0(n.g,R2)),!0)}),(function(n,e,t){if(e=(function(i){if(i==null)return i;var r=typeof i;if(r==="bigint")return String(dhe(64,i));if(xx(i)){if(r==="string")return r=Y0(Number(i)),rg(r)&&r>=0?i=String(r):((r=i.indexOf("."))!==-1&&(i=i.substring(0,r)),(r=i[0]!=="-"&&((r=i.length)<20||r===20&&i<="18446744073709551615"))||(_C(i),i=Hb(zr,Ss))),i;if(r==="number")return(i=Y0(i))>=0&&rg(i)||(X0(i),i=R2(zr,Ss)),i}})(e),e!=null&&(typeof e=="string"&&C5(e),e!=null))switch(pc(n,t,0),typeof e){case"number":n=n.g,X0(e),b0(n,zr,Ss);break;case"bigint":t=BigInt.asUintN(64,e),t=new D2(Number(t&BigInt(4294967295)),Number(t>>BigInt(32))),b0(n.g,t.h,t.g);break;default:t=C5(e),b0(n.g,t.h,t.g)}}),Uhe),na=lo((function(n,e,t){return n.h===0&&(sa(e,t,Xd(n.g)),!0)}),F7,HB),Ex=Tv((function(n,e,t){return(n.h===0||n.h===2)&&(e=Ev(e,0|e[ln],t),n.h==2?CC(n,Xd,e):e.push(Xd(n.g)),!0)}),(function(n,e,t){if((e=Cv(bv,e))!=null&&e.length){t=OB(n,t);for(let i=0;i<e.length;i++)TC(n.g,e[i]);kB(n,t)}}),HB),u0=lo((function(n,e,t){return n.h===0&&(sa(e,t,(n=Xd(n.g))===0?void 0:n),!0)}),F7,HB),hs=lo((function(n,e,t){return n.h===0&&(sa(e,t,UB(n.g)),!0)}),P7,_7),Um=lo((function(n,e,t){return n.h===0&&(sa(e,t,(n=UB(n.g))===!1?void 0:n),!0)}),P7,_7),Pa=Tv((function(n,e,t){return n.h===2&&(n=FB(n),Ev(e,0|e[ln],t).push(n),!0)}),(function(n,e,t){if((e=Cv(xa,e))!=null)for(let a=0;a<e.length;a++){var i=n,r=t,s=e[a];s!=null&&IC(i,r,zG(s))}}),GB),Rd=lo((function(n,e,t){return n.h===2&&(sa(e,t,(n=FB(n))===""?void 0:n),!0)}),O7,GB),sr=lo((function(n,e,t){return n.h===2&&(sa(e,t,FB(n)),!0)}),O7,GB),$s=(function(n,e,t=zB){return new Mv(n,e,t)})((function(n,e,t,i,r){return n.h===2&&(i=Bm(void 0,i),Ev(e,0|e[ln],t).push(i),Sx(n,i,r),!0)}),(function(n,e,t,i,r){if(Array.isArray(e)){for(let s=0;s<e.length;s++)k7(n,e[s],t,i,r);1&(n=0|e[ln])||ks(e,1|n)}})),cs=BC((function(n,e,t,i,r,s){if(n.h!==2)return!1;let a=0|e[ln];return h7(e,a,s,t,yv(a)),Sx(n,e=DB(e,i,t),r),!0}),k7),H7=lo((function(n,e,t){return n.h===2&&(sa(e,t,x7(n)),!0)}),z7,w7),jhe=Tv((function(n,e,t){return(n.h===0||n.h===2)&&(e=Ev(e,0|e[ln],t),n.h==2?CC(n,_f,e):e.push(_f(n.g)),!0)}),(function(n,e,t){if((e=Cv(e7,e))!=null)for(let a=0;a<e.length;a++){var i=n,r=t,s=e[a];s!=null&&(pc(i,r,0),wv(i.g,s))}}),S7),Whe=lo((function(n,e,t){return n.h===0&&(sa(e,t,(n=_f(n.g))===0?void 0:n),!0)}),(function(n,e,t){(e=e7(e))!=null&&e!=null&&(pc(n,t,0),wv(n.g,e))}),S7),gl=lo((function(n,e,t){return n.h===0&&(sa(e,t,Xd(n.g)),!0)}),(function(n,e,t){(e=bv(e))!=null&&(e=parseInt(e,10),pc(n,t,0),TC(n.g,e))}),M7);class qhe{constructor(e,t){var i=yl;this.g=e,this.h=t,this.m=_i,this.j=_n,this.defaultValue=void 0,this.l=i.Oa!=null?$G:void 0}register(){yC(this)}}function oh(n,e){return new qhe(n,e)}function np(n,e){return(t,i)=>{{const s={ea:!0};i&&Object.assign(s,i),t=v7(t,void 0,void 0,s);try{const a=new n,o=a.v;jB(e)(o,t);var r=a}finally{y7(t)}}return r}}function FC(n){return function(){const e=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const a=this.g;return this.g=[],a}}}};L7(this.v,e,hg(DC,NC,UC,n)),$0(e,e.g.end());const t=new Uint8Array(e.h),i=e.l,r=i.length;let s=0;for(let a=0;a<r;a++){const o=i[a];t.set(o,s),s+=o.length}return e.l=[t],t}}var B5=class extends cn{constructor(n){super(n)}},D5=[0,Rd,lo((function(n,e,t){return n.h===2&&(sa(e,t,(n=x7(n))===ng()?void 0:n),!0)}),(function(n,e,t){if(e!=null){if(e instanceof cn){const i=e.Ra;return void(i?(e=i(e),e!=null&&IC(n,t,NB(e,!0).buffer)):j0(T2,3))}if(Array.isArray(e))return void j0(T2,3)}z7(n,e,t)}),w7)];let vR,L5=globalThis.trustedTypes;function N5(n){var e;return vR===void 0&&(vR=(function(){let t=null;if(!L5)return t;try{const i=r=>r;t=L5.createPolicy("goog#html",{createHTML:i,createScript:i,createScriptURL:i})}catch{}return t})()),n=(e=vR)?e.createScriptURL(n):n,new class{constructor(t){this.g=t}toString(){return this.g+""}}(n)}function Xhe(n,...e){if(e.length===0)return N5(n[0]);let t=n[0];for(let i=0;i<e.length;i++)t+=encodeURIComponent(e[i])+n[i+1];return N5(t)}var Q7=[0,na,gl,hs,-1,Ex,gl,-1,hs],Yhe=class extends cn{constructor(n){super(n)}},V7=[0,hs,sr,hs,gl,-1,Tv((function(n,e,t){return(n.h===0||n.h===2)&&(e=Ev(e,0|e[ln],t),n.h==2?CC(n,Bhe,e):e.push(Xd(n.g)),!0)}),(function(n,e,t){if((e=Cv(bv,e))!=null&&e.length){t=OB(n,t);for(let i=0;i<e.length;i++)TC(n.g,e[i]);kB(n,t)}}),M7),sr,-1,[0,hs,-1],gl,hs,-1],j7=[0,3,hs,-1,2,[0,na],[0,gl,hs],[0,sr,-1],[0]],W7=[0,sr,-2],U5=class extends cn{constructor(n){super(n)}},q7=[0],X7=[0,na,hs,1,hs,-4],yl=class extends cn{constructor(n){super(n,2)}},Ns={};Ns[336783863]=[0,sr,hs,-1,na,[0,[1,2,3,4,5,6,7,8,9],cs,q7,cs,V7,cs,W7,cs,X7,cs,Q7,cs,[0,sr,-2],cs,[0,sr,gl],cs,j7,cs,[0,gl,-1,hs]],[0,sr],hs,[0,[1,3],[2,4],cs,[0,Ex],-1,cs,[0,Pa],-1,$s,[0,sr,-1]],sr];var F5=[0,AR,-1,Um,-3,AR,Ex,Rd,u0,AR,-1,Um,u0,Um,-2,Rd];function Tr(n,e){MC(n,3,e)}function mi(n,e){MC(n,4,e)}var Go=class extends cn{constructor(n){super(n,500)}o(n){return _n(this,0,7,n)}},cb=[-1,{}],P5=[0,sr,1,cb],O5=[0,sr,Pa,cb];function mc(n,e){LB(n,1,Go,e)}function Wr(n,e){MC(n,10,e)}function Ti(n,e){MC(n,15,e)}var bl=class extends cn{constructor(n){super(n,500)}o(n){return _n(this,0,1001,n)}},Y7=[-500,$s,[-500,Rd,-1,Pa,-3,[-2,Ns,hs],$s,D5,u0,-1,P5,O5,$s,[0,Rd,Um],Rd,F5,u0,Pa,987,Pa],4,$s,[-500,sr,-1,[-1,{}],998,sr],$s,[-500,sr,Pa,-1,[-2,{},hs],997,Pa,-1],u0,$s,[-500,sr,Pa,cb,998,Pa],Pa,u0,P5,O5,$s,[0,Rd,-1,cb],Pa,-2,F5,Rd,-1,Um,[0,Um,Whe],978,cb,$s,D5];bl.prototype.g=FC(Y7);var Khe=np(bl,Y7),$he=class extends cn{constructor(n){super(n)}},K7=class extends cn{constructor(n){super(n)}g(){return bf(this,$he,1)}},$7=[0,$s,[0,na,Es,sr,-1]],PC=np(K7,$7),Jhe=class extends cn{constructor(n){super(n)}},Zhe=class extends cn{constructor(n){super(n)}},yR=class extends cn{constructor(n){super(n)}l(){return _i(this,Jhe,2)}g(){return bf(this,Zhe,5)}},J7=np(class extends cn{constructor(n){super(n)}},[0,Pa,Ex,WB,[0,gl,[0,na,-3],[0,Es,-3],[0,na,-1,[0,$s,[0,na,-2]]],$s,[0,Es,-1,sr,Es]],sr,-1,Yd,$s,[0,na,Es],Pa,Yd]),Z7=class extends cn{constructor(n){super(n)}},x0=np(class extends cn{constructor(n){super(n)}},[0,$s,[0,Es,-4]]),eH=class extends cn{constructor(n){super(n)}},wx=np(class extends cn{constructor(n){super(n)}},[0,$s,[0,Es,-4]]),efe=class extends cn{constructor(n){super(n)}},tfe=[0,na,-1,WB,gl],tH=class extends cn{constructor(n){super(n)}};tH.prototype.g=FC([0,Es,-4,Yd]);var nfe=class extends cn{constructor(n){super(n)}},ife=np(class extends cn{constructor(n){super(n)}},[0,$s,[0,1,na,sr,$7],Yd]),k5=class extends cn{constructor(n){super(n)}},rfe=class extends cn{constructor(n){super(n)}na(){const n=Cr(this,1,void 0,void 0,c7);return n??ng()}},sfe=class extends cn{constructor(n){super(n)}},nH=[1,2],afe=np(class extends cn{constructor(n){super(n)}},[0,$s,[0,nH,cs,[0,WB],cs,[0,H7],na,sr],Yd]),qB=class extends cn{constructor(n){super(n)}},iH=[0,sr,na,Es,Pa,-1],z5=class extends cn{constructor(n){super(n)}},ofe=[0,hs,-1],G5=class extends cn{constructor(n){super(n)}},rw=[1,2,3,4,5,6],cM=class extends cn{constructor(n){super(n)}g(){return Cr(this,1,void 0,void 0,c7)!=null}l(){return xa(Cr(this,2))!=null}},ns=class extends cn{constructor(n){super(n)}g(){return ZG(Cr(this,2))??!1}},rH=[0,H7,sr,[0,na,Yd,-1],[0,Vhe,Yd]],ws=[0,rH,hs,[0,rw,cs,X7,cs,V7,cs,Q7,cs,q7,cs,W7,cs,j7],gl],OC=class extends cn{constructor(n){super(n)}},XB=[0,ws,Es,-1,na],lfe=oh(502141897,OC);Ns[502141897]=XB;var cfe=np(class extends cn{constructor(n){super(n)}},[0,[0,gl,-1,Hhe,jhe],tfe]),sH=class extends cn{constructor(n){super(n)}},aH=class extends cn{constructor(n){super(n)}},U2=[0,ws,Es,[0,ws],hs],ufe=oh(508968150,aH);Ns[508968150]=[0,ws,XB,U2,Es,[0,[0,rH]]],Ns[508968149]=U2;var i0=class extends cn{constructor(n){super(n)}l(){return _i(this,qB,2)}g(){qi(this,2)}},oH=[0,ws,iH];Ns[478825465]=oH;var hfe=class extends cn{constructor(n){super(n)}},lH=class extends cn{constructor(n){super(n)}},YB=class extends cn{constructor(n){super(n)}},KB=class extends cn{constructor(n){super(n)}},cH=class extends cn{constructor(n){super(n)}},H5=[0,ws,[0,ws],oH,-1],uH=[0,ws,Es,na],$B=[0,ws,Es],hH=[0,ws,uH,$B,Es],ffe=oh(479097054,cH);Ns[479097054]=[0,ws,hH,H5],Ns[463370452]=H5,Ns[464864288]=uH;var dfe=oh(462713202,KB);Ns[462713202]=hH,Ns[474472470]=$B;var pfe=class extends cn{constructor(n){super(n)}},fH=class extends cn{constructor(n){super(n)}},dH=class extends cn{constructor(n){super(n)}},pH=class extends cn{constructor(n){super(n)}},JB=[0,ws,Es,-1,na],F2=[0,ws,Es,hs];pH.prototype.g=FC([0,ws,$B,[0,ws],XB,U2,JB,F2]);var mH=class extends cn{constructor(n){super(n)}},mfe=oh(456383383,mH);Ns[456383383]=[0,ws,iH];var gH=class extends cn{constructor(n){super(n)}},gfe=oh(476348187,gH);Ns[476348187]=[0,ws,ofe];var AH=class extends cn{constructor(n){super(n)}},Q5=class extends cn{constructor(n){super(n)}},vH=[0,gl,-1],Afe=oh(458105876,class extends cn{constructor(n){super(n)}g(){let n;var e=this.v;const t=0|e[ln];return n=pl(this,t),e=(function(i,r,s,a){var o=Q5;!a&&_v(i)&&(s=0|(r=i.v)[ln]);var c=yf(r,2);if(i=!1,c==null){if(a)return S5();c=[]}else if(c.constructor===vf){if(!(2&c.J)||a)return c;c=c.V()}else Array.isArray(c)?i=!!(2&(0|c[ln])):c=[];if(a){if(!c.length)return S5();i||(i=!0,yx(c))}else i&&(i=!1,Gb(c),c=u7(c));return!i&&32&s&&vx(c,32),s=Ls(r,s,2,a=new vf(c,o,Ahe,void 0)),i||ug(r,s),a})(this,e,t,n),!n&&Q5&&(e.ra=!0),e}});Ns[458105876]=[0,vH,Ghe,[!0,Yd,[0,sr,-1,Pa]],[0,Ex,hs,gl]];var ZB=class extends cn{constructor(n){super(n)}},yH=oh(458105758,ZB);Ns[458105758]=[0,ws,sr,vH];var bR=class extends cn{constructor(n){super(n)}},V5=[0,Qhe,-1,Um],vfe=class extends cn{constructor(n){super(n)}},bH=class extends cn{constructor(n){super(n)}},P2=[1,2];bH.prototype.g=FC([0,P2,cs,V5,cs,[0,$s,V5]]);var xH=class extends cn{constructor(n){super(n)}},yfe=oh(443442058,xH);Ns[443442058]=[0,ws,sr,na,Es,Pa,-1,hs,Es],Ns[514774813]=JB;var _H=class extends cn{constructor(n){super(n)}},bfe=oh(516587230,_H);function O2(n,e){return e=e?e.clone():new qB,n.displayNamesLocale!==void 0?qi(e,1,_x(n.displayNamesLocale)):n.displayNamesLocale===void 0&&qi(e,1),n.maxResults!==void 0?xf(e,2,n.maxResults):"maxResults"in n&&qi(e,2),n.scoreThreshold!==void 0?dn(e,3,n.scoreThreshold):"scoreThreshold"in n&&qi(e,3),n.categoryAllowlist!==void 0?sM(e,4,n.categoryAllowlist):"categoryAllowlist"in n&&qi(e,4),n.categoryDenylist!==void 0?sM(e,5,n.categoryDenylist):"categoryDenylist"in n&&qi(e,5),e}function SH(n){const e=Number(n);return Number.isSafeInteger(e)?e:String(n)}function eD(n,e=-1,t=""){return{categories:n.map((i=>({index:oc(i,1)??0??-1,score:us(i,2)??0,categoryName:xa(Cr(i,3))??""??"",displayName:xa(Cr(i,4))??""??""}))),headIndex:e,headName:t}}function xfe(n){const e={classifications:bf(n,nfe,1).map((t=>eD(_i(t,K7,4)?.g()??[],oc(t,2)??0,xa(Cr(t,3))??"")))};return(function(t){return ghe(mB?Cr(t,2,void 0,void 0,iM):Cr(t,2))})(n)!=null&&(e.timestampMs=SH(m7(n))),e}function EH(n){var e=Sm(n,3,Ku,_m()),t=Sm(n,2,bv,_m()),i=Sm(n,1,xa,_m()),r=Sm(n,9,xa,_m());const s={categories:[],keypoints:[]};for(let a=0;a<e.length;a++)s.categories.push({score:e[a],index:t[a]??-1,categoryName:i[a]??"",displayName:r[a]??""});if((e=_i(n,yR,4)?.l())&&(s.boundingBox={originX:oc(e,1,bd)??0,originY:oc(e,2,bd)??0,width:oc(e,3,bd)??0,height:oc(e,4,bd)??0,angle:0}),_i(n,yR,4)?.g().length)for(const a of _i(n,yR,4).g())s.keypoints.push({x:Cr(a,1,void 0,bd,Ku)??0,y:Cr(a,2,void 0,bd,Ku)??0,score:Cr(a,4,void 0,bd,Ku)??0,label:xa(Cr(a,3,void 0,bd))??""});return s}function kC(n){const e=[];for(const t of bf(n,eH,1))e.push({x:us(t,1)??0,y:us(t,2)??0,z:us(t,3)??0,visibility:us(t,4)??0});return e}function ub(n){const e=[];for(const t of bf(n,Z7,1))e.push({x:us(t,1)??0,y:us(t,2)??0,z:us(t,3)??0,visibility:us(t,4)??0});return e}function j5(n){return Array.from(n,(e=>e>127?e-256:e))}function W5(n,e){if(n.length!==e.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${n.length} vs. ${e.length}).`);let t=0,i=0,r=0;for(let s=0;s<n.length;s++)t+=n[s]*e[s],i+=n[s]*n[s],r+=e[s]*e[s];if(i<=0||r<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return t/Math.sqrt(i*r)}let UE;Ns[516587230]=[0,ws,JB,F2,Es],Ns[518928384]=F2;const _fe=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function wH(){if(UE===void 0)try{await WebAssembly.instantiate(_fe),UE=!0}catch{UE=!1}return UE}async function P1(n,e=Xhe``){const t=await wH()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${e}/${n}_${t}.js`,wasmBinaryPath:`${e}/${n}_${t}.wasm`}}var wd=class{};function MH(){var n=navigator;return typeof OffscreenCanvas<"u"&&(!(function(e=navigator){return(e=e.userAgent).includes("Safari")&&!e.includes("Chrome")})(n)||!!((n=n.userAgent.match(/Version\/([\d]+).*Safari/))&&n.length>=1&&Number(n[1])>=17))}async function q5(n){if(typeof importScripts!="function"){const e=document.createElement("script");return e.src=n.toString(),e.crossOrigin="anonymous",new Promise(((t,i)=>{e.addEventListener("load",(()=>{t()}),!1),e.addEventListener("error",(r=>{i(r)}),!1),document.body.appendChild(e)}))}try{importScripts(n.toString())}catch(e){if(!(e instanceof TypeError))throw e;await self.import(n.toString())}}function CH(n){return n.videoWidth!==void 0?[n.videoWidth,n.videoHeight]:n.naturalWidth!==void 0?[n.naturalWidth,n.naturalHeight]:n.displayWidth!==void 0?[n.displayWidth,n.displayHeight]:[n.width,n.height]}function un(n,e,t){n.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),t(e=n.i.stringToNewUTF8(e)),n.i._free(e)}function X5(n,e,t){if(!n.i.canvas)throw Error("No OpenGL canvas configured.");if(t?n.i._bindTextureToStream(t):n.i._bindTextureToCanvas(),!(t=n.i.canvas.getContext("webgl2")||n.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");n.i.gpuOriginForWebTexturesIsBottomLeft&&t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),n.i.gpuOriginForWebTexturesIsBottomLeft&&t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1);const[i,r]=CH(e);return!n.l||i===n.i.canvas.width&&r===n.i.canvas.height||(n.i.canvas.width=i,n.i.canvas.height=r),[i,r]}function Y5(n,e,t){n.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const i=new Uint32Array(e.length);for(let r=0;r<e.length;r++)i[r]=n.i.stringToNewUTF8(e[r]);e=n.i._malloc(4*i.length),n.i.HEAPU32.set(i,e>>2),t(e);for(const r of i)n.i._free(r);n.i._free(e)}function Pu(n,e,t){n.i.simpleListeners=n.i.simpleListeners||{},n.i.simpleListeners[e]=t}function xd(n,e,t){let i=[];n.i.simpleListeners=n.i.simpleListeners||{},n.i.simpleListeners[e]=(r,s,a)=>{s?(t(i,a),i=[]):i.push(r)}}wd.forVisionTasks=function(n){return P1("vision",n)},wd.forTextTasks=function(n){return P1("text",n)},wd.forGenAiExperimentalTasks=function(n){return P1("genai_experimental",n)},wd.forGenAiTasks=function(n){return P1("genai",n)},wd.forAudioTasks=function(n){return P1("audio",n)},wd.isSimdSupported=function(){return wH()};async function Sfe(n,e,t,i){return n=await(async(r,s,a,o,c)=>{if(s&&await q5(s),!self.ModuleFactory||a&&(await q5(a),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&c&&((s=self.Module).locateFile=c.locateFile,c.mainScriptUrlOrBlob&&(s.mainScriptUrlOrBlob=c.mainScriptUrlOrBlob)),c=await self.ModuleFactory(self.Module||c),self.ModuleFactory=self.Module=void 0,new r(c,o)})(n,t.wasmLoaderPath,t.assetLoaderPath,e,{locateFile:r=>r.endsWith(".wasm")?t.wasmBinaryPath.toString():t.assetBinaryPath&&r.endsWith(".data")?t.assetBinaryPath.toString():r}),await n.o(i),n}function xR(n,e){const t=_i(n.baseOptions,cM,1)||new cM;typeof e=="string"?(qi(t,2,_x(e)),qi(t,1)):e instanceof Uint8Array&&(qi(t,1,vB(e,!1)),qi(t,2)),_n(n.baseOptions,0,1,t)}function K5(n){try{const e=n.H.length;if(e===1)throw Error(n.H[0].message);if(e>1)throw Error("Encountered multiple errors: "+n.H.map((t=>t.message)).join(", "))}finally{n.H=[]}}function nn(n,e){n.C=Math.max(n.C,e)}function zC(n,e){n.B=new Go,ml(n.B,2,"PassThroughCalculator"),Tr(n.B,"free_memory"),mi(n.B,"free_memory_unused_out"),Wr(e,"free_memory"),mc(e,n.B)}function J0(n,e){Tr(n.B,e),mi(n.B,e+"_unused_out")}function GC(n){n.g.addBoolToStream(!0,"free_memory",n.C)}var k2=class{constructor(n){this.g=n,this.H=[],this.C=0,this.g.setAutoRenderToScreen(!1)}l(n,e=!0){if(e){const t=n.baseOptions||{};if(n.baseOptions?.modelAssetBuffer&&n.baseOptions?.modelAssetPath)throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!(_i(this.baseOptions,cM,1)?.g()||_i(this.baseOptions,cM,1)?.l()||n.baseOptions?.modelAssetBuffer||n.baseOptions?.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if((function(i,r){let s=_i(i.baseOptions,G5,3);if(!s){var a=s=new G5,o=new U5;lb(a,4,rw,o)}"delegate"in r&&(r.delegate==="GPU"?(r=s,a=new Yhe,lb(r,2,rw,a)):(r=s,a=new U5,lb(r,4,rw,a))),_n(i.baseOptions,0,3,s)})(this,t),t.modelAssetPath)return fetch(t.modelAssetPath.toString()).then((i=>{if(i.ok)return i.arrayBuffer();throw Error(`Failed to fetch model: ${t.modelAssetPath} (${i.status})`)})).then((i=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(i),!0,!1,!1),xR(this,"/model.dat"),this.m(),this.L()}));if(t.modelAssetBuffer instanceof Uint8Array)xR(this,t.modelAssetBuffer);else if(t.modelAssetBuffer)return(async function(i){const r=[];for(var s=0;;){const{done:a,value:o}=await i.read();if(a)break;r.push(o),s+=o.length}if(r.length===0)return new Uint8Array(0);if(r.length===1)return r[0];i=new Uint8Array(s),s=0;for(const a of r)i.set(a,s),s+=a.length;return i})(t.modelAssetBuffer).then((i=>{xR(this,i),this.m(),this.L()}))}return this.m(),this.L(),Promise.resolve()}L(){}ca(){let n;if(this.g.ca((e=>{n=Khe(e)})),!n)throw Error("Failed to retrieve CalculatorGraphConfig");return n}setGraph(n,e){this.g.attachErrorListener(((t,i)=>{this.H.push(Error(i))})),this.g.Ja(),this.g.setGraph(n,e),this.B=void 0,K5(this)}finishProcessing(){this.g.finishProcessing(),K5(this)}close(){this.B=void 0,this.g.closeGraph()}};function zd(n,e){if(!n)throw Error(`Unable to obtain required WebGL resource: ${e}`);return n}k2.prototype.close=k2.prototype.close;class Efe{constructor(e,t,i,r){this.g=e,this.h=t,this.m=i,this.l=r}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function $5(n,e,t){const i=n.g;if(t=zd(i.createShader(t),"Failed to create WebGL shader"),i.shaderSource(t,e),i.compileShader(t),!i.getShaderParameter(t,i.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${i.getShaderInfoLog(t)}`);return i.attachShader(n.h,t),t}function J5(n,e){const t=n.g,i=zd(t.createVertexArray(),"Failed to create vertex array");t.bindVertexArray(i);const r=zd(t.createBuffer(),"Failed to create buffer");t.bindBuffer(t.ARRAY_BUFFER,r),t.enableVertexAttribArray(n.O),t.vertexAttribPointer(n.O,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),t.STATIC_DRAW);const s=zd(t.createBuffer(),"Failed to create buffer");return t.bindBuffer(t.ARRAY_BUFFER,s),t.enableVertexAttribArray(n.L),t.vertexAttribPointer(n.L,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null),new Efe(t,i,r,s)}function tD(n,e){if(n.g){if(e!==n.g)throw Error("Cannot change GL context once initialized")}else n.g=e}function wfe(n,e,t,i){return tD(n,e),n.h||(n.m(),n.D()),t?(n.u||(n.u=J5(n,!0)),t=n.u):(n.A||(n.A=J5(n,!1)),t=n.A),e.useProgram(n.h),t.bind(),n.l(),n=i(),t.g.bindVertexArray(null),n}function TH(n,e,t){return tD(n,e),n=zd(e.createTexture(),"Failed to create texture"),e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t??e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t??e.LINEAR),e.bindTexture(e.TEXTURE_2D,null),n}function IH(n,e,t){tD(n,e),n.B||(n.B=zd(e.createFramebuffer(),"Failed to create framebuffe.")),e.bindFramebuffer(e.FRAMEBUFFER,n.B),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}function Mfe(n){n.g?.bindFramebuffer(n.g.FRAMEBUFFER,null)}var RH=class{H(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const n=this.g;if(this.h=zd(n.createProgram(),"Failed to create WebGL program"),this.X=$5(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,n.VERTEX_SHADER),this.W=$5(this,this.H(),n.FRAGMENT_SHADER),n.linkProgram(this.h),!n.getProgramParameter(this.h,n.LINK_STATUS))throw Error(`Error during program linking: ${n.getProgramInfoLog(this.h)}`);this.O=n.getAttribLocation(this.h,"aVertex"),this.L=n.getAttribLocation(this.h,"aTex")}D(){}l(){}close(){if(this.h){const n=this.g;n.deleteProgram(this.h),n.deleteShader(this.X),n.deleteShader(this.W)}this.B&&this.g.deleteFramebuffer(this.B),this.A&&this.A.close(),this.u&&this.u.close()}};function af(n,e){switch(e){case 0:return n.g.find((t=>t instanceof Uint8Array));case 1:return n.g.find((t=>t instanceof Float32Array));case 2:return n.g.find((t=>typeof WebGLTexture<"u"&&t instanceof WebGLTexture));default:throw Error(`Type is not supported: ${e}`)}}function z2(n){var e=af(n,1);if(!e){if(e=af(n,0))e=new Float32Array(e).map((i=>i/255));else{e=new Float32Array(n.width*n.height);const i=Z0(n);var t=nD(n);if(IH(t,i,BH(n)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){t=new Float32Array(n.width*n.height*4),i.readPixels(0,0,n.width,n.height,i.RGBA,i.FLOAT,t);for(let r=0,s=0;r<e.length;++r,s+=4)e[r]=t[s]}else i.readPixels(0,0,n.width,n.height,i.RED,i.FLOAT,e)}n.g.push(e)}return e}function BH(n){let e=af(n,2);if(!e){const t=Z0(n);e=LH(n);const i=z2(n),r=DH(n);t.texImage2D(t.TEXTURE_2D,0,r,n.width,n.height,0,t.RED,t.FLOAT,i),G2(n)}return e}function Z0(n){if(!n.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return n.h||(n.h=zd(n.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),n.h}function DH(n){if(n=Z0(n),!FE)if(n.getExtension("EXT_color_buffer_float")&&n.getExtension("OES_texture_float_linear")&&n.getExtension("EXT_float_blend"))FE=n.R32F;else{if(!n.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");FE=n.R16F}return FE}function nD(n){return n.l||(n.l=new RH),n.l}function LH(n){const e=Z0(n);e.viewport(0,0,n.width,n.height),e.activeTexture(e.TEXTURE0);let t=af(n,2);return t||(t=TH(nD(n),e,n.m?e.LINEAR:e.NEAREST),n.g.push(t),n.j=!0),e.bindTexture(e.TEXTURE_2D,t),t}function G2(n){n.h.bindTexture(n.h.TEXTURE_2D,null)}var FE,Ys=class{constructor(n,e,t,i,r,s,a){this.g=n,this.m=e,this.j=t,this.canvas=i,this.l=r,this.width=s,this.height=a,this.j&&--Z5===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Fa(){return!!af(this,0)}ka(){return!!af(this,1)}R(){return!!af(this,2)}ja(){return(e=af(n=this,0))||(e=z2(n),e=new Uint8Array(e.map((t=>Math.round(255*t)))),n.g.push(e)),e;var n,e}ia(){return z2(this)}N(){return BH(this)}clone(){const n=[];for(const e of this.g){let t;if(e instanceof Uint8Array)t=new Uint8Array(e);else if(e instanceof Float32Array)t=new Float32Array(e);else{if(!(e instanceof WebGLTexture))throw Error(`Type is not supported: ${e}`);{const i=Z0(this),r=nD(this);i.activeTexture(i.TEXTURE1),t=TH(r,i,this.m?i.LINEAR:i.NEAREST),i.bindTexture(i.TEXTURE_2D,t);const s=DH(this);i.texImage2D(i.TEXTURE_2D,0,s,this.width,this.height,0,i.RED,i.FLOAT,null),i.bindTexture(i.TEXTURE_2D,null),IH(r,i,t),wfe(r,i,!1,(()=>{LH(this),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.drawArrays(i.TRIANGLE_FAN,0,4),G2(this)})),Mfe(r),G2(this)}}n.push(t)}return new Ys(n,this.m,this.R(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Z0(this).deleteTexture(af(this,2)),Z5=-1}};Ys.prototype.close=Ys.prototype.close,Ys.prototype.clone=Ys.prototype.clone,Ys.prototype.getAsWebGLTexture=Ys.prototype.N,Ys.prototype.getAsFloat32Array=Ys.prototype.ia,Ys.prototype.getAsUint8Array=Ys.prototype.ja,Ys.prototype.hasWebGLTexture=Ys.prototype.R,Ys.prototype.hasFloat32Array=Ys.prototype.ka,Ys.prototype.hasUint8Array=Ys.prototype.Fa;var Z5=250;function $c(...n){return n.map((([e,t])=>({start:e,end:t})))}const Cfe=(function(n){return class extends n{Ja(){this.i._registerModelResourcesGraphService()}}})((ek=class{constructor(n,e){this.l=!0,this.i=n,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",e!==void 0?this.i.canvas=e:MH()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(n){const e=await(await fetch(n)).arrayBuffer();n=!(n.endsWith(".pbtxt")||n.endsWith(".textproto")),this.setGraph(new Uint8Array(e),n)}setGraphFromString(n){this.setGraph(new TextEncoder().encode(n),!1)}setGraph(n,e){const t=n.length,i=this.i._malloc(t);this.i.HEAPU8.set(n,i),e?this.i._changeBinaryGraph(t,i):this.i._changeTextGraph(t,i),this.i._free(i)}configureAudio(n,e,t,i,r){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),un(this,i||"input_audio",(s=>{un(this,r=r||"audio_header",(a=>{this.i._configureAudio(s,a,n,e??0,t)}))}))}setAutoResizeCanvas(n){this.l=n}setAutoRenderToScreen(n){this.i._setAutoRenderToScreen(n)}setGpuBufferVerticalFlip(n){this.i.gpuOriginForWebTexturesIsBottomLeft=n}ca(n){Pu(this,"__graph_config__",(e=>{n(e)})),un(this,"__graph_config__",(e=>{this.i._getGraphConfig(e,void 0)})),delete this.i.simpleListeners.__graph_config__}attachErrorListener(n){this.i.errorListener=n}attachEmptyPacketListener(n,e){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[n]=e}addAudioToStream(n,e,t){this.addAudioToStreamWithShape(n,0,0,e,t)}addAudioToStreamWithShape(n,e,t,i,r){const s=4*n.length;this.h!==s&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(s),this.h=s),this.i.HEAPF32.set(n,this.g/4),un(this,i,(a=>{this.i._addAudioToInputStream(this.g,e,t,a,r)}))}addGpuBufferToStream(n,e,t){un(this,e,(i=>{const[r,s]=X5(this,n,i);this.i._addBoundTextureToStream(i,r,s,t)}))}addBoolToStream(n,e,t){un(this,e,(i=>{this.i._addBoolToInputStream(n,i,t)}))}addDoubleToStream(n,e,t){un(this,e,(i=>{this.i._addDoubleToInputStream(n,i,t)}))}addFloatToStream(n,e,t){un(this,e,(i=>{this.i._addFloatToInputStream(n,i,t)}))}addIntToStream(n,e,t){un(this,e,(i=>{this.i._addIntToInputStream(n,i,t)}))}addUintToStream(n,e,t){un(this,e,(i=>{this.i._addUintToInputStream(n,i,t)}))}addStringToStream(n,e,t){un(this,e,(i=>{un(this,n,(r=>{this.i._addStringToInputStream(r,i,t)}))}))}addStringRecordToStream(n,e,t){un(this,e,(i=>{Y5(this,Object.keys(n),(r=>{Y5(this,Object.values(n),(s=>{this.i._addFlatHashMapToInputStream(r,s,Object.keys(n).length,i,t)}))}))}))}addProtoToStream(n,e,t,i){un(this,t,(r=>{un(this,e,(s=>{const a=this.i._malloc(n.length);this.i.HEAPU8.set(n,a),this.i._addProtoToInputStream(a,n.length,s,r,i),this.i._free(a)}))}))}addEmptyPacketToStream(n,e){un(this,n,(t=>{this.i._addEmptyPacketToInputStream(t,e)}))}addBoolVectorToStream(n,e,t){un(this,e,(i=>{const r=this.i._allocateBoolVector(n.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const s of n)this.i._addBoolVectorEntry(r,s);this.i._addBoolVectorToInputStream(r,i,t)}))}addDoubleVectorToStream(n,e,t){un(this,e,(i=>{const r=this.i._allocateDoubleVector(n.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const s of n)this.i._addDoubleVectorEntry(r,s);this.i._addDoubleVectorToInputStream(r,i,t)}))}addFloatVectorToStream(n,e,t){un(this,e,(i=>{const r=this.i._allocateFloatVector(n.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const s of n)this.i._addFloatVectorEntry(r,s);this.i._addFloatVectorToInputStream(r,i,t)}))}addIntVectorToStream(n,e,t){un(this,e,(i=>{const r=this.i._allocateIntVector(n.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const s of n)this.i._addIntVectorEntry(r,s);this.i._addIntVectorToInputStream(r,i,t)}))}addUintVectorToStream(n,e,t){un(this,e,(i=>{const r=this.i._allocateUintVector(n.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const s of n)this.i._addUintVectorEntry(r,s);this.i._addUintVectorToInputStream(r,i,t)}))}addStringVectorToStream(n,e,t){un(this,e,(i=>{const r=this.i._allocateStringVector(n.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const s of n)un(this,s,(a=>{this.i._addStringVectorEntry(r,a)}));this.i._addStringVectorToInputStream(r,i,t)}))}addBoolToInputSidePacket(n,e){un(this,e,(t=>{this.i._addBoolToInputSidePacket(n,t)}))}addDoubleToInputSidePacket(n,e){un(this,e,(t=>{this.i._addDoubleToInputSidePacket(n,t)}))}addFloatToInputSidePacket(n,e){un(this,e,(t=>{this.i._addFloatToInputSidePacket(n,t)}))}addIntToInputSidePacket(n,e){un(this,e,(t=>{this.i._addIntToInputSidePacket(n,t)}))}addUintToInputSidePacket(n,e){un(this,e,(t=>{this.i._addUintToInputSidePacket(n,t)}))}addStringToInputSidePacket(n,e){un(this,e,(t=>{un(this,n,(i=>{this.i._addStringToInputSidePacket(i,t)}))}))}addProtoToInputSidePacket(n,e,t){un(this,t,(i=>{un(this,e,(r=>{const s=this.i._malloc(n.length);this.i.HEAPU8.set(n,s),this.i._addProtoToInputSidePacket(s,n.length,r,i),this.i._free(s)}))}))}addBoolVectorToInputSidePacket(n,e){un(this,e,(t=>{const i=this.i._allocateBoolVector(n.length);if(!i)throw Error("Unable to allocate new bool vector on heap.");for(const r of n)this.i._addBoolVectorEntry(i,r);this.i._addBoolVectorToInputSidePacket(i,t)}))}addDoubleVectorToInputSidePacket(n,e){un(this,e,(t=>{const i=this.i._allocateDoubleVector(n.length);if(!i)throw Error("Unable to allocate new double vector on heap.");for(const r of n)this.i._addDoubleVectorEntry(i,r);this.i._addDoubleVectorToInputSidePacket(i,t)}))}addFloatVectorToInputSidePacket(n,e){un(this,e,(t=>{const i=this.i._allocateFloatVector(n.length);if(!i)throw Error("Unable to allocate new float vector on heap.");for(const r of n)this.i._addFloatVectorEntry(i,r);this.i._addFloatVectorToInputSidePacket(i,t)}))}addIntVectorToInputSidePacket(n,e){un(this,e,(t=>{const i=this.i._allocateIntVector(n.length);if(!i)throw Error("Unable to allocate new int vector on heap.");for(const r of n)this.i._addIntVectorEntry(i,r);this.i._addIntVectorToInputSidePacket(i,t)}))}addUintVectorToInputSidePacket(n,e){un(this,e,(t=>{const i=this.i._allocateUintVector(n.length);if(!i)throw Error("Unable to allocate new unsigned int vector on heap.");for(const r of n)this.i._addUintVectorEntry(i,r);this.i._addUintVectorToInputSidePacket(i,t)}))}addStringVectorToInputSidePacket(n,e){un(this,e,(t=>{const i=this.i._allocateStringVector(n.length);if(!i)throw Error("Unable to allocate new string vector on heap.");for(const r of n)un(this,r,(s=>{this.i._addStringVectorEntry(i,s)}));this.i._addStringVectorToInputSidePacket(i,t)}))}attachBoolListener(n,e){Pu(this,n,e),un(this,n,(t=>{this.i._attachBoolListener(t)}))}attachBoolVectorListener(n,e){xd(this,n,e),un(this,n,(t=>{this.i._attachBoolVectorListener(t)}))}attachIntListener(n,e){Pu(this,n,e),un(this,n,(t=>{this.i._attachIntListener(t)}))}attachIntVectorListener(n,e){xd(this,n,e),un(this,n,(t=>{this.i._attachIntVectorListener(t)}))}attachUintListener(n,e){Pu(this,n,e),un(this,n,(t=>{this.i._attachUintListener(t)}))}attachUintVectorListener(n,e){xd(this,n,e),un(this,n,(t=>{this.i._attachUintVectorListener(t)}))}attachDoubleListener(n,e){Pu(this,n,e),un(this,n,(t=>{this.i._attachDoubleListener(t)}))}attachDoubleVectorListener(n,e){xd(this,n,e),un(this,n,(t=>{this.i._attachDoubleVectorListener(t)}))}attachFloatListener(n,e){Pu(this,n,e),un(this,n,(t=>{this.i._attachFloatListener(t)}))}attachFloatVectorListener(n,e){xd(this,n,e),un(this,n,(t=>{this.i._attachFloatVectorListener(t)}))}attachStringListener(n,e){Pu(this,n,e),un(this,n,(t=>{this.i._attachStringListener(t)}))}attachStringVectorListener(n,e){xd(this,n,e),un(this,n,(t=>{this.i._attachStringVectorListener(t)}))}attachProtoListener(n,e,t){Pu(this,n,e),un(this,n,(i=>{this.i._attachProtoListener(i,t||!1)}))}attachProtoVectorListener(n,e,t){xd(this,n,e),un(this,n,(i=>{this.i._attachProtoVectorListener(i,t||!1)}))}attachAudioListener(n,e,t){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),Pu(this,n,((i,r)=>{i=new Float32Array(i.buffer,i.byteOffset,i.length/4),e(i,r)})),un(this,n,(i=>{this.i._attachAudioListener(i,t||!1)}))}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends ek{get ga(){return this.i}pa(n,e,t){un(this,e,(i=>{const[r,s]=X5(this,n,i);this.ga._addBoundTextureAsImageToStream(i,r,s,t)}))}Z(n,e){Pu(this,n,e),un(this,n,(t=>{this.ga._attachImageListener(t)}))}aa(n,e){xd(this,n,e),un(this,n,(t=>{this.ga._attachImageVectorListener(t)}))}}));var ek,Jc=class extends Cfe{};async function Ai(n,e,t){return(async function(i,r,s,a){return Sfe(i,r,s,a)})(n,t.canvas??(MH()?void 0:document.createElement("canvas")),e,t)}function NH(n,e,t,i){if(n.U){const s=new tH;if(t?.regionOfInterest){if(!n.oa)throw Error("This task doesn't support region-of-interest.");var r=t.regionOfInterest;if(r.left>=r.right||r.top>=r.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(r.left<0||r.top<0||r.right>1||r.bottom>1)throw Error("Expected RectF values to be in [0,1].");dn(s,1,(r.left+r.right)/2),dn(s,2,(r.top+r.bottom)/2),dn(s,4,r.right-r.left),dn(s,3,r.bottom-r.top)}else dn(s,1,.5),dn(s,2,.5),dn(s,4,1),dn(s,3,1);if(t?.rotationDegrees){if(t?.rotationDegrees%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(dn(s,5,-Math.PI*t.rotationDegrees/180),t?.rotationDegrees%180!=0){const[a,o]=CH(e);t=us(s,3)*o/a,r=us(s,4)*a/o,dn(s,4,t),dn(s,3,r)}}n.g.addProtoToStream(s.g(),"mediapipe.NormalizedRect",n.U,i)}n.g.pa(e,n.X,i??performance.now()),n.finishProcessing()}function Zc(n,e,t){if(n.baseOptions?.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");NH(n,e,t,n.C+1)}function lh(n,e,t,i){if(!n.baseOptions?.g())throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");NH(n,e,t,i)}function ev(n,e,t,i){var r=e.data;const s=e.width,a=s*(e=e.height);if((r instanceof Uint8Array||r instanceof Float32Array)&&r.length!==a)throw Error("Unsupported channel count: "+r.length/a);return n=new Ys([r],t,!1,n.g.i.canvas,n.P,s,e),i?n.clone():n}var Al=class extends k2{constructor(n,e,t,i){super(n),this.g=n,this.X=e,this.U=t,this.oa=i,this.P=new RH}l(n,e=!0){if("runningMode"in n&&qi(this.baseOptions,2,Qb(!!n.runningMode&&n.runningMode!=="IMAGE")),n.canvas!==void 0&&this.g.i.canvas!==n.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(n,e)}close(){this.P.close(),super.close()}};Al.prototype.close=Al.prototype.close;var Jl=class extends Al{constructor(n,e){super(new Jc(n,e),"image_in","norm_rect_in",!1),this.j={detections:[]},_n(n=this.h=new OC,0,1,e=new ns),dn(this.h,2,.5),dn(this.h,3,.3)}get baseOptions(){return _i(this.h,ns,1)}set baseOptions(n){_n(this.h,0,1,n)}o(n){return"minDetectionConfidence"in n&&dn(this.h,2,n.minDetectionConfidence??.5),"minSuppressionThreshold"in n&&dn(this.h,3,n.minSuppressionThreshold??.3),this.l(n)}F(n,e){return this.j={detections:[]},Zc(this,n,e),this.j}G(n,e,t){return this.j={detections:[]},lh(this,n,t,e),this.j}m(){var n=new bl;Wr(n,"image_in"),Wr(n,"norm_rect_in"),Ti(n,"detections");const e=new yl;ah(e,lfe,this.h);const t=new Go;ml(t,2,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),Tr(t,"IMAGE:image_in"),Tr(t,"NORM_RECT:norm_rect_in"),mi(t,"DETECTIONS:detections"),t.o(e),mc(n,t),this.g.attachProtoVectorListener("detections",((i,r)=>{for(const s of i)i=J7(s),this.j.detections.push(EH(i));nn(this,r)})),this.g.attachEmptyPacketListener("detections",(i=>{nn(this,i)})),n=n.g(),this.setGraph(new Uint8Array(n),!0)}};Jl.prototype.detectForVideo=Jl.prototype.G,Jl.prototype.detect=Jl.prototype.F,Jl.prototype.setOptions=Jl.prototype.o,Jl.createFromModelPath=async function(n,e){return Ai(Jl,n,{baseOptions:{modelAssetPath:e}})},Jl.createFromModelBuffer=function(n,e){return Ai(Jl,n,{baseOptions:{modelAssetBuffer:e}})},Jl.createFromOptions=function(n,e){return Ai(Jl,n,e)};var iD=$c([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),rD=$c([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),sD=$c([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),UH=$c([474,475],[475,476],[476,477],[477,474]),aD=$c([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),oD=$c([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),FH=$c([469,470],[470,471],[471,472],[472,469]),lD=$c([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),PH=[...iD,...rD,...sD,...aD,...oD,...lD],OH=$c([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function tk(n){n.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var es=class extends Al{constructor(n,e){super(new Jc(n,e),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,_n(n=this.h=new aH,0,1,e=new ns),this.A=new sH,_n(this.h,0,3,this.A),this.u=new OC,_n(this.h,0,2,this.u),xf(this.u,4,1),dn(this.u,2,.5),dn(this.A,2,.5),dn(this.h,4,.5)}get baseOptions(){return _i(this.h,ns,1)}set baseOptions(n){_n(this.h,0,1,n)}o(n){return"numFaces"in n&&xf(this.u,4,n.numFaces??1),"minFaceDetectionConfidence"in n&&dn(this.u,2,n.minFaceDetectionConfidence??.5),"minTrackingConfidence"in n&&dn(this.h,4,n.minTrackingConfidence??.5),"minFacePresenceConfidence"in n&&dn(this.A,2,n.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in n&&(this.outputFaceBlendshapes=!!n.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in n&&(this.outputFacialTransformationMatrixes=!!n.outputFacialTransformationMatrixes),this.l(n)}F(n,e){return tk(this),Zc(this,n,e),this.j}G(n,e,t){return tk(this),lh(this,n,t,e),this.j}m(){var n=new bl;Wr(n,"image_in"),Wr(n,"norm_rect"),Ti(n,"face_landmarks");const e=new yl;ah(e,ufe,this.h);const t=new Go;ml(t,2,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),Tr(t,"IMAGE:image_in"),Tr(t,"NORM_RECT:norm_rect"),mi(t,"NORM_LANDMARKS:face_landmarks"),t.o(e),mc(n,t),this.g.attachProtoVectorListener("face_landmarks",((i,r)=>{for(const s of i)i=wx(s),this.j.faceLandmarks.push(kC(i));nn(this,r)})),this.g.attachEmptyPacketListener("face_landmarks",(i=>{nn(this,i)})),this.outputFaceBlendshapes&&(Ti(n,"blendshapes"),mi(t,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",((i,r)=>{if(this.outputFaceBlendshapes)for(const s of i)i=PC(s),this.j.faceBlendshapes.push(eD(i.g()??[]));nn(this,r)})),this.g.attachEmptyPacketListener("blendshapes",(i=>{nn(this,i)}))),this.outputFacialTransformationMatrixes&&(Ti(n,"face_geometry"),mi(t,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",((i,r)=>{if(this.outputFacialTransformationMatrixes)for(const s of i)(i=_i(i=cfe(s),efe,2))&&this.j.facialTransformationMatrixes.push({rows:oc(i,1)??0??0,columns:oc(i,2)??0??0,data:Sm(i,3,Ku,_m()).slice()??[]});nn(this,r)})),this.g.attachEmptyPacketListener("face_geometry",(i=>{nn(this,i)}))),n=n.g(),this.setGraph(new Uint8Array(n),!0)}};es.prototype.detectForVideo=es.prototype.G,es.prototype.detect=es.prototype.F,es.prototype.setOptions=es.prototype.o,es.createFromModelPath=function(n,e){return Ai(es,n,{baseOptions:{modelAssetPath:e}})},es.createFromModelBuffer=function(n,e){return Ai(es,n,{baseOptions:{modelAssetBuffer:e}})},es.createFromOptions=function(n,e){return Ai(es,n,e)},es.FACE_LANDMARKS_LIPS=iD,es.FACE_LANDMARKS_LEFT_EYE=rD,es.FACE_LANDMARKS_LEFT_EYEBROW=sD,es.FACE_LANDMARKS_LEFT_IRIS=UH,es.FACE_LANDMARKS_RIGHT_EYE=aD,es.FACE_LANDMARKS_RIGHT_EYEBROW=oD,es.FACE_LANDMARKS_RIGHT_IRIS=FH,es.FACE_LANDMARKS_FACE_OVAL=lD,es.FACE_LANDMARKS_CONTOURS=PH,es.FACE_LANDMARKS_TESSELATION=OH;var cD=$c([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function nk(n){n.gestures=[],n.landmarks=[],n.worldLandmarks=[],n.handedness=[]}function ik(n){return n.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:n.gestures,landmarks:n.landmarks,worldLandmarks:n.worldLandmarks,handedness:n.handedness,handednesses:n.handedness}}function rk(n,e=!0){const t=[];for(const r of n){var i=PC(r);n=[];for(const s of i.g())i=e&&oc(s,1)!=null?oc(s,1)??0:-1,n.push({score:us(s,2)??0,index:i,categoryName:xa(Cr(s,3))??""??"",displayName:xa(Cr(s,4))??""??""});t.push(n)}return t}var el=class extends Al{constructor(n,e){super(new Jc(n,e),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],_n(n=this.j=new cH,0,1,e=new ns),this.u=new KB,_n(this.j,0,2,this.u),this.D=new YB,_n(this.u,0,3,this.D),this.A=new lH,_n(this.u,0,2,this.A),this.h=new hfe,_n(this.j,0,3,this.h),dn(this.A,2,.5),dn(this.u,4,.5),dn(this.D,2,.5)}get baseOptions(){return _i(this.j,ns,1)}set baseOptions(n){_n(this.j,0,1,n)}o(n){if(xf(this.A,3,n.numHands??1),"minHandDetectionConfidence"in n&&dn(this.A,2,n.minHandDetectionConfidence??.5),"minTrackingConfidence"in n&&dn(this.u,4,n.minTrackingConfidence??.5),"minHandPresenceConfidence"in n&&dn(this.D,2,n.minHandPresenceConfidence??.5),n.cannedGesturesClassifierOptions){var e=new i0,t=e,i=O2(n.cannedGesturesClassifierOptions,_i(this.h,i0,3)?.l());_n(t,0,2,i),_n(this.h,0,3,e)}else n.cannedGesturesClassifierOptions===void 0&&_i(this.h,i0,3)?.g();return n.customGesturesClassifierOptions?(_n(t=e=new i0,0,2,i=O2(n.customGesturesClassifierOptions,_i(this.h,i0,4)?.l())),_n(this.h,0,4,e)):n.customGesturesClassifierOptions===void 0&&_i(this.h,i0,4)?.g(),this.l(n)}Ha(n,e){return nk(this),Zc(this,n,e),ik(this)}Ia(n,e,t){return nk(this),lh(this,n,t,e),ik(this)}m(){var n=new bl;Wr(n,"image_in"),Wr(n,"norm_rect"),Ti(n,"hand_gestures"),Ti(n,"hand_landmarks"),Ti(n,"world_hand_landmarks"),Ti(n,"handedness");const e=new yl;ah(e,ffe,this.j);const t=new Go;ml(t,2,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),Tr(t,"IMAGE:image_in"),Tr(t,"NORM_RECT:norm_rect"),mi(t,"HAND_GESTURES:hand_gestures"),mi(t,"LANDMARKS:hand_landmarks"),mi(t,"WORLD_LANDMARKS:world_hand_landmarks"),mi(t,"HANDEDNESS:handedness"),t.o(e),mc(n,t),this.g.attachProtoVectorListener("hand_landmarks",((i,r)=>{for(const s of i){i=wx(s);const a=[];for(const o of bf(i,eH,1))a.push({x:us(o,1)??0,y:us(o,2)??0,z:us(o,3)??0,visibility:us(o,4)??0});this.landmarks.push(a)}nn(this,r)})),this.g.attachEmptyPacketListener("hand_landmarks",(i=>{nn(this,i)})),this.g.attachProtoVectorListener("world_hand_landmarks",((i,r)=>{for(const s of i){i=x0(s);const a=[];for(const o of bf(i,Z7,1))a.push({x:us(o,1)??0,y:us(o,2)??0,z:us(o,3)??0,visibility:us(o,4)??0});this.worldLandmarks.push(a)}nn(this,r)})),this.g.attachEmptyPacketListener("world_hand_landmarks",(i=>{nn(this,i)})),this.g.attachProtoVectorListener("hand_gestures",((i,r)=>{this.gestures.push(...rk(i,!1)),nn(this,r)})),this.g.attachEmptyPacketListener("hand_gestures",(i=>{nn(this,i)})),this.g.attachProtoVectorListener("handedness",((i,r)=>{this.handedness.push(...rk(i)),nn(this,r)})),this.g.attachEmptyPacketListener("handedness",(i=>{nn(this,i)})),n=n.g(),this.setGraph(new Uint8Array(n),!0)}};function sk(n){return{landmarks:n.landmarks,worldLandmarks:n.worldLandmarks,handednesses:n.handedness,handedness:n.handedness}}el.prototype.recognizeForVideo=el.prototype.Ia,el.prototype.recognize=el.prototype.Ha,el.prototype.setOptions=el.prototype.o,el.createFromModelPath=function(n,e){return Ai(el,n,{baseOptions:{modelAssetPath:e}})},el.createFromModelBuffer=function(n,e){return Ai(el,n,{baseOptions:{modelAssetBuffer:e}})},el.createFromOptions=function(n,e){return Ai(el,n,e)},el.HAND_CONNECTIONS=cD;var Fo=class extends Al{constructor(n,e){super(new Jc(n,e),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],_n(n=this.h=new KB,0,1,e=new ns),this.u=new YB,_n(this.h,0,3,this.u),this.j=new lH,_n(this.h,0,2,this.j),xf(this.j,3,1),dn(this.j,2,.5),dn(this.u,2,.5),dn(this.h,4,.5)}get baseOptions(){return _i(this.h,ns,1)}set baseOptions(n){_n(this.h,0,1,n)}o(n){return"numHands"in n&&xf(this.j,3,n.numHands??1),"minHandDetectionConfidence"in n&&dn(this.j,2,n.minHandDetectionConfidence??.5),"minTrackingConfidence"in n&&dn(this.h,4,n.minTrackingConfidence??.5),"minHandPresenceConfidence"in n&&dn(this.u,2,n.minHandPresenceConfidence??.5),this.l(n)}F(n,e){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Zc(this,n,e),sk(this)}G(n,e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],lh(this,n,t,e),sk(this)}m(){var n=new bl;Wr(n,"image_in"),Wr(n,"norm_rect"),Ti(n,"hand_landmarks"),Ti(n,"world_hand_landmarks"),Ti(n,"handedness");const e=new yl;ah(e,dfe,this.h);const t=new Go;ml(t,2,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),Tr(t,"IMAGE:image_in"),Tr(t,"NORM_RECT:norm_rect"),mi(t,"LANDMARKS:hand_landmarks"),mi(t,"WORLD_LANDMARKS:world_hand_landmarks"),mi(t,"HANDEDNESS:handedness"),t.o(e),mc(n,t),this.g.attachProtoVectorListener("hand_landmarks",((i,r)=>{for(const s of i)i=wx(s),this.landmarks.push(kC(i));nn(this,r)})),this.g.attachEmptyPacketListener("hand_landmarks",(i=>{nn(this,i)})),this.g.attachProtoVectorListener("world_hand_landmarks",((i,r)=>{for(const s of i)i=x0(s),this.worldLandmarks.push(ub(i));nn(this,r)})),this.g.attachEmptyPacketListener("world_hand_landmarks",(i=>{nn(this,i)})),this.g.attachProtoVectorListener("handedness",((i,r)=>{var s=this.handedness,a=s.push;const o=[];for(const c of i){i=PC(c);const h=[];for(const p of i.g())h.push({score:us(p,2)??0,index:oc(p,1)??0??-1,categoryName:xa(Cr(p,3))??""??"",displayName:xa(Cr(p,4))??""??""});o.push(h)}a.call(s,...o),nn(this,r)})),this.g.attachEmptyPacketListener("handedness",(i=>{nn(this,i)})),n=n.g(),this.setGraph(new Uint8Array(n),!0)}};Fo.prototype.detectForVideo=Fo.prototype.G,Fo.prototype.detect=Fo.prototype.F,Fo.prototype.setOptions=Fo.prototype.o,Fo.createFromModelPath=function(n,e){return Ai(Fo,n,{baseOptions:{modelAssetPath:e}})},Fo.createFromModelBuffer=function(n,e){return Ai(Fo,n,{baseOptions:{modelAssetBuffer:e}})},Fo.createFromOptions=function(n,e){return Ai(Fo,n,e)},Fo.HAND_CONNECTIONS=cD;var kH=$c([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function ak(n){n.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function ok(n){try{if(!n.D)return n.h;n.D(n.h)}finally{GC(n)}}function PE(n,e){n=wx(n),e.push(kC(n))}var Er=class extends Al{constructor(n,e){super(new Jc(n,e),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,_n(n=this.j=new pH,0,1,e=new ns),this.I=new YB,_n(this.j,0,2,this.I),this.W=new pfe,_n(this.j,0,3,this.W),this.u=new OC,_n(this.j,0,4,this.u),this.O=new sH,_n(this.j,0,5,this.O),this.A=new fH,_n(this.j,0,6,this.A),this.M=new dH,_n(this.j,0,7,this.M),dn(this.u,2,.5),dn(this.u,3,.3),dn(this.O,2,.5),dn(this.A,2,.5),dn(this.A,3,.3),dn(this.M,2,.5),dn(this.I,2,.5)}get baseOptions(){return _i(this.j,ns,1)}set baseOptions(n){_n(this.j,0,1,n)}o(n){return"minFaceDetectionConfidence"in n&&dn(this.u,2,n.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in n&&dn(this.u,3,n.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in n&&dn(this.O,2,n.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in n&&(this.outputFaceBlendshapes=!!n.outputFaceBlendshapes),"minPoseDetectionConfidence"in n&&dn(this.A,2,n.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in n&&dn(this.A,3,n.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in n&&dn(this.M,2,n.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in n&&(this.outputPoseSegmentationMasks=!!n.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in n&&dn(this.I,2,n.minHandLandmarksConfidence??.5),this.l(n)}F(n,e,t){const i=typeof e!="function"?e:{};return this.D=typeof e=="function"?e:t,ak(this),Zc(this,n,i),ok(this)}G(n,e,t,i){const r=typeof t!="function"?t:{};return this.D=typeof t=="function"?t:i,ak(this),lh(this,n,r,e),ok(this)}m(){var n=new bl;Wr(n,"input_frames_image"),Ti(n,"pose_landmarks"),Ti(n,"pose_world_landmarks"),Ti(n,"face_landmarks"),Ti(n,"left_hand_landmarks"),Ti(n,"left_hand_world_landmarks"),Ti(n,"right_hand_landmarks"),Ti(n,"right_hand_world_landmarks");const e=new yl,t=new B5;ml(t,1,"type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),(function(r,s){if(s!=null)if(Array.isArray(s))qi(r,2,wC(s,0,Vb));else{if(!(typeof s=="string"||s instanceof $u||gB(s)))throw Error("invalid value in Any.value field: "+s+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");Ed(r,2,vB(s,!1),ng())}})(t,this.j.g());const i=new Go;ml(i,2,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),LB(i,8,B5,t),Tr(i,"IMAGE:input_frames_image"),mi(i,"POSE_LANDMARKS:pose_landmarks"),mi(i,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),mi(i,"FACE_LANDMARKS:face_landmarks"),mi(i,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),mi(i,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),mi(i,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),mi(i,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),i.o(e),mc(n,i),zC(this,n),this.g.attachProtoListener("pose_landmarks",((r,s)=>{PE(r,this.h.poseLandmarks),nn(this,s)})),this.g.attachEmptyPacketListener("pose_landmarks",(r=>{nn(this,r)})),this.g.attachProtoListener("pose_world_landmarks",((r,s)=>{var a=this.h.poseWorldLandmarks;r=x0(r),a.push(ub(r)),nn(this,s)})),this.g.attachEmptyPacketListener("pose_world_landmarks",(r=>{nn(this,r)})),this.outputPoseSegmentationMasks&&(mi(i,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),J0(this,"pose_segmentation_mask"),this.g.Z("pose_segmentation_mask",((r,s)=>{this.h.poseSegmentationMasks=[ev(this,r,!0,!this.D)],nn(this,s)})),this.g.attachEmptyPacketListener("pose_segmentation_mask",(r=>{this.h.poseSegmentationMasks=[],nn(this,r)}))),this.g.attachProtoListener("face_landmarks",((r,s)=>{PE(r,this.h.faceLandmarks),nn(this,s)})),this.g.attachEmptyPacketListener("face_landmarks",(r=>{nn(this,r)})),this.outputFaceBlendshapes&&(Ti(n,"extra_blendshapes"),mi(i,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",((r,s)=>{var a=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(r=PC(r),a.push(eD(r.g()??[]))),nn(this,s)})),this.g.attachEmptyPacketListener("extra_blendshapes",(r=>{nn(this,r)}))),this.g.attachProtoListener("left_hand_landmarks",((r,s)=>{PE(r,this.h.leftHandLandmarks),nn(this,s)})),this.g.attachEmptyPacketListener("left_hand_landmarks",(r=>{nn(this,r)})),this.g.attachProtoListener("left_hand_world_landmarks",((r,s)=>{var a=this.h.leftHandWorldLandmarks;r=x0(r),a.push(ub(r)),nn(this,s)})),this.g.attachEmptyPacketListener("left_hand_world_landmarks",(r=>{nn(this,r)})),this.g.attachProtoListener("right_hand_landmarks",((r,s)=>{PE(r,this.h.rightHandLandmarks),nn(this,s)})),this.g.attachEmptyPacketListener("right_hand_landmarks",(r=>{nn(this,r)})),this.g.attachProtoListener("right_hand_world_landmarks",((r,s)=>{var a=this.h.rightHandWorldLandmarks;r=x0(r),a.push(ub(r)),nn(this,s)})),this.g.attachEmptyPacketListener("right_hand_world_landmarks",(r=>{nn(this,r)})),n=n.g(),this.setGraph(new Uint8Array(n),!0)}};Er.prototype.detectForVideo=Er.prototype.G,Er.prototype.detect=Er.prototype.F,Er.prototype.setOptions=Er.prototype.o,Er.createFromModelPath=function(n,e){return Ai(Er,n,{baseOptions:{modelAssetPath:e}})},Er.createFromModelBuffer=function(n,e){return Ai(Er,n,{baseOptions:{modelAssetBuffer:e}})},Er.createFromOptions=function(n,e){return Ai(Er,n,e)},Er.HAND_CONNECTIONS=cD,Er.POSE_CONNECTIONS=kH,Er.FACE_LANDMARKS_LIPS=iD,Er.FACE_LANDMARKS_LEFT_EYE=rD,Er.FACE_LANDMARKS_LEFT_EYEBROW=sD,Er.FACE_LANDMARKS_LEFT_IRIS=UH,Er.FACE_LANDMARKS_RIGHT_EYE=aD,Er.FACE_LANDMARKS_RIGHT_EYEBROW=oD,Er.FACE_LANDMARKS_RIGHT_IRIS=FH,Er.FACE_LANDMARKS_FACE_OVAL=lD,Er.FACE_LANDMARKS_CONTOURS=PH,Er.FACE_LANDMARKS_TESSELATION=OH;var Zl=class extends Al{constructor(n,e){super(new Jc(n,e),"input_image","norm_rect",!0),this.j={classifications:[]},_n(n=this.h=new mH,0,1,e=new ns)}get baseOptions(){return _i(this.h,ns,1)}set baseOptions(n){_n(this.h,0,1,n)}o(n){return _n(this.h,0,2,O2(n,_i(this.h,qB,2))),this.l(n)}sa(n,e){return this.j={classifications:[]},Zc(this,n,e),this.j}ta(n,e,t){return this.j={classifications:[]},lh(this,n,t,e),this.j}m(){var n=new bl;Wr(n,"input_image"),Wr(n,"norm_rect"),Ti(n,"classifications");const e=new yl;ah(e,mfe,this.h);const t=new Go;ml(t,2,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),Tr(t,"IMAGE:input_image"),Tr(t,"NORM_RECT:norm_rect"),mi(t,"CLASSIFICATIONS:classifications"),t.o(e),mc(n,t),this.g.attachProtoListener("classifications",((i,r)=>{this.j=xfe(ife(i)),nn(this,r)})),this.g.attachEmptyPacketListener("classifications",(i=>{nn(this,i)})),n=n.g(),this.setGraph(new Uint8Array(n),!0)}};Zl.prototype.classifyForVideo=Zl.prototype.ta,Zl.prototype.classify=Zl.prototype.sa,Zl.prototype.setOptions=Zl.prototype.o,Zl.createFromModelPath=function(n,e){return Ai(Zl,n,{baseOptions:{modelAssetPath:e}})},Zl.createFromModelBuffer=function(n,e){return Ai(Zl,n,{baseOptions:{modelAssetBuffer:e}})},Zl.createFromOptions=function(n,e){return Ai(Zl,n,e)};var tl=class extends Al{constructor(n,e){super(new Jc(n,e),"image_in","norm_rect",!0),this.h=new gH,this.embeddings={embeddings:[]},_n(n=this.h,0,1,e=new ns)}get baseOptions(){return _i(this.h,ns,1)}set baseOptions(n){_n(this.h,0,1,n)}o(n){var e=this.h,t=_i(this.h,z5,2);return t=t?t.clone():new z5,n.l2Normalize!==void 0?qi(t,1,Qb(n.l2Normalize)):"l2Normalize"in n&&qi(t,1),n.quantize!==void 0?qi(t,2,Qb(n.quantize)):"quantize"in n&&qi(t,2),_n(e,0,2,t),this.l(n)}za(n,e){return Zc(this,n,e),this.embeddings}Aa(n,e,t){return lh(this,n,t,e),this.embeddings}m(){var n=new bl;Wr(n,"image_in"),Wr(n,"norm_rect"),Ti(n,"embeddings_out");const e=new yl;ah(e,gfe,this.h);const t=new Go;ml(t,2,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),Tr(t,"IMAGE:image_in"),Tr(t,"NORM_RECT:norm_rect"),mi(t,"EMBEDDINGS:embeddings_out"),t.o(e),mc(n,t),this.g.attachProtoListener("embeddings_out",((i,r)=>{i=afe(i),this.embeddings=(function(s){return{embeddings:bf(s,sfe,1).map((a=>{const o={headIndex:oc(a,3)??0??-1,headName:xa(Cr(a,4))??""??""};var c=a.v;return f7(c,0|c[ln],k5,gR(a,1))!==void 0?(a=Sm(a=_i(a,k5,gR(a,1),void 0),1,Ku,_m()),o.floatEmbedding=a.slice()):(c=new Uint8Array(0),o.quantizedEmbedding=_i(a,rfe,gR(a,2),void 0)?.na()?.h()??c),o})),timestampMs:SH(m7(s))}})(i),nn(this,r)})),this.g.attachEmptyPacketListener("embeddings_out",(i=>{nn(this,i)})),n=n.g(),this.setGraph(new Uint8Array(n),!0)}};tl.cosineSimilarity=function(n,e){if(n.floatEmbedding&&e.floatEmbedding)n=W5(n.floatEmbedding,e.floatEmbedding);else{if(!n.quantizedEmbedding||!e.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");n=W5(j5(n.quantizedEmbedding),j5(e.quantizedEmbedding))}return n},tl.prototype.embedForVideo=tl.prototype.Aa,tl.prototype.embed=tl.prototype.za,tl.prototype.setOptions=tl.prototype.o,tl.createFromModelPath=function(n,e){return Ai(tl,n,{baseOptions:{modelAssetPath:e}})},tl.createFromModelBuffer=function(n,e){return Ai(tl,n,{baseOptions:{modelAssetBuffer:e}})},tl.createFromOptions=function(n,e){return Ai(tl,n,e)};var H2=class{constructor(n,e,t){this.confidenceMasks=n,this.categoryMask=e,this.qualityScores=t}close(){this.confidenceMasks?.forEach((n=>{n.close()})),this.categoryMask?.close()}};function Tfe(n){const e=(function(t){return bf(t,Go,1)})(n.ca()).filter((t=>(xa(Cr(t,1))??"").includes("mediapipe.tasks.TensorsToSegmentationCalculator")));if(n.u=[],e.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");e.length===1&&(_i(e[0],yl,7)?.j()?.g()??new Map).forEach(((t,i)=>{n.u[Number(i)]=xa(Cr(t,1))??""}))}function lk(n){n.categoryMask=void 0,n.confidenceMasks=void 0,n.qualityScores=void 0}function ck(n){try{const e=new H2(n.confidenceMasks,n.categoryMask,n.qualityScores);if(!n.j)return e;n.j(e)}finally{GC(n)}}H2.prototype.close=H2.prototype.close;var No=class extends Al{constructor(n,e){super(new Jc(n,e),"image_in","norm_rect",!1),this.u=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new ZB,this.A=new AH,_n(this.h,0,3,this.A),_n(n=this.h,0,1,e=new ns)}get baseOptions(){return _i(this.h,ns,1)}set baseOptions(n){_n(this.h,0,1,n)}o(n){return n.displayNamesLocale!==void 0?qi(this.h,2,_x(n.displayNamesLocale)):"displayNamesLocale"in n&&qi(this.h,2),"outputCategoryMask"in n&&(this.outputCategoryMask=n.outputCategoryMask??!1),"outputConfidenceMasks"in n&&(this.outputConfidenceMasks=n.outputConfidenceMasks??!0),super.l(n)}L(){Tfe(this)}segment(n,e,t){const i=typeof e!="function"?e:{};return this.j=typeof e=="function"?e:t,lk(this),Zc(this,n,i),ck(this)}La(n,e,t,i){const r=typeof t!="function"?t:{};return this.j=typeof t=="function"?t:i,lk(this),lh(this,n,r,e),ck(this)}Da(){return this.u}m(){var n=new bl;Wr(n,"image_in"),Wr(n,"norm_rect");const e=new yl;ah(e,yH,this.h);const t=new Go;ml(t,2,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),Tr(t,"IMAGE:image_in"),Tr(t,"NORM_RECT:norm_rect"),t.o(e),mc(n,t),zC(this,n),this.outputConfidenceMasks&&(Ti(n,"confidence_masks"),mi(t,"CONFIDENCE_MASKS:confidence_masks"),J0(this,"confidence_masks"),this.g.aa("confidence_masks",((i,r)=>{this.confidenceMasks=i.map((s=>ev(this,s,!0,!this.j))),nn(this,r)})),this.g.attachEmptyPacketListener("confidence_masks",(i=>{this.confidenceMasks=[],nn(this,i)}))),this.outputCategoryMask&&(Ti(n,"category_mask"),mi(t,"CATEGORY_MASK:category_mask"),J0(this,"category_mask"),this.g.Z("category_mask",((i,r)=>{this.categoryMask=ev(this,i,!1,!this.j),nn(this,r)})),this.g.attachEmptyPacketListener("category_mask",(i=>{this.categoryMask=void 0,nn(this,i)}))),Ti(n,"quality_scores"),mi(t,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",((i,r)=>{this.qualityScores=i,nn(this,r)})),this.g.attachEmptyPacketListener("quality_scores",(i=>{this.categoryMask=void 0,nn(this,i)})),n=n.g(),this.setGraph(new Uint8Array(n),!0)}};No.prototype.getLabels=No.prototype.Da,No.prototype.segmentForVideo=No.prototype.La,No.prototype.segment=No.prototype.segment,No.prototype.setOptions=No.prototype.o,No.createFromModelPath=function(n,e){return Ai(No,n,{baseOptions:{modelAssetPath:e}})},No.createFromModelBuffer=function(n,e){return Ai(No,n,{baseOptions:{modelAssetBuffer:e}})},No.createFromOptions=function(n,e){return Ai(No,n,e)};var Q2=class{constructor(n,e,t){this.confidenceMasks=n,this.categoryMask=e,this.qualityScores=t}close(){this.confidenceMasks?.forEach((n=>{n.close()})),this.categoryMask?.close()}};Q2.prototype.close=Q2.prototype.close;var Ou=class extends Al{constructor(n,e){super(new Jc(n,e),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new ZB,this.u=new AH,_n(this.h,0,3,this.u),_n(n=this.h,0,1,e=new ns)}get baseOptions(){return _i(this.h,ns,1)}set baseOptions(n){_n(this.h,0,1,n)}o(n){return"outputCategoryMask"in n&&(this.outputCategoryMask=n.outputCategoryMask??!1),"outputConfidenceMasks"in n&&(this.outputConfidenceMasks=n.outputConfidenceMasks??!0),super.l(n)}segment(n,e,t,i){const r=typeof t!="function"?t:{};if(this.j=typeof t=="function"?t:i,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,t=this.C+1,i=new bH,e.keypoint&&e.scribble)throw Error("Cannot provide both keypoint and scribble.");if(e.keypoint){var s=new bR;Ed(s,3,Qb(!0),!1),Ed(s,1,K1(e.keypoint.x),0),Ed(s,2,K1(e.keypoint.y),0),lb(i,1,P2,s)}else{if(!e.scribble)throw Error("Must provide either a keypoint or a scribble.");{const o=new vfe;for(s of e.scribble)Ed(e=new bR,3,Qb(!0),!1),Ed(e,1,K1(s.x),0),Ed(e,2,K1(s.y),0),LB(o,1,bR,e);lb(i,2,P2,o)}}this.g.addProtoToStream(i.g(),"mediapipe.tasks.vision.interactive_segmenter.proto.RegionOfInterest","roi_in",t),Zc(this,n,r);e:{try{const o=new Q2(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var a=o;break e}this.j(o)}finally{GC(this)}a=void 0}return a}m(){var n=new bl;Wr(n,"image_in"),Wr(n,"roi_in"),Wr(n,"norm_rect_in");const e=new yl;ah(e,yH,this.h);const t=new Go;ml(t,2,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraphV2"),Tr(t,"IMAGE:image_in"),Tr(t,"ROI:roi_in"),Tr(t,"NORM_RECT:norm_rect_in"),t.o(e),mc(n,t),zC(this,n),this.outputConfidenceMasks&&(Ti(n,"confidence_masks"),mi(t,"CONFIDENCE_MASKS:confidence_masks"),J0(this,"confidence_masks"),this.g.aa("confidence_masks",((i,r)=>{this.confidenceMasks=i.map((s=>ev(this,s,!0,!this.j))),nn(this,r)})),this.g.attachEmptyPacketListener("confidence_masks",(i=>{this.confidenceMasks=[],nn(this,i)}))),this.outputCategoryMask&&(Ti(n,"category_mask"),mi(t,"CATEGORY_MASK:category_mask"),J0(this,"category_mask"),this.g.Z("category_mask",((i,r)=>{this.categoryMask=ev(this,i,!1,!this.j),nn(this,r)})),this.g.attachEmptyPacketListener("category_mask",(i=>{this.categoryMask=void 0,nn(this,i)}))),Ti(n,"quality_scores"),mi(t,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",((i,r)=>{this.qualityScores=i,nn(this,r)})),this.g.attachEmptyPacketListener("quality_scores",(i=>{this.categoryMask=void 0,nn(this,i)})),n=n.g(),this.setGraph(new Uint8Array(n),!0)}};Ou.prototype.segment=Ou.prototype.segment,Ou.prototype.setOptions=Ou.prototype.o,Ou.createFromModelPath=function(n,e){return Ai(Ou,n,{baseOptions:{modelAssetPath:e}})},Ou.createFromModelBuffer=function(n,e){return Ai(Ou,n,{baseOptions:{modelAssetBuffer:e}})},Ou.createFromOptions=function(n,e){return Ai(Ou,n,e)};var ec=class extends Al{constructor(n,e){super(new Jc(n,e),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},_n(n=this.h=new xH,0,1,e=new ns)}get baseOptions(){return _i(this.h,ns,1)}set baseOptions(n){_n(this.h,0,1,n)}o(n){return n.displayNamesLocale!==void 0?qi(this.h,2,_x(n.displayNamesLocale)):"displayNamesLocale"in n&&qi(this.h,2),n.maxResults!==void 0?xf(this.h,3,n.maxResults):"maxResults"in n&&qi(this.h,3),n.scoreThreshold!==void 0?dn(this.h,4,n.scoreThreshold):"scoreThreshold"in n&&qi(this.h,4),n.categoryAllowlist!==void 0?sM(this.h,5,n.categoryAllowlist):"categoryAllowlist"in n&&qi(this.h,5),n.categoryDenylist!==void 0?sM(this.h,6,n.categoryDenylist):"categoryDenylist"in n&&qi(this.h,6),this.l(n)}F(n,e){return this.j={detections:[]},Zc(this,n,e),this.j}G(n,e,t){return this.j={detections:[]},lh(this,n,t,e),this.j}m(){var n=new bl;Wr(n,"input_frame_gpu"),Wr(n,"norm_rect"),Ti(n,"detections");const e=new yl;ah(e,yfe,this.h);const t=new Go;ml(t,2,"mediapipe.tasks.vision.ObjectDetectorGraph"),Tr(t,"IMAGE:input_frame_gpu"),Tr(t,"NORM_RECT:norm_rect"),mi(t,"DETECTIONS:detections"),t.o(e),mc(n,t),this.g.attachProtoVectorListener("detections",((i,r)=>{for(const s of i)i=J7(s),this.j.detections.push(EH(i));nn(this,r)})),this.g.attachEmptyPacketListener("detections",(i=>{nn(this,i)})),n=n.g(),this.setGraph(new Uint8Array(n),!0)}};ec.prototype.detectForVideo=ec.prototype.G,ec.prototype.detect=ec.prototype.F,ec.prototype.setOptions=ec.prototype.o,ec.createFromModelPath=async function(n,e){return Ai(ec,n,{baseOptions:{modelAssetPath:e}})},ec.createFromModelBuffer=function(n,e){return Ai(ec,n,{baseOptions:{modelAssetBuffer:e}})},ec.createFromOptions=function(n,e){return Ai(ec,n,e)};var V2=class{constructor(n,e,t){this.landmarks=n,this.worldLandmarks=e,this.segmentationMasks=t}close(){this.segmentationMasks?.forEach((n=>{n.close()}))}};function uk(n){n.landmarks=[],n.worldLandmarks=[],n.segmentationMasks=void 0}function hk(n){try{const e=new V2(n.landmarks,n.worldLandmarks,n.segmentationMasks);if(!n.u)return e;n.u(e)}finally{GC(n)}}V2.prototype.close=V2.prototype.close;var Po=class extends Al{constructor(n,e){super(new Jc(n,e),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,_n(n=this.h=new _H,0,1,e=new ns),this.A=new dH,_n(this.h,0,3,this.A),this.j=new fH,_n(this.h,0,2,this.j),xf(this.j,4,1),dn(this.j,2,.5),dn(this.A,2,.5),dn(this.h,4,.5)}get baseOptions(){return _i(this.h,ns,1)}set baseOptions(n){_n(this.h,0,1,n)}o(n){return"numPoses"in n&&xf(this.j,4,n.numPoses??1),"minPoseDetectionConfidence"in n&&dn(this.j,2,n.minPoseDetectionConfidence??.5),"minTrackingConfidence"in n&&dn(this.h,4,n.minTrackingConfidence??.5),"minPosePresenceConfidence"in n&&dn(this.A,2,n.minPosePresenceConfidence??.5),"outputSegmentationMasks"in n&&(this.outputSegmentationMasks=n.outputSegmentationMasks??!1),this.l(n)}F(n,e,t){const i=typeof e!="function"?e:{};return this.u=typeof e=="function"?e:t,uk(this),Zc(this,n,i),hk(this)}G(n,e,t,i){const r=typeof t!="function"?t:{};return this.u=typeof t=="function"?t:i,uk(this),lh(this,n,r,e),hk(this)}m(){var n=new bl;Wr(n,"image_in"),Wr(n,"norm_rect"),Ti(n,"normalized_landmarks"),Ti(n,"world_landmarks"),Ti(n,"segmentation_masks");const e=new yl;ah(e,bfe,this.h);const t=new Go;ml(t,2,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),Tr(t,"IMAGE:image_in"),Tr(t,"NORM_RECT:norm_rect"),mi(t,"NORM_LANDMARKS:normalized_landmarks"),mi(t,"WORLD_LANDMARKS:world_landmarks"),t.o(e),mc(n,t),zC(this,n),this.g.attachProtoVectorListener("normalized_landmarks",((i,r)=>{this.landmarks=[];for(const s of i)i=wx(s),this.landmarks.push(kC(i));nn(this,r)})),this.g.attachEmptyPacketListener("normalized_landmarks",(i=>{this.landmarks=[],nn(this,i)})),this.g.attachProtoVectorListener("world_landmarks",((i,r)=>{this.worldLandmarks=[];for(const s of i)i=x0(s),this.worldLandmarks.push(ub(i));nn(this,r)})),this.g.attachEmptyPacketListener("world_landmarks",(i=>{this.worldLandmarks=[],nn(this,i)})),this.outputSegmentationMasks&&(mi(t,"SEGMENTATION_MASK:segmentation_masks"),J0(this,"segmentation_masks"),this.g.aa("segmentation_masks",((i,r)=>{this.segmentationMasks=i.map((s=>ev(this,s,!0,!this.u))),nn(this,r)})),this.g.attachEmptyPacketListener("segmentation_masks",(i=>{this.segmentationMasks=[],nn(this,i)}))),n=n.g(),this.setGraph(new Uint8Array(n),!0)}};Po.prototype.detectForVideo=Po.prototype.G,Po.prototype.detect=Po.prototype.F,Po.prototype.setOptions=Po.prototype.o,Po.createFromModelPath=function(n,e){return Ai(Po,n,{baseOptions:{modelAssetPath:e}})},Po.createFromModelBuffer=function(n,e){return Ai(Po,n,{baseOptions:{modelAssetBuffer:e}})},Po.createFromOptions=function(n,e){return Ai(Po,n,e)},Po.POSE_CONNECTIONS=kH;const Zt={WRIST:0,THUMB_CMC:1,THUMB_MCP:2,THUMB_IP:3,THUMB_TIP:4,INDEX_MCP:5,INDEX_PIP:6,INDEX_DIP:7,INDEX_TIP:8,MIDDLE_MCP:9,MIDDLE_PIP:10,MIDDLE_DIP:11,MIDDLE_TIP:12,RING_MCP:13,RING_PIP:14,RING_DIP:15,RING_TIP:16,PINKY_MCP:17,PINKY_PIP:18,PINKY_DIP:19,PINKY_TIP:20},Ife=[[Zt.WRIST,Zt.THUMB_CMC],[Zt.THUMB_CMC,Zt.THUMB_MCP],[Zt.THUMB_MCP,Zt.THUMB_IP],[Zt.THUMB_IP,Zt.THUMB_TIP],[Zt.WRIST,Zt.INDEX_MCP],[Zt.INDEX_MCP,Zt.INDEX_PIP],[Zt.INDEX_PIP,Zt.INDEX_DIP],[Zt.INDEX_DIP,Zt.INDEX_TIP],[Zt.WRIST,Zt.MIDDLE_MCP],[Zt.MIDDLE_MCP,Zt.MIDDLE_PIP],[Zt.MIDDLE_PIP,Zt.MIDDLE_DIP],[Zt.MIDDLE_DIP,Zt.MIDDLE_TIP],[Zt.WRIST,Zt.RING_MCP],[Zt.RING_MCP,Zt.RING_PIP],[Zt.RING_PIP,Zt.RING_DIP],[Zt.RING_DIP,Zt.RING_TIP],[Zt.WRIST,Zt.PINKY_MCP],[Zt.PINKY_MCP,Zt.PINKY_PIP],[Zt.PINKY_PIP,Zt.PINKY_DIP],[Zt.PINKY_DIP,Zt.PINKY_TIP],[Zt.INDEX_MCP,Zt.MIDDLE_MCP],[Zt.MIDDLE_MCP,Zt.RING_MCP],[Zt.RING_MCP,Zt.PINKY_MCP]],_R={open_palm:{name:"Open Palm",emoji:"",description:"All fingers extended"},fist:{name:"Fist",emoji:"",description:"All fingers closed"},pointing:{name:"Pointing",emoji:"",description:"Index finger up"},thumbs_up:{name:"Thumbs Up",emoji:"",description:"Thumb extended up"},pinch:{name:"Pinch",emoji:"",description:"Thumb + index touching"},peace:{name:"Peace",emoji:"",description:"Index + middle up"},unknown:{name:"Unknown",emoji:"",description:"Gesture not recognized"}};function Rfe(n,e){const t=n.x-e.x,i=n.y-e.y;return Math.sqrt(t*t+i*i)}function OE(n,e,t,i){const r=n[e],s=n[t],a=n[i];return r.y<s.y&&s.y<a.y}function Bfe(n,e){const t=n[Zt.THUMB_TIP],i=n[Zt.THUMB_IP],r=n[Zt.THUMB_MCP];return e?t.x<i.x&&i.x<r.x:t.x>i.x&&i.x>r.x}function Dfe(n,e){const t=Bfe(n,e),i=OE(n,Zt.INDEX_TIP,Zt.INDEX_PIP,Zt.INDEX_MCP),r=OE(n,Zt.MIDDLE_TIP,Zt.MIDDLE_PIP,Zt.MIDDLE_MCP),s=OE(n,Zt.RING_TIP,Zt.RING_PIP,Zt.RING_MCP),a=OE(n,Zt.PINKY_TIP,Zt.PINKY_PIP,Zt.PINKY_MCP);return Rfe(n[Zt.THUMB_TIP],n[Zt.INDEX_TIP])<.05?"pinch":t&&!i&&!r&&!s&&!a?"thumbs_up":t&&i&&r&&s&&a?"open_palm":!t&&!i&&!r&&!s&&!a?"fist":!t&&i&&!r&&!s&&!a?"pointing":!t&&i&&r&&!s&&!a?"peace":"unknown"}const fk=["#06b6d4","#8b5cf6","#f43f5e","#22c55e","#f59e0b","#ec4899"];function Lfe(){const n=X.useRef(null),e=X.useRef(null),t=X.useRef(null),i=X.useRef(null),r=X.useRef(null),s=X.useRef(-1),a=X.useRef([]),o=X.useRef(null),c=X.useRef(!1),[h,p]=X.useState(!0),[g,A]=X.useState(!1),[v,x]=X.useState(null),[S,_]=X.useState("Initializing..."),[E,C]=X.useState(new Map),[T,R]=X.useState(0),[B,U]=X.useState(!0),[O,F]=X.useState(fk[0]),L=X.useCallback(async()=>{try{_("Loading MediaPipe...");const K=await wd.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");_("Creating hand detector...");const ce=await Fo.createFromOptions(K,{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/hand_landmarker/hand_landmarker/float16/1/hand_landmarker.task",delegate:"GPU"},runningMode:"VIDEO",numHands:2,minHandDetectionConfidence:.5,minHandPresenceConfidence:.5,minTrackingConfidence:.5});return i.current=ce,_("Ready!"),!0}catch(K){return console.error("Failed to initialize HandLandmarker:",K),x("Failed to load hand tracking model. Please check your internet connection."),!1}},[]),P=X.useCallback(async()=>{try{_("Starting camera...");const K=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:"user"}});return n.current&&(n.current.srcObject=K,await new Promise(ce=>{n.current.onloadedmetadata=()=>{n.current.play(),ce()}}),e.current&&t.current&&(e.current.width=n.current.videoWidth,e.current.height=n.current.videoHeight,t.current.width=n.current.videoWidth,t.current.height=n.current.videoHeight)),!0}catch(K){return console.error("Failed to start camera:",K),x("Failed to access camera. Please grant camera permission."),!1}},[]),W=X.useCallback((K,ce,ue)=>{const oe=e.current?.width||640,z=e.current?.height||480,ae=ue==="Right"?"#06b6d4":"#8b5cf6";K.strokeStyle=ae,K.lineWidth=3,K.lineCap="round",Ife.forEach(([he,me])=>{const le=ce[he],fe=ce[me];K.beginPath(),K.moveTo(le.x*oe,le.y*z),K.lineTo(fe.x*oe,fe.y*z),K.stroke()}),ce.forEach((he,me)=>{const le=he.x*oe,fe=he.y*z,_e=[4,8,12,16,20].includes(me),Pe=_e?8:5;K.beginPath(),K.arc(le,fe,Pe,0,2*Math.PI),K.fillStyle=_e?"#ffffff":ae,K.fill(),K.strokeStyle=ae,K.lineWidth=2,K.stroke()})},[]),j=X.useCallback(()=>{const K=t.current?.getContext("2d");if(!K||!t.current)return;K.clearRect(0,0,t.current.width,t.current.height);const ce=[...a.current];o.current&&ce.push(o.current),ce.forEach(ue=>{if(!(ue.points.length<2)){K.strokeStyle=ue.color,K.lineWidth=4,K.lineCap="round",K.lineJoin="round",K.beginPath(),K.moveTo(ue.points[0].x,ue.points[0].y);for(let oe=1;oe<ue.points.length;oe++)K.lineTo(ue.points[oe].x,ue.points[oe].y);K.stroke()}})},[]),V=X.useCallback(()=>{if(!n.current||!e.current||!i.current||n.current.currentTime===s.current){r.current=requestAnimationFrame(V);return}s.current=n.current.currentTime;const K=i.current.detectForVideo(n.current,performance.now()),ce=e.current.getContext("2d");if(!ce){r.current=requestAnimationFrame(V);return}ce.clearRect(0,0,e.current.width,e.current.height),R(K.landmarks.length);const ue=new Map;let oe=!1,z=null;K.landmarks.forEach(($,ae)=>{const he=K.handednesses[ae]?.[0]?.categoryName||"Unknown",me=he==="Right";W(ce,$,he);const le=Dfe($,me);if(ue.set(he,le),le==="pinch"&&B){oe=!0;const fe=$[Zt.THUMB_TIP],_e=$[Zt.INDEX_TIP];z={x:(fe.x+_e.x)/2*e.current.width,y:(fe.y+_e.y)/2*e.current.height}}}),C(ue),B&&(oe&&z?c.current?o.current&&o.current.points.push(z):o.current={points:[z],color:O}:c.current&&o.current&&(o.current.points.length>1&&a.current.push(o.current),o.current=null),c.current=oe,j()),r.current=requestAnimationFrame(V)},[W,j,B,O]),q=X.useCallback(async()=>{if(!await P()){p(!1);return}A(!0),p(!1),r.current=requestAnimationFrame(V)},[P,V]),re=X.useCallback(()=>{r.current&&(cancelAnimationFrame(r.current),r.current=null),n.current?.srcObject&&(n.current.srcObject.getTracks().forEach(ce=>ce.stop()),n.current.srcObject=null),A(!1)},[]),Q=X.useCallback(()=>{a.current=[],o.current=null,c.current=!1;const K=t.current?.getContext("2d");K&&t.current&&K.clearRect(0,0,t.current.width,t.current.height)},[]);return X.useEffect(()=>{let K=!0;return(async()=>{const ue=await L();K&&ue&&p(!1)})(),()=>{K=!1,re(),i.current?.close()}},[L,re]),D.jsxs("div",{className:"experiment-page hand-tracking-page",children:[D.jsxs("header",{className:"experiment-header",children:[D.jsx(nh,{to:"/",className:"back-link",children:" Back"}),D.jsxs("div",{children:[D.jsx("h1",{children:"Hand Tracking"}),D.jsx("p",{children:"MediaPipe hand detection & gesture recognition"})]})]}),D.jsxs("div",{className:"ar-container-wrapper",children:[D.jsxs("div",{className:`ar-container ${g?"active":""}`,children:[D.jsx("video",{ref:n,className:"video-feed",playsInline:!0,muted:!0}),D.jsx("canvas",{ref:e,className:"landmarks-canvas"}),D.jsx("canvas",{ref:t,className:"draw-canvas"}),h&&D.jsxs("div",{className:"loading-overlay",children:[D.jsx("div",{className:"loading-spinner"}),D.jsx("p",{children:S})]}),v&&D.jsxs("div",{className:"error-overlay",children:[D.jsx("span",{className:"error-icon",children:""}),D.jsx("p",{children:v}),D.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]}),!g&&!h&&!v&&D.jsxs("div",{className:"start-overlay",children:[D.jsx("button",{onClick:q,className:"start-button",children:" Start Tracking"}),D.jsx("p",{className:"permission-note",children:"Requires camera permission"})]}),g&&D.jsxs("div",{className:"status-overlay",children:[D.jsx("div",{className:"hand-count",children:T===0?" Show your hands!":`${T} hand${T>1?"s":""} detected`}),Array.from(E.entries()).map(([K,ce])=>D.jsxs("div",{className:"gesture-display",children:[D.jsxs("span",{className:"hand-label",children:[K,":"]}),D.jsx("span",{className:"gesture-emoji",children:_R[ce].emoji}),D.jsx("span",{className:"gesture-name",children:_R[ce].name})]},K))]})]}),g&&D.jsxs("div",{className:"controls-bar",children:[D.jsx("button",{onClick:re,className:"control-button stop",children:" Stop"}),D.jsx("button",{onClick:()=>U(!B),className:`control-button ${B?"active":""}`,children:B?" Draw ON":" Draw OFF"}),B&&D.jsx("button",{onClick:Q,className:"control-button",children:" Clear"})]})]}),g&&B&&D.jsxs("div",{className:"color-picker",children:[D.jsx("h3",{children:"Drawing Color"}),D.jsx("div",{className:"color-options",children:fk.map(K=>D.jsx("button",{className:`color-swatch ${O===K?"active":""}`,style:{backgroundColor:K},onClick:()=>F(K)},K))}),D.jsx("p",{className:"color-hint",children:"Pinch  to draw in the air!"})]}),D.jsxs("section",{className:"gestures-section",children:[D.jsx("h2",{children:"Recognized Gestures"}),D.jsx("div",{className:"gestures-grid",children:Object.entries(_R).filter(([K])=>K!=="unknown").map(([K,ce])=>D.jsxs("div",{className:"gesture-card",children:[D.jsx("span",{className:"gesture-card-emoji",children:ce.emoji}),D.jsx("span",{className:"gesture-card-name",children:ce.name}),D.jsx("span",{className:"gesture-card-desc",children:ce.description})]},K))})]}),D.jsxs("section",{className:"info-section",children:[D.jsx("h2",{children:"How It Works"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"MediaPipe HandLandmarker"}),"  Google's ML hand detection model"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"21 Landmarks"}),"  Tracks all finger joints and wrist"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Gesture Recognition"}),"  Custom logic using landmark positions"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"WebGL Acceleration"}),"  GPU-powered inference for real-time tracking"]})]}),D.jsx("h2",{children:"Hand Landmarks"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"Wrist (0)"}),"  Base reference point"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Thumb (1-4)"}),"  CMC, MCP, IP, Tip"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Index (5-8)"}),"  MCP, PIP, DIP, Tip"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Middle (9-12)"}),"  MCP, PIP, DIP, Tip"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Ring (13-16)"}),"  MCP, PIP, DIP, Tip"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Pinky (17-20)"}),"  MCP, PIP, DIP, Tip"]})]}),D.jsx("h2",{children:"Browser Requirements"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"Chrome / Edge / Safari"}),"  Modern browsers with WebGL"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Camera permission"}),"  Required for video input"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"HTTPS"}),"  Required for camera access"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"GPU recommended"}),"  For smooth real-time tracking"]})]}),D.jsx("h2",{children:"Use Cases"}),D.jsxs("ul",{children:[D.jsx("li",{children:"Sign language recognition"}),D.jsx("li",{children:"Touchless UI control"}),D.jsx("li",{children:"Virtual instrument playing"}),D.jsx("li",{children:"AR/VR hand interaction"}),D.jsx("li",{children:"Accessibility tools"}),D.jsx("li",{children:"Gesture-based gaming"})]})]})]})}const pt={NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,MOUTH_LEFT:9,MOUTH_RIGHT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32},Nfe=[[pt.LEFT_EAR,pt.LEFT_EYE_OUTER],[pt.LEFT_EYE_OUTER,pt.LEFT_EYE],[pt.LEFT_EYE,pt.LEFT_EYE_INNER],[pt.LEFT_EYE_INNER,pt.NOSE],[pt.NOSE,pt.RIGHT_EYE_INNER],[pt.RIGHT_EYE_INNER,pt.RIGHT_EYE],[pt.RIGHT_EYE,pt.RIGHT_EYE_OUTER],[pt.RIGHT_EYE_OUTER,pt.RIGHT_EAR],[pt.MOUTH_LEFT,pt.MOUTH_RIGHT],[pt.LEFT_SHOULDER,pt.RIGHT_SHOULDER],[pt.LEFT_SHOULDER,pt.LEFT_HIP],[pt.RIGHT_SHOULDER,pt.RIGHT_HIP],[pt.LEFT_HIP,pt.RIGHT_HIP],[pt.LEFT_SHOULDER,pt.LEFT_ELBOW],[pt.LEFT_ELBOW,pt.LEFT_WRIST],[pt.LEFT_WRIST,pt.LEFT_PINKY],[pt.LEFT_WRIST,pt.LEFT_INDEX],[pt.LEFT_WRIST,pt.LEFT_THUMB],[pt.LEFT_PINKY,pt.LEFT_INDEX],[pt.RIGHT_SHOULDER,pt.RIGHT_ELBOW],[pt.RIGHT_ELBOW,pt.RIGHT_WRIST],[pt.RIGHT_WRIST,pt.RIGHT_PINKY],[pt.RIGHT_WRIST,pt.RIGHT_INDEX],[pt.RIGHT_WRIST,pt.RIGHT_THUMB],[pt.RIGHT_PINKY,pt.RIGHT_INDEX],[pt.LEFT_HIP,pt.LEFT_KNEE],[pt.LEFT_KNEE,pt.LEFT_ANKLE],[pt.LEFT_ANKLE,pt.LEFT_HEEL],[pt.LEFT_ANKLE,pt.LEFT_FOOT_INDEX],[pt.LEFT_HEEL,pt.LEFT_FOOT_INDEX],[pt.RIGHT_HIP,pt.RIGHT_KNEE],[pt.RIGHT_KNEE,pt.RIGHT_ANKLE],[pt.RIGHT_ANKLE,pt.RIGHT_HEEL],[pt.RIGHT_ANKLE,pt.RIGHT_FOOT_INDEX],[pt.RIGHT_HEEL,pt.RIGHT_FOOT_INDEX]],SR={standing:{name:"Standing",emoji:"",description:"Upright neutral position"},t_pose:{name:"T-Pose",emoji:"",description:"Arms extended horizontally"},arms_up:{name:"Arms Up",emoji:"",description:"Both arms raised overhead"},hands_on_hips:{name:"Hands on Hips",emoji:"",description:"Arms bent, hands at waist"},sitting:{name:"Sitting",emoji:"",description:"Seated or crouching position"},leaning:{name:"Leaning",emoji:"",description:"Body tilted to one side"},unknown:{name:"Unknown",emoji:"",description:"Pose not recognized"}},ER=["#06b6d4","#8b5cf6","#f43f5e","#22c55e","#f59e0b","#ec4899"];function ic(n,e,t){const i=Math.atan2(t.y-e.y,t.x-e.x)-Math.atan2(n.y-e.y,n.x-e.x);let r=Math.abs(i*180/Math.PI);return r>180&&(r=360-r),r}function wR(n,e){const t=n.x-e.x,i=n.y-e.y;return Math.sqrt(t*t+i*i)}function r0(n,e=.5){return(n.visibility??0)>e}function Ufe(n){const e=n[pt.LEFT_SHOULDER],t=n[pt.RIGHT_SHOULDER],i=n[pt.LEFT_ELBOW],r=n[pt.RIGHT_ELBOW],s=n[pt.LEFT_WRIST],a=n[pt.RIGHT_WRIST],o=n[pt.LEFT_HIP],c=n[pt.RIGHT_HIP],h=n[pt.LEFT_KNEE],p=n[pt.RIGHT_KNEE];if(!(r0(e)&&r0(t)&&r0(o)&&r0(c)))return"unknown";const A=ic(e,i,s),v=ic(t,r,a),x=ic(o,e,i),S=ic(c,t,r),_=r0(h)?ic(o,h,n[pt.LEFT_ANKLE]):180,E=r0(p)?ic(c,p,n[pt.RIGHT_ANKLE]):180,C={x:(e.x+t.x)/2,y:(e.y+t.y)/2},T={x:(o.x+c.x)/2,y:(o.y+c.y)/2},R=Math.abs(C.x-T.x)/wR(e,t);if(s.y<e.y-.1&&a.y<t.y-.1&&x>150&&S>150)return"arms_up";if(x>70&&x<110&&S>70&&S<110&&A>150&&v>150){const O=Math.abs(s.y-e.y),F=Math.abs(a.y-t.y);if(O<.15&&F<.15)return"t_pose"}const B=wR(s,o)<.15,U=wR(a,c)<.15;return B&&U&&A<120&&v<120?"hands_on_hips":_<120&&E<120?"sitting":R>.3?"leaning":_>150&&E>150&&R<.2?"standing":"unknown"}function dk(n){return{leftElbow:Math.round(ic(n[pt.LEFT_SHOULDER],n[pt.LEFT_ELBOW],n[pt.LEFT_WRIST])),rightElbow:Math.round(ic(n[pt.RIGHT_SHOULDER],n[pt.RIGHT_ELBOW],n[pt.RIGHT_WRIST])),leftKnee:Math.round(ic(n[pt.LEFT_HIP],n[pt.LEFT_KNEE],n[pt.LEFT_ANKLE])),rightKnee:Math.round(ic(n[pt.RIGHT_HIP],n[pt.RIGHT_KNEE],n[pt.RIGHT_ANKLE])),leftShoulder:Math.round(ic(n[pt.LEFT_HIP],n[pt.LEFT_SHOULDER],n[pt.LEFT_ELBOW])),rightShoulder:Math.round(ic(n[pt.RIGHT_HIP],n[pt.RIGHT_SHOULDER],n[pt.RIGHT_ELBOW]))}}function Ffe(){const n=X.useRef(null),e=X.useRef(null),t=X.useRef(null),i=X.useRef(null),r=X.useRef(-1),[s,a]=X.useState(!0),[o,c]=X.useState(!1),[h,p]=X.useState(null),[g,A]=X.useState("Initializing..."),[v,x]=X.useState(0),[S,_]=X.useState([]),[E,C]=X.useState(null),[T,R]=X.useState(!1),[B,U]=X.useState(!0),O=X.useCallback(async()=>{try{A("Loading MediaPipe...");const V=await wd.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");A("Creating pose detector...");const q=await Po.createFromOptions(V,{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/pose_landmarker/pose_landmarker_lite/float16/latest/pose_landmarker_lite.task",delegate:"GPU"},runningMode:"VIDEO",numPoses:3,minPoseDetectionConfidence:.5,minPosePresenceConfidence:.5,minTrackingConfidence:.5});return t.current=q,A("Ready!"),!0}catch(V){return console.error("Failed to initialize PoseLandmarker:",V),p("Failed to load pose detection model. Please check your internet connection."),!1}},[]),F=X.useCallback(async()=>{try{A("Starting camera...");const V=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:"user"}});return n.current&&(n.current.srcObject=V,await new Promise(q=>{n.current.onloadedmetadata=()=>{n.current.play(),q()}}),e.current&&(e.current.width=n.current.videoWidth,e.current.height=n.current.videoHeight)),!0}catch(V){return console.error("Failed to start camera:",V),p("Failed to access camera. Please grant camera permission."),!1}},[]),L=X.useCallback((V,q,re)=>{const Q=e.current?.width||640,K=e.current?.height||480;if(B&&(V.strokeStyle=re,V.lineWidth=3,V.lineCap="round",Nfe.forEach(([ce,ue])=>{const oe=q[ce],z=q[ue];(oe.visibility??0)>.5&&(z.visibility??0)>.5&&(V.beginPath(),V.moveTo(oe.x*Q,oe.y*K),V.lineTo(z.x*Q,z.y*K),V.stroke())}),q.forEach((ce,ue)=>{if((ce.visibility??0)<.5)return;const oe=ce.x*Q,z=ce.y*K,$=[pt.NOSE,pt.LEFT_SHOULDER,pt.RIGHT_SHOULDER,pt.LEFT_ELBOW,pt.RIGHT_ELBOW,pt.LEFT_WRIST,pt.RIGHT_WRIST,pt.LEFT_HIP,pt.RIGHT_HIP,pt.LEFT_KNEE,pt.RIGHT_KNEE,pt.LEFT_ANKLE,pt.RIGHT_ANKLE].includes(ue),ae=$?6:3;V.beginPath(),V.arc(oe,z,ae,0,2*Math.PI),V.fillStyle=$?"#ffffff":re,V.fill(),$&&(V.strokeStyle=re,V.lineWidth=2,V.stroke())}),T&&q.length>=33)){V.font="14px monospace",V.fillStyle="#ffffff",V.strokeStyle="#000000",V.lineWidth=3;const ce=dk(q);[{angle:ce.leftElbow,landmark:q[pt.LEFT_ELBOW]},{angle:ce.rightElbow,landmark:q[pt.RIGHT_ELBOW]},{angle:ce.leftKnee,landmark:q[pt.LEFT_KNEE]},{angle:ce.rightKnee,landmark:q[pt.RIGHT_KNEE]}].forEach(({angle:oe,landmark:z})=>{if((z.visibility??0)>.5){const $=z.x*Q+10,ae=z.y*K,he=`${oe}`;V.strokeText(he,$,ae),V.fillText(he,$,ae)}})}},[B,T]),P=X.useCallback(()=>{if(!n.current||!e.current||!t.current||n.current.currentTime===r.current){i.current=requestAnimationFrame(P);return}r.current=n.current.currentTime;const V=t.current.detectForVideo(n.current,performance.now()),q=e.current.getContext("2d");if(!q){i.current=requestAnimationFrame(P);return}q.clearRect(0,0,e.current.width,e.current.height),x(V.landmarks.length);const re=[];V.landmarks.forEach((Q,K)=>{const ce=ER[K%ER.length];L(q,Q,ce);const ue=Ufe(Q);re.push(ue),K===0&&C(dk(Q))}),_(re),i.current=requestAnimationFrame(P)},[L]),W=X.useCallback(async()=>{if(!await F()){a(!1);return}c(!0),a(!1),i.current=requestAnimationFrame(P)},[F,P]),j=X.useCallback(()=>{i.current&&(cancelAnimationFrame(i.current),i.current=null),n.current?.srcObject&&(n.current.srcObject.getTracks().forEach(q=>q.stop()),n.current.srcObject=null),c(!1),C(null),_([])},[]);return X.useEffect(()=>{let V=!0;return(async()=>{const re=await O();V&&re&&a(!1)})(),()=>{V=!1,j(),t.current?.close()}},[O,j]),D.jsxs("div",{className:"experiment-page body-tracking-page",children:[D.jsxs("header",{className:"experiment-header",children:[D.jsx(nh,{to:"/",className:"back-link",children:" Back"}),D.jsxs("div",{children:[D.jsx("h1",{children:"Body Tracking"}),D.jsx("p",{children:"MediaPipe full-body pose detection & analysis"})]})]}),D.jsxs("div",{className:"ar-container-wrapper",children:[D.jsxs("div",{className:`ar-container ${o?"active":""}`,children:[D.jsx("video",{ref:n,className:"video-feed",playsInline:!0,muted:!0}),D.jsx("canvas",{ref:e,className:"landmarks-canvas"}),s&&D.jsxs("div",{className:"loading-overlay",children:[D.jsx("div",{className:"loading-spinner"}),D.jsx("p",{children:g})]}),h&&D.jsxs("div",{className:"error-overlay",children:[D.jsx("span",{className:"error-icon",children:""}),D.jsx("p",{children:h}),D.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]}),!o&&!s&&!h&&D.jsxs("div",{className:"start-overlay",children:[D.jsx("button",{onClick:W,className:"start-button",children:" Start Tracking"}),D.jsx("p",{className:"permission-note",children:"Requires camera permission"})]}),o&&D.jsxs("div",{className:"status-overlay",children:[D.jsx("div",{className:"pose-count",children:v===0?" Step into frame!":`${v} ${v===1?"person":"people"} detected`}),S.map((V,q)=>D.jsxs("div",{className:"pose-display",style:{color:ER[q]},children:[D.jsxs("span",{className:"person-label",children:["Person ",q+1,":"]}),D.jsx("span",{className:"pose-emoji",children:SR[V].emoji}),D.jsx("span",{className:"pose-name",children:SR[V].name})]},q))]})]}),o&&D.jsxs("div",{className:"controls-bar",children:[D.jsx("button",{onClick:j,className:"control-button stop",children:" Stop"}),D.jsx("button",{onClick:()=>U(!B),className:`control-button ${B?"active":""}`,children:B?" Skeleton ON":" Skeleton OFF"}),D.jsx("button",{onClick:()=>R(!T),className:`control-button ${T?"active":""}`,children:T?" Angles ON":" Angles OFF"})]})]}),o&&E&&D.jsxs("div",{className:"angles-panel",children:[D.jsx("h3",{children:"Joint Angles (Person 1)"}),D.jsxs("div",{className:"angles-grid",children:[D.jsxs("div",{className:"angle-item",children:[D.jsx("span",{className:"angle-label",children:"L Shoulder"}),D.jsxs("span",{className:"angle-value",children:[E.leftShoulder,""]})]}),D.jsxs("div",{className:"angle-item",children:[D.jsx("span",{className:"angle-label",children:"R Shoulder"}),D.jsxs("span",{className:"angle-value",children:[E.rightShoulder,""]})]}),D.jsxs("div",{className:"angle-item",children:[D.jsx("span",{className:"angle-label",children:"L Elbow"}),D.jsxs("span",{className:"angle-value",children:[E.leftElbow,""]})]}),D.jsxs("div",{className:"angle-item",children:[D.jsx("span",{className:"angle-label",children:"R Elbow"}),D.jsxs("span",{className:"angle-value",children:[E.rightElbow,""]})]}),D.jsxs("div",{className:"angle-item",children:[D.jsx("span",{className:"angle-label",children:"L Knee"}),D.jsxs("span",{className:"angle-value",children:[E.leftKnee,""]})]}),D.jsxs("div",{className:"angle-item",children:[D.jsx("span",{className:"angle-label",children:"R Knee"}),D.jsxs("span",{className:"angle-value",children:[E.rightKnee,""]})]})]})]}),D.jsxs("section",{className:"poses-section",children:[D.jsx("h2",{children:"Recognized Poses"}),D.jsx("div",{className:"poses-grid",children:Object.entries(SR).filter(([V])=>V!=="unknown").map(([V,q])=>D.jsxs("div",{className:"pose-card",children:[D.jsx("span",{className:"pose-card-emoji",children:q.emoji}),D.jsx("span",{className:"pose-card-name",children:q.name}),D.jsx("span",{className:"pose-card-desc",children:q.description})]},V))})]}),D.jsxs("section",{className:"info-section",children:[D.jsx("h2",{children:"How It Works"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"MediaPipe PoseLandmarker"}),"  Google's ML body detection model"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"33 Landmarks"}),"  Tracks full body from face to feet"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Multi-Person"}),"  Detects up to 3 people simultaneously"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Joint Angles"}),"  Real-time angle calculation for analysis"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"3D Coordinates"}),"  Depth estimation for each landmark"]})]}),D.jsx("h2",{children:"Body Landmarks (33 Points)"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"Face (0-10)"}),"  Nose, eyes, ears, mouth"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Upper Body (11-22)"}),"  Shoulders, elbows, wrists, hands"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Lower Body (23-32)"}),"  Hips, knees, ankles, feet"]})]}),D.jsx("h2",{children:"Browser Requirements"}),D.jsxs("ul",{children:[D.jsxs("li",{children:[D.jsx("strong",{children:"Chrome / Edge / Safari"}),"  Modern browsers with WebGL"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"Camera permission"}),"  Required for video input"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"HTTPS"}),"  Required for camera access"]}),D.jsxs("li",{children:[D.jsx("strong",{children:"GPU recommended"}),"  For smooth real-time tracking"]})]}),D.jsx("h2",{children:"Use Cases"}),D.jsxs("ul",{children:[D.jsx("li",{children:"Fitness & workout tracking"}),D.jsx("li",{children:"Posture analysis & correction"}),D.jsx("li",{children:"Physical therapy exercises"}),D.jsx("li",{children:"Dance & movement training"}),D.jsx("li",{children:"Sports performance analysis"}),D.jsx("li",{children:"Gesture-based gaming"}),D.jsx("li",{children:"Motion capture for animation"})]})]})]})}const zH=[{id:"01-model-viewer",title:"Model Viewer",description:"3D model with AR quick-look support",component:kre,status:"done"},{id:"02-face-tracking",title:"Face Tracking",description:"Face detection and filter overlays",component:zre,status:"done"},{id:"03-image-tracking",title:"Image Tracking",description:"Recognize images and overlay 3D content",component:Hre,status:"done"},{id:"04-surface-detection",title:"Surface Detection",description:"Place objects on real-world surfaces",component:Nue,status:"done"},{id:"05-world-tracking",title:"World Tracking",description:"Persistent AR anchors in space",component:Hue,status:"done"},{id:"06-hand-tracking",title:"Hand Tracking",description:"MediaPipe hand detection & gesture recognition",component:Lfe,status:"done"},{id:"07-body-tracking",title:"Body Tracking",description:"Full-body pose detection & analysis",component:Ffe,status:"done"}];function Pfe(){return D.jsxs("div",{className:"gallery",children:[D.jsxs("header",{className:"gallery-header",children:[D.jsx("h1",{children:"AR Lab"}),D.jsx("p",{children:"Web-based augmented reality experiments"})]}),D.jsx("div",{className:"experiments-grid",children:zH.map(n=>D.jsx("div",{className:`experiment-card ${n.status}`,children:n.status==="done"?D.jsxs(nh,{to:`/${n.id}`,className:"experiment-link",children:[D.jsx("div",{className:"experiment-number",children:n.id.split("-")[0]}),D.jsx("h2",{children:n.title}),D.jsx("p",{children:n.description}),D.jsx("span",{className:"status-badge",children:"Ready"})]}):D.jsxs("div",{className:"experiment-placeholder",children:[D.jsx("div",{className:"experiment-number",children:n.id.split("-")[0]}),D.jsx("h2",{children:n.title}),D.jsx("p",{children:n.description}),D.jsx("span",{className:"status-badge planned",children:"Coming Soon"})]})},n.id))}),D.jsx("footer",{className:"gallery-footer",children:D.jsx("p",{children:"Built with Three.js, WebXR, and React"})})]})}function Ofe(){return D.jsx(KV,{basename:"/ar-lab",children:D.jsxs(MV,{children:[D.jsx(CR,{path:"/",element:D.jsx(Pfe,{})}),zH.filter(n=>n.component).map(n=>D.jsx(CR,{path:`/${n.id}`,element:n.component?D.jsx(n.component,{}):null},n.id))]})})}mk.createRoot(document.getElementById("root")).render(D.jsx(X.StrictMode,{children:D.jsx(Ofe,{})}));export{vn as B,Mt as C,Us as E,Kt as F,Ds as G,qc as L,qt as M,Gn as O,nc as P,Bi as Q,Gd as R,hc as S,Qu as T,ee as V,Uk as _,JE as a,za as b,Xre as c,Yc as d,ar as e,Wt as f,j2 as g,Wd as h,ba as i,D as j,lv as k,Ze as l,gde as m,mk as n,X as r};
